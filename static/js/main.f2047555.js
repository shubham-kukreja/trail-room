/*! For license information please see main.f2047555.js.LICENSE.txt */
!function(){var g={5318:function(g){g.exports=function(g){return g&&g.__esModule?g:{default:g}},g.exports.__esModule=!0,g.exports.default=g.exports},7757:function(g,e,I){g.exports=I(9727)},8677:function(g,e,I){"use strict";I.d(e,{Z:function(){return ng}});var t=I(6567),n=Math.abs,C=String.fromCharCode,l=Object.assign;function o(g){return g.trim()}function a(g,e,I){return g.replace(e,I)}function i(g,e){return g.indexOf(e)}function r(g,e){return 0|g.charCodeAt(e)}function c(g,e,I){return g.slice(e,I)}function A(g){return g.length}function u(g){return g.length}function s(g,e){return e.push(g),g}var d=1,Z=1,b=0,m=0,h=0,G="";function p(g,e,I,t,n,C,l){return{value:g,root:e,parent:I,type:t,props:n,children:C,line:d,column:Z,length:l,return:""}}function y(g,e){return l(p("",null,null,"",null,null,0),g,{length:-g.length},e)}function B(){return h=m>0?r(G,--m):0,Z--,10===h&&(Z=1,d--),h}function v(){return h=m<b?r(G,m++):0,Z++,10===h&&(Z=1,d++),h}function V(){return r(G,m)}function W(){return m}function S(g,e){return c(G,g,e)}function f(g){switch(g){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function k(g){return d=Z=1,b=A(G=g),m=0,[]}function R(g){return G="",g}function X(g){return o(S(m-1,H(91===g?g+2:40===g?g+1:g)))}function J(g){for(;(h=V())&&h<33;)v();return f(g)>2||f(h)>3?"":" "}function Y(g,e){for(;--e&&v()&&!(h<48||h>102||h>57&&h<65||h>70&&h<97););return S(g,W()+(e<6&&32==V()&&32==v()))}function H(g){for(;v();)switch(h){case g:return m;case 34:case 39:34!==g&&39!==g&&H(h);break;case 40:41===g&&H(g);break;case 92:v()}return m}function w(g,e){for(;v()&&g+h!==57&&(g+h!==84||47!==V()););return"/*"+S(e,m-1)+"*"+C(47===g?g:v())}function N(g){for(;!f(V());)v();return S(g,m)}var K="-ms-",F="-moz-",E="-webkit-",x="comm",z="rule",U="decl",M="@keyframes";function L(g,e){for(var I="",t=u(g),n=0;n<t;n++)I+=e(g[n],n,g,e)||"";return I}function T(g,e,I,t){switch(g.type){case"@import":case U:return g.return=g.return||g.value;case x:return"";case M:return g.return=g.value+"{"+L(g.children,t)+"}";case z:g.value=g.props.join(",")}return A(I=L(g.children,t))?g.return=g.value+"{"+I+"}":""}function Q(g,e){switch(function(g,e){return(((e<<2^r(g,0))<<2^r(g,1))<<2^r(g,2))<<2^r(g,3)}(g,e)){case 5103:return E+"print-"+g+g;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return E+g+g;case 5349:case 4246:case 4810:case 6968:case 2756:return E+g+F+g+K+g+g;case 6828:case 4268:return E+g+K+g+g;case 6165:return E+g+K+"flex-"+g+g;case 5187:return E+g+a(g,/(\w+).+(:[^]+)/,"-webkit-box-$1$2-ms-flex-$1$2")+g;case 5443:return E+g+K+"flex-item-"+a(g,/flex-|-self/,"")+g;case 4675:return E+g+K+"flex-line-pack"+a(g,/align-content|flex-|-self/,"")+g;case 5548:return E+g+K+a(g,"shrink","negative")+g;case 5292:return E+g+K+a(g,"basis","preferred-size")+g;case 6060:return E+"box-"+a(g,"-grow","")+E+g+K+a(g,"grow","positive")+g;case 4554:return E+a(g,/([^-])(transform)/g,"$1-webkit-$2")+g;case 6187:return a(a(a(g,/(zoom-|grab)/,E+"$1"),/(image-set)/,E+"$1"),g,"")+g;case 5495:case 3959:return a(g,/(image-set\([^]*)/,E+"$1$`$1");case 4968:return a(a(g,/(.+:)(flex-)?(.*)/,"-webkit-box-pack:$3-ms-flex-pack:$3"),/s.+-b[^;]+/,"justify")+E+g+g;case 4095:case 3583:case 4068:case 2532:return a(g,/(.+)-inline(.+)/,E+"$1$2")+g;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(A(g)-1-e>6)switch(r(g,e+1)){case 109:if(45!==r(g,e+4))break;case 102:return a(g,/(.+:)(.+)-([^]+)/,"$1-webkit-$2-$3$1"+F+(108==r(g,e+3)?"$3":"$2-$3"))+g;case 115:return~i(g,"stretch")?Q(a(g,"stretch","fill-available"),e)+g:g}break;case 4949:if(115!==r(g,e+1))break;case 6444:switch(r(g,A(g)-3-(~i(g,"!important")&&10))){case 107:return a(g,":",":"+E)+g;case 101:return a(g,/(.+:)([^;!]+)(;|!.+)?/,"$1"+E+(45===r(g,14)?"inline-":"")+"box$3$1"+E+"$2$3$1"+K+"$2box$3")+g}break;case 5936:switch(r(g,e+11)){case 114:return E+g+K+a(g,/[svh]\w+-[tblr]{2}/,"tb")+g;case 108:return E+g+K+a(g,/[svh]\w+-[tblr]{2}/,"tb-rl")+g;case 45:return E+g+K+a(g,/[svh]\w+-[tblr]{2}/,"lr")+g}return E+g+K+g+g}return g}function D(g){return R(j("",null,null,null,[""],g=k(g),0,[0],g))}function j(g,e,I,t,n,l,o,r,c){for(var u=0,d=0,Z=o,b=0,m=0,h=0,G=1,p=1,y=1,S=0,f="",k=n,R=l,H=t,K=f;p;)switch(h=S,S=v()){case 40:if(108!=h&&58==K.charCodeAt(Z-1)){-1!=i(K+=a(X(S),"&","&\f"),"&\f")&&(y=-1);break}case 34:case 39:case 91:K+=X(S);break;case 9:case 10:case 13:case 32:K+=J(h);break;case 92:K+=Y(W()-1,7);continue;case 47:switch(V()){case 42:case 47:s(O(w(v(),W()),e,I),c);break;default:K+="/"}break;case 123*G:r[u++]=A(K)*y;case 125*G:case 59:case 0:switch(S){case 0:case 125:p=0;case 59+d:m>0&&A(K)-Z&&s(m>32?_(K+";",t,I,Z-1):_(a(K," ","")+";",t,I,Z-2),c);break;case 59:K+=";";default:if(s(H=P(K,e,I,u,d,n,r,f,k=[],R=[],Z),l),123===S)if(0===d)j(K,e,H,H,k,l,Z,r,R);else switch(b){case 100:case 109:case 115:j(g,H,H,t&&s(P(g,H,H,0,0,n,r,f,n,k=[],Z),R),n,R,Z,r,t?k:R);break;default:j(K,H,H,H,[""],R,0,r,R)}}u=d=m=0,G=y=1,f=K="",Z=o;break;case 58:Z=1+A(K),m=h;default:if(G<1)if(123==S)--G;else if(125==S&&0==G++&&125==B())continue;switch(K+=C(S),S*G){case 38:y=d>0?1:(K+="\f",-1);break;case 44:r[u++]=(A(K)-1)*y,y=1;break;case 64:45===V()&&(K+=X(v())),b=V(),d=Z=A(f=K+=N(W())),S++;break;case 45:45===h&&2==A(K)&&(G=0)}}return l}function P(g,e,I,t,C,l,i,r,A,s,d){for(var Z=C-1,b=0===C?l:[""],m=u(b),h=0,G=0,y=0;h<t;++h)for(var B=0,v=c(g,Z+1,Z=n(G=i[h])),V=g;B<m;++B)(V=o(G>0?b[B]+" "+v:a(v,/&\f/g,b[B])))&&(A[y++]=V);return p(g,e,I,0===C?z:r,A,s,d)}function O(g,e,I){return p(g,e,I,x,C(h),c(g,2,-2),0)}function _(g,e,I,t){return p(g,e,I,U,c(g,0,t),c(g,t+1,-1),t)}var q=function(g,e,I){for(var t=0,n=0;t=n,n=V(),38===t&&12===n&&(e[I]=1),!f(n);)v();return S(g,m)},$=function(g,e){return R(function(g,e){var I=-1,t=44;do{switch(f(t)){case 0:38===t&&12===V()&&(e[I]=1),g[I]+=q(m-1,e,I);break;case 2:g[I]+=X(t);break;case 4:if(44===t){g[++I]=58===V()?"&\f":"",e[I]=g[I].length;break}default:g[I]+=C(t)}}while(t=v());return g}(k(g),e))},gg=new WeakMap,eg=function(g){if("rule"===g.type&&g.parent&&!(g.length<1)){for(var e=g.value,I=g.parent,t=g.column===I.column&&g.line===I.line;"rule"!==I.type;)if(!(I=I.parent))return;if((1!==g.props.length||58===e.charCodeAt(0)||gg.get(I))&&!t){gg.set(g,!0);for(var n=[],C=$(e,n),l=I.props,o=0,a=0;o<C.length;o++)for(var i=0;i<l.length;i++,a++)g.props[a]=n[o]?C[o].replace(/&\f/g,l[i]):l[i]+" "+C[o]}}},Ig=function(g){if("decl"===g.type){var e=g.value;108===e.charCodeAt(0)&&98===e.charCodeAt(2)&&(g.return="",g.value="")}},tg=[function(g,e,I,t){if(g.length>-1&&!g.return)switch(g.type){case U:g.return=Q(g.value,g.length);break;case M:return L([y(g,{value:a(g.value,"@","@"+E)})],t);case z:if(g.length)return function(g,e){return g.map(e).join("")}(g.props,(function(e){switch(function(g,e){return(g=e.exec(g))?g[0]:g}(e,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return L([y(g,{props:[a(e,/:(read-\w+)/,":-moz-$1")]})],t);case"::placeholder":return L([y(g,{props:[a(e,/:(plac\w+)/,":-webkit-input-$1")]}),y(g,{props:[a(e,/:(plac\w+)/,":-moz-$1")]}),y(g,{props:[a(e,/:(plac\w+)/,K+"input-$1")]})],t)}return""}))}}],ng=function(g){var e=g.key;if("css"===e){var I=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(I,(function(g){-1!==g.getAttribute("data-emotion").indexOf(" ")&&(document.head.appendChild(g),g.setAttribute("data-s",""))}))}var n=g.stylisPlugins||tg;var C,l,o={},a=[];C=g.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+e+' "]'),(function(g){for(var e=g.getAttribute("data-emotion").split(" "),I=1;I<e.length;I++)o[e[I]]=!0;a.push(g)}));var i,r,c=[T,(r=function(g){i.insert(g)},function(g){g.root||(g=g.return)&&r(g)})],A=function(g){var e=u(g);return function(I,t,n,C){for(var l="",o=0;o<e;o++)l+=g[o](I,t,n,C)||"";return l}}([eg,Ig].concat(n,c));l=function(g,e,I,t){i=I,L(D(g?g+"{"+e.styles+"}":e.styles),A),t&&(s.inserted[e.name]=!0)};var s={key:e,sheet:new t.m({key:e,container:C,nonce:g.nonce,speedy:g.speedy,prepend:g.prepend,insertionPoint:g.insertionPoint}),nonce:g.nonce,inserted:o,registered:{},insert:l};return s.sheet.hydrate(a),s}},3782:function(g,e){"use strict";e.Z=function(g){var e=Object.create(null);return function(I){return void 0===e[I]&&(e[I]=g(I)),e[I]}}},1672:function(g,e,I){"use strict";I.d(e,{T:function(){return o},w:function(){return l}});var t=I(2791),n=I(8677),C=(I(1346),(0,t.createContext)("undefined"!==typeof HTMLElement?(0,n.Z)({key:"css"}):null));C.Provider;var l=function(g){return(0,t.forwardRef)((function(e,I){var n=(0,t.useContext)(C);return g(e,n,I)}))},o=(0,t.createContext)({})},1346:function(g,e,I){"use strict";I.d(e,{O:function(){return d}});var t=function(g){for(var e,I=0,t=0,n=g.length;n>=4;++t,n-=4)e=1540483477*(65535&(e=255&g.charCodeAt(t)|(255&g.charCodeAt(++t))<<8|(255&g.charCodeAt(++t))<<16|(255&g.charCodeAt(++t))<<24))+(59797*(e>>>16)<<16),I=1540483477*(65535&(e^=e>>>24))+(59797*(e>>>16)<<16)^1540483477*(65535&I)+(59797*(I>>>16)<<16);switch(n){case 3:I^=(255&g.charCodeAt(t+2))<<16;case 2:I^=(255&g.charCodeAt(t+1))<<8;case 1:I=1540483477*(65535&(I^=255&g.charCodeAt(t)))+(59797*(I>>>16)<<16)}return(((I=1540483477*(65535&(I^=I>>>13))+(59797*(I>>>16)<<16))^I>>>15)>>>0).toString(36)},n={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},C=I(3782),l=/[A-Z]|^ms/g,o=/_EMO_([^_]+?)_([^]*?)_EMO_/g,a=function(g){return 45===g.charCodeAt(1)},i=function(g){return null!=g&&"boolean"!==typeof g},r=(0,C.Z)((function(g){return a(g)?g:g.replace(l,"-$&").toLowerCase()})),c=function(g,e){switch(g){case"animation":case"animationName":if("string"===typeof e)return e.replace(o,(function(g,e,I){return u={name:e,styles:I,next:u},e}))}return 1===n[g]||a(g)||"number"!==typeof e||0===e?e:e+"px"};function A(g,e,I){if(null==I)return"";if(void 0!==I.__emotion_styles)return I;switch(typeof I){case"boolean":return"";case"object":if(1===I.anim)return u={name:I.name,styles:I.styles,next:u},I.name;if(void 0!==I.styles){var t=I.next;if(void 0!==t)for(;void 0!==t;)u={name:t.name,styles:t.styles,next:u},t=t.next;return I.styles+";"}return function(g,e,I){var t="";if(Array.isArray(I))for(var n=0;n<I.length;n++)t+=A(g,e,I[n])+";";else for(var C in I){var l=I[C];if("object"!==typeof l)null!=e&&void 0!==e[l]?t+=C+"{"+e[l]+"}":i(l)&&(t+=r(C)+":"+c(C,l)+";");else if(!Array.isArray(l)||"string"!==typeof l[0]||null!=e&&void 0!==e[l[0]]){var o=A(g,e,l);switch(C){case"animation":case"animationName":t+=r(C)+":"+o+";";break;default:t+=C+"{"+o+"}"}}else for(var a=0;a<l.length;a++)i(l[a])&&(t+=r(C)+":"+c(C,l[a])+";")}return t}(g,e,I);case"function":if(void 0!==g){var n=u,C=I(g);return u=n,A(g,e,C)}}if(null==e)return I;var l=e[I];return void 0!==l?l:I}var u,s=/label:\s*([^\s;\n{]+)\s*(;|$)/g;var d=function(g,e,I){if(1===g.length&&"object"===typeof g[0]&&null!==g[0]&&void 0!==g[0].styles)return g[0];var n=!0,C="";u=void 0;var l=g[0];null==l||void 0===l.raw?(n=!1,C+=A(I,e,l)):C+=l[0];for(var o=1;o<g.length;o++)C+=A(I,e,g[o]),n&&(C+=l[o]);s.lastIndex=0;for(var a,i="";null!==(a=s.exec(C));)i+="-"+a[1];return{name:t(C)+i,styles:C,next:u}}},6567:function(g,e,I){"use strict";I.d(e,{m:function(){return t}});var t=function(){function g(g){var e=this;this._insertTag=function(g){var I;I=0===e.tags.length?e.insertionPoint?e.insertionPoint.nextSibling:e.prepend?e.container.firstChild:e.before:e.tags[e.tags.length-1].nextSibling,e.container.insertBefore(g,I),e.tags.push(g)},this.isSpeedy=void 0===g.speedy||g.speedy,this.tags=[],this.ctr=0,this.nonce=g.nonce,this.key=g.key,this.container=g.container,this.prepend=g.prepend,this.insertionPoint=g.insertionPoint,this.before=null}var e=g.prototype;return e.hydrate=function(g){g.forEach(this._insertTag)},e.insert=function(g){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(function(g){var e=document.createElement("style");return e.setAttribute("data-emotion",g.key),void 0!==g.nonce&&e.setAttribute("nonce",g.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}(this));var e=this.tags[this.tags.length-1];if(this.isSpeedy){var I=function(g){if(g.sheet)return g.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===g)return document.styleSheets[e]}(e);try{I.insertRule(g,I.cssRules.length)}catch(t){0}}else e.appendChild(document.createTextNode(g));this.ctr++},e.flush=function(){this.tags.forEach((function(g){return g.parentNode&&g.parentNode.removeChild(g)})),this.tags=[],this.ctr=0},g}()},5438:function(g,e,I){"use strict";I.d(e,{f:function(){return t},M:function(){return n}});function t(g,e,I){var t="";return I.split(" ").forEach((function(I){void 0!==g[I]?e.push(g[I]+";"):t+=I+" "})),t}var n=function(g,e,I){var t=g.key+"-"+e.name;if(!1===I&&void 0===g.registered[t]&&(g.registered[t]=e.styles),void 0===g.inserted[e.name]){var n=e;do{g.insert(e===n?"."+t:"",n,g.sheet,!0);n=n.next}while(void 0!==n)}}},767:function(g,e,I){"use strict";function t(g,e,I){var t={};return Object.keys(g).forEach((function(n){t[n]=g[n].reduce((function(g,t){return t&&(I&&I[t]&&g.push(I[t]),g.push(e(t))),g}),[]).join(" ")})),t}I.d(e,{Z:function(){return t}})},7125:function(g,e){"use strict";var I=function(g){return g},t=function(){var g=I;return{configure:function(e){g=e},generate:function(e){return g(e)},reset:function(){g=I}}}();e.Z=t},5159:function(g,e,I){"use strict";I.d(e,{Z:function(){return C}});var t=I(7125),n={active:"Mui-active",checked:"Mui-checked",completed:"Mui-completed",disabled:"Mui-disabled",error:"Mui-error",expanded:"Mui-expanded",focused:"Mui-focused",focusVisible:"Mui-focusVisible",required:"Mui-required",selected:"Mui-selected"};function C(g,e){return n[e]||"".concat(t.Z.generate(g),"-").concat(e)}},208:function(g,e,I){"use strict";I.d(e,{Z:function(){return n}});var t=I(5159);function n(g,e){var I={};return e.forEach((function(e){I[e]=(0,t.Z)(g,e)})),I}},7394:function(g,e,I){"use strict";var t=I(5318);e.Z=void 0;var n=t(I(5649)),C=I(184),l=(0,n.default)((0,C.jsx)("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"}),"ArrowBack");e.Z=l},9823:function(g,e,I){"use strict";var t=I(5318);e.Z=void 0;var n=t(I(5649)),C=I(184),l=(0,n.default)((0,C.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close");e.Z=l},3007:function(g,e,I){"use strict";var t=I(5318);e.Z=void 0;var n=t(I(5649)),C=I(184),l=(0,n.default)([(0,C.jsx)("path",{d:"M19.78 17.51c-2.47 0-6.57-1.33-8.68-5.43-2.33-4.51-.5-8.48.53-10.07C6.27 2.2 1.98 6.59 1.98 12c0 .14.02.28.02.42.61-.26 1.28-.42 1.98-.42 0-3.09 1.73-5.77 4.3-7.1-.5 2.19-.54 5.04 1.04 8.1 1.57 3.04 4.18 4.95 6.8 5.86-1.23.74-2.65 1.15-4.13 1.15-.5 0-1-.05-1.48-.14-.37.7-.94 1.27-1.64 1.64.98.32 2.03.5 3.11.5 3.5 0 6.58-1.8 8.37-4.52-.17.01-.37.02-.57.02z"},"0"),(0,C.jsx)("path",{d:"M7 16h-.18C6.4 14.84 5.3 14 4 14c-1.66 0-3 1.34-3 3s1.34 3 3 3h3c1.1 0 2-.9 2-2s-.9-2-2-2z"},"1")],"NightsStayOutlined");e.Z=l},36:function(g,e,I){"use strict";var t=I(5318);e.Z=void 0;var n=t(I(5649)),C=I(184),l=(0,n.default)((0,C.jsx)("path",{d:"M9.5 6.5v3h-3v-3h3M11 5H5v6h6V5zm-1.5 9.5v3h-3v-3h3M11 13H5v6h6v-6zm6.5-6.5v3h-3v-3h3M19 5h-6v6h6V5zm-6 8h1.5v1.5H13V13zm1.5 1.5H16V16h-1.5v-1.5zM16 13h1.5v1.5H16V13zm-3 3h1.5v1.5H13V16zm1.5 1.5H16V19h-1.5v-1.5zM16 16h1.5v1.5H16V16zm1.5-1.5H19V16h-1.5v-1.5zm0 3H19V19h-1.5v-1.5zM22 7h-2V4h-3V2h5v5zm0 15v-5h-2v3h-3v2h5zM2 22h5v-2H4v-3H2v5zM2 2v5h2V4h3V2H2z"}),"QrCodeScanner");e.Z=l},3950:function(g,e,I){"use strict";var t=I(5318);e.Z=void 0;var n=t(I(5649)),C=I(184),l=(0,n.default)((0,C.jsx)("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"}),"Refresh");e.Z=l},3579:function(g,e,I){"use strict";var t=I(5318);e.Z=void 0;var n=t(I(5649)),C=I(184),l=(0,n.default)((0,C.jsx)("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"}),"RemoveRedEye");e.Z=l},165:function(g,e,I){"use strict";var t=I(5318);e.Z=void 0;var n=t(I(5649)),C=I(184),l=(0,n.default)((0,C.jsx)("path",{d:"M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78 3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z"}),"VisibilityOff");e.Z=l},5649:function(g,e,I){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"default",{enumerable:!0,get:function(){return t.createSvgIcon}});var t=I(3519)},5519:function(g,e){"use strict";e.Z={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"}},5547:function(g,e,I){"use strict";I.d(e,{Z:function(){return E}});var t=I(7462),n=I(3366),C=I(2466),l=I(5080),o=I(4942);function a(g,e,I){var n;return(0,t.Z)({toolbar:(n={minHeight:56},(0,o.Z)(n,"".concat(g.up("xs")," and (orientation: landscape)"),{minHeight:48}),(0,o.Z)(n,g.up("sm"),{minHeight:64}),n)},I)}var i=I(6189),r=I(2065),c={black:"#000",white:"#fff"},A=I(5519),u={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},s={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},d={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},Z={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},b={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},m={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},h=["mode","contrastThreshold","tonalOffset"],G={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:c.white,default:c.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},p={text:{primary:c.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:c.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function y(g,e,I,t){var n=t.light||t,C=t.dark||1.5*t;g[e]||(g.hasOwnProperty(I)?g[e]=g[I]:"light"===e?g.light=(0,r.$n)(g.main,n):"dark"===e&&(g.dark=(0,r._j)(g.main,C)))}function B(g){var e=g.mode,I=void 0===e?"light":e,l=g.contrastThreshold,o=void 0===l?3:l,a=g.tonalOffset,B=void 0===a?.2:a,v=(0,n.Z)(g,h),V=g.primary||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:Z[200],light:Z[50],dark:Z[400]}:{main:Z[700],light:Z[400],dark:Z[800]}}(I),W=g.secondary||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:u[200],light:u[50],dark:u[400]}:{main:u[500],light:u[300],dark:u[700]}}(I),S=g.error||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:s[500],light:s[300],dark:s[700]}:{main:s[700],light:s[400],dark:s[800]}}(I),f=g.info||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:b[400],light:b[300],dark:b[700]}:{main:b[700],light:b[500],dark:b[900]}}(I),k=g.success||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:m[400],light:m[300],dark:m[700]}:{main:m[800],light:m[500],dark:m[900]}}(I),R=g.warning||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:d[400],light:d[300],dark:d[700]}:{main:"#ed6c02",light:d[500],dark:d[900]}}(I);function X(g){return(0,r.mi)(g,p.text.primary)>=o?p.text.primary:G.text.primary}var J=function(g){var e=g.color,I=g.name,n=g.mainShade,C=void 0===n?500:n,l=g.lightShade,o=void 0===l?300:l,a=g.darkShade,r=void 0===a?700:a;if(!(e=(0,t.Z)({},e)).main&&e[C]&&(e.main=e[C]),!e.hasOwnProperty("main"))throw new Error((0,i.Z)(11,I?" (".concat(I,")"):"",C));if("string"!==typeof e.main)throw new Error((0,i.Z)(12,I?" (".concat(I,")"):"",JSON.stringify(e.main)));return y(e,"light",o,B),y(e,"dark",r,B),e.contrastText||(e.contrastText=X(e.main)),e},Y={dark:p,light:G};return(0,C.Z)((0,t.Z)({common:c,mode:I,primary:J({color:V,name:"primary"}),secondary:J({color:W,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:J({color:S,name:"error"}),warning:J({color:R,name:"warning"}),info:J({color:f,name:"info"}),success:J({color:k,name:"success"}),grey:A.Z,contrastThreshold:o,getContrastText:X,augmentColor:J,tonalOffset:B},Y[I]),v)}var v=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];var V={textTransform:"uppercase"},W='"Roboto", "Helvetica", "Arial", sans-serif';function S(g,e){var I="function"===typeof e?e(g):e,l=I.fontFamily,o=void 0===l?W:l,a=I.fontSize,i=void 0===a?14:a,r=I.fontWeightLight,c=void 0===r?300:r,A=I.fontWeightRegular,u=void 0===A?400:A,s=I.fontWeightMedium,d=void 0===s?500:s,Z=I.fontWeightBold,b=void 0===Z?700:Z,m=I.htmlFontSize,h=void 0===m?16:m,G=I.allVariants,p=I.pxToRem,y=(0,n.Z)(I,v);var B=i/14,S=p||function(g){return"".concat(g/h*B,"rem")},f=function(g,e,I,n,C){return(0,t.Z)({fontFamily:o,fontWeight:g,fontSize:S(e),lineHeight:I},o===W?{letterSpacing:"".concat((l=n/e,Math.round(1e5*l)/1e5),"em")}:{},C,G);var l},k={h1:f(c,96,1.167,-1.5),h2:f(c,60,1.2,-.5),h3:f(u,48,1.167,0),h4:f(u,34,1.235,.25),h5:f(u,24,1.334,0),h6:f(d,20,1.6,.15),subtitle1:f(u,16,1.75,.15),subtitle2:f(d,14,1.57,.1),body1:f(u,16,1.5,.15),body2:f(u,14,1.43,.15),button:f(d,14,1.75,.4,V),caption:f(u,12,1.66,.4),overline:f(u,12,2.66,1,V)};return(0,C.Z)((0,t.Z)({htmlFontSize:h,pxToRem:S,fontFamily:o,fontSize:i,fontWeightLight:c,fontWeightRegular:u,fontWeightMedium:d,fontWeightBold:b},k),y,{clone:!1})}function f(){return["".concat(arguments.length<=0?void 0:arguments[0],"px ").concat(arguments.length<=1?void 0:arguments[1],"px ").concat(arguments.length<=2?void 0:arguments[2],"px ").concat(arguments.length<=3?void 0:arguments[3],"px rgba(0,0,0,").concat(.2,")"),"".concat(arguments.length<=4?void 0:arguments[4],"px ").concat(arguments.length<=5?void 0:arguments[5],"px ").concat(arguments.length<=6?void 0:arguments[6],"px ").concat(arguments.length<=7?void 0:arguments[7],"px rgba(0,0,0,").concat(.14,")"),"".concat(arguments.length<=8?void 0:arguments[8],"px ").concat(arguments.length<=9?void 0:arguments[9],"px ").concat(arguments.length<=10?void 0:arguments[10],"px ").concat(arguments.length<=11?void 0:arguments[11],"px rgba(0,0,0,").concat(.12,")")].join(",")}var k=["none",f(0,2,1,-1,0,1,1,0,0,1,3,0),f(0,3,1,-2,0,2,2,0,0,1,5,0),f(0,3,3,-2,0,3,4,0,0,1,8,0),f(0,2,4,-1,0,4,5,0,0,1,10,0),f(0,3,5,-1,0,5,8,0,0,1,14,0),f(0,3,5,-1,0,6,10,0,0,1,18,0),f(0,4,5,-2,0,7,10,1,0,2,16,1),f(0,5,5,-3,0,8,10,1,0,3,14,2),f(0,5,6,-3,0,9,12,1,0,3,16,2),f(0,6,6,-3,0,10,14,1,0,4,18,3),f(0,6,7,-4,0,11,15,1,0,4,20,3),f(0,7,8,-4,0,12,17,2,0,5,22,4),f(0,7,8,-4,0,13,19,2,0,5,24,4),f(0,7,9,-4,0,14,21,2,0,5,26,4),f(0,8,9,-5,0,15,22,2,0,6,28,5),f(0,8,10,-5,0,16,24,2,0,6,30,5),f(0,8,11,-5,0,17,26,2,0,6,32,5),f(0,9,11,-5,0,18,28,2,0,7,34,6),f(0,9,12,-6,0,19,29,2,0,7,36,6),f(0,10,13,-6,0,20,31,3,0,8,38,7),f(0,10,13,-6,0,21,33,3,0,8,40,7),f(0,10,14,-6,0,22,35,3,0,8,42,7),f(0,11,14,-7,0,23,36,3,0,9,44,8),f(0,11,15,-7,0,24,38,3,0,9,46,8)],R=["duration","easing","delay"],X={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},J={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function Y(g){return"".concat(Math.round(g),"ms")}function H(g){if(!g)return 0;var e=g/36;return Math.round(10*(4+15*Math.pow(e,.25)+e/5))}function w(g){var e=(0,t.Z)({},X,g.easing),I=(0,t.Z)({},J,g.duration);return(0,t.Z)({getAutoHeightDuration:H,create:function(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["all"],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},C=t.duration,l=void 0===C?I.standard:C,o=t.easing,a=void 0===o?e.easeInOut:o,i=t.delay,r=void 0===i?0:i;(0,n.Z)(t,R);return(Array.isArray(g)?g:[g]).map((function(g){return"".concat(g," ").concat("string"===typeof l?l:Y(l)," ").concat(a," ").concat("string"===typeof r?r:Y(r))})).join(",")}},g,{easing:e,duration:I})}var N={mobileStepper:1e3,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},K=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function F(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=g.mixins,I=void 0===e?{}:e,o=g.palette,i=void 0===o?{}:o,r=g.transitions,c=void 0===r?{}:r,A=g.typography,u=void 0===A?{}:A,s=(0,n.Z)(g,K),d=B(i),Z=(0,l.Z)(g),b=(0,C.Z)(Z,{mixins:a(Z.breakpoints,Z.spacing,I),palette:d,shadows:k.slice(),typography:S(d,u),transitions:w(c),zIndex:(0,t.Z)({},N)});b=(0,C.Z)(b,s);for(var m=arguments.length,h=new Array(m>1?m-1:0),G=1;G<m;G++)h[G-1]=arguments[G];return b=h.reduce((function(g,e){return(0,C.Z)(g,e)}),b)}var E=F},6482:function(g,e,I){"use strict";var t=(0,I(5547).Z)();e.Z=t},7630:function(g,e,I){"use strict";I.d(e,{ZP:function(){return V},FO:function(){return B}});var t=I(3433),n=I(7462),C=I(3366),l=I(594),o=I(5080),a=I(104),i=I(7312),r=["variant"];function c(g){return 0===g.length}function A(g){var e=g.variant,I=(0,C.Z)(g,r),t=e||"";return Object.keys(I).sort().forEach((function(e){t+="color"===e?c(t)?g[e]:(0,i.Z)(g[e]):"".concat(c(t)?e:(0,i.Z)(e)).concat((0,i.Z)(g[e].toString()))})),t}var u=["name","slot","skipVariantsResolver","skipSx","overridesResolver"],s=["theme"],d=["theme"];function Z(g){return 0===Object.keys(g).length}var b=function(g,e){return e.components&&e.components[g]&&e.components[g].styleOverrides?e.components[g].styleOverrides:null},m=function(g,e){var I=[];e&&e.components&&e.components[g]&&e.components[g].variants&&(I=e.components[g].variants);var t={};return I.forEach((function(g){var e=A(g.props);t[e]=g.style})),t},h=function(g,e,I,t){var n,C,l=g.ownerState,o=void 0===l?{}:l,a=[],i=null==I||null==(n=I.components)||null==(C=n[t])?void 0:C.variants;return i&&i.forEach((function(I){var t=!0;Object.keys(I.props).forEach((function(e){o[e]!==I.props[e]&&g[e]!==I.props[e]&&(t=!1)})),t&&a.push(e[A(I.props)])})),a};function G(g){return"ownerState"!==g&&"theme"!==g&&"sx"!==g&&"as"!==g}var p=(0,o.Z)();var y=I(6482),B=function(g){return G(g)&&"classes"!==g},v=function(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=g.defaultTheme,I=void 0===e?p:e,o=g.rootShouldForwardProp,i=void 0===o?G:o,r=g.slotShouldForwardProp,c=void 0===r?G:r;return function(g){var e,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=o.name,A=o.slot,p=o.skipVariantsResolver,y=o.skipSx,B=o.overridesResolver,v=(0,C.Z)(o,u),V=void 0!==p?p:A&&"Root"!==A||!1,W=y||!1;var S=G;"Root"===A?S=i:A&&(S=c);var f=(0,l.ZP)(g,(0,n.Z)({shouldForwardProp:S,label:e},v)),k=function(g){for(var e=arguments.length,l=new Array(e>1?e-1:0),o=1;o<e;o++)l[o-1]=arguments[o];var i=l?l.map((function(g){return"function"===typeof g&&g.__emotion_real!==g?function(e){var t=e.theme,l=(0,C.Z)(e,s);return g((0,n.Z)({theme:Z(t)?I:t},l))}:g})):[],c=g;r&&B&&i.push((function(g){var e=Z(g.theme)?I:g.theme,t=b(r,e);return t?B(g,t):null})),r&&!V&&i.push((function(g){var e=Z(g.theme)?I:g.theme;return h(g,m(r,e),e,r)})),W||i.push((function(g){var e=Z(g.theme)?I:g.theme;return(0,a.Z)((0,n.Z)({},g,{theme:e}))}));var A=i.length-l.length;if(Array.isArray(g)&&A>0){var u=new Array(A).fill("");(c=[].concat((0,t.Z)(g),(0,t.Z)(u))).raw=[].concat((0,t.Z)(g.raw),(0,t.Z)(u))}else"function"===typeof g&&(c=function(e){var t=e.theme,l=(0,C.Z)(e,d);return g((0,n.Z)({theme:Z(t)?I:t},l))});var G=f.apply(void 0,[c].concat((0,t.Z)(i)));return G};return k}}({defaultTheme:y.Z,rootShouldForwardProp:B}),V=v},1046:function(g,e,I){"use strict";I.d(e,{Z:function(){return o}});var t=I(5735);var n=I(3459);function C(g){var e=g.props,I=g.name,C=g.defaultTheme,l=function(g){var e=g.theme,I=g.name,n=g.props;return e&&e.components&&e.components[I]&&e.components[I].defaultProps?(0,t.Z)(e.components[I].defaultProps,n):n}({theme:(0,n.Z)(C),name:I,props:e});return l}var l=I(6482);function o(g){return C({props:g.props,name:g.name,defaultTheme:l.Z})}},4036:function(g,e,I){"use strict";var t=I(7312);e.Z=t.Z},3519:function(g,e,I){"use strict";I.r(e),I.d(e,{capitalize:function(){return t.Z},createChainedFunction:function(){return n},createSvgIcon:function(){return h},debounce:function(){return G},deprecatedPropType:function(){return p},isMuiElement:function(){return y},ownerDocument:function(){return v},ownerWindow:function(){return V},requirePropFactory:function(){return W},setRef:function(){return S},unstable_ClassNameGenerator:function(){return K.Z},unstable_useEnhancedEffect:function(){return f},unstable_useId:function(){return X},unsupportedProp:function(){return J},useControlled:function(){return Y},useEventCallback:function(){return H.Z},useForkRef:function(){return w.Z},useIsFocusVisible:function(){return N.Z}});var t=I(4036);var n=function(){for(var g=arguments.length,e=new Array(g),I=0;I<g;I++)e[I]=arguments[I];return e.reduce((function(g,e){return null==e?g:function(){for(var I=arguments.length,t=new Array(I),n=0;n<I;n++)t[n]=arguments[n];g.apply(this,t),e.apply(this,t)}}),(function(){}))},C=I(7462),l=I(2791),o=I(3366),a=I(8182),i=I(767),r=I(1046),c=I(7630),A=I(5159);function u(g){return(0,A.Z)("MuiSvgIcon",g)}(0,I(208).Z)("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);var s=I(184),d=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],Z=(0,c.ZP)("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:function(g,e){var I=g.ownerState;return[e.root,"inherit"!==I.color&&e["color".concat((0,t.Z)(I.color))],e["fontSize".concat((0,t.Z)(I.fontSize))]]}})((function(g){var e,I,t=g.theme,n=g.ownerState;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:"currentColor",flexShrink:0,transition:t.transitions.create("fill",{duration:t.transitions.duration.shorter}),fontSize:{inherit:"inherit",small:t.typography.pxToRem(20),medium:t.typography.pxToRem(24),large:t.typography.pxToRem(35)}[n.fontSize],color:null!=(e=null==(I=t.palette[n.color])?void 0:I.main)?e:{action:t.palette.action.active,disabled:t.palette.action.disabled,inherit:void 0}[n.color]}})),b=l.forwardRef((function(g,e){var I=(0,r.Z)({props:g,name:"MuiSvgIcon"}),n=I.children,l=I.className,c=I.color,A=void 0===c?"inherit":c,b=I.component,m=void 0===b?"svg":b,h=I.fontSize,G=void 0===h?"medium":h,p=I.htmlColor,y=I.inheritViewBox,B=void 0!==y&&y,v=I.titleAccess,V=I.viewBox,W=void 0===V?"0 0 24 24":V,S=(0,o.Z)(I,d),f=(0,C.Z)({},I,{color:A,component:m,fontSize:G,inheritViewBox:B,viewBox:W}),k={};B||(k.viewBox=W);var R=function(g){var e=g.color,I=g.fontSize,n=g.classes,C={root:["root","inherit"!==e&&"color".concat((0,t.Z)(e)),"fontSize".concat((0,t.Z)(I))]};return(0,i.Z)(C,u,n)}(f);return(0,s.jsxs)(Z,(0,C.Z)({as:m,className:(0,a.Z)(R.root,l),ownerState:f,focusable:"false",color:p,"aria-hidden":!v||void 0,role:v?"img":void 0,ref:e},k,S,{children:[n,v?(0,s.jsx)("title",{children:v}):null]}))}));b.muiName="SvgIcon";var m=b;function h(g,e){var I=function(I,t){return(0,s.jsx)(m,(0,C.Z)({"data-testid":"".concat(e,"Icon"),ref:t},I,{children:g}))};return I.muiName=m.muiName,l.memo(l.forwardRef(I))}var G=function(g){var e,I=arguments.length>1&&void 0!==arguments[1]?arguments[1]:166;function t(){for(var t=this,n=arguments.length,C=new Array(n),l=0;l<n;l++)C[l]=arguments[l];var o=function(){g.apply(t,C)};clearTimeout(e),e=setTimeout(o,I)}return t.clear=function(){clearTimeout(e)},t};var p=function(g,e){return function(){return null}};var y=function(g,e){return l.isValidElement(g)&&-1!==e.indexOf(g.type.muiName)};function B(g){return g&&g.ownerDocument||document}var v=B;var V=function(g){return B(g).defaultView||window};var W=function(g,e){return function(){return null}},S=I(2971).Z,f=I(5721).Z,k=I(9439),R=0;var X=function(g){var e=l.useState(g),I=(0,k.Z)(e,2),t=I[0],n=I[1],C=g||t;return l.useEffect((function(){null==t&&n("mui-".concat(R+=1))}),[t]),C};var J=function(g,e,I,t,n){return null};var Y=function(g){var e=g.controlled,I=g.default,t=(g.name,g.state,l.useRef(void 0!==e).current),n=l.useState(I),C=(0,k.Z)(n,2),o=C[0],a=C[1];return[t?e:o,l.useCallback((function(g){t||a(g)}),[])]},H=I(6868),w=I(4843),N=I(3031),K=I(7125)},6868:function(g,e,I){"use strict";I.d(e,{Z:function(){return C}});var t=I(2791),n=I(5721);var C=function(g){var e=t.useRef(g);return(0,n.Z)((function(){e.current=g})),t.useCallback((function(){return e.current.apply(void 0,arguments)}),[])}},4843:function(g,e,I){"use strict";I.d(e,{Z:function(){return C}});var t=I(2791),n=I(2971);var C=function(g,e){return t.useMemo((function(){return null==g&&null==e?null:function(I){(0,n.Z)(g,I),(0,n.Z)(e,I)}}),[g,e])}},3031:function(g,e,I){"use strict";I.d(e,{Z:function(){return A}});var t,n=I(2791),C=!0,l=!1,o={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function a(g){g.metaKey||g.altKey||g.ctrlKey||(C=!0)}function i(){C=!1}function r(){"hidden"===this.visibilityState&&l&&(C=!0)}function c(g){var e=g.target;try{return e.matches(":focus-visible")}catch(I){}return C||function(g){var e=g.type,I=g.tagName;return!("INPUT"!==I||!o[e]||g.readOnly)||"TEXTAREA"===I&&!g.readOnly||!!g.isContentEditable}(e)}var A=function(){var g=n.useCallback((function(g){var e;null!=g&&((e=g.ownerDocument).addEventListener("keydown",a,!0),e.addEventListener("mousedown",i,!0),e.addEventListener("pointerdown",i,!0),e.addEventListener("touchstart",i,!0),e.addEventListener("visibilitychange",r,!0))}),[]),e=n.useRef(!1);return{isFocusVisibleRef:e,onFocus:function(g){return!!c(g)&&(e.current=!0,!0)},onBlur:function(){return!!e.current&&(l=!0,window.clearTimeout(t),t=window.setTimeout((function(){l=!1}),100),e.current=!1,!0)},ref:g}}},8023:function(g,e,I){"use strict";var t=I(2791).createContext(null);e.Z=t},9598:function(g,e,I){"use strict";I.d(e,{Z:function(){return C}});var t=I(2791),n=I(8023);function C(){return t.useContext(n.Z)}},594:function(g,e,I){"use strict";I.d(e,{ZP:function(){return h}});var t=I(2791),n=I(7462),C=I(3782),l=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,o=(0,C.Z)((function(g){return l.test(g)||111===g.charCodeAt(0)&&110===g.charCodeAt(1)&&g.charCodeAt(2)<91})),a=I(1672),i=I(5438),r=I(1346),c=o,A=function(g){return"theme"!==g},u=function(g){return"string"===typeof g&&g.charCodeAt(0)>96?c:A},s=function(g,e,I){var t;if(e){var n=e.shouldForwardProp;t=g.__emotion_forwardProp&&n?function(e){return g.__emotion_forwardProp(e)&&n(e)}:n}return"function"!==typeof t&&I&&(t=g.__emotion_forwardProp),t},d=function(){return null},Z=function g(e,I){var C,l,o=e.__emotion_real===e,c=o&&e.__emotion_base||e;void 0!==I&&(C=I.label,l=I.target);var A=s(e,I,o),Z=A||u(c),b=!Z("as");return function(){var m=arguments,h=o&&void 0!==e.__emotion_styles?e.__emotion_styles.slice(0):[];if(void 0!==C&&h.push("label:"+C+";"),null==m[0]||void 0===m[0].raw)h.push.apply(h,m);else{0,h.push(m[0][0]);for(var G=m.length,p=1;p<G;p++)h.push(m[p],m[0][p])}var y=(0,a.w)((function(g,e,I){var n=b&&g.as||c,C="",o=[],s=g;if(null==g.theme){for(var m in s={},g)s[m]=g[m];s.theme=(0,t.useContext)(a.T)}"string"===typeof g.className?C=(0,i.f)(e.registered,o,g.className):null!=g.className&&(C=g.className+" ");var G=(0,r.O)(h.concat(o),e.registered,s);(0,i.M)(e,G,"string"===typeof n);C+=e.key+"-"+G.name,void 0!==l&&(C+=" "+l);var p=b&&void 0===A?u(n):Z,y={};for(var B in g)b&&"as"===B||p(B)&&(y[B]=g[B]);y.className=C,y.ref=I;var v=(0,t.createElement)(n,y),V=(0,t.createElement)(d,null);return(0,t.createElement)(t.Fragment,null,V,v)}));return y.displayName=void 0!==C?C:"Styled("+("string"===typeof c?c:c.displayName||c.name||"Component")+")",y.defaultProps=e.defaultProps,y.__emotion_real=y,y.__emotion_base=c,y.__emotion_styles=h,y.__emotion_forwardProp=A,Object.defineProperty(y,"toString",{value:function(){return"."+l}}),y.withComponent=function(e,t){return g(e,(0,n.Z)({},I,t,{shouldForwardProp:s(y,t,!0)})).apply(void 0,h)},y}},b=Z.bind();["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"].forEach((function(g){b[g]=b(g)}));var m=b;function h(g,e){return m(g,e)}},1184:function(g,e,I){"use strict";I.d(e,{VO:function(){return t},k9:function(){return C},W8:function(){return l},L7:function(){return o}});var t={xs:0,sm:600,md:900,lg:1200,xl:1536},n={keys:["xs","sm","md","lg","xl"],up:function(g){return"@media (min-width:".concat(t[g],"px)")}};function C(g,e,I){var C=g.theme||{};if(Array.isArray(e)){var l=C.breakpoints||n;return e.reduce((function(g,t,n){return g[l.up(l.keys[n])]=I(e[n]),g}),{})}if("object"===typeof e){var o=C.breakpoints||n;return Object.keys(e).reduce((function(g,n){if(-1!==Object.keys(o.values||t).indexOf(n)){g[o.up(n)]=I(e[n],n)}else{var C=n;g[C]=e[C]}return g}),{})}return I(e)}function l(){var g,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},I=null==e||null==(g=e.keys)?void 0:g.reduce((function(g,I){return g[e.up(I)]={},g}),{});return I||{}}function o(g,e){return g.reduce((function(g,e){var I=g[e];return(!I||0===Object.keys(I).length)&&delete g[e],g}),e)}},2065:function(g,e,I){"use strict";I.d(e,{mi:function(){return a},Fq:function(){return i},_j:function(){return r},$n:function(){return c}});var t=I(6189);function n(g){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,I=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Math.min(Math.max(e,g),I)}function C(g){if(g.type)return g;if("#"===g.charAt(0))return C(function(g){g=g.substr(1);var e=new RegExp(".{1,".concat(g.length>=6?2:1,"}"),"g"),I=g.match(e);return I&&1===I[0].length&&(I=I.map((function(g){return g+g}))),I?"rgb".concat(4===I.length?"a":"","(").concat(I.map((function(g,e){return e<3?parseInt(g,16):Math.round(parseInt(g,16)/255*1e3)/1e3})).join(", "),")"):""}(g));var e=g.indexOf("("),I=g.substring(0,e);if(-1===["rgb","rgba","hsl","hsla","color"].indexOf(I))throw new Error((0,t.Z)(9,g));var n,l=g.substring(e+1,g.length-1);if("color"===I){if(n=(l=l.split(" ")).shift(),4===l.length&&"/"===l[3].charAt(0)&&(l[3]=l[3].substr(1)),-1===["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(n))throw new Error((0,t.Z)(10,n))}else l=l.split(",");return{type:I,values:l=l.map((function(g){return parseFloat(g)})),colorSpace:n}}function l(g){var e=g.type,I=g.colorSpace,t=g.values;return-1!==e.indexOf("rgb")?t=t.map((function(g,e){return e<3?parseInt(g,10):g})):-1!==e.indexOf("hsl")&&(t[1]="".concat(t[1],"%"),t[2]="".concat(t[2],"%")),t=-1!==e.indexOf("color")?"".concat(I," ").concat(t.join(" ")):"".concat(t.join(", ")),"".concat(e,"(").concat(t,")")}function o(g){var e="hsl"===(g=C(g)).type?C(function(g){var e=(g=C(g)).values,I=e[0],t=e[1]/100,n=e[2]/100,o=t*Math.min(n,1-n),a=function(g){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(g+I/30)%12;return n-o*Math.max(Math.min(e-3,9-e,1),-1)},i="rgb",r=[Math.round(255*a(0)),Math.round(255*a(8)),Math.round(255*a(4))];return"hsla"===g.type&&(i+="a",r.push(e[3])),l({type:i,values:r})}(g)).values:g.values;return e=e.map((function(e){return"color"!==g.type&&(e/=255),e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)})),Number((.2126*e[0]+.7152*e[1]+.0722*e[2]).toFixed(3))}function a(g,e){var I=o(g),t=o(e);return(Math.max(I,t)+.05)/(Math.min(I,t)+.05)}function i(g,e){return g=C(g),e=n(e),"rgb"!==g.type&&"hsl"!==g.type||(g.type+="a"),"color"===g.type?g.values[3]="/".concat(e):g.values[3]=e,l(g)}function r(g,e){if(g=C(g),e=n(e),-1!==g.type.indexOf("hsl"))g.values[2]*=1-e;else if(-1!==g.type.indexOf("rgb")||-1!==g.type.indexOf("color"))for(var I=0;I<3;I+=1)g.values[I]*=1-e;return l(g)}function c(g,e){if(g=C(g),e=n(e),-1!==g.type.indexOf("hsl"))g.values[2]+=(100-g.values[2])*e;else if(-1!==g.type.indexOf("rgb"))for(var I=0;I<3;I+=1)g.values[I]+=(255-g.values[I])*e;else if(-1!==g.type.indexOf("color"))for(var t=0;t<3;t+=1)g.values[t]+=(1-g.values[t])*e;return l(g)}},5080:function(g,e,I){"use strict";I.d(e,{Z:function(){return A}});var t=I(7462),n=I(3366),C=I(2466),l=["values","unit","step"];function o(g){var e=g.values,I=void 0===e?{xs:0,sm:600,md:900,lg:1200,xl:1536}:e,C=g.unit,o=void 0===C?"px":C,a=g.step,i=void 0===a?5:a,r=(0,n.Z)(g,l),c=Object.keys(I);function A(g){var e="number"===typeof I[g]?I[g]:g;return"@media (min-width:".concat(e).concat(o,")")}function u(g){var e="number"===typeof I[g]?I[g]:g;return"@media (max-width:".concat(e-i/100).concat(o,")")}function s(g,e){var t=c.indexOf(e);return"@media (min-width:".concat("number"===typeof I[g]?I[g]:g).concat(o,") and ")+"(max-width:".concat((-1!==t&&"number"===typeof I[c[t]]?I[c[t]]:e)-i/100).concat(o,")")}return(0,t.Z)({keys:c,values:I,up:A,down:u,between:s,only:function(g){return c.indexOf(g)+1<c.length?s(g,c[c.indexOf(g)+1]):A(g)},not:function(g){var e=c.indexOf(g);return 0===e?A(c[1]):e===c.length-1?u(c[e]):s(g,c[c.indexOf(g)+1]).replace("@media","@media not all and")},unit:o},r)}var a={borderRadius:4},i=I(5682);function r(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;if(g.mui)return g;var e=(0,i.hB)({spacing:g}),I=function(){for(var g=arguments.length,I=new Array(g),t=0;t<g;t++)I[t]=arguments[t];var n=0===I.length?[1]:I;return n.map((function(g){var I=e(g);return"number"===typeof I?"".concat(I,"px"):I})).join(" ")};return I.mui=!0,I}var c=["breakpoints","palette","spacing","shape"];var A=function(){for(var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=g.breakpoints,I=void 0===e?{}:e,l=g.palette,i=void 0===l?{}:l,A=g.spacing,u=g.shape,s=void 0===u?{}:u,d=(0,n.Z)(g,c),Z=o(I),b=r(A),m=(0,C.Z)({breakpoints:Z,direction:"ltr",components:{},palette:(0,t.Z)({mode:"light"},i),spacing:b,shape:(0,t.Z)({},a,s)},d),h=arguments.length,G=new Array(h>1?h-1:0),p=1;p<h;p++)G[p-1]=arguments[p];return m=G.reduce((function(g,e){return(0,C.Z)(g,e)}),m)}},6001:function(g,e,I){"use strict";I.d(e,{Z:function(){return O},G:function(){return P}});var t=I(4942),n=I(8529),C=I(8247);var l=function(){for(var g=arguments.length,e=new Array(g),I=0;I<g;I++)e[I]=arguments[I];var t=e.reduce((function(g,e){return e.filterProps.forEach((function(I){g[I]=e})),g}),{}),n=function(g){return Object.keys(g).reduce((function(e,I){return t[I]?(0,C.Z)(e,t[I](g)):e}),{})};return n.propTypes={},n.filterProps=e.reduce((function(g,e){return g.concat(e.filterProps)}),[]),n},o=I(5682),a=I(1184);function i(g){return"number"!==typeof g?g:"".concat(g,"px solid")}var r=(0,n.Z)({prop:"border",themeKey:"borders",transform:i}),c=(0,n.Z)({prop:"borderTop",themeKey:"borders",transform:i}),A=(0,n.Z)({prop:"borderRight",themeKey:"borders",transform:i}),u=(0,n.Z)({prop:"borderBottom",themeKey:"borders",transform:i}),s=(0,n.Z)({prop:"borderLeft",themeKey:"borders",transform:i}),d=(0,n.Z)({prop:"borderColor",themeKey:"palette"}),Z=(0,n.Z)({prop:"borderTopColor",themeKey:"palette"}),b=(0,n.Z)({prop:"borderRightColor",themeKey:"palette"}),m=(0,n.Z)({prop:"borderBottomColor",themeKey:"palette"}),h=(0,n.Z)({prop:"borderLeftColor",themeKey:"palette"}),G=function(g){if(void 0!==g.borderRadius&&null!==g.borderRadius){var e=(0,o.eI)(g.theme,"shape.borderRadius",4,"borderRadius");return(0,a.k9)(g,g.borderRadius,(function(g){return{borderRadius:(0,o.NA)(e,g)}}))}return null};G.propTypes={},G.filterProps=["borderRadius"];var p=l(r,c,A,u,s,d,Z,b,m,h,G),y=l((0,n.Z)({prop:"displayPrint",cssProperty:!1,transform:function(g){return{"@media print":{display:g}}}}),(0,n.Z)({prop:"display"}),(0,n.Z)({prop:"overflow"}),(0,n.Z)({prop:"textOverflow"}),(0,n.Z)({prop:"visibility"}),(0,n.Z)({prop:"whiteSpace"})),B=l((0,n.Z)({prop:"flexBasis"}),(0,n.Z)({prop:"flexDirection"}),(0,n.Z)({prop:"flexWrap"}),(0,n.Z)({prop:"justifyContent"}),(0,n.Z)({prop:"alignItems"}),(0,n.Z)({prop:"alignContent"}),(0,n.Z)({prop:"order"}),(0,n.Z)({prop:"flex"}),(0,n.Z)({prop:"flexGrow"}),(0,n.Z)({prop:"flexShrink"}),(0,n.Z)({prop:"alignSelf"}),(0,n.Z)({prop:"justifyItems"}),(0,n.Z)({prop:"justifySelf"})),v=function(g){if(void 0!==g.gap&&null!==g.gap){var e=(0,o.eI)(g.theme,"spacing",8,"gap");return(0,a.k9)(g,g.gap,(function(g){return{gap:(0,o.NA)(e,g)}}))}return null};v.propTypes={},v.filterProps=["gap"];var V=function(g){if(void 0!==g.columnGap&&null!==g.columnGap){var e=(0,o.eI)(g.theme,"spacing",8,"columnGap");return(0,a.k9)(g,g.columnGap,(function(g){return{columnGap:(0,o.NA)(e,g)}}))}return null};V.propTypes={},V.filterProps=["columnGap"];var W=function(g){if(void 0!==g.rowGap&&null!==g.rowGap){var e=(0,o.eI)(g.theme,"spacing",8,"rowGap");return(0,a.k9)(g,g.rowGap,(function(g){return{rowGap:(0,o.NA)(e,g)}}))}return null};W.propTypes={},W.filterProps=["rowGap"];var S=l(v,V,W,(0,n.Z)({prop:"gridColumn"}),(0,n.Z)({prop:"gridRow"}),(0,n.Z)({prop:"gridAutoFlow"}),(0,n.Z)({prop:"gridAutoColumns"}),(0,n.Z)({prop:"gridAutoRows"}),(0,n.Z)({prop:"gridTemplateColumns"}),(0,n.Z)({prop:"gridTemplateRows"}),(0,n.Z)({prop:"gridTemplateAreas"}),(0,n.Z)({prop:"gridArea"})),f=l((0,n.Z)({prop:"position"}),(0,n.Z)({prop:"zIndex",themeKey:"zIndex"}),(0,n.Z)({prop:"top"}),(0,n.Z)({prop:"right"}),(0,n.Z)({prop:"bottom"}),(0,n.Z)({prop:"left"})),k=l((0,n.Z)({prop:"color",themeKey:"palette"}),(0,n.Z)({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette"}),(0,n.Z)({prop:"backgroundColor",themeKey:"palette"})),R=(0,n.Z)({prop:"boxShadow",themeKey:"shadows"});function X(g){return g<=1&&0!==g?"".concat(100*g,"%"):g}var J=(0,n.Z)({prop:"width",transform:X}),Y=function(g){if(void 0!==g.maxWidth&&null!==g.maxWidth){return(0,a.k9)(g,g.maxWidth,(function(e){var I,t,n;return{maxWidth:(null==(I=g.theme)||null==(t=I.breakpoints)||null==(n=t.values)?void 0:n[e])||a.VO[e]||X(e)}}))}return null};Y.filterProps=["maxWidth"];var H=(0,n.Z)({prop:"minWidth",transform:X}),w=(0,n.Z)({prop:"height",transform:X}),N=(0,n.Z)({prop:"maxHeight",transform:X}),K=(0,n.Z)({prop:"minHeight",transform:X}),F=((0,n.Z)({prop:"size",cssProperty:"width",transform:X}),(0,n.Z)({prop:"size",cssProperty:"height",transform:X}),l(J,Y,H,w,N,K,(0,n.Z)({prop:"boxSizing"}))),E=(0,n.Z)({prop:"fontFamily",themeKey:"typography"}),x=(0,n.Z)({prop:"fontSize",themeKey:"typography"}),z=(0,n.Z)({prop:"fontStyle",themeKey:"typography"}),U=(0,n.Z)({prop:"fontWeight",themeKey:"typography"}),M=(0,n.Z)({prop:"letterSpacing"}),L=(0,n.Z)({prop:"lineHeight"}),T=(0,n.Z)({prop:"textAlign"}),Q=l((0,n.Z)({prop:"typography",cssProperty:!1,themeKey:"typography"}),E,x,z,U,M,L,T),D={borders:p.filterProps,display:y.filterProps,flexbox:B.filterProps,grid:S.filterProps,positions:f.filterProps,palette:k.filterProps,shadows:R.filterProps,sizing:F.filterProps,spacing:o.ZP.filterProps,typography:Q.filterProps},j={borders:p,display:y,flexbox:B,grid:S,positions:f,palette:k,shadows:R,sizing:F,spacing:o.ZP,typography:Q},P=Object.keys(D).reduce((function(g,e){return D[e].forEach((function(I){g[I]=j[e]})),g}),{});var O=function(g,e,I){var n,C=(n={},(0,t.Z)(n,g,e),(0,t.Z)(n,"theme",I),n),l=P[g];return l?l(C):(0,t.Z)({},g,e)}},8247:function(g,e,I){"use strict";var t=I(2466);e.Z=function(g,e){return e?(0,t.Z)(g,e,{clone:!1}):g}},5682:function(g,e,I){"use strict";I.d(e,{hB:function(){return d},eI:function(){return s},ZP:function(){return y},NA:function(){return Z}});var t=I(9439),n=I(1184),C=I(8529),l=I(8247);var o={m:"margin",p:"padding"},a={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},i={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},r=function(g){var e={};return function(I){return void 0===e[I]&&(e[I]=g(I)),e[I]}}((function(g){if(g.length>2){if(!i[g])return[g];g=i[g]}var e=g.split(""),I=(0,t.Z)(e,2),n=I[0],C=I[1],l=o[n],r=a[C]||"";return Array.isArray(r)?r.map((function(g){return l+g})):[l+r]})),c=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],A=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"],u=[].concat(c,A);function s(g,e,I,t){var n=(0,C.D)(g,e)||I;return"number"===typeof n?function(g){return"string"===typeof g?g:n*g}:Array.isArray(n)?function(g){return"string"===typeof g?g:n[g]}:"function"===typeof n?n:function(){}}function d(g){return s(g,"spacing",8)}function Z(g,e){if("string"===typeof e||null==e)return e;var I=g(Math.abs(e));return e>=0?I:"number"===typeof I?-I:"-".concat(I)}function b(g,e,I,t){if(-1===e.indexOf(I))return null;var C=function(g,e){return function(I){return g.reduce((function(g,t){return g[t]=Z(e,I),g}),{})}}(r(I),t),l=g[I];return(0,n.k9)(g,l,C)}function m(g,e){var I=d(g.theme);return Object.keys(g).map((function(t){return b(g,e,t,I)})).reduce(l.Z,{})}function h(g){return m(g,c)}function G(g){return m(g,A)}function p(g){return m(g,u)}h.propTypes={},h.filterProps=c,G.propTypes={},G.filterProps=A,p.propTypes={},p.filterProps=u;var y=p},8529:function(g,e,I){"use strict";I.d(e,{D:function(){return l}});var t=I(4942),n=I(7312),C=I(1184);function l(g,e){return e&&"string"===typeof e?e.split(".").reduce((function(g,e){return g&&g[e]?g[e]:null}),g):null}function o(g,e,I){var t,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:I;return t="function"===typeof g?g(I):Array.isArray(g)?g[I]||n:l(g,I)||n,e&&(t=e(t)),t}e.Z=function(g){var e=g.prop,I=g.cssProperty,a=void 0===I?g.prop:I,i=g.themeKey,r=g.transform,c=function(g){if(null==g[e])return null;var I=g[e],c=l(g.theme,i)||{};return(0,C.k9)(g,I,(function(g){var I=o(c,r,g);return g===I&&"string"===typeof g&&(I=o(c,r,"".concat(e).concat("default"===g?"":(0,n.Z)(g)),g)),!1===a?I:(0,t.Z)({},a,I)}))};return c.propTypes={},c.filterProps=[e],c}},104:function(g,e,I){"use strict";var t=I(4942),n=I(8247),C=I(6001),l=I(1184);function o(g){var e=g||{},I=e.sx,a=e.theme,i=void 0===a?{}:a;if(!I)return null;function r(g){var e=g;if("function"===typeof g)e=g(i);else if("object"!==typeof g)return g;var I=(0,l.W8)(i.breakpoints),a=Object.keys(I),r=I;return Object.keys(e).forEach((function(g){var I,a,c=(I=e[g],a=i,"function"===typeof I?I(a):I);if(null!==c&&void 0!==c)if("object"===typeof c)if(C.G[g])r=(0,n.Z)(r,(0,C.Z)(g,c,i));else{var A=(0,l.k9)({theme:i},c,(function(e){return(0,t.Z)({},g,e)}));!function(){for(var g=arguments.length,e=new Array(g),I=0;I<g;I++)e[I]=arguments[I];var t=e.reduce((function(g,e){return g.concat(Object.keys(e))}),[]),n=new Set(t);return e.every((function(g){return n.size===Object.keys(g).length}))}(A,c)?r=(0,n.Z)(r,A):r[g]=o({sx:c,theme:i})}else r=(0,n.Z)(r,(0,C.Z)(g,c,i))})),(0,l.L7)(a,r)}return Array.isArray(I)?I.map(r):r(I)}o.filterProps=["sx"],e.Z=o},3459:function(g,e,I){"use strict";I.d(e,{Z:function(){return a}});var t=I(5080),n=I(9598);function C(g){return 0===Object.keys(g).length}var l=function(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=(0,n.Z)();return!e||C(e)?g:e},o=(0,t.Z)();var a=function(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o;return l(g)}},7312:function(g,e,I){"use strict";I.d(e,{Z:function(){return n}});var t=I(6189);function n(g){if("string"!==typeof g)throw new Error((0,t.Z)(7));return g.charAt(0).toUpperCase()+g.slice(1)}},2466:function(g,e,I){"use strict";I.d(e,{P:function(){return n},Z:function(){return C}});var t=I(7462);function n(g){return null!==g&&"object"===typeof g&&g.constructor===Object}function C(g,e){var I=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{clone:!0},l=I.clone?(0,t.Z)({},g):g;return n(g)&&n(e)&&Object.keys(e).forEach((function(t){"__proto__"!==t&&(n(e[t])&&t in g&&n(g[t])?l[t]=C(g[t],e[t],I):l[t]=e[t])})),l}},6189:function(g,e,I){"use strict";function t(g){for(var e="https://mui.com/production-error/?code="+g,I=1;I<arguments.length;I+=1)e+="&args[]="+encodeURIComponent(arguments[I]);return"Minified MUI error #"+g+"; visit "+e+" for the full message."}I.d(e,{Z:function(){return t}})},5735:function(g,e,I){"use strict";I.d(e,{Z:function(){return n}});var t=I(7462);function n(g,e){var I=(0,t.Z)({},e);return Object.keys(g).forEach((function(e){void 0===I[e]&&(I[e]=g[e])})),I}},2971:function(g,e,I){"use strict";function t(g,e){"function"===typeof g?g(e):g&&(g.current=e)}I.d(e,{Z:function(){return t}})},5721:function(g,e,I){"use strict";var t=I(2791),n="undefined"!==typeof window?t.useLayoutEffect:t.useEffect;e.Z=n},8182:function(g,e,I){"use strict";function t(g){var e,I,n="";if("string"===typeof g||"number"===typeof g)n+=g;else if("object"===typeof g)if(Array.isArray(g))for(e=0;e<g.length;e++)g[e]&&(I=t(g[e]))&&(n&&(n+=" "),n+=I);else for(e in g)g[e]&&(n&&(n+=" "),n+=e);return n}function n(){for(var g,e,I=0,n="";I<arguments.length;)(g=arguments[I++])&&(e=t(g))&&(n&&(n+=" "),n+=e);return n}I.d(e,{Z:function(){return n}})},2110:function(g,e,I){"use strict";var t=I(8309),n={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},C={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},l={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},o={};function a(g){return t.isMemo(g)?l:o[g.$$typeof]||n}o[t.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},o[t.Memo]=l;var i=Object.defineProperty,r=Object.getOwnPropertyNames,c=Object.getOwnPropertySymbols,A=Object.getOwnPropertyDescriptor,u=Object.getPrototypeOf,s=Object.prototype;g.exports=function g(e,I,t){if("string"!==typeof I){if(s){var n=u(I);n&&n!==s&&g(e,n,t)}var l=r(I);c&&(l=l.concat(c(I)));for(var o=a(e),d=a(I),Z=0;Z<l.length;++Z){var b=l[Z];if(!C[b]&&(!t||!t[b])&&(!d||!d[b])&&(!o||!o[b])){var m=A(I,b);try{i(e,b,m)}catch(h){}}}}return e}},746:function(g,e){"use strict";var I="function"===typeof Symbol&&Symbol.for,t=I?Symbol.for("react.element"):60103,n=I?Symbol.for("react.portal"):60106,C=I?Symbol.for("react.fragment"):60107,l=I?Symbol.for("react.strict_mode"):60108,o=I?Symbol.for("react.profiler"):60114,a=I?Symbol.for("react.provider"):60109,i=I?Symbol.for("react.context"):60110,r=I?Symbol.for("react.async_mode"):60111,c=I?Symbol.for("react.concurrent_mode"):60111,A=I?Symbol.for("react.forward_ref"):60112,u=I?Symbol.for("react.suspense"):60113,s=I?Symbol.for("react.suspense_list"):60120,d=I?Symbol.for("react.memo"):60115,Z=I?Symbol.for("react.lazy"):60116,b=I?Symbol.for("react.block"):60121,m=I?Symbol.for("react.fundamental"):60117,h=I?Symbol.for("react.responder"):60118,G=I?Symbol.for("react.scope"):60119;function p(g){if("object"===typeof g&&null!==g){var e=g.$$typeof;switch(e){case t:switch(g=g.type){case r:case c:case C:case o:case l:case u:return g;default:switch(g=g&&g.$$typeof){case i:case A:case Z:case d:case a:return g;default:return e}}case n:return e}}}function y(g){return p(g)===c}e.AsyncMode=r,e.ConcurrentMode=c,e.ContextConsumer=i,e.ContextProvider=a,e.Element=t,e.ForwardRef=A,e.Fragment=C,e.Lazy=Z,e.Memo=d,e.Portal=n,e.Profiler=o,e.StrictMode=l,e.Suspense=u,e.isAsyncMode=function(g){return y(g)||p(g)===r},e.isConcurrentMode=y,e.isContextConsumer=function(g){return p(g)===i},e.isContextProvider=function(g){return p(g)===a},e.isElement=function(g){return"object"===typeof g&&null!==g&&g.$$typeof===t},e.isForwardRef=function(g){return p(g)===A},e.isFragment=function(g){return p(g)===C},e.isLazy=function(g){return p(g)===Z},e.isMemo=function(g){return p(g)===d},e.isPortal=function(g){return p(g)===n},e.isProfiler=function(g){return p(g)===o},e.isStrictMode=function(g){return p(g)===l},e.isSuspense=function(g){return p(g)===u},e.isValidElementType=function(g){return"string"===typeof g||"function"===typeof g||g===C||g===c||g===o||g===l||g===u||g===s||"object"===typeof g&&null!==g&&(g.$$typeof===Z||g.$$typeof===d||g.$$typeof===a||g.$$typeof===i||g.$$typeof===A||g.$$typeof===m||g.$$typeof===h||g.$$typeof===G||g.$$typeof===b)},e.typeOf=p},8309:function(g,e,I){"use strict";g.exports=I(746)},1725:function(g){"use strict";var e=Object.getOwnPropertySymbols,I=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable;function n(g){if(null===g||void 0===g)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(g)}g.exports=function(){try{if(!Object.assign)return!1;var g=new String("abc");if(g[5]="de","5"===Object.getOwnPropertyNames(g)[0])return!1;for(var e={},I=0;I<10;I++)e["_"+String.fromCharCode(I)]=I;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(g){return e[g]})).join(""))return!1;var t={};return"abcdefghijklmnopqrst".split("").forEach((function(g){t[g]=g})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},t)).join("")}catch(n){return!1}}()?Object.assign:function(g,C){for(var l,o,a=n(g),i=1;i<arguments.length;i++){for(var r in l=Object(arguments[i]))I.call(l,r)&&(a[r]=l[r]);if(e){o=e(l);for(var c=0;c<o.length;c++)t.call(l,o[c])&&(a[o[c]]=l[o[c]])}}return a}},888:function(g,e,I){"use strict";var t=I(9047);function n(){}function C(){}C.resetWarningCache=n,g.exports=function(){function g(g,e,I,n,C,l){if(l!==t){var o=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw o.name="Invariant Violation",o}}function e(){return g}g.isRequired=g;var I={array:g,bigint:g,bool:g,func:g,number:g,object:g,string:g,symbol:g,any:g,arrayOf:e,element:g,elementType:g,instanceOf:e,node:g,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:C,resetWarningCache:n};return I.PropTypes=I,I}},2007:function(g,e,I){g.exports=I(888)()},9047:function(g){"use strict";g.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},4463:function(g,e,I){"use strict";var t=I(2791),n=I(1725),C=I(5296);function l(g){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+g,I=1;I<arguments.length;I++)e+="&args[]="+encodeURIComponent(arguments[I]);return"Minified React error #"+g+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!t)throw Error(l(227));var o=new Set,a={};function i(g,e){r(g,e),r(g+"Capture",e)}function r(g,e){for(a[g]=e,g=0;g<e.length;g++)o.add(e[g])}var c=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),A=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,u=Object.prototype.hasOwnProperty,s={},d={};function Z(g,e,I,t,n,C,l){this.acceptsBooleans=2===e||3===e||4===e,this.attributeName=t,this.attributeNamespace=n,this.mustUseProperty=I,this.propertyName=g,this.type=e,this.sanitizeURL=C,this.removeEmptyString=l}var b={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(g){b[g]=new Z(g,0,!1,g,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(g){var e=g[0];b[e]=new Z(e,1,!1,g[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(g){b[g]=new Z(g,2,!1,g.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(g){b[g]=new Z(g,2,!1,g,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(g){b[g]=new Z(g,3,!1,g.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(g){b[g]=new Z(g,3,!0,g,null,!1,!1)})),["capture","download"].forEach((function(g){b[g]=new Z(g,4,!1,g,null,!1,!1)})),["cols","rows","size","span"].forEach((function(g){b[g]=new Z(g,6,!1,g,null,!1,!1)})),["rowSpan","start"].forEach((function(g){b[g]=new Z(g,5,!1,g.toLowerCase(),null,!1,!1)}));var m=/[\-:]([a-z])/g;function h(g){return g[1].toUpperCase()}function G(g,e,I,t){var n=b.hasOwnProperty(e)?b[e]:null;(null!==n?0===n.type:!t&&(2<e.length&&("o"===e[0]||"O"===e[0])&&("n"===e[1]||"N"===e[1])))||(function(g,e,I,t){if(null===e||"undefined"===typeof e||function(g,e,I,t){if(null!==I&&0===I.type)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return!t&&(null!==I?!I.acceptsBooleans:"data-"!==(g=g.toLowerCase().slice(0,5))&&"aria-"!==g);default:return!1}}(g,e,I,t))return!0;if(t)return!1;if(null!==I)switch(I.type){case 3:return!e;case 4:return!1===e;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}(e,I,n,t)&&(I=null),t||null===n?function(g){return!!u.call(d,g)||!u.call(s,g)&&(A.test(g)?d[g]=!0:(s[g]=!0,!1))}(e)&&(null===I?g.removeAttribute(e):g.setAttribute(e,""+I)):n.mustUseProperty?g[n.propertyName]=null===I?3!==n.type&&"":I:(e=n.attributeName,t=n.attributeNamespace,null===I?g.removeAttribute(e):(I=3===(n=n.type)||4===n&&!0===I?"":""+I,t?g.setAttributeNS(t,e,I):g.setAttribute(e,I))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(g){var e=g.replace(m,h);b[e]=new Z(e,1,!1,g,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(g){var e=g.replace(m,h);b[e]=new Z(e,1,!1,g,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(g){var e=g.replace(m,h);b[e]=new Z(e,1,!1,g,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(g){b[g]=new Z(g,1,!1,g.toLowerCase(),null,!1,!1)})),b.xlinkHref=new Z("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(g){b[g]=new Z(g,1,!1,g.toLowerCase(),null,!0,!0)}));var p=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,y=60103,B=60106,v=60107,V=60108,W=60114,S=60109,f=60110,k=60112,R=60113,X=60120,J=60115,Y=60116,H=60121,w=60128,N=60129,K=60130,F=60131;if("function"===typeof Symbol&&Symbol.for){var E=Symbol.for;y=E("react.element"),B=E("react.portal"),v=E("react.fragment"),V=E("react.strict_mode"),W=E("react.profiler"),S=E("react.provider"),f=E("react.context"),k=E("react.forward_ref"),R=E("react.suspense"),X=E("react.suspense_list"),J=E("react.memo"),Y=E("react.lazy"),H=E("react.block"),E("react.scope"),w=E("react.opaque.id"),N=E("react.debug_trace_mode"),K=E("react.offscreen"),F=E("react.legacy_hidden")}var x,z="function"===typeof Symbol&&Symbol.iterator;function U(g){return null===g||"object"!==typeof g?null:"function"===typeof(g=z&&g[z]||g["@@iterator"])?g:null}function M(g){if(void 0===x)try{throw Error()}catch(I){var e=I.stack.trim().match(/\n( *(at )?)/);x=e&&e[1]||""}return"\n"+x+g}var L=!1;function T(g,e){if(!g||L)return"";L=!0;var I=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(e,[])}catch(a){var t=a}Reflect.construct(g,[],e)}else{try{e.call()}catch(a){t=a}g.call(e.prototype)}else{try{throw Error()}catch(a){t=a}g()}}catch(a){if(a&&t&&"string"===typeof a.stack){for(var n=a.stack.split("\n"),C=t.stack.split("\n"),l=n.length-1,o=C.length-1;1<=l&&0<=o&&n[l]!==C[o];)o--;for(;1<=l&&0<=o;l--,o--)if(n[l]!==C[o]){if(1!==l||1!==o)do{if(l--,0>--o||n[l]!==C[o])return"\n"+n[l].replace(" at new "," at ")}while(1<=l&&0<=o);break}}}finally{L=!1,Error.prepareStackTrace=I}return(g=g?g.displayName||g.name:"")?M(g):""}function Q(g){switch(g.tag){case 5:return M(g.type);case 16:return M("Lazy");case 13:return M("Suspense");case 19:return M("SuspenseList");case 0:case 2:case 15:return g=T(g.type,!1);case 11:return g=T(g.type.render,!1);case 22:return g=T(g.type._render,!1);case 1:return g=T(g.type,!0);default:return""}}function D(g){if(null==g)return null;if("function"===typeof g)return g.displayName||g.name||null;if("string"===typeof g)return g;switch(g){case v:return"Fragment";case B:return"Portal";case W:return"Profiler";case V:return"StrictMode";case R:return"Suspense";case X:return"SuspenseList"}if("object"===typeof g)switch(g.$$typeof){case f:return(g.displayName||"Context")+".Consumer";case S:return(g._context.displayName||"Context")+".Provider";case k:var e=g.render;return e=e.displayName||e.name||"",g.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case J:return D(g.type);case H:return D(g._render);case Y:e=g._payload,g=g._init;try{return D(g(e))}catch(I){}}return null}function j(g){switch(typeof g){case"boolean":case"number":case"object":case"string":case"undefined":return g;default:return""}}function P(g){var e=g.type;return(g=g.nodeName)&&"input"===g.toLowerCase()&&("checkbox"===e||"radio"===e)}function O(g){g._valueTracker||(g._valueTracker=function(g){var e=P(g)?"checked":"value",I=Object.getOwnPropertyDescriptor(g.constructor.prototype,e),t=""+g[e];if(!g.hasOwnProperty(e)&&"undefined"!==typeof I&&"function"===typeof I.get&&"function"===typeof I.set){var n=I.get,C=I.set;return Object.defineProperty(g,e,{configurable:!0,get:function(){return n.call(this)},set:function(g){t=""+g,C.call(this,g)}}),Object.defineProperty(g,e,{enumerable:I.enumerable}),{getValue:function(){return t},setValue:function(g){t=""+g},stopTracking:function(){g._valueTracker=null,delete g[e]}}}}(g))}function _(g){if(!g)return!1;var e=g._valueTracker;if(!e)return!0;var I=e.getValue(),t="";return g&&(t=P(g)?g.checked?"true":"false":g.value),(g=t)!==I&&(e.setValue(g),!0)}function q(g){if("undefined"===typeof(g=g||("undefined"!==typeof document?document:void 0)))return null;try{return g.activeElement||g.body}catch(e){return g.body}}function $(g,e){var I=e.checked;return n({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=I?I:g._wrapperState.initialChecked})}function gg(g,e){var I=null==e.defaultValue?"":e.defaultValue,t=null!=e.checked?e.checked:e.defaultChecked;I=j(null!=e.value?e.value:I),g._wrapperState={initialChecked:t,initialValue:I,controlled:"checkbox"===e.type||"radio"===e.type?null!=e.checked:null!=e.value}}function eg(g,e){null!=(e=e.checked)&&G(g,"checked",e,!1)}function Ig(g,e){eg(g,e);var I=j(e.value),t=e.type;if(null!=I)"number"===t?(0===I&&""===g.value||g.value!=I)&&(g.value=""+I):g.value!==""+I&&(g.value=""+I);else if("submit"===t||"reset"===t)return void g.removeAttribute("value");e.hasOwnProperty("value")?ng(g,e.type,I):e.hasOwnProperty("defaultValue")&&ng(g,e.type,j(e.defaultValue)),null==e.checked&&null!=e.defaultChecked&&(g.defaultChecked=!!e.defaultChecked)}function tg(g,e,I){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var t=e.type;if(!("submit"!==t&&"reset"!==t||void 0!==e.value&&null!==e.value))return;e=""+g._wrapperState.initialValue,I||e===g.value||(g.value=e),g.defaultValue=e}""!==(I=g.name)&&(g.name=""),g.defaultChecked=!!g._wrapperState.initialChecked,""!==I&&(g.name=I)}function ng(g,e,I){"number"===e&&q(g.ownerDocument)===g||(null==I?g.defaultValue=""+g._wrapperState.initialValue:g.defaultValue!==""+I&&(g.defaultValue=""+I))}function Cg(g,e){return g=n({children:void 0},e),(e=function(g){var e="";return t.Children.forEach(g,(function(g){null!=g&&(e+=g)})),e}(e.children))&&(g.children=e),g}function lg(g,e,I,t){if(g=g.options,e){e={};for(var n=0;n<I.length;n++)e["$"+I[n]]=!0;for(I=0;I<g.length;I++)n=e.hasOwnProperty("$"+g[I].value),g[I].selected!==n&&(g[I].selected=n),n&&t&&(g[I].defaultSelected=!0)}else{for(I=""+j(I),e=null,n=0;n<g.length;n++){if(g[n].value===I)return g[n].selected=!0,void(t&&(g[n].defaultSelected=!0));null!==e||g[n].disabled||(e=g[n])}null!==e&&(e.selected=!0)}}function og(g,e){if(null!=e.dangerouslySetInnerHTML)throw Error(l(91));return n({},e,{value:void 0,defaultValue:void 0,children:""+g._wrapperState.initialValue})}function ag(g,e){var I=e.value;if(null==I){if(I=e.children,e=e.defaultValue,null!=I){if(null!=e)throw Error(l(92));if(Array.isArray(I)){if(!(1>=I.length))throw Error(l(93));I=I[0]}e=I}null==e&&(e=""),I=e}g._wrapperState={initialValue:j(I)}}function ig(g,e){var I=j(e.value),t=j(e.defaultValue);null!=I&&((I=""+I)!==g.value&&(g.value=I),null==e.defaultValue&&g.defaultValue!==I&&(g.defaultValue=I)),null!=t&&(g.defaultValue=""+t)}function rg(g){var e=g.textContent;e===g._wrapperState.initialValue&&""!==e&&null!==e&&(g.value=e)}var cg="http://www.w3.org/1999/xhtml",Ag="http://www.w3.org/2000/svg";function ug(g){switch(g){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function sg(g,e){return null==g||"http://www.w3.org/1999/xhtml"===g?ug(e):"http://www.w3.org/2000/svg"===g&&"foreignObject"===e?"http://www.w3.org/1999/xhtml":g}var dg,Zg,bg=(Zg=function(g,e){if(g.namespaceURI!==Ag||"innerHTML"in g)g.innerHTML=e;else{for((dg=dg||document.createElement("div")).innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=dg.firstChild;g.firstChild;)g.removeChild(g.firstChild);for(;e.firstChild;)g.appendChild(e.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(g,e,I,t){MSApp.execUnsafeLocalFunction((function(){return Zg(g,e)}))}:Zg);function mg(g,e){if(e){var I=g.firstChild;if(I&&I===g.lastChild&&3===I.nodeType)return void(I.nodeValue=e)}g.textContent=e}var hg={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Gg=["Webkit","ms","Moz","O"];function pg(g,e,I){return null==e||"boolean"===typeof e||""===e?"":I||"number"!==typeof e||0===e||hg.hasOwnProperty(g)&&hg[g]?(""+e).trim():e+"px"}function yg(g,e){for(var I in g=g.style,e)if(e.hasOwnProperty(I)){var t=0===I.indexOf("--"),n=pg(I,e[I],t);"float"===I&&(I="cssFloat"),t?g.setProperty(I,n):g[I]=n}}Object.keys(hg).forEach((function(g){Gg.forEach((function(e){e=e+g.charAt(0).toUpperCase()+g.substring(1),hg[e]=hg[g]}))}));var Bg=n({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function vg(g,e){if(e){if(Bg[g]&&(null!=e.children||null!=e.dangerouslySetInnerHTML))throw Error(l(137,g));if(null!=e.dangerouslySetInnerHTML){if(null!=e.children)throw Error(l(60));if("object"!==typeof e.dangerouslySetInnerHTML||!("__html"in e.dangerouslySetInnerHTML))throw Error(l(61))}if(null!=e.style&&"object"!==typeof e.style)throw Error(l(62))}}function Vg(g,e){if(-1===g.indexOf("-"))return"string"===typeof e.is;switch(g){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function Wg(g){return(g=g.target||g.srcElement||window).correspondingUseElement&&(g=g.correspondingUseElement),3===g.nodeType?g.parentNode:g}var Sg=null,fg=null,kg=null;function Rg(g){if(g=In(g)){if("function"!==typeof Sg)throw Error(l(280));var e=g.stateNode;e&&(e=nn(e),Sg(g.stateNode,g.type,e))}}function Xg(g){fg?kg?kg.push(g):kg=[g]:fg=g}function Jg(){if(fg){var g=fg,e=kg;if(kg=fg=null,Rg(g),e)for(g=0;g<e.length;g++)Rg(e[g])}}function Yg(g,e){return g(e)}function Hg(g,e,I,t,n){return g(e,I,t,n)}function wg(){}var Ng=Yg,Kg=!1,Fg=!1;function Eg(){null===fg&&null===kg||(wg(),Jg())}function xg(g,e){var I=g.stateNode;if(null===I)return null;var t=nn(I);if(null===t)return null;I=t[e];g:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(t=!t.disabled)||(t=!("button"===(g=g.type)||"input"===g||"select"===g||"textarea"===g)),g=!t;break g;default:g=!1}if(g)return null;if(I&&"function"!==typeof I)throw Error(l(231,e,typeof I));return I}var zg=!1;if(c)try{var Ug={};Object.defineProperty(Ug,"passive",{get:function(){zg=!0}}),window.addEventListener("test",Ug,Ug),window.removeEventListener("test",Ug,Ug)}catch(Zg){zg=!1}function Mg(g,e,I,t,n,C,l,o,a){var i=Array.prototype.slice.call(arguments,3);try{e.apply(I,i)}catch(r){this.onError(r)}}var Lg=!1,Tg=null,Qg=!1,Dg=null,jg={onError:function(g){Lg=!0,Tg=g}};function Pg(g,e,I,t,n,C,l,o,a){Lg=!1,Tg=null,Mg.apply(jg,arguments)}function Og(g){var e=g,I=g;if(g.alternate)for(;e.return;)e=e.return;else{g=e;do{0!==(1026&(e=g).flags)&&(I=e.return),g=e.return}while(g)}return 3===e.tag?I:null}function _g(g){if(13===g.tag){var e=g.memoizedState;if(null===e&&(null!==(g=g.alternate)&&(e=g.memoizedState)),null!==e)return e.dehydrated}return null}function qg(g){if(Og(g)!==g)throw Error(l(188))}function $g(g){if(g=function(g){var e=g.alternate;if(!e){if(null===(e=Og(g)))throw Error(l(188));return e!==g?null:g}for(var I=g,t=e;;){var n=I.return;if(null===n)break;var C=n.alternate;if(null===C){if(null!==(t=n.return)){I=t;continue}break}if(n.child===C.child){for(C=n.child;C;){if(C===I)return qg(n),g;if(C===t)return qg(n),e;C=C.sibling}throw Error(l(188))}if(I.return!==t.return)I=n,t=C;else{for(var o=!1,a=n.child;a;){if(a===I){o=!0,I=n,t=C;break}if(a===t){o=!0,t=n,I=C;break}a=a.sibling}if(!o){for(a=C.child;a;){if(a===I){o=!0,I=C,t=n;break}if(a===t){o=!0,t=C,I=n;break}a=a.sibling}if(!o)throw Error(l(189))}}if(I.alternate!==t)throw Error(l(190))}if(3!==I.tag)throw Error(l(188));return I.stateNode.current===I?g:e}(g),!g)return null;for(var e=g;;){if(5===e.tag||6===e.tag)return e;if(e.child)e.child.return=e,e=e.child;else{if(e===g)break;for(;!e.sibling;){if(!e.return||e.return===g)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}}return null}function ge(g,e){for(var I=g.alternate;null!==e;){if(e===g||e===I)return!0;e=e.return}return!1}var ee,Ie,te,ne,Ce=!1,le=[],oe=null,ae=null,ie=null,re=new Map,ce=new Map,Ae=[],ue="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function se(g,e,I,t,n){return{blockedOn:g,domEventName:e,eventSystemFlags:16|I,nativeEvent:n,targetContainers:[t]}}function de(g,e){switch(g){case"focusin":case"focusout":oe=null;break;case"dragenter":case"dragleave":ae=null;break;case"mouseover":case"mouseout":ie=null;break;case"pointerover":case"pointerout":re.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":ce.delete(e.pointerId)}}function Ze(g,e,I,t,n,C){return null===g||g.nativeEvent!==C?(g=se(e,I,t,n,C),null!==e&&(null!==(e=In(e))&&Ie(e)),g):(g.eventSystemFlags|=t,e=g.targetContainers,null!==n&&-1===e.indexOf(n)&&e.push(n),g)}function be(g){var e=en(g.target);if(null!==e){var I=Og(e);if(null!==I)if(13===(e=I.tag)){if(null!==(e=_g(I)))return g.blockedOn=e,void ne(g.lanePriority,(function(){C.unstable_runWithPriority(g.priority,(function(){te(I)}))}))}else if(3===e&&I.stateNode.hydrate)return void(g.blockedOn=3===I.tag?I.stateNode.containerInfo:null)}g.blockedOn=null}function me(g){if(null!==g.blockedOn)return!1;for(var e=g.targetContainers;0<e.length;){var I=$e(g.domEventName,g.eventSystemFlags,e[0],g.nativeEvent);if(null!==I)return null!==(e=In(I))&&Ie(e),g.blockedOn=I,!1;e.shift()}return!0}function he(g,e,I){me(g)&&I.delete(e)}function Ge(){for(Ce=!1;0<le.length;){var g=le[0];if(null!==g.blockedOn){null!==(g=In(g.blockedOn))&&ee(g);break}for(var e=g.targetContainers;0<e.length;){var I=$e(g.domEventName,g.eventSystemFlags,e[0],g.nativeEvent);if(null!==I){g.blockedOn=I;break}e.shift()}null===g.blockedOn&&le.shift()}null!==oe&&me(oe)&&(oe=null),null!==ae&&me(ae)&&(ae=null),null!==ie&&me(ie)&&(ie=null),re.forEach(he),ce.forEach(he)}function pe(g,e){g.blockedOn===e&&(g.blockedOn=null,Ce||(Ce=!0,C.unstable_scheduleCallback(C.unstable_NormalPriority,Ge)))}function ye(g){function e(e){return pe(e,g)}if(0<le.length){pe(le[0],g);for(var I=1;I<le.length;I++){var t=le[I];t.blockedOn===g&&(t.blockedOn=null)}}for(null!==oe&&pe(oe,g),null!==ae&&pe(ae,g),null!==ie&&pe(ie,g),re.forEach(e),ce.forEach(e),I=0;I<Ae.length;I++)(t=Ae[I]).blockedOn===g&&(t.blockedOn=null);for(;0<Ae.length&&null===(I=Ae[0]).blockedOn;)be(I),null===I.blockedOn&&Ae.shift()}function Be(g,e){var I={};return I[g.toLowerCase()]=e.toLowerCase(),I["Webkit"+g]="webkit"+e,I["Moz"+g]="moz"+e,I}var ve={animationend:Be("Animation","AnimationEnd"),animationiteration:Be("Animation","AnimationIteration"),animationstart:Be("Animation","AnimationStart"),transitionend:Be("Transition","TransitionEnd")},Ve={},We={};function Se(g){if(Ve[g])return Ve[g];if(!ve[g])return g;var e,I=ve[g];for(e in I)if(I.hasOwnProperty(e)&&e in We)return Ve[g]=I[e];return g}c&&(We=document.createElement("div").style,"AnimationEvent"in window||(delete ve.animationend.animation,delete ve.animationiteration.animation,delete ve.animationstart.animation),"TransitionEvent"in window||delete ve.transitionend.transition);var fe=Se("animationend"),ke=Se("animationiteration"),Re=Se("animationstart"),Xe=Se("transitionend"),Je=new Map,Ye=new Map,He=["abort","abort",fe,"animationEnd",ke,"animationIteration",Re,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",Xe,"transitionEnd","waiting","waiting"];function we(g,e){for(var I=0;I<g.length;I+=2){var t=g[I],n=g[I+1];n="on"+(n[0].toUpperCase()+n.slice(1)),Ye.set(t,e),Je.set(t,n),i(n,[t])}}(0,C.unstable_now)();var Ne=8;function Ke(g){if(0!==(1&g))return Ne=15,1;if(0!==(2&g))return Ne=14,2;if(0!==(4&g))return Ne=13,4;var e=24&g;return 0!==e?(Ne=12,e):0!==(32&g)?(Ne=11,32):0!==(e=192&g)?(Ne=10,e):0!==(256&g)?(Ne=9,256):0!==(e=3584&g)?(Ne=8,e):0!==(4096&g)?(Ne=7,4096):0!==(e=4186112&g)?(Ne=6,e):0!==(e=62914560&g)?(Ne=5,e):67108864&g?(Ne=4,67108864):0!==(134217728&g)?(Ne=3,134217728):0!==(e=805306368&g)?(Ne=2,e):0!==(1073741824&g)?(Ne=1,1073741824):(Ne=8,g)}function Fe(g,e){var I=g.pendingLanes;if(0===I)return Ne=0;var t=0,n=0,C=g.expiredLanes,l=g.suspendedLanes,o=g.pingedLanes;if(0!==C)t=C,n=Ne=15;else if(0!==(C=134217727&I)){var a=C&~l;0!==a?(t=Ke(a),n=Ne):0!==(o&=C)&&(t=Ke(o),n=Ne)}else 0!==(C=I&~l)?(t=Ke(C),n=Ne):0!==o&&(t=Ke(o),n=Ne);if(0===t)return 0;if(t=I&((0>(t=31-Le(t))?0:1<<t)<<1)-1,0!==e&&e!==t&&0===(e&l)){if(Ke(e),n<=Ne)return e;Ne=n}if(0!==(e=g.entangledLanes))for(g=g.entanglements,e&=t;0<e;)n=1<<(I=31-Le(e)),t|=g[I],e&=~n;return t}function Ee(g){return 0!==(g=-1073741825&g.pendingLanes)?g:1073741824&g?1073741824:0}function xe(g,e){switch(g){case 15:return 1;case 14:return 2;case 12:return 0===(g=ze(24&~e))?xe(10,e):g;case 10:return 0===(g=ze(192&~e))?xe(8,e):g;case 8:return 0===(g=ze(3584&~e))&&(0===(g=ze(4186112&~e))&&(g=512)),g;case 2:return 0===(e=ze(805306368&~e))&&(e=268435456),e}throw Error(l(358,g))}function ze(g){return g&-g}function Ue(g){for(var e=[],I=0;31>I;I++)e.push(g);return e}function Me(g,e,I){g.pendingLanes|=e;var t=e-1;g.suspendedLanes&=t,g.pingedLanes&=t,(g=g.eventTimes)[e=31-Le(e)]=I}var Le=Math.clz32?Math.clz32:function(g){return 0===g?32:31-(Te(g)/Qe|0)|0},Te=Math.log,Qe=Math.LN2;var De=C.unstable_UserBlockingPriority,je=C.unstable_runWithPriority,Pe=!0;function Oe(g,e,I,t){Kg||wg();var n=qe,C=Kg;Kg=!0;try{Hg(n,g,e,I,t)}finally{(Kg=C)||Eg()}}function _e(g,e,I,t){je(De,qe.bind(null,g,e,I,t))}function qe(g,e,I,t){var n;if(Pe)if((n=0===(4&e))&&0<le.length&&-1<ue.indexOf(g))g=se(null,g,e,I,t),le.push(g);else{var C=$e(g,e,I,t);if(null===C)n&&de(g,t);else{if(n){if(-1<ue.indexOf(g))return g=se(C,g,e,I,t),void le.push(g);if(function(g,e,I,t,n){switch(e){case"focusin":return oe=Ze(oe,g,e,I,t,n),!0;case"dragenter":return ae=Ze(ae,g,e,I,t,n),!0;case"mouseover":return ie=Ze(ie,g,e,I,t,n),!0;case"pointerover":var C=n.pointerId;return re.set(C,Ze(re.get(C)||null,g,e,I,t,n)),!0;case"gotpointercapture":return C=n.pointerId,ce.set(C,Ze(ce.get(C)||null,g,e,I,t,n)),!0}return!1}(C,g,e,I,t))return;de(g,t)}Ht(g,e,t,null,I)}}}function $e(g,e,I,t){var n=Wg(t);if(null!==(n=en(n))){var C=Og(n);if(null===C)n=null;else{var l=C.tag;if(13===l){if(null!==(n=_g(C)))return n;n=null}else if(3===l){if(C.stateNode.hydrate)return 3===C.tag?C.stateNode.containerInfo:null;n=null}else C!==n&&(n=null)}}return Ht(g,e,t,n,I),null}var gI=null,eI=null,II=null;function tI(){if(II)return II;var g,e,I=eI,t=I.length,n="value"in gI?gI.value:gI.textContent,C=n.length;for(g=0;g<t&&I[g]===n[g];g++);var l=t-g;for(e=1;e<=l&&I[t-e]===n[C-e];e++);return II=n.slice(g,1<e?1-e:void 0)}function nI(g){var e=g.keyCode;return"charCode"in g?0===(g=g.charCode)&&13===e&&(g=13):g=e,10===g&&(g=13),32<=g||13===g?g:0}function CI(){return!0}function lI(){return!1}function oI(g){function e(e,I,t,n,C){for(var l in this._reactName=e,this._targetInst=t,this.type=I,this.nativeEvent=n,this.target=C,this.currentTarget=null,g)g.hasOwnProperty(l)&&(e=g[l],this[l]=e?e(n):n[l]);return this.isDefaultPrevented=(null!=n.defaultPrevented?n.defaultPrevented:!1===n.returnValue)?CI:lI,this.isPropagationStopped=lI,this}return n(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var g=this.nativeEvent;g&&(g.preventDefault?g.preventDefault():"unknown"!==typeof g.returnValue&&(g.returnValue=!1),this.isDefaultPrevented=CI)},stopPropagation:function(){var g=this.nativeEvent;g&&(g.stopPropagation?g.stopPropagation():"unknown"!==typeof g.cancelBubble&&(g.cancelBubble=!0),this.isPropagationStopped=CI)},persist:function(){},isPersistent:CI}),e}var aI,iI,rI,cI={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(g){return g.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},AI=oI(cI),uI=n({},cI,{view:0,detail:0}),sI=oI(uI),dI=n({},uI,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:SI,button:0,buttons:0,relatedTarget:function(g){return void 0===g.relatedTarget?g.fromElement===g.srcElement?g.toElement:g.fromElement:g.relatedTarget},movementX:function(g){return"movementX"in g?g.movementX:(g!==rI&&(rI&&"mousemove"===g.type?(aI=g.screenX-rI.screenX,iI=g.screenY-rI.screenY):iI=aI=0,rI=g),aI)},movementY:function(g){return"movementY"in g?g.movementY:iI}}),ZI=oI(dI),bI=oI(n({},dI,{dataTransfer:0})),mI=oI(n({},uI,{relatedTarget:0})),hI=oI(n({},cI,{animationName:0,elapsedTime:0,pseudoElement:0})),GI=n({},cI,{clipboardData:function(g){return"clipboardData"in g?g.clipboardData:window.clipboardData}}),pI=oI(GI),yI=oI(n({},cI,{data:0})),BI={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},vI={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},VI={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function WI(g){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(g):!!(g=VI[g])&&!!e[g]}function SI(){return WI}var fI=n({},uI,{key:function(g){if(g.key){var e=BI[g.key]||g.key;if("Unidentified"!==e)return e}return"keypress"===g.type?13===(g=nI(g))?"Enter":String.fromCharCode(g):"keydown"===g.type||"keyup"===g.type?vI[g.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:SI,charCode:function(g){return"keypress"===g.type?nI(g):0},keyCode:function(g){return"keydown"===g.type||"keyup"===g.type?g.keyCode:0},which:function(g){return"keypress"===g.type?nI(g):"keydown"===g.type||"keyup"===g.type?g.keyCode:0}}),kI=oI(fI),RI=oI(n({},dI,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),XI=oI(n({},uI,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:SI})),JI=oI(n({},cI,{propertyName:0,elapsedTime:0,pseudoElement:0})),YI=n({},dI,{deltaX:function(g){return"deltaX"in g?g.deltaX:"wheelDeltaX"in g?-g.wheelDeltaX:0},deltaY:function(g){return"deltaY"in g?g.deltaY:"wheelDeltaY"in g?-g.wheelDeltaY:"wheelDelta"in g?-g.wheelDelta:0},deltaZ:0,deltaMode:0}),HI=oI(YI),wI=[9,13,27,32],NI=c&&"CompositionEvent"in window,KI=null;c&&"documentMode"in document&&(KI=document.documentMode);var FI=c&&"TextEvent"in window&&!KI,EI=c&&(!NI||KI&&8<KI&&11>=KI),xI=String.fromCharCode(32),zI=!1;function UI(g,e){switch(g){case"keyup":return-1!==wI.indexOf(e.keyCode);case"keydown":return 229!==e.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function MI(g){return"object"===typeof(g=g.detail)&&"data"in g?g.data:null}var LI=!1;var TI={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function QI(g){var e=g&&g.nodeName&&g.nodeName.toLowerCase();return"input"===e?!!TI[g.type]:"textarea"===e}function DI(g,e,I,t){Xg(t),0<(e=Nt(e,"onChange")).length&&(I=new AI("onChange","change",null,I,t),g.push({event:I,listeners:e}))}var jI=null,PI=null;function OI(g){ft(g,0)}function _I(g){if(_(tn(g)))return g}function qI(g,e){if("change"===g)return e}var $I=!1;if(c){var gt;if(c){var et="oninput"in document;if(!et){var It=document.createElement("div");It.setAttribute("oninput","return;"),et="function"===typeof It.oninput}gt=et}else gt=!1;$I=gt&&(!document.documentMode||9<document.documentMode)}function tt(){jI&&(jI.detachEvent("onpropertychange",nt),PI=jI=null)}function nt(g){if("value"===g.propertyName&&_I(PI)){var e=[];if(DI(e,PI,g,Wg(g)),g=OI,Kg)g(e);else{Kg=!0;try{Yg(g,e)}finally{Kg=!1,Eg()}}}}function Ct(g,e,I){"focusin"===g?(tt(),PI=I,(jI=e).attachEvent("onpropertychange",nt)):"focusout"===g&&tt()}function lt(g){if("selectionchange"===g||"keyup"===g||"keydown"===g)return _I(PI)}function ot(g,e){if("click"===g)return _I(e)}function at(g,e){if("input"===g||"change"===g)return _I(e)}var it="function"===typeof Object.is?Object.is:function(g,e){return g===e&&(0!==g||1/g===1/e)||g!==g&&e!==e},rt=Object.prototype.hasOwnProperty;function ct(g,e){if(it(g,e))return!0;if("object"!==typeof g||null===g||"object"!==typeof e||null===e)return!1;var I=Object.keys(g),t=Object.keys(e);if(I.length!==t.length)return!1;for(t=0;t<I.length;t++)if(!rt.call(e,I[t])||!it(g[I[t]],e[I[t]]))return!1;return!0}function At(g){for(;g&&g.firstChild;)g=g.firstChild;return g}function ut(g,e){var I,t=At(g);for(g=0;t;){if(3===t.nodeType){if(I=g+t.textContent.length,g<=e&&I>=e)return{node:t,offset:e-g};g=I}g:{for(;t;){if(t.nextSibling){t=t.nextSibling;break g}t=t.parentNode}t=void 0}t=At(t)}}function st(g,e){return!(!g||!e)&&(g===e||(!g||3!==g.nodeType)&&(e&&3===e.nodeType?st(g,e.parentNode):"contains"in g?g.contains(e):!!g.compareDocumentPosition&&!!(16&g.compareDocumentPosition(e))))}function dt(){for(var g=window,e=q();e instanceof g.HTMLIFrameElement;){try{var I="string"===typeof e.contentWindow.location.href}catch(t){I=!1}if(!I)break;e=q((g=e.contentWindow).document)}return e}function Zt(g){var e=g&&g.nodeName&&g.nodeName.toLowerCase();return e&&("input"===e&&("text"===g.type||"search"===g.type||"tel"===g.type||"url"===g.type||"password"===g.type)||"textarea"===e||"true"===g.contentEditable)}var bt=c&&"documentMode"in document&&11>=document.documentMode,mt=null,ht=null,Gt=null,pt=!1;function yt(g,e,I){var t=I.window===I?I.document:9===I.nodeType?I:I.ownerDocument;pt||null==mt||mt!==q(t)||("selectionStart"in(t=mt)&&Zt(t)?t={start:t.selectionStart,end:t.selectionEnd}:t={anchorNode:(t=(t.ownerDocument&&t.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:t.anchorOffset,focusNode:t.focusNode,focusOffset:t.focusOffset},Gt&&ct(Gt,t)||(Gt=t,0<(t=Nt(ht,"onSelect")).length&&(e=new AI("onSelect","select",null,e,I),g.push({event:e,listeners:t}),e.target=mt)))}we("cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focusin focus focusout blur input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0),we("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1),we(He,2);for(var Bt="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),vt=0;vt<Bt.length;vt++)Ye.set(Bt[vt],0);r("onMouseEnter",["mouseout","mouseover"]),r("onMouseLeave",["mouseout","mouseover"]),r("onPointerEnter",["pointerout","pointerover"]),r("onPointerLeave",["pointerout","pointerover"]),i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),i("onBeforeInput",["compositionend","keypress","textInput","paste"]),i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Vt="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Wt=new Set("cancel close invalid load scroll toggle".split(" ").concat(Vt));function St(g,e,I){var t=g.type||"unknown-event";g.currentTarget=I,function(g,e,I,t,n,C,o,a,i){if(Pg.apply(this,arguments),Lg){if(!Lg)throw Error(l(198));var r=Tg;Lg=!1,Tg=null,Qg||(Qg=!0,Dg=r)}}(t,e,void 0,g),g.currentTarget=null}function ft(g,e){e=0!==(4&e);for(var I=0;I<g.length;I++){var t=g[I],n=t.event;t=t.listeners;g:{var C=void 0;if(e)for(var l=t.length-1;0<=l;l--){var o=t[l],a=o.instance,i=o.currentTarget;if(o=o.listener,a!==C&&n.isPropagationStopped())break g;St(n,o,i),C=a}else for(l=0;l<t.length;l++){if(a=(o=t[l]).instance,i=o.currentTarget,o=o.listener,a!==C&&n.isPropagationStopped())break g;St(n,o,i),C=a}}}if(Qg)throw g=Dg,Qg=!1,Dg=null,g}function kt(g,e){var I=Cn(e),t=g+"__bubble";I.has(t)||(Yt(e,g,2,!1),I.add(t))}var Rt="_reactListening"+Math.random().toString(36).slice(2);function Xt(g){g[Rt]||(g[Rt]=!0,o.forEach((function(e){Wt.has(e)||Jt(e,!1,g,null),Jt(e,!0,g,null)})))}function Jt(g,e,I,t){var n=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,C=I;if("selectionchange"===g&&9!==I.nodeType&&(C=I.ownerDocument),null!==t&&!e&&Wt.has(g)){if("scroll"!==g)return;n|=2,C=t}var l=Cn(C),o=g+"__"+(e?"capture":"bubble");l.has(o)||(e&&(n|=4),Yt(C,g,n,e),l.add(o))}function Yt(g,e,I,t){var n=Ye.get(e);switch(void 0===n?2:n){case 0:n=Oe;break;case 1:n=_e;break;default:n=qe}I=n.bind(null,e,I,g),n=void 0,!zg||"touchstart"!==e&&"touchmove"!==e&&"wheel"!==e||(n=!0),t?void 0!==n?g.addEventListener(e,I,{capture:!0,passive:n}):g.addEventListener(e,I,!0):void 0!==n?g.addEventListener(e,I,{passive:n}):g.addEventListener(e,I,!1)}function Ht(g,e,I,t,n){var C=t;if(0===(1&e)&&0===(2&e)&&null!==t)g:for(;;){if(null===t)return;var l=t.tag;if(3===l||4===l){var o=t.stateNode.containerInfo;if(o===n||8===o.nodeType&&o.parentNode===n)break;if(4===l)for(l=t.return;null!==l;){var a=l.tag;if((3===a||4===a)&&((a=l.stateNode.containerInfo)===n||8===a.nodeType&&a.parentNode===n))return;l=l.return}for(;null!==o;){if(null===(l=en(o)))return;if(5===(a=l.tag)||6===a){t=C=l;continue g}o=o.parentNode}}t=t.return}!function(g,e,I){if(Fg)return g(e,I);Fg=!0;try{Ng(g,e,I)}finally{Fg=!1,Eg()}}((function(){var t=C,n=Wg(I),l=[];g:{var o=Je.get(g);if(void 0!==o){var a=AI,i=g;switch(g){case"keypress":if(0===nI(I))break g;case"keydown":case"keyup":a=kI;break;case"focusin":i="focus",a=mI;break;case"focusout":i="blur",a=mI;break;case"beforeblur":case"afterblur":a=mI;break;case"click":if(2===I.button)break g;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":a=ZI;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":a=bI;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":a=XI;break;case fe:case ke:case Re:a=hI;break;case Xe:a=JI;break;case"scroll":a=sI;break;case"wheel":a=HI;break;case"copy":case"cut":case"paste":a=pI;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":a=RI}var r=0!==(4&e),c=!r&&"scroll"===g,A=r?null!==o?o+"Capture":null:o;r=[];for(var u,s=t;null!==s;){var d=(u=s).stateNode;if(5===u.tag&&null!==d&&(u=d,null!==A&&(null!=(d=xg(s,A))&&r.push(wt(s,d,u)))),c)break;s=s.return}0<r.length&&(o=new a(o,i,null,I,n),l.push({event:o,listeners:r}))}}if(0===(7&e)){if(a="mouseout"===g||"pointerout"===g,(!(o="mouseover"===g||"pointerover"===g)||0!==(16&e)||!(i=I.relatedTarget||I.fromElement)||!en(i)&&!i[$t])&&(a||o)&&(o=n.window===n?n:(o=n.ownerDocument)?o.defaultView||o.parentWindow:window,a?(a=t,null!==(i=(i=I.relatedTarget||I.toElement)?en(i):null)&&(i!==(c=Og(i))||5!==i.tag&&6!==i.tag)&&(i=null)):(a=null,i=t),a!==i)){if(r=ZI,d="onMouseLeave",A="onMouseEnter",s="mouse","pointerout"!==g&&"pointerover"!==g||(r=RI,d="onPointerLeave",A="onPointerEnter",s="pointer"),c=null==a?o:tn(a),u=null==i?o:tn(i),(o=new r(d,s+"leave",a,I,n)).target=c,o.relatedTarget=u,d=null,en(n)===t&&((r=new r(A,s+"enter",i,I,n)).target=u,r.relatedTarget=c,d=r),c=d,a&&i)g:{for(A=i,s=0,u=r=a;u;u=Kt(u))s++;for(u=0,d=A;d;d=Kt(d))u++;for(;0<s-u;)r=Kt(r),s--;for(;0<u-s;)A=Kt(A),u--;for(;s--;){if(r===A||null!==A&&r===A.alternate)break g;r=Kt(r),A=Kt(A)}r=null}else r=null;null!==a&&Ft(l,o,a,r,!1),null!==i&&null!==c&&Ft(l,c,i,r,!0)}if("select"===(a=(o=t?tn(t):window).nodeName&&o.nodeName.toLowerCase())||"input"===a&&"file"===o.type)var Z=qI;else if(QI(o))if($I)Z=at;else{Z=lt;var b=Ct}else(a=o.nodeName)&&"input"===a.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(Z=ot);switch(Z&&(Z=Z(g,t))?DI(l,Z,I,n):(b&&b(g,o,t),"focusout"===g&&(b=o._wrapperState)&&b.controlled&&"number"===o.type&&ng(o,"number",o.value)),b=t?tn(t):window,g){case"focusin":(QI(b)||"true"===b.contentEditable)&&(mt=b,ht=t,Gt=null);break;case"focusout":Gt=ht=mt=null;break;case"mousedown":pt=!0;break;case"contextmenu":case"mouseup":case"dragend":pt=!1,yt(l,I,n);break;case"selectionchange":if(bt)break;case"keydown":case"keyup":yt(l,I,n)}var m;if(NI)g:{switch(g){case"compositionstart":var h="onCompositionStart";break g;case"compositionend":h="onCompositionEnd";break g;case"compositionupdate":h="onCompositionUpdate";break g}h=void 0}else LI?UI(g,I)&&(h="onCompositionEnd"):"keydown"===g&&229===I.keyCode&&(h="onCompositionStart");h&&(EI&&"ko"!==I.locale&&(LI||"onCompositionStart"!==h?"onCompositionEnd"===h&&LI&&(m=tI()):(eI="value"in(gI=n)?gI.value:gI.textContent,LI=!0)),0<(b=Nt(t,h)).length&&(h=new yI(h,g,null,I,n),l.push({event:h,listeners:b}),m?h.data=m:null!==(m=MI(I))&&(h.data=m))),(m=FI?function(g,e){switch(g){case"compositionend":return MI(e);case"keypress":return 32!==e.which?null:(zI=!0,xI);case"textInput":return(g=e.data)===xI&&zI?null:g;default:return null}}(g,I):function(g,e){if(LI)return"compositionend"===g||!NI&&UI(g,e)?(g=tI(),II=eI=gI=null,LI=!1,g):null;switch(g){case"paste":default:return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return EI&&"ko"!==e.locale?null:e.data}}(g,I))&&(0<(t=Nt(t,"onBeforeInput")).length&&(n=new yI("onBeforeInput","beforeinput",null,I,n),l.push({event:n,listeners:t}),n.data=m))}ft(l,e)}))}function wt(g,e,I){return{instance:g,listener:e,currentTarget:I}}function Nt(g,e){for(var I=e+"Capture",t=[];null!==g;){var n=g,C=n.stateNode;5===n.tag&&null!==C&&(n=C,null!=(C=xg(g,I))&&t.unshift(wt(g,C,n)),null!=(C=xg(g,e))&&t.push(wt(g,C,n))),g=g.return}return t}function Kt(g){if(null===g)return null;do{g=g.return}while(g&&5!==g.tag);return g||null}function Ft(g,e,I,t,n){for(var C=e._reactName,l=[];null!==I&&I!==t;){var o=I,a=o.alternate,i=o.stateNode;if(null!==a&&a===t)break;5===o.tag&&null!==i&&(o=i,n?null!=(a=xg(I,C))&&l.unshift(wt(I,a,o)):n||null!=(a=xg(I,C))&&l.push(wt(I,a,o))),I=I.return}0!==l.length&&g.push({event:e,listeners:l})}function Et(){}var xt=null,zt=null;function Ut(g,e){switch(g){case"button":case"input":case"select":case"textarea":return!!e.autoFocus}return!1}function Mt(g,e){return"textarea"===g||"option"===g||"noscript"===g||"string"===typeof e.children||"number"===typeof e.children||"object"===typeof e.dangerouslySetInnerHTML&&null!==e.dangerouslySetInnerHTML&&null!=e.dangerouslySetInnerHTML.__html}var Lt="function"===typeof setTimeout?setTimeout:void 0,Tt="function"===typeof clearTimeout?clearTimeout:void 0;function Qt(g){1===g.nodeType?g.textContent="":9===g.nodeType&&(null!=(g=g.body)&&(g.textContent=""))}function Dt(g){for(;null!=g;g=g.nextSibling){var e=g.nodeType;if(1===e||3===e)break}return g}function jt(g){g=g.previousSibling;for(var e=0;g;){if(8===g.nodeType){var I=g.data;if("$"===I||"$!"===I||"$?"===I){if(0===e)return g;e--}else"/$"===I&&e++}g=g.previousSibling}return null}var Pt=0;var Ot=Math.random().toString(36).slice(2),_t="__reactFiber$"+Ot,qt="__reactProps$"+Ot,$t="__reactContainer$"+Ot,gn="__reactEvents$"+Ot;function en(g){var e=g[_t];if(e)return e;for(var I=g.parentNode;I;){if(e=I[$t]||I[_t]){if(I=e.alternate,null!==e.child||null!==I&&null!==I.child)for(g=jt(g);null!==g;){if(I=g[_t])return I;g=jt(g)}return e}I=(g=I).parentNode}return null}function In(g){return!(g=g[_t]||g[$t])||5!==g.tag&&6!==g.tag&&13!==g.tag&&3!==g.tag?null:g}function tn(g){if(5===g.tag||6===g.tag)return g.stateNode;throw Error(l(33))}function nn(g){return g[qt]||null}function Cn(g){var e=g[gn];return void 0===e&&(e=g[gn]=new Set),e}var ln=[],on=-1;function an(g){return{current:g}}function rn(g){0>on||(g.current=ln[on],ln[on]=null,on--)}function cn(g,e){on++,ln[on]=g.current,g.current=e}var An={},un=an(An),sn=an(!1),dn=An;function Zn(g,e){var I=g.type.contextTypes;if(!I)return An;var t=g.stateNode;if(t&&t.__reactInternalMemoizedUnmaskedChildContext===e)return t.__reactInternalMemoizedMaskedChildContext;var n,C={};for(n in I)C[n]=e[n];return t&&((g=g.stateNode).__reactInternalMemoizedUnmaskedChildContext=e,g.__reactInternalMemoizedMaskedChildContext=C),C}function bn(g){return null!==(g=g.childContextTypes)&&void 0!==g}function mn(){rn(sn),rn(un)}function hn(g,e,I){if(un.current!==An)throw Error(l(168));cn(un,e),cn(sn,I)}function Gn(g,e,I){var t=g.stateNode;if(g=e.childContextTypes,"function"!==typeof t.getChildContext)return I;for(var C in t=t.getChildContext())if(!(C in g))throw Error(l(108,D(e)||"Unknown",C));return n({},I,t)}function pn(g){return g=(g=g.stateNode)&&g.__reactInternalMemoizedMergedChildContext||An,dn=un.current,cn(un,g),cn(sn,sn.current),!0}function yn(g,e,I){var t=g.stateNode;if(!t)throw Error(l(169));I?(g=Gn(g,e,dn),t.__reactInternalMemoizedMergedChildContext=g,rn(sn),rn(un),cn(un,g)):rn(sn),cn(sn,I)}var Bn=null,vn=null,Vn=C.unstable_runWithPriority,Wn=C.unstable_scheduleCallback,Sn=C.unstable_cancelCallback,fn=C.unstable_shouldYield,kn=C.unstable_requestPaint,Rn=C.unstable_now,Xn=C.unstable_getCurrentPriorityLevel,Jn=C.unstable_ImmediatePriority,Yn=C.unstable_UserBlockingPriority,Hn=C.unstable_NormalPriority,wn=C.unstable_LowPriority,Nn=C.unstable_IdlePriority,Kn={},Fn=void 0!==kn?kn:function(){},En=null,xn=null,zn=!1,Un=Rn(),Mn=1e4>Un?Rn:function(){return Rn()-Un};function Ln(){switch(Xn()){case Jn:return 99;case Yn:return 98;case Hn:return 97;case wn:return 96;case Nn:return 95;default:throw Error(l(332))}}function Tn(g){switch(g){case 99:return Jn;case 98:return Yn;case 97:return Hn;case 96:return wn;case 95:return Nn;default:throw Error(l(332))}}function Qn(g,e){return g=Tn(g),Vn(g,e)}function Dn(g,e,I){return g=Tn(g),Wn(g,e,I)}function jn(){if(null!==xn){var g=xn;xn=null,Sn(g)}Pn()}function Pn(){if(!zn&&null!==En){zn=!0;var g=0;try{var e=En;Qn(99,(function(){for(;g<e.length;g++){var I=e[g];do{I=I(!0)}while(null!==I)}})),En=null}catch(I){throw null!==En&&(En=En.slice(g+1)),Wn(Jn,jn),I}finally{zn=!1}}}var On=p.ReactCurrentBatchConfig;function _n(g,e){if(g&&g.defaultProps){for(var I in e=n({},e),g=g.defaultProps)void 0===e[I]&&(e[I]=g[I]);return e}return e}var qn=an(null),$n=null,gC=null,eC=null;function IC(){eC=gC=$n=null}function tC(g){var e=qn.current;rn(qn),g.type._context._currentValue=e}function nC(g,e){for(;null!==g;){var I=g.alternate;if((g.childLanes&e)===e){if(null===I||(I.childLanes&e)===e)break;I.childLanes|=e}else g.childLanes|=e,null!==I&&(I.childLanes|=e);g=g.return}}function CC(g,e){$n=g,eC=gC=null,null!==(g=g.dependencies)&&null!==g.firstContext&&(0!==(g.lanes&e)&&(Nl=!0),g.firstContext=null)}function lC(g,e){if(eC!==g&&!1!==e&&0!==e)if("number"===typeof e&&1073741823!==e||(eC=g,e=1073741823),e={context:g,observedBits:e,next:null},null===gC){if(null===$n)throw Error(l(308));gC=e,$n.dependencies={lanes:0,firstContext:e,responders:null}}else gC=gC.next=e;return g._currentValue}var oC=!1;function aC(g){g.updateQueue={baseState:g.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null},effects:null}}function iC(g,e){g=g.updateQueue,e.updateQueue===g&&(e.updateQueue={baseState:g.baseState,firstBaseUpdate:g.firstBaseUpdate,lastBaseUpdate:g.lastBaseUpdate,shared:g.shared,effects:g.effects})}function rC(g,e){return{eventTime:g,lane:e,tag:0,payload:null,callback:null,next:null}}function cC(g,e){if(null!==(g=g.updateQueue)){var I=(g=g.shared).pending;null===I?e.next=e:(e.next=I.next,I.next=e),g.pending=e}}function AC(g,e){var I=g.updateQueue,t=g.alternate;if(null!==t&&I===(t=t.updateQueue)){var n=null,C=null;if(null!==(I=I.firstBaseUpdate)){do{var l={eventTime:I.eventTime,lane:I.lane,tag:I.tag,payload:I.payload,callback:I.callback,next:null};null===C?n=C=l:C=C.next=l,I=I.next}while(null!==I);null===C?n=C=e:C=C.next=e}else n=C=e;return I={baseState:t.baseState,firstBaseUpdate:n,lastBaseUpdate:C,shared:t.shared,effects:t.effects},void(g.updateQueue=I)}null===(g=I.lastBaseUpdate)?I.firstBaseUpdate=e:g.next=e,I.lastBaseUpdate=e}function uC(g,e,I,t){var C=g.updateQueue;oC=!1;var l=C.firstBaseUpdate,o=C.lastBaseUpdate,a=C.shared.pending;if(null!==a){C.shared.pending=null;var i=a,r=i.next;i.next=null,null===o?l=r:o.next=r,o=i;var c=g.alternate;if(null!==c){var A=(c=c.updateQueue).lastBaseUpdate;A!==o&&(null===A?c.firstBaseUpdate=r:A.next=r,c.lastBaseUpdate=i)}}if(null!==l){for(A=C.baseState,o=0,c=r=i=null;;){a=l.lane;var u=l.eventTime;if((t&a)===a){null!==c&&(c=c.next={eventTime:u,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});g:{var s=g,d=l;switch(a=e,u=I,d.tag){case 1:if("function"===typeof(s=d.payload)){A=s.call(u,A,a);break g}A=s;break g;case 3:s.flags=-4097&s.flags|64;case 0:if(null===(a="function"===typeof(s=d.payload)?s.call(u,A,a):s)||void 0===a)break g;A=n({},A,a);break g;case 2:oC=!0}}null!==l.callback&&(g.flags|=32,null===(a=C.effects)?C.effects=[l]:a.push(l))}else u={eventTime:u,lane:a,tag:l.tag,payload:l.payload,callback:l.callback,next:null},null===c?(r=c=u,i=A):c=c.next=u,o|=a;if(null===(l=l.next)){if(null===(a=C.shared.pending))break;l=a.next,a.next=null,C.lastBaseUpdate=a,C.shared.pending=null}}null===c&&(i=A),C.baseState=i,C.firstBaseUpdate=r,C.lastBaseUpdate=c,zo|=o,g.lanes=o,g.memoizedState=A}}function sC(g,e,I){if(g=e.effects,e.effects=null,null!==g)for(e=0;e<g.length;e++){var t=g[e],n=t.callback;if(null!==n){if(t.callback=null,t=I,"function"!==typeof n)throw Error(l(191,n));n.call(t)}}}var dC=(new t.Component).refs;function ZC(g,e,I,t){I=null===(I=I(t,e=g.memoizedState))||void 0===I?e:n({},e,I),g.memoizedState=I,0===g.lanes&&(g.updateQueue.baseState=I)}var bC={isMounted:function(g){return!!(g=g._reactInternals)&&Og(g)===g},enqueueSetState:function(g,e,I){g=g._reactInternals;var t=Aa(),n=ua(g),C=rC(t,n);C.payload=e,void 0!==I&&null!==I&&(C.callback=I),cC(g,C),sa(g,n,t)},enqueueReplaceState:function(g,e,I){g=g._reactInternals;var t=Aa(),n=ua(g),C=rC(t,n);C.tag=1,C.payload=e,void 0!==I&&null!==I&&(C.callback=I),cC(g,C),sa(g,n,t)},enqueueForceUpdate:function(g,e){g=g._reactInternals;var I=Aa(),t=ua(g),n=rC(I,t);n.tag=2,void 0!==e&&null!==e&&(n.callback=e),cC(g,n),sa(g,t,I)}};function mC(g,e,I,t,n,C,l){return"function"===typeof(g=g.stateNode).shouldComponentUpdate?g.shouldComponentUpdate(t,C,l):!e.prototype||!e.prototype.isPureReactComponent||(!ct(I,t)||!ct(n,C))}function hC(g,e,I){var t=!1,n=An,C=e.contextType;return"object"===typeof C&&null!==C?C=lC(C):(n=bn(e)?dn:un.current,C=(t=null!==(t=e.contextTypes)&&void 0!==t)?Zn(g,n):An),e=new e(I,C),g.memoizedState=null!==e.state&&void 0!==e.state?e.state:null,e.updater=bC,g.stateNode=e,e._reactInternals=g,t&&((g=g.stateNode).__reactInternalMemoizedUnmaskedChildContext=n,g.__reactInternalMemoizedMaskedChildContext=C),e}function GC(g,e,I,t){g=e.state,"function"===typeof e.componentWillReceiveProps&&e.componentWillReceiveProps(I,t),"function"===typeof e.UNSAFE_componentWillReceiveProps&&e.UNSAFE_componentWillReceiveProps(I,t),e.state!==g&&bC.enqueueReplaceState(e,e.state,null)}function pC(g,e,I,t){var n=g.stateNode;n.props=I,n.state=g.memoizedState,n.refs=dC,aC(g);var C=e.contextType;"object"===typeof C&&null!==C?n.context=lC(C):(C=bn(e)?dn:un.current,n.context=Zn(g,C)),uC(g,I,n,t),n.state=g.memoizedState,"function"===typeof(C=e.getDerivedStateFromProps)&&(ZC(g,e,C,I),n.state=g.memoizedState),"function"===typeof e.getDerivedStateFromProps||"function"===typeof n.getSnapshotBeforeUpdate||"function"!==typeof n.UNSAFE_componentWillMount&&"function"!==typeof n.componentWillMount||(e=n.state,"function"===typeof n.componentWillMount&&n.componentWillMount(),"function"===typeof n.UNSAFE_componentWillMount&&n.UNSAFE_componentWillMount(),e!==n.state&&bC.enqueueReplaceState(n,n.state,null),uC(g,I,n,t),n.state=g.memoizedState),"function"===typeof n.componentDidMount&&(g.flags|=4)}var yC=Array.isArray;function BC(g,e,I){if(null!==(g=I.ref)&&"function"!==typeof g&&"object"!==typeof g){if(I._owner){if(I=I._owner){if(1!==I.tag)throw Error(l(309));var t=I.stateNode}if(!t)throw Error(l(147,g));var n=""+g;return null!==e&&null!==e.ref&&"function"===typeof e.ref&&e.ref._stringRef===n?e.ref:(e=function(g){var e=t.refs;e===dC&&(e=t.refs={}),null===g?delete e[n]:e[n]=g},e._stringRef=n,e)}if("string"!==typeof g)throw Error(l(284));if(!I._owner)throw Error(l(290,g))}return g}function vC(g,e){if("textarea"!==g.type)throw Error(l(31,"[object Object]"===Object.prototype.toString.call(e)?"object with keys {"+Object.keys(e).join(", ")+"}":e))}function VC(g){function e(e,I){if(g){var t=e.lastEffect;null!==t?(t.nextEffect=I,e.lastEffect=I):e.firstEffect=e.lastEffect=I,I.nextEffect=null,I.flags=8}}function I(I,t){if(!g)return null;for(;null!==t;)e(I,t),t=t.sibling;return null}function t(g,e){for(g=new Map;null!==e;)null!==e.key?g.set(e.key,e):g.set(e.index,e),e=e.sibling;return g}function n(g,e){return(g=Qa(g,e)).index=0,g.sibling=null,g}function C(e,I,t){return e.index=t,g?null!==(t=e.alternate)?(t=t.index)<I?(e.flags=2,I):t:(e.flags=2,I):I}function o(e){return g&&null===e.alternate&&(e.flags=2),e}function a(g,e,I,t){return null===e||6!==e.tag?((e=Oa(I,g.mode,t)).return=g,e):((e=n(e,I)).return=g,e)}function i(g,e,I,t){return null!==e&&e.elementType===I.type?((t=n(e,I.props)).ref=BC(g,e,I),t.return=g,t):((t=Da(I.type,I.key,I.props,null,g.mode,t)).ref=BC(g,e,I),t.return=g,t)}function r(g,e,I,t){return null===e||4!==e.tag||e.stateNode.containerInfo!==I.containerInfo||e.stateNode.implementation!==I.implementation?((e=_a(I,g.mode,t)).return=g,e):((e=n(e,I.children||[])).return=g,e)}function c(g,e,I,t,C){return null===e||7!==e.tag?((e=ja(I,g.mode,t,C)).return=g,e):((e=n(e,I)).return=g,e)}function A(g,e,I){if("string"===typeof e||"number"===typeof e)return(e=Oa(""+e,g.mode,I)).return=g,e;if("object"===typeof e&&null!==e){switch(e.$$typeof){case y:return(I=Da(e.type,e.key,e.props,null,g.mode,I)).ref=BC(g,null,e),I.return=g,I;case B:return(e=_a(e,g.mode,I)).return=g,e}if(yC(e)||U(e))return(e=ja(e,g.mode,I,null)).return=g,e;vC(g,e)}return null}function u(g,e,I,t){var n=null!==e?e.key:null;if("string"===typeof I||"number"===typeof I)return null!==n?null:a(g,e,""+I,t);if("object"===typeof I&&null!==I){switch(I.$$typeof){case y:return I.key===n?I.type===v?c(g,e,I.props.children,t,n):i(g,e,I,t):null;case B:return I.key===n?r(g,e,I,t):null}if(yC(I)||U(I))return null!==n?null:c(g,e,I,t,null);vC(g,I)}return null}function s(g,e,I,t,n){if("string"===typeof t||"number"===typeof t)return a(e,g=g.get(I)||null,""+t,n);if("object"===typeof t&&null!==t){switch(t.$$typeof){case y:return g=g.get(null===t.key?I:t.key)||null,t.type===v?c(e,g,t.props.children,n,t.key):i(e,g,t,n);case B:return r(e,g=g.get(null===t.key?I:t.key)||null,t,n)}if(yC(t)||U(t))return c(e,g=g.get(I)||null,t,n,null);vC(e,t)}return null}function d(n,l,o,a){for(var i=null,r=null,c=l,d=l=0,Z=null;null!==c&&d<o.length;d++){c.index>d?(Z=c,c=null):Z=c.sibling;var b=u(n,c,o[d],a);if(null===b){null===c&&(c=Z);break}g&&c&&null===b.alternate&&e(n,c),l=C(b,l,d),null===r?i=b:r.sibling=b,r=b,c=Z}if(d===o.length)return I(n,c),i;if(null===c){for(;d<o.length;d++)null!==(c=A(n,o[d],a))&&(l=C(c,l,d),null===r?i=c:r.sibling=c,r=c);return i}for(c=t(n,c);d<o.length;d++)null!==(Z=s(c,n,d,o[d],a))&&(g&&null!==Z.alternate&&c.delete(null===Z.key?d:Z.key),l=C(Z,l,d),null===r?i=Z:r.sibling=Z,r=Z);return g&&c.forEach((function(g){return e(n,g)})),i}function Z(n,o,a,i){var r=U(a);if("function"!==typeof r)throw Error(l(150));if(null==(a=r.call(a)))throw Error(l(151));for(var c=r=null,d=o,Z=o=0,b=null,m=a.next();null!==d&&!m.done;Z++,m=a.next()){d.index>Z?(b=d,d=null):b=d.sibling;var h=u(n,d,m.value,i);if(null===h){null===d&&(d=b);break}g&&d&&null===h.alternate&&e(n,d),o=C(h,o,Z),null===c?r=h:c.sibling=h,c=h,d=b}if(m.done)return I(n,d),r;if(null===d){for(;!m.done;Z++,m=a.next())null!==(m=A(n,m.value,i))&&(o=C(m,o,Z),null===c?r=m:c.sibling=m,c=m);return r}for(d=t(n,d);!m.done;Z++,m=a.next())null!==(m=s(d,n,Z,m.value,i))&&(g&&null!==m.alternate&&d.delete(null===m.key?Z:m.key),o=C(m,o,Z),null===c?r=m:c.sibling=m,c=m);return g&&d.forEach((function(g){return e(n,g)})),r}return function(g,t,C,a){var i="object"===typeof C&&null!==C&&C.type===v&&null===C.key;i&&(C=C.props.children);var r="object"===typeof C&&null!==C;if(r)switch(C.$$typeof){case y:g:{for(r=C.key,i=t;null!==i;){if(i.key===r){if(7===i.tag){if(C.type===v){I(g,i.sibling),(t=n(i,C.props.children)).return=g,g=t;break g}}else if(i.elementType===C.type){I(g,i.sibling),(t=n(i,C.props)).ref=BC(g,i,C),t.return=g,g=t;break g}I(g,i);break}e(g,i),i=i.sibling}C.type===v?((t=ja(C.props.children,g.mode,a,C.key)).return=g,g=t):((a=Da(C.type,C.key,C.props,null,g.mode,a)).ref=BC(g,t,C),a.return=g,g=a)}return o(g);case B:g:{for(i=C.key;null!==t;){if(t.key===i){if(4===t.tag&&t.stateNode.containerInfo===C.containerInfo&&t.stateNode.implementation===C.implementation){I(g,t.sibling),(t=n(t,C.children||[])).return=g,g=t;break g}I(g,t);break}e(g,t),t=t.sibling}(t=_a(C,g.mode,a)).return=g,g=t}return o(g)}if("string"===typeof C||"number"===typeof C)return C=""+C,null!==t&&6===t.tag?(I(g,t.sibling),(t=n(t,C)).return=g,g=t):(I(g,t),(t=Oa(C,g.mode,a)).return=g,g=t),o(g);if(yC(C))return d(g,t,C,a);if(U(C))return Z(g,t,C,a);if(r&&vC(g,C),"undefined"===typeof C&&!i)switch(g.tag){case 1:case 22:case 0:case 11:case 15:throw Error(l(152,D(g.type)||"Component"))}return I(g,t)}}var WC=VC(!0),SC=VC(!1),fC={},kC=an(fC),RC=an(fC),XC=an(fC);function JC(g){if(g===fC)throw Error(l(174));return g}function YC(g,e){switch(cn(XC,e),cn(RC,g),cn(kC,fC),g=e.nodeType){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:sg(null,"");break;default:e=sg(e=(g=8===g?e.parentNode:e).namespaceURI||null,g=g.tagName)}rn(kC),cn(kC,e)}function HC(){rn(kC),rn(RC),rn(XC)}function wC(g){JC(XC.current);var e=JC(kC.current),I=sg(e,g.type);e!==I&&(cn(RC,g),cn(kC,I))}function NC(g){RC.current===g&&(rn(kC),rn(RC))}var KC=an(0);function FC(g){for(var e=g;null!==e;){if(13===e.tag){var I=e.memoizedState;if(null!==I&&(null===(I=I.dehydrated)||"$?"===I.data||"$!"===I.data))return e}else if(19===e.tag&&void 0!==e.memoizedProps.revealOrder){if(0!==(64&e.flags))return e}else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===g)break;for(;null===e.sibling;){if(null===e.return||e.return===g)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var EC=null,xC=null,zC=!1;function UC(g,e){var I=La(5,null,null,0);I.elementType="DELETED",I.type="DELETED",I.stateNode=e,I.return=g,I.flags=8,null!==g.lastEffect?(g.lastEffect.nextEffect=I,g.lastEffect=I):g.firstEffect=g.lastEffect=I}function MC(g,e){switch(g.tag){case 5:var I=g.type;return null!==(e=1!==e.nodeType||I.toLowerCase()!==e.nodeName.toLowerCase()?null:e)&&(g.stateNode=e,!0);case 6:return null!==(e=""===g.pendingProps||3!==e.nodeType?null:e)&&(g.stateNode=e,!0);default:return!1}}function LC(g){if(zC){var e=xC;if(e){var I=e;if(!MC(g,e)){if(!(e=Dt(I.nextSibling))||!MC(g,e))return g.flags=-1025&g.flags|2,zC=!1,void(EC=g);UC(EC,I)}EC=g,xC=Dt(e.firstChild)}else g.flags=-1025&g.flags|2,zC=!1,EC=g}}function TC(g){for(g=g.return;null!==g&&5!==g.tag&&3!==g.tag&&13!==g.tag;)g=g.return;EC=g}function QC(g){if(g!==EC)return!1;if(!zC)return TC(g),zC=!0,!1;var e=g.type;if(5!==g.tag||"head"!==e&&"body"!==e&&!Mt(e,g.memoizedProps))for(e=xC;e;)UC(g,e),e=Dt(e.nextSibling);if(TC(g),13===g.tag){if(!(g=null!==(g=g.memoizedState)?g.dehydrated:null))throw Error(l(317));g:{for(g=g.nextSibling,e=0;g;){if(8===g.nodeType){var I=g.data;if("/$"===I){if(0===e){xC=Dt(g.nextSibling);break g}e--}else"$"!==I&&"$!"!==I&&"$?"!==I||e++}g=g.nextSibling}xC=null}}else xC=EC?Dt(g.stateNode.nextSibling):null;return!0}function DC(){xC=EC=null,zC=!1}var jC=[];function PC(){for(var g=0;g<jC.length;g++)jC[g]._workInProgressVersionPrimary=null;jC.length=0}var OC=p.ReactCurrentDispatcher,_C=p.ReactCurrentBatchConfig,qC=0,$C=null,gl=null,el=null,Il=!1,tl=!1;function nl(){throw Error(l(321))}function Cl(g,e){if(null===e)return!1;for(var I=0;I<e.length&&I<g.length;I++)if(!it(g[I],e[I]))return!1;return!0}function ll(g,e,I,t,n,C){if(qC=C,$C=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,OC.current=null===g||null===g.memoizedState?Jl:Yl,g=I(t,n),tl){C=0;do{if(tl=!1,!(25>C))throw Error(l(301));C+=1,el=gl=null,e.updateQueue=null,OC.current=Hl,g=I(t,n)}while(tl)}if(OC.current=Xl,e=null!==gl&&null!==gl.next,qC=0,el=gl=$C=null,Il=!1,e)throw Error(l(300));return g}function ol(){var g={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===el?$C.memoizedState=el=g:el=el.next=g,el}function al(){if(null===gl){var g=$C.alternate;g=null!==g?g.memoizedState:null}else g=gl.next;var e=null===el?$C.memoizedState:el.next;if(null!==e)el=e,gl=g;else{if(null===g)throw Error(l(310));g={memoizedState:(gl=g).memoizedState,baseState:gl.baseState,baseQueue:gl.baseQueue,queue:gl.queue,next:null},null===el?$C.memoizedState=el=g:el=el.next=g}return el}function il(g,e){return"function"===typeof e?e(g):e}function rl(g){var e=al(),I=e.queue;if(null===I)throw Error(l(311));I.lastRenderedReducer=g;var t=gl,n=t.baseQueue,C=I.pending;if(null!==C){if(null!==n){var o=n.next;n.next=C.next,C.next=o}t.baseQueue=n=C,I.pending=null}if(null!==n){n=n.next,t=t.baseState;var a=o=C=null,i=n;do{var r=i.lane;if((qC&r)===r)null!==a&&(a=a.next={lane:0,action:i.action,eagerReducer:i.eagerReducer,eagerState:i.eagerState,next:null}),t=i.eagerReducer===g?i.eagerState:g(t,i.action);else{var c={lane:r,action:i.action,eagerReducer:i.eagerReducer,eagerState:i.eagerState,next:null};null===a?(o=a=c,C=t):a=a.next=c,$C.lanes|=r,zo|=r}i=i.next}while(null!==i&&i!==n);null===a?C=t:a.next=o,it(t,e.memoizedState)||(Nl=!0),e.memoizedState=t,e.baseState=C,e.baseQueue=a,I.lastRenderedState=t}return[e.memoizedState,I.dispatch]}function cl(g){var e=al(),I=e.queue;if(null===I)throw Error(l(311));I.lastRenderedReducer=g;var t=I.dispatch,n=I.pending,C=e.memoizedState;if(null!==n){I.pending=null;var o=n=n.next;do{C=g(C,o.action),o=o.next}while(o!==n);it(C,e.memoizedState)||(Nl=!0),e.memoizedState=C,null===e.baseQueue&&(e.baseState=C),I.lastRenderedState=C}return[C,t]}function Al(g,e,I){var t=e._getVersion;t=t(e._source);var n=e._workInProgressVersionPrimary;if(null!==n?g=n===t:(g=g.mutableReadLanes,(g=(qC&g)===g)&&(e._workInProgressVersionPrimary=t,jC.push(e))),g)return I(e._source);throw jC.push(e),Error(l(350))}function ul(g,e,I,t){var n=Yo;if(null===n)throw Error(l(349));var C=e._getVersion,o=C(e._source),a=OC.current,i=a.useState((function(){return Al(n,e,I)})),r=i[1],c=i[0];i=el;var A=g.memoizedState,u=A.refs,s=u.getSnapshot,d=A.source;A=A.subscribe;var Z=$C;return g.memoizedState={refs:u,source:e,subscribe:t},a.useEffect((function(){u.getSnapshot=I,u.setSnapshot=r;var g=C(e._source);if(!it(o,g)){g=I(e._source),it(c,g)||(r(g),g=ua(Z),n.mutableReadLanes|=g&n.pendingLanes),g=n.mutableReadLanes,n.entangledLanes|=g;for(var t=n.entanglements,l=g;0<l;){var a=31-Le(l),i=1<<a;t[a]|=g,l&=~i}}}),[I,e,t]),a.useEffect((function(){return t(e._source,(function(){var g=u.getSnapshot,I=u.setSnapshot;try{I(g(e._source));var t=ua(Z);n.mutableReadLanes|=t&n.pendingLanes}catch(C){I((function(){throw C}))}}))}),[e,t]),it(s,I)&&it(d,e)&&it(A,t)||((g={pending:null,dispatch:null,lastRenderedReducer:il,lastRenderedState:c}).dispatch=r=Rl.bind(null,$C,g),i.queue=g,i.baseQueue=null,c=Al(n,e,I),i.memoizedState=i.baseState=c),c}function sl(g,e,I){return ul(al(),g,e,I)}function dl(g){var e=ol();return"function"===typeof g&&(g=g()),e.memoizedState=e.baseState=g,g=(g=e.queue={pending:null,dispatch:null,lastRenderedReducer:il,lastRenderedState:g}).dispatch=Rl.bind(null,$C,g),[e.memoizedState,g]}function Zl(g,e,I,t){return g={tag:g,create:e,destroy:I,deps:t,next:null},null===(e=$C.updateQueue)?(e={lastEffect:null},$C.updateQueue=e,e.lastEffect=g.next=g):null===(I=e.lastEffect)?e.lastEffect=g.next=g:(t=I.next,I.next=g,g.next=t,e.lastEffect=g),g}function bl(g){return g={current:g},ol().memoizedState=g}function ml(){return al().memoizedState}function hl(g,e,I,t){var n=ol();$C.flags|=g,n.memoizedState=Zl(1|e,I,void 0,void 0===t?null:t)}function Gl(g,e,I,t){var n=al();t=void 0===t?null:t;var C=void 0;if(null!==gl){var l=gl.memoizedState;if(C=l.destroy,null!==t&&Cl(t,l.deps))return void Zl(e,I,C,t)}$C.flags|=g,n.memoizedState=Zl(1|e,I,C,t)}function pl(g,e){return hl(516,4,g,e)}function yl(g,e){return Gl(516,4,g,e)}function Bl(g,e){return Gl(4,2,g,e)}function vl(g,e){return"function"===typeof e?(g=g(),e(g),function(){e(null)}):null!==e&&void 0!==e?(g=g(),e.current=g,function(){e.current=null}):void 0}function Vl(g,e,I){return I=null!==I&&void 0!==I?I.concat([g]):null,Gl(4,2,vl.bind(null,e,g),I)}function Wl(){}function Sl(g,e){var I=al();e=void 0===e?null:e;var t=I.memoizedState;return null!==t&&null!==e&&Cl(e,t[1])?t[0]:(I.memoizedState=[g,e],g)}function fl(g,e){var I=al();e=void 0===e?null:e;var t=I.memoizedState;return null!==t&&null!==e&&Cl(e,t[1])?t[0]:(g=g(),I.memoizedState=[g,e],g)}function kl(g,e){var I=Ln();Qn(98>I?98:I,(function(){g(!0)})),Qn(97<I?97:I,(function(){var I=_C.transition;_C.transition=1;try{g(!1),e()}finally{_C.transition=I}}))}function Rl(g,e,I){var t=Aa(),n=ua(g),C={lane:n,action:I,eagerReducer:null,eagerState:null,next:null},l=e.pending;if(null===l?C.next=C:(C.next=l.next,l.next=C),e.pending=C,l=g.alternate,g===$C||null!==l&&l===$C)tl=Il=!0;else{if(0===g.lanes&&(null===l||0===l.lanes)&&null!==(l=e.lastRenderedReducer))try{var o=e.lastRenderedState,a=l(o,I);if(C.eagerReducer=l,C.eagerState=a,it(a,o))return}catch(i){}sa(g,n,t)}}var Xl={readContext:lC,useCallback:nl,useContext:nl,useEffect:nl,useImperativeHandle:nl,useLayoutEffect:nl,useMemo:nl,useReducer:nl,useRef:nl,useState:nl,useDebugValue:nl,useDeferredValue:nl,useTransition:nl,useMutableSource:nl,useOpaqueIdentifier:nl,unstable_isNewReconciler:!1},Jl={readContext:lC,useCallback:function(g,e){return ol().memoizedState=[g,void 0===e?null:e],g},useContext:lC,useEffect:pl,useImperativeHandle:function(g,e,I){return I=null!==I&&void 0!==I?I.concat([g]):null,hl(4,2,vl.bind(null,e,g),I)},useLayoutEffect:function(g,e){return hl(4,2,g,e)},useMemo:function(g,e){var I=ol();return e=void 0===e?null:e,g=g(),I.memoizedState=[g,e],g},useReducer:function(g,e,I){var t=ol();return e=void 0!==I?I(e):e,t.memoizedState=t.baseState=e,g=(g=t.queue={pending:null,dispatch:null,lastRenderedReducer:g,lastRenderedState:e}).dispatch=Rl.bind(null,$C,g),[t.memoizedState,g]},useRef:bl,useState:dl,useDebugValue:Wl,useDeferredValue:function(g){var e=dl(g),I=e[0],t=e[1];return pl((function(){var e=_C.transition;_C.transition=1;try{t(g)}finally{_C.transition=e}}),[g]),I},useTransition:function(){var g=dl(!1),e=g[0];return bl(g=kl.bind(null,g[1])),[g,e]},useMutableSource:function(g,e,I){var t=ol();return t.memoizedState={refs:{getSnapshot:e,setSnapshot:null},source:g,subscribe:I},ul(t,g,e,I)},useOpaqueIdentifier:function(){if(zC){var g=!1,e=function(g){return{$$typeof:w,toString:g,valueOf:g}}((function(){throw g||(g=!0,I("r:"+(Pt++).toString(36))),Error(l(355))})),I=dl(e)[1];return 0===(2&$C.mode)&&($C.flags|=516,Zl(5,(function(){I("r:"+(Pt++).toString(36))}),void 0,null)),e}return dl(e="r:"+(Pt++).toString(36)),e},unstable_isNewReconciler:!1},Yl={readContext:lC,useCallback:Sl,useContext:lC,useEffect:yl,useImperativeHandle:Vl,useLayoutEffect:Bl,useMemo:fl,useReducer:rl,useRef:ml,useState:function(){return rl(il)},useDebugValue:Wl,useDeferredValue:function(g){var e=rl(il),I=e[0],t=e[1];return yl((function(){var e=_C.transition;_C.transition=1;try{t(g)}finally{_C.transition=e}}),[g]),I},useTransition:function(){var g=rl(il)[0];return[ml().current,g]},useMutableSource:sl,useOpaqueIdentifier:function(){return rl(il)[0]},unstable_isNewReconciler:!1},Hl={readContext:lC,useCallback:Sl,useContext:lC,useEffect:yl,useImperativeHandle:Vl,useLayoutEffect:Bl,useMemo:fl,useReducer:cl,useRef:ml,useState:function(){return cl(il)},useDebugValue:Wl,useDeferredValue:function(g){var e=cl(il),I=e[0],t=e[1];return yl((function(){var e=_C.transition;_C.transition=1;try{t(g)}finally{_C.transition=e}}),[g]),I},useTransition:function(){var g=cl(il)[0];return[ml().current,g]},useMutableSource:sl,useOpaqueIdentifier:function(){return cl(il)[0]},unstable_isNewReconciler:!1},wl=p.ReactCurrentOwner,Nl=!1;function Kl(g,e,I,t){e.child=null===g?SC(e,null,I,t):WC(e,g.child,I,t)}function Fl(g,e,I,t,n){I=I.render;var C=e.ref;return CC(e,n),t=ll(g,e,I,t,C,n),null===g||Nl?(e.flags|=1,Kl(g,e,t,n),e.child):(e.updateQueue=g.updateQueue,e.flags&=-517,g.lanes&=~n,no(g,e,n))}function El(g,e,I,t,n,C){if(null===g){var l=I.type;return"function"!==typeof l||Ta(l)||void 0!==l.defaultProps||null!==I.compare||void 0!==I.defaultProps?((g=Da(I.type,null,t,e,e.mode,C)).ref=e.ref,g.return=e,e.child=g):(e.tag=15,e.type=l,xl(g,e,l,t,n,C))}return l=g.child,0===(n&C)&&(n=l.memoizedProps,(I=null!==(I=I.compare)?I:ct)(n,t)&&g.ref===e.ref)?no(g,e,C):(e.flags|=1,(g=Qa(l,t)).ref=e.ref,g.return=e,e.child=g)}function xl(g,e,I,t,n,C){if(null!==g&&ct(g.memoizedProps,t)&&g.ref===e.ref){if(Nl=!1,0===(C&n))return e.lanes=g.lanes,no(g,e,C);0!==(16384&g.flags)&&(Nl=!0)}return Ml(g,e,I,t,C)}function zl(g,e,I){var t=e.pendingProps,n=t.children,C=null!==g?g.memoizedState:null;if("hidden"===t.mode||"unstable-defer-without-hiding"===t.mode)if(0===(4&e.mode))e.memoizedState={baseLanes:0},ya(e,I);else{if(0===(1073741824&I))return g=null!==C?C.baseLanes|I:I,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:g},ya(e,g),null;e.memoizedState={baseLanes:0},ya(e,null!==C?C.baseLanes:I)}else null!==C?(t=C.baseLanes|I,e.memoizedState=null):t=I,ya(e,t);return Kl(g,e,n,I),e.child}function Ul(g,e){var I=e.ref;(null===g&&null!==I||null!==g&&g.ref!==I)&&(e.flags|=128)}function Ml(g,e,I,t,n){var C=bn(I)?dn:un.current;return C=Zn(e,C),CC(e,n),I=ll(g,e,I,t,C,n),null===g||Nl?(e.flags|=1,Kl(g,e,I,n),e.child):(e.updateQueue=g.updateQueue,e.flags&=-517,g.lanes&=~n,no(g,e,n))}function Ll(g,e,I,t,n){if(bn(I)){var C=!0;pn(e)}else C=!1;if(CC(e,n),null===e.stateNode)null!==g&&(g.alternate=null,e.alternate=null,e.flags|=2),hC(e,I,t),pC(e,I,t,n),t=!0;else if(null===g){var l=e.stateNode,o=e.memoizedProps;l.props=o;var a=l.context,i=I.contextType;"object"===typeof i&&null!==i?i=lC(i):i=Zn(e,i=bn(I)?dn:un.current);var r=I.getDerivedStateFromProps,c="function"===typeof r||"function"===typeof l.getSnapshotBeforeUpdate;c||"function"!==typeof l.UNSAFE_componentWillReceiveProps&&"function"!==typeof l.componentWillReceiveProps||(o!==t||a!==i)&&GC(e,l,t,i),oC=!1;var A=e.memoizedState;l.state=A,uC(e,t,l,n),a=e.memoizedState,o!==t||A!==a||sn.current||oC?("function"===typeof r&&(ZC(e,I,r,t),a=e.memoizedState),(o=oC||mC(e,I,o,t,A,a,i))?(c||"function"!==typeof l.UNSAFE_componentWillMount&&"function"!==typeof l.componentWillMount||("function"===typeof l.componentWillMount&&l.componentWillMount(),"function"===typeof l.UNSAFE_componentWillMount&&l.UNSAFE_componentWillMount()),"function"===typeof l.componentDidMount&&(e.flags|=4)):("function"===typeof l.componentDidMount&&(e.flags|=4),e.memoizedProps=t,e.memoizedState=a),l.props=t,l.state=a,l.context=i,t=o):("function"===typeof l.componentDidMount&&(e.flags|=4),t=!1)}else{l=e.stateNode,iC(g,e),o=e.memoizedProps,i=e.type===e.elementType?o:_n(e.type,o),l.props=i,c=e.pendingProps,A=l.context,"object"===typeof(a=I.contextType)&&null!==a?a=lC(a):a=Zn(e,a=bn(I)?dn:un.current);var u=I.getDerivedStateFromProps;(r="function"===typeof u||"function"===typeof l.getSnapshotBeforeUpdate)||"function"!==typeof l.UNSAFE_componentWillReceiveProps&&"function"!==typeof l.componentWillReceiveProps||(o!==c||A!==a)&&GC(e,l,t,a),oC=!1,A=e.memoizedState,l.state=A,uC(e,t,l,n);var s=e.memoizedState;o!==c||A!==s||sn.current||oC?("function"===typeof u&&(ZC(e,I,u,t),s=e.memoizedState),(i=oC||mC(e,I,i,t,A,s,a))?(r||"function"!==typeof l.UNSAFE_componentWillUpdate&&"function"!==typeof l.componentWillUpdate||("function"===typeof l.componentWillUpdate&&l.componentWillUpdate(t,s,a),"function"===typeof l.UNSAFE_componentWillUpdate&&l.UNSAFE_componentWillUpdate(t,s,a)),"function"===typeof l.componentDidUpdate&&(e.flags|=4),"function"===typeof l.getSnapshotBeforeUpdate&&(e.flags|=256)):("function"!==typeof l.componentDidUpdate||o===g.memoizedProps&&A===g.memoizedState||(e.flags|=4),"function"!==typeof l.getSnapshotBeforeUpdate||o===g.memoizedProps&&A===g.memoizedState||(e.flags|=256),e.memoizedProps=t,e.memoizedState=s),l.props=t,l.state=s,l.context=a,t=i):("function"!==typeof l.componentDidUpdate||o===g.memoizedProps&&A===g.memoizedState||(e.flags|=4),"function"!==typeof l.getSnapshotBeforeUpdate||o===g.memoizedProps&&A===g.memoizedState||(e.flags|=256),t=!1)}return Tl(g,e,I,t,C,n)}function Tl(g,e,I,t,n,C){Ul(g,e);var l=0!==(64&e.flags);if(!t&&!l)return n&&yn(e,I,!1),no(g,e,C);t=e.stateNode,wl.current=e;var o=l&&"function"!==typeof I.getDerivedStateFromError?null:t.render();return e.flags|=1,null!==g&&l?(e.child=WC(e,g.child,null,C),e.child=WC(e,null,o,C)):Kl(g,e,o,C),e.memoizedState=t.state,n&&yn(e,I,!0),e.child}function Ql(g){var e=g.stateNode;e.pendingContext?hn(0,e.pendingContext,e.pendingContext!==e.context):e.context&&hn(0,e.context,!1),YC(g,e.containerInfo)}var Dl,jl,Pl,Ol={dehydrated:null,retryLane:0};function _l(g,e,I){var t,n=e.pendingProps,C=KC.current,l=!1;return(t=0!==(64&e.flags))||(t=(null===g||null!==g.memoizedState)&&0!==(2&C)),t?(l=!0,e.flags&=-65):null!==g&&null===g.memoizedState||void 0===n.fallback||!0===n.unstable_avoidThisFallback||(C|=1),cn(KC,1&C),null===g?(void 0!==n.fallback&&LC(e),g=n.children,C=n.fallback,l?(g=ql(e,g,C,I),e.child.memoizedState={baseLanes:I},e.memoizedState=Ol,g):"number"===typeof n.unstable_expectedLoadTime?(g=ql(e,g,C,I),e.child.memoizedState={baseLanes:I},e.memoizedState=Ol,e.lanes=33554432,g):((I=Pa({mode:"visible",children:g},e.mode,I,null)).return=e,e.child=I)):(g.memoizedState,l?(n=go(g,e,n.children,n.fallback,I),l=e.child,C=g.child.memoizedState,l.memoizedState=null===C?{baseLanes:I}:{baseLanes:C.baseLanes|I},l.childLanes=g.childLanes&~I,e.memoizedState=Ol,n):(I=$l(g,e,n.children,I),e.memoizedState=null,I))}function ql(g,e,I,t){var n=g.mode,C=g.child;return e={mode:"hidden",children:e},0===(2&n)&&null!==C?(C.childLanes=0,C.pendingProps=e):C=Pa(e,n,0,null),I=ja(I,n,t,null),C.return=g,I.return=g,C.sibling=I,g.child=C,I}function $l(g,e,I,t){var n=g.child;return g=n.sibling,I=Qa(n,{mode:"visible",children:I}),0===(2&e.mode)&&(I.lanes=t),I.return=e,I.sibling=null,null!==g&&(g.nextEffect=null,g.flags=8,e.firstEffect=e.lastEffect=g),e.child=I}function go(g,e,I,t,n){var C=e.mode,l=g.child;g=l.sibling;var o={mode:"hidden",children:I};return 0===(2&C)&&e.child!==l?((I=e.child).childLanes=0,I.pendingProps=o,null!==(l=I.lastEffect)?(e.firstEffect=I.firstEffect,e.lastEffect=l,l.nextEffect=null):e.firstEffect=e.lastEffect=null):I=Qa(l,o),null!==g?t=Qa(g,t):(t=ja(t,C,n,null)).flags|=2,t.return=e,I.return=e,I.sibling=t,e.child=I,t}function eo(g,e){g.lanes|=e;var I=g.alternate;null!==I&&(I.lanes|=e),nC(g.return,e)}function Io(g,e,I,t,n,C){var l=g.memoizedState;null===l?g.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:t,tail:I,tailMode:n,lastEffect:C}:(l.isBackwards=e,l.rendering=null,l.renderingStartTime=0,l.last=t,l.tail=I,l.tailMode=n,l.lastEffect=C)}function to(g,e,I){var t=e.pendingProps,n=t.revealOrder,C=t.tail;if(Kl(g,e,t.children,I),0!==(2&(t=KC.current)))t=1&t|2,e.flags|=64;else{if(null!==g&&0!==(64&g.flags))g:for(g=e.child;null!==g;){if(13===g.tag)null!==g.memoizedState&&eo(g,I);else if(19===g.tag)eo(g,I);else if(null!==g.child){g.child.return=g,g=g.child;continue}if(g===e)break g;for(;null===g.sibling;){if(null===g.return||g.return===e)break g;g=g.return}g.sibling.return=g.return,g=g.sibling}t&=1}if(cn(KC,t),0===(2&e.mode))e.memoizedState=null;else switch(n){case"forwards":for(I=e.child,n=null;null!==I;)null!==(g=I.alternate)&&null===FC(g)&&(n=I),I=I.sibling;null===(I=n)?(n=e.child,e.child=null):(n=I.sibling,I.sibling=null),Io(e,!1,n,I,C,e.lastEffect);break;case"backwards":for(I=null,n=e.child,e.child=null;null!==n;){if(null!==(g=n.alternate)&&null===FC(g)){e.child=n;break}g=n.sibling,n.sibling=I,I=n,n=g}Io(e,!0,I,null,C,e.lastEffect);break;case"together":Io(e,!1,null,null,void 0,e.lastEffect);break;default:e.memoizedState=null}return e.child}function no(g,e,I){if(null!==g&&(e.dependencies=g.dependencies),zo|=e.lanes,0!==(I&e.childLanes)){if(null!==g&&e.child!==g.child)throw Error(l(153));if(null!==e.child){for(I=Qa(g=e.child,g.pendingProps),e.child=I,I.return=e;null!==g.sibling;)g=g.sibling,(I=I.sibling=Qa(g,g.pendingProps)).return=e;I.sibling=null}return e.child}return null}function Co(g,e){if(!zC)switch(g.tailMode){case"hidden":e=g.tail;for(var I=null;null!==e;)null!==e.alternate&&(I=e),e=e.sibling;null===I?g.tail=null:I.sibling=null;break;case"collapsed":I=g.tail;for(var t=null;null!==I;)null!==I.alternate&&(t=I),I=I.sibling;null===t?e||null===g.tail?g.tail=null:g.tail.sibling=null:t.sibling=null}}function lo(g,e,I){var t=e.pendingProps;switch(e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:case 17:return bn(e.type)&&mn(),null;case 3:return HC(),rn(sn),rn(un),PC(),(t=e.stateNode).pendingContext&&(t.context=t.pendingContext,t.pendingContext=null),null!==g&&null!==g.child||(QC(e)?e.flags|=4:t.hydrate||(e.flags|=256)),null;case 5:NC(e);var C=JC(XC.current);if(I=e.type,null!==g&&null!=e.stateNode)jl(g,e,I,t),g.ref!==e.ref&&(e.flags|=128);else{if(!t){if(null===e.stateNode)throw Error(l(166));return null}if(g=JC(kC.current),QC(e)){t=e.stateNode,I=e.type;var o=e.memoizedProps;switch(t[_t]=e,t[qt]=o,I){case"dialog":kt("cancel",t),kt("close",t);break;case"iframe":case"object":case"embed":kt("load",t);break;case"video":case"audio":for(g=0;g<Vt.length;g++)kt(Vt[g],t);break;case"source":kt("error",t);break;case"img":case"image":case"link":kt("error",t),kt("load",t);break;case"details":kt("toggle",t);break;case"input":gg(t,o),kt("invalid",t);break;case"select":t._wrapperState={wasMultiple:!!o.multiple},kt("invalid",t);break;case"textarea":ag(t,o),kt("invalid",t)}for(var i in vg(I,o),g=null,o)o.hasOwnProperty(i)&&(C=o[i],"children"===i?"string"===typeof C?t.textContent!==C&&(g=["children",C]):"number"===typeof C&&t.textContent!==""+C&&(g=["children",""+C]):a.hasOwnProperty(i)&&null!=C&&"onScroll"===i&&kt("scroll",t));switch(I){case"input":O(t),tg(t,o,!0);break;case"textarea":O(t),rg(t);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(t.onclick=Et)}t=g,e.updateQueue=t,null!==t&&(e.flags|=4)}else{switch(i=9===C.nodeType?C:C.ownerDocument,g===cg&&(g=ug(I)),g===cg?"script"===I?((g=i.createElement("div")).innerHTML="<script><\/script>",g=g.removeChild(g.firstChild)):"string"===typeof t.is?g=i.createElement(I,{is:t.is}):(g=i.createElement(I),"select"===I&&(i=g,t.multiple?i.multiple=!0:t.size&&(i.size=t.size))):g=i.createElementNS(g,I),g[_t]=e,g[qt]=t,Dl(g,e),e.stateNode=g,i=Vg(I,t),I){case"dialog":kt("cancel",g),kt("close",g),C=t;break;case"iframe":case"object":case"embed":kt("load",g),C=t;break;case"video":case"audio":for(C=0;C<Vt.length;C++)kt(Vt[C],g);C=t;break;case"source":kt("error",g),C=t;break;case"img":case"image":case"link":kt("error",g),kt("load",g),C=t;break;case"details":kt("toggle",g),C=t;break;case"input":gg(g,t),C=$(g,t),kt("invalid",g);break;case"option":C=Cg(g,t);break;case"select":g._wrapperState={wasMultiple:!!t.multiple},C=n({},t,{value:void 0}),kt("invalid",g);break;case"textarea":ag(g,t),C=og(g,t),kt("invalid",g);break;default:C=t}vg(I,C);var r=C;for(o in r)if(r.hasOwnProperty(o)){var c=r[o];"style"===o?yg(g,c):"dangerouslySetInnerHTML"===o?null!=(c=c?c.__html:void 0)&&bg(g,c):"children"===o?"string"===typeof c?("textarea"!==I||""!==c)&&mg(g,c):"number"===typeof c&&mg(g,""+c):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(a.hasOwnProperty(o)?null!=c&&"onScroll"===o&&kt("scroll",g):null!=c&&G(g,o,c,i))}switch(I){case"input":O(g),tg(g,t,!1);break;case"textarea":O(g),rg(g);break;case"option":null!=t.value&&g.setAttribute("value",""+j(t.value));break;case"select":g.multiple=!!t.multiple,null!=(o=t.value)?lg(g,!!t.multiple,o,!1):null!=t.defaultValue&&lg(g,!!t.multiple,t.defaultValue,!0);break;default:"function"===typeof C.onClick&&(g.onclick=Et)}Ut(I,t)&&(e.flags|=4)}null!==e.ref&&(e.flags|=128)}return null;case 6:if(g&&null!=e.stateNode)Pl(0,e,g.memoizedProps,t);else{if("string"!==typeof t&&null===e.stateNode)throw Error(l(166));I=JC(XC.current),JC(kC.current),QC(e)?(t=e.stateNode,I=e.memoizedProps,t[_t]=e,t.nodeValue!==I&&(e.flags|=4)):((t=(9===I.nodeType?I:I.ownerDocument).createTextNode(t))[_t]=e,e.stateNode=t)}return null;case 13:return rn(KC),t=e.memoizedState,0!==(64&e.flags)?(e.lanes=I,e):(t=null!==t,I=!1,null===g?void 0!==e.memoizedProps.fallback&&QC(e):I=null!==g.memoizedState,t&&!I&&0!==(2&e.mode)&&(null===g&&!0!==e.memoizedProps.unstable_avoidThisFallback||0!==(1&KC.current)?0===Fo&&(Fo=3):(0!==Fo&&3!==Fo||(Fo=4),null===Yo||0===(134217727&zo)&&0===(134217727&Uo)||ma(Yo,wo))),(t||I)&&(e.flags|=4),null);case 4:return HC(),null===g&&Xt(e.stateNode.containerInfo),null;case 10:return tC(e),null;case 19:if(rn(KC),null===(t=e.memoizedState))return null;if(o=0!==(64&e.flags),null===(i=t.rendering))if(o)Co(t,!1);else{if(0!==Fo||null!==g&&0!==(64&g.flags))for(g=e.child;null!==g;){if(null!==(i=FC(g))){for(e.flags|=64,Co(t,!1),null!==(o=i.updateQueue)&&(e.updateQueue=o,e.flags|=4),null===t.lastEffect&&(e.firstEffect=null),e.lastEffect=t.lastEffect,t=I,I=e.child;null!==I;)g=t,(o=I).flags&=2,o.nextEffect=null,o.firstEffect=null,o.lastEffect=null,null===(i=o.alternate)?(o.childLanes=0,o.lanes=g,o.child=null,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=i.childLanes,o.lanes=i.lanes,o.child=i.child,o.memoizedProps=i.memoizedProps,o.memoizedState=i.memoizedState,o.updateQueue=i.updateQueue,o.type=i.type,g=i.dependencies,o.dependencies=null===g?null:{lanes:g.lanes,firstContext:g.firstContext}),I=I.sibling;return cn(KC,1&KC.current|2),e.child}g=g.sibling}null!==t.tail&&Mn()>Qo&&(e.flags|=64,o=!0,Co(t,!1),e.lanes=33554432)}else{if(!o)if(null!==(g=FC(i))){if(e.flags|=64,o=!0,null!==(I=g.updateQueue)&&(e.updateQueue=I,e.flags|=4),Co(t,!0),null===t.tail&&"hidden"===t.tailMode&&!i.alternate&&!zC)return null!==(e=e.lastEffect=t.lastEffect)&&(e.nextEffect=null),null}else 2*Mn()-t.renderingStartTime>Qo&&1073741824!==I&&(e.flags|=64,o=!0,Co(t,!1),e.lanes=33554432);t.isBackwards?(i.sibling=e.child,e.child=i):(null!==(I=t.last)?I.sibling=i:e.child=i,t.last=i)}return null!==t.tail?(I=t.tail,t.rendering=I,t.tail=I.sibling,t.lastEffect=e.lastEffect,t.renderingStartTime=Mn(),I.sibling=null,e=KC.current,cn(KC,o?1&e|2:1&e),I):null;case 23:case 24:return Ba(),null!==g&&null!==g.memoizedState!==(null!==e.memoizedState)&&"unstable-defer-without-hiding"!==t.mode&&(e.flags|=4),null}throw Error(l(156,e.tag))}function oo(g){switch(g.tag){case 1:bn(g.type)&&mn();var e=g.flags;return 4096&e?(g.flags=-4097&e|64,g):null;case 3:if(HC(),rn(sn),rn(un),PC(),0!==(64&(e=g.flags)))throw Error(l(285));return g.flags=-4097&e|64,g;case 5:return NC(g),null;case 13:return rn(KC),4096&(e=g.flags)?(g.flags=-4097&e|64,g):null;case 19:return rn(KC),null;case 4:return HC(),null;case 10:return tC(g),null;case 23:case 24:return Ba(),null;default:return null}}function ao(g,e){try{var I="",t=e;do{I+=Q(t),t=t.return}while(t);var n=I}catch(C){n="\nError generating stack: "+C.message+"\n"+C.stack}return{value:g,source:e,stack:n}}function io(g,e){try{console.error(e.value)}catch(I){setTimeout((function(){throw I}))}}Dl=function(g,e){for(var I=e.child;null!==I;){if(5===I.tag||6===I.tag)g.appendChild(I.stateNode);else if(4!==I.tag&&null!==I.child){I.child.return=I,I=I.child;continue}if(I===e)break;for(;null===I.sibling;){if(null===I.return||I.return===e)return;I=I.return}I.sibling.return=I.return,I=I.sibling}},jl=function(g,e,I,t){var C=g.memoizedProps;if(C!==t){g=e.stateNode,JC(kC.current);var l,o=null;switch(I){case"input":C=$(g,C),t=$(g,t),o=[];break;case"option":C=Cg(g,C),t=Cg(g,t),o=[];break;case"select":C=n({},C,{value:void 0}),t=n({},t,{value:void 0}),o=[];break;case"textarea":C=og(g,C),t=og(g,t),o=[];break;default:"function"!==typeof C.onClick&&"function"===typeof t.onClick&&(g.onclick=Et)}for(c in vg(I,t),I=null,C)if(!t.hasOwnProperty(c)&&C.hasOwnProperty(c)&&null!=C[c])if("style"===c){var i=C[c];for(l in i)i.hasOwnProperty(l)&&(I||(I={}),I[l]="")}else"dangerouslySetInnerHTML"!==c&&"children"!==c&&"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&"autoFocus"!==c&&(a.hasOwnProperty(c)?o||(o=[]):(o=o||[]).push(c,null));for(c in t){var r=t[c];if(i=null!=C?C[c]:void 0,t.hasOwnProperty(c)&&r!==i&&(null!=r||null!=i))if("style"===c)if(i){for(l in i)!i.hasOwnProperty(l)||r&&r.hasOwnProperty(l)||(I||(I={}),I[l]="");for(l in r)r.hasOwnProperty(l)&&i[l]!==r[l]&&(I||(I={}),I[l]=r[l])}else I||(o||(o=[]),o.push(c,I)),I=r;else"dangerouslySetInnerHTML"===c?(r=r?r.__html:void 0,i=i?i.__html:void 0,null!=r&&i!==r&&(o=o||[]).push(c,r)):"children"===c?"string"!==typeof r&&"number"!==typeof r||(o=o||[]).push(c,""+r):"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&(a.hasOwnProperty(c)?(null!=r&&"onScroll"===c&&kt("scroll",g),o||i===r||(o=[])):"object"===typeof r&&null!==r&&r.$$typeof===w?r.toString():(o=o||[]).push(c,r))}I&&(o=o||[]).push("style",I);var c=o;(e.updateQueue=c)&&(e.flags|=4)}},Pl=function(g,e,I,t){I!==t&&(e.flags|=4)};var ro="function"===typeof WeakMap?WeakMap:Map;function co(g,e,I){(I=rC(-1,I)).tag=3,I.payload={element:null};var t=e.value;return I.callback=function(){Oo||(Oo=!0,_o=t),io(0,e)},I}function Ao(g,e,I){(I=rC(-1,I)).tag=3;var t=g.type.getDerivedStateFromError;if("function"===typeof t){var n=e.value;I.payload=function(){return io(0,e),t(n)}}var C=g.stateNode;return null!==C&&"function"===typeof C.componentDidCatch&&(I.callback=function(){"function"!==typeof t&&(null===qo?qo=new Set([this]):qo.add(this),io(0,e));var g=e.stack;this.componentDidCatch(e.value,{componentStack:null!==g?g:""})}),I}var uo="function"===typeof WeakSet?WeakSet:Set;function so(g){var e=g.ref;if(null!==e)if("function"===typeof e)try{e(null)}catch(I){xa(g,I)}else e.current=null}function Zo(g,e){switch(e.tag){case 0:case 11:case 15:case 22:case 5:case 6:case 4:case 17:return;case 1:if(256&e.flags&&null!==g){var I=g.memoizedProps,t=g.memoizedState;e=(g=e.stateNode).getSnapshotBeforeUpdate(e.elementType===e.type?I:_n(e.type,I),t),g.__reactInternalSnapshotBeforeUpdate=e}return;case 3:return void(256&e.flags&&Qt(e.stateNode.containerInfo))}throw Error(l(163))}function bo(g,e,I){switch(I.tag){case 0:case 11:case 15:case 22:if(null!==(e=null!==(e=I.updateQueue)?e.lastEffect:null)){g=e=e.next;do{if(3===(3&g.tag)){var t=g.create;g.destroy=t()}g=g.next}while(g!==e)}if(null!==(e=null!==(e=I.updateQueue)?e.lastEffect:null)){g=e=e.next;do{var n=g;t=n.next,0!==(4&(n=n.tag))&&0!==(1&n)&&(Ka(I,g),Na(I,g)),g=t}while(g!==e)}return;case 1:return g=I.stateNode,4&I.flags&&(null===e?g.componentDidMount():(t=I.elementType===I.type?e.memoizedProps:_n(I.type,e.memoizedProps),g.componentDidUpdate(t,e.memoizedState,g.__reactInternalSnapshotBeforeUpdate))),void(null!==(e=I.updateQueue)&&sC(I,e,g));case 3:if(null!==(e=I.updateQueue)){if(g=null,null!==I.child)switch(I.child.tag){case 5:case 1:g=I.child.stateNode}sC(I,e,g)}return;case 5:return g=I.stateNode,void(null===e&&4&I.flags&&Ut(I.type,I.memoizedProps)&&g.focus());case 6:case 4:case 12:case 19:case 17:case 20:case 21:case 23:case 24:return;case 13:return void(null===I.memoizedState&&(I=I.alternate,null!==I&&(I=I.memoizedState,null!==I&&(I=I.dehydrated,null!==I&&ye(I)))))}throw Error(l(163))}function mo(g,e){for(var I=g;;){if(5===I.tag){var t=I.stateNode;if(e)"function"===typeof(t=t.style).setProperty?t.setProperty("display","none","important"):t.display="none";else{t=I.stateNode;var n=I.memoizedProps.style;n=void 0!==n&&null!==n&&n.hasOwnProperty("display")?n.display:null,t.style.display=pg("display",n)}}else if(6===I.tag)I.stateNode.nodeValue=e?"":I.memoizedProps;else if((23!==I.tag&&24!==I.tag||null===I.memoizedState||I===g)&&null!==I.child){I.child.return=I,I=I.child;continue}if(I===g)break;for(;null===I.sibling;){if(null===I.return||I.return===g)return;I=I.return}I.sibling.return=I.return,I=I.sibling}}function ho(g,e){if(vn&&"function"===typeof vn.onCommitFiberUnmount)try{vn.onCommitFiberUnmount(Bn,e)}catch(C){}switch(e.tag){case 0:case 11:case 14:case 15:case 22:if(null!==(g=e.updateQueue)&&null!==(g=g.lastEffect)){var I=g=g.next;do{var t=I,n=t.destroy;if(t=t.tag,void 0!==n)if(0!==(4&t))Ka(e,I);else{t=e;try{n()}catch(C){xa(t,C)}}I=I.next}while(I!==g)}break;case 1:if(so(e),"function"===typeof(g=e.stateNode).componentWillUnmount)try{g.props=e.memoizedProps,g.state=e.memoizedState,g.componentWillUnmount()}catch(C){xa(e,C)}break;case 5:so(e);break;case 4:Vo(g,e)}}function Go(g){g.alternate=null,g.child=null,g.dependencies=null,g.firstEffect=null,g.lastEffect=null,g.memoizedProps=null,g.memoizedState=null,g.pendingProps=null,g.return=null,g.updateQueue=null}function po(g){return 5===g.tag||3===g.tag||4===g.tag}function yo(g){g:{for(var e=g.return;null!==e;){if(po(e))break g;e=e.return}throw Error(l(160))}var I=e;switch(e=I.stateNode,I.tag){case 5:var t=!1;break;case 3:case 4:e=e.containerInfo,t=!0;break;default:throw Error(l(161))}16&I.flags&&(mg(e,""),I.flags&=-17);g:e:for(I=g;;){for(;null===I.sibling;){if(null===I.return||po(I.return)){I=null;break g}I=I.return}for(I.sibling.return=I.return,I=I.sibling;5!==I.tag&&6!==I.tag&&18!==I.tag;){if(2&I.flags)continue e;if(null===I.child||4===I.tag)continue e;I.child.return=I,I=I.child}if(!(2&I.flags)){I=I.stateNode;break g}}t?Bo(g,I,e):vo(g,I,e)}function Bo(g,e,I){var t=g.tag,n=5===t||6===t;if(n)g=n?g.stateNode:g.stateNode.instance,e?8===I.nodeType?I.parentNode.insertBefore(g,e):I.insertBefore(g,e):(8===I.nodeType?(e=I.parentNode).insertBefore(g,I):(e=I).appendChild(g),null!==(I=I._reactRootContainer)&&void 0!==I||null!==e.onclick||(e.onclick=Et));else if(4!==t&&null!==(g=g.child))for(Bo(g,e,I),g=g.sibling;null!==g;)Bo(g,e,I),g=g.sibling}function vo(g,e,I){var t=g.tag,n=5===t||6===t;if(n)g=n?g.stateNode:g.stateNode.instance,e?I.insertBefore(g,e):I.appendChild(g);else if(4!==t&&null!==(g=g.child))for(vo(g,e,I),g=g.sibling;null!==g;)vo(g,e,I),g=g.sibling}function Vo(g,e){for(var I,t,n=e,C=!1;;){if(!C){C=n.return;g:for(;;){if(null===C)throw Error(l(160));switch(I=C.stateNode,C.tag){case 5:t=!1;break g;case 3:case 4:I=I.containerInfo,t=!0;break g}C=C.return}C=!0}if(5===n.tag||6===n.tag){g:for(var o=g,a=n,i=a;;)if(ho(o,i),null!==i.child&&4!==i.tag)i.child.return=i,i=i.child;else{if(i===a)break g;for(;null===i.sibling;){if(null===i.return||i.return===a)break g;i=i.return}i.sibling.return=i.return,i=i.sibling}t?(o=I,a=n.stateNode,8===o.nodeType?o.parentNode.removeChild(a):o.removeChild(a)):I.removeChild(n.stateNode)}else if(4===n.tag){if(null!==n.child){I=n.stateNode.containerInfo,t=!0,n.child.return=n,n=n.child;continue}}else if(ho(g,n),null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;4===(n=n.return).tag&&(C=!1)}n.sibling.return=n.return,n=n.sibling}}function Wo(g,e){switch(e.tag){case 0:case 11:case 14:case 15:case 22:var I=e.updateQueue;if(null!==(I=null!==I?I.lastEffect:null)){var t=I=I.next;do{3===(3&t.tag)&&(g=t.destroy,t.destroy=void 0,void 0!==g&&g()),t=t.next}while(t!==I)}return;case 1:case 12:case 17:return;case 5:if(null!=(I=e.stateNode)){t=e.memoizedProps;var n=null!==g?g.memoizedProps:t;g=e.type;var C=e.updateQueue;if(e.updateQueue=null,null!==C){for(I[qt]=t,"input"===g&&"radio"===t.type&&null!=t.name&&eg(I,t),Vg(g,n),e=Vg(g,t),n=0;n<C.length;n+=2){var o=C[n],a=C[n+1];"style"===o?yg(I,a):"dangerouslySetInnerHTML"===o?bg(I,a):"children"===o?mg(I,a):G(I,o,a,e)}switch(g){case"input":Ig(I,t);break;case"textarea":ig(I,t);break;case"select":g=I._wrapperState.wasMultiple,I._wrapperState.wasMultiple=!!t.multiple,null!=(C=t.value)?lg(I,!!t.multiple,C,!1):g!==!!t.multiple&&(null!=t.defaultValue?lg(I,!!t.multiple,t.defaultValue,!0):lg(I,!!t.multiple,t.multiple?[]:"",!1))}}}return;case 6:if(null===e.stateNode)throw Error(l(162));return void(e.stateNode.nodeValue=e.memoizedProps);case 3:return void((I=e.stateNode).hydrate&&(I.hydrate=!1,ye(I.containerInfo)));case 13:return null!==e.memoizedState&&(To=Mn(),mo(e.child,!0)),void So(e);case 19:return void So(e);case 23:case 24:return void mo(e,null!==e.memoizedState)}throw Error(l(163))}function So(g){var e=g.updateQueue;if(null!==e){g.updateQueue=null;var I=g.stateNode;null===I&&(I=g.stateNode=new uo),e.forEach((function(e){var t=Ua.bind(null,g,e);I.has(e)||(I.add(e),e.then(t,t))}))}}function fo(g,e){return null!==g&&(null===(g=g.memoizedState)||null!==g.dehydrated)&&(null!==(e=e.memoizedState)&&null===e.dehydrated)}var ko=Math.ceil,Ro=p.ReactCurrentDispatcher,Xo=p.ReactCurrentOwner,Jo=0,Yo=null,Ho=null,wo=0,No=0,Ko=an(0),Fo=0,Eo=null,xo=0,zo=0,Uo=0,Mo=0,Lo=null,To=0,Qo=1/0;function Do(){Qo=Mn()+500}var jo,Po=null,Oo=!1,_o=null,qo=null,$o=!1,ga=null,ea=90,Ia=[],ta=[],na=null,Ca=0,la=null,oa=-1,aa=0,ia=0,ra=null,ca=!1;function Aa(){return 0!==(48&Jo)?Mn():-1!==oa?oa:oa=Mn()}function ua(g){if(0===(2&(g=g.mode)))return 1;if(0===(4&g))return 99===Ln()?1:2;if(0===aa&&(aa=xo),0!==On.transition){0!==ia&&(ia=null!==Lo?Lo.pendingLanes:0),g=aa;var e=4186112&~ia;return 0===(e&=-e)&&(0===(e=(g=4186112&~g)&-g)&&(e=8192)),e}return g=Ln(),0!==(4&Jo)&&98===g?g=xe(12,aa):g=xe(g=function(g){switch(g){case 99:return 15;case 98:return 10;case 97:case 96:return 8;case 95:return 2;default:return 0}}(g),aa),g}function sa(g,e,I){if(50<Ca)throw Ca=0,la=null,Error(l(185));if(null===(g=da(g,e)))return null;Me(g,e,I),g===Yo&&(Uo|=e,4===Fo&&ma(g,wo));var t=Ln();1===e?0!==(8&Jo)&&0===(48&Jo)?ha(g):(Za(g,I),0===Jo&&(Do(),jn())):(0===(4&Jo)||98!==t&&99!==t||(null===na?na=new Set([g]):na.add(g)),Za(g,I)),Lo=g}function da(g,e){g.lanes|=e;var I=g.alternate;for(null!==I&&(I.lanes|=e),I=g,g=g.return;null!==g;)g.childLanes|=e,null!==(I=g.alternate)&&(I.childLanes|=e),I=g,g=g.return;return 3===I.tag?I.stateNode:null}function Za(g,e){for(var I=g.callbackNode,t=g.suspendedLanes,n=g.pingedLanes,C=g.expirationTimes,o=g.pendingLanes;0<o;){var a=31-Le(o),i=1<<a,r=C[a];if(-1===r){if(0===(i&t)||0!==(i&n)){r=e,Ke(i);var c=Ne;C[a]=10<=c?r+250:6<=c?r+5e3:-1}}else r<=e&&(g.expiredLanes|=i);o&=~i}if(t=Fe(g,g===Yo?wo:0),e=Ne,0===t)null!==I&&(I!==Kn&&Sn(I),g.callbackNode=null,g.callbackPriority=0);else{if(null!==I){if(g.callbackPriority===e)return;I!==Kn&&Sn(I)}15===e?(I=ha.bind(null,g),null===En?(En=[I],xn=Wn(Jn,Pn)):En.push(I),I=Kn):14===e?I=Dn(99,ha.bind(null,g)):(I=function(g){switch(g){case 15:case 14:return 99;case 13:case 12:case 11:case 10:return 98;case 9:case 8:case 7:case 6:case 4:case 5:return 97;case 3:case 2:case 1:return 95;case 0:return 90;default:throw Error(l(358,g))}}(e),I=Dn(I,ba.bind(null,g))),g.callbackPriority=e,g.callbackNode=I}}function ba(g){if(oa=-1,ia=aa=0,0!==(48&Jo))throw Error(l(327));var e=g.callbackNode;if(wa()&&g.callbackNode!==e)return null;var I=Fe(g,g===Yo?wo:0);if(0===I)return null;var t=I,n=Jo;Jo|=16;var C=Wa();for(Yo===g&&wo===t||(Do(),va(g,t));;)try{ka();break}catch(a){Va(g,a)}if(IC(),Ro.current=C,Jo=n,null!==Ho?t=0:(Yo=null,wo=0,t=Fo),0!==(xo&Uo))va(g,0);else if(0!==t){if(2===t&&(Jo|=64,g.hydrate&&(g.hydrate=!1,Qt(g.containerInfo)),0!==(I=Ee(g))&&(t=Sa(g,I))),1===t)throw e=Eo,va(g,0),ma(g,I),Za(g,Mn()),e;switch(g.finishedWork=g.current.alternate,g.finishedLanes=I,t){case 0:case 1:throw Error(l(345));case 2:case 5:Ja(g);break;case 3:if(ma(g,I),(62914560&I)===I&&10<(t=To+500-Mn())){if(0!==Fe(g,0))break;if(((n=g.suspendedLanes)&I)!==I){Aa(),g.pingedLanes|=g.suspendedLanes&n;break}g.timeoutHandle=Lt(Ja.bind(null,g),t);break}Ja(g);break;case 4:if(ma(g,I),(4186112&I)===I)break;for(t=g.eventTimes,n=-1;0<I;){var o=31-Le(I);C=1<<o,(o=t[o])>n&&(n=o),I&=~C}if(I=n,10<(I=(120>(I=Mn()-I)?120:480>I?480:1080>I?1080:1920>I?1920:3e3>I?3e3:4320>I?4320:1960*ko(I/1960))-I)){g.timeoutHandle=Lt(Ja.bind(null,g),I);break}Ja(g);break;default:throw Error(l(329))}}return Za(g,Mn()),g.callbackNode===e?ba.bind(null,g):null}function ma(g,e){for(e&=~Mo,e&=~Uo,g.suspendedLanes|=e,g.pingedLanes&=~e,g=g.expirationTimes;0<e;){var I=31-Le(e),t=1<<I;g[I]=-1,e&=~t}}function ha(g){if(0!==(48&Jo))throw Error(l(327));if(wa(),g===Yo&&0!==(g.expiredLanes&wo)){var e=wo,I=Sa(g,e);0!==(xo&Uo)&&(I=Sa(g,e=Fe(g,e)))}else I=Sa(g,e=Fe(g,0));if(0!==g.tag&&2===I&&(Jo|=64,g.hydrate&&(g.hydrate=!1,Qt(g.containerInfo)),0!==(e=Ee(g))&&(I=Sa(g,e))),1===I)throw I=Eo,va(g,0),ma(g,e),Za(g,Mn()),I;return g.finishedWork=g.current.alternate,g.finishedLanes=e,Ja(g),Za(g,Mn()),null}function Ga(g,e){var I=Jo;Jo|=1;try{return g(e)}finally{0===(Jo=I)&&(Do(),jn())}}function pa(g,e){var I=Jo;Jo&=-2,Jo|=8;try{return g(e)}finally{0===(Jo=I)&&(Do(),jn())}}function ya(g,e){cn(Ko,No),No|=e,xo|=e}function Ba(){No=Ko.current,rn(Ko)}function va(g,e){g.finishedWork=null,g.finishedLanes=0;var I=g.timeoutHandle;if(-1!==I&&(g.timeoutHandle=-1,Tt(I)),null!==Ho)for(I=Ho.return;null!==I;){var t=I;switch(t.tag){case 1:null!==(t=t.type.childContextTypes)&&void 0!==t&&mn();break;case 3:HC(),rn(sn),rn(un),PC();break;case 5:NC(t);break;case 4:HC();break;case 13:case 19:rn(KC);break;case 10:tC(t);break;case 23:case 24:Ba()}I=I.return}Yo=g,Ho=Qa(g.current,null),wo=No=xo=e,Fo=0,Eo=null,Mo=Uo=zo=0}function Va(g,e){for(;;){var I=Ho;try{if(IC(),OC.current=Xl,Il){for(var t=$C.memoizedState;null!==t;){var n=t.queue;null!==n&&(n.pending=null),t=t.next}Il=!1}if(qC=0,el=gl=$C=null,tl=!1,Xo.current=null,null===I||null===I.return){Fo=1,Eo=e,Ho=null;break}g:{var C=g,l=I.return,o=I,a=e;if(e=wo,o.flags|=2048,o.firstEffect=o.lastEffect=null,null!==a&&"object"===typeof a&&"function"===typeof a.then){var i=a;if(0===(2&o.mode)){var r=o.alternate;r?(o.updateQueue=r.updateQueue,o.memoizedState=r.memoizedState,o.lanes=r.lanes):(o.updateQueue=null,o.memoizedState=null)}var c=0!==(1&KC.current),A=l;do{var u;if(u=13===A.tag){var s=A.memoizedState;if(null!==s)u=null!==s.dehydrated;else{var d=A.memoizedProps;u=void 0!==d.fallback&&(!0!==d.unstable_avoidThisFallback||!c)}}if(u){var Z=A.updateQueue;if(null===Z){var b=new Set;b.add(i),A.updateQueue=b}else Z.add(i);if(0===(2&A.mode)){if(A.flags|=64,o.flags|=16384,o.flags&=-2981,1===o.tag)if(null===o.alternate)o.tag=17;else{var m=rC(-1,1);m.tag=2,cC(o,m)}o.lanes|=1;break g}a=void 0,o=e;var h=C.pingCache;if(null===h?(h=C.pingCache=new ro,a=new Set,h.set(i,a)):void 0===(a=h.get(i))&&(a=new Set,h.set(i,a)),!a.has(o)){a.add(o);var G=za.bind(null,C,i,o);i.then(G,G)}A.flags|=4096,A.lanes=e;break g}A=A.return}while(null!==A);a=Error((D(o.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display.")}5!==Fo&&(Fo=2),a=ao(a,o),A=l;do{switch(A.tag){case 3:C=a,A.flags|=4096,e&=-e,A.lanes|=e,AC(A,co(0,C,e));break g;case 1:C=a;var p=A.type,y=A.stateNode;if(0===(64&A.flags)&&("function"===typeof p.getDerivedStateFromError||null!==y&&"function"===typeof y.componentDidCatch&&(null===qo||!qo.has(y)))){A.flags|=4096,e&=-e,A.lanes|=e,AC(A,Ao(A,C,e));break g}}A=A.return}while(null!==A)}Xa(I)}catch(B){e=B,Ho===I&&null!==I&&(Ho=I=I.return);continue}break}}function Wa(){var g=Ro.current;return Ro.current=Xl,null===g?Xl:g}function Sa(g,e){var I=Jo;Jo|=16;var t=Wa();for(Yo===g&&wo===e||va(g,e);;)try{fa();break}catch(n){Va(g,n)}if(IC(),Jo=I,Ro.current=t,null!==Ho)throw Error(l(261));return Yo=null,wo=0,Fo}function fa(){for(;null!==Ho;)Ra(Ho)}function ka(){for(;null!==Ho&&!fn();)Ra(Ho)}function Ra(g){var e=jo(g.alternate,g,No);g.memoizedProps=g.pendingProps,null===e?Xa(g):Ho=e,Xo.current=null}function Xa(g){var e=g;do{var I=e.alternate;if(g=e.return,0===(2048&e.flags)){if(null!==(I=lo(I,e,No)))return void(Ho=I);if(24!==(I=e).tag&&23!==I.tag||null===I.memoizedState||0!==(1073741824&No)||0===(4&I.mode)){for(var t=0,n=I.child;null!==n;)t|=n.lanes|n.childLanes,n=n.sibling;I.childLanes=t}null!==g&&0===(2048&g.flags)&&(null===g.firstEffect&&(g.firstEffect=e.firstEffect),null!==e.lastEffect&&(null!==g.lastEffect&&(g.lastEffect.nextEffect=e.firstEffect),g.lastEffect=e.lastEffect),1<e.flags&&(null!==g.lastEffect?g.lastEffect.nextEffect=e:g.firstEffect=e,g.lastEffect=e))}else{if(null!==(I=oo(e)))return I.flags&=2047,void(Ho=I);null!==g&&(g.firstEffect=g.lastEffect=null,g.flags|=2048)}if(null!==(e=e.sibling))return void(Ho=e);Ho=e=g}while(null!==e);0===Fo&&(Fo=5)}function Ja(g){var e=Ln();return Qn(99,Ya.bind(null,g,e)),null}function Ya(g,e){do{wa()}while(null!==ga);if(0!==(48&Jo))throw Error(l(327));var I=g.finishedWork;if(null===I)return null;if(g.finishedWork=null,g.finishedLanes=0,I===g.current)throw Error(l(177));g.callbackNode=null;var t=I.lanes|I.childLanes,n=t,C=g.pendingLanes&~n;g.pendingLanes=n,g.suspendedLanes=0,g.pingedLanes=0,g.expiredLanes&=n,g.mutableReadLanes&=n,g.entangledLanes&=n,n=g.entanglements;for(var o=g.eventTimes,a=g.expirationTimes;0<C;){var i=31-Le(C),r=1<<i;n[i]=0,o[i]=-1,a[i]=-1,C&=~r}if(null!==na&&0===(24&t)&&na.has(g)&&na.delete(g),g===Yo&&(Ho=Yo=null,wo=0),1<I.flags?null!==I.lastEffect?(I.lastEffect.nextEffect=I,t=I.firstEffect):t=I:t=I.firstEffect,null!==t){if(n=Jo,Jo|=32,Xo.current=null,xt=Pe,Zt(o=dt())){if("selectionStart"in o)a={start:o.selectionStart,end:o.selectionEnd};else g:if(a=(a=o.ownerDocument)&&a.defaultView||window,(r=a.getSelection&&a.getSelection())&&0!==r.rangeCount){a=r.anchorNode,C=r.anchorOffset,i=r.focusNode,r=r.focusOffset;try{a.nodeType,i.nodeType}catch(W){a=null;break g}var c=0,A=-1,u=-1,s=0,d=0,Z=o,b=null;e:for(;;){for(var m;Z!==a||0!==C&&3!==Z.nodeType||(A=c+C),Z!==i||0!==r&&3!==Z.nodeType||(u=c+r),3===Z.nodeType&&(c+=Z.nodeValue.length),null!==(m=Z.firstChild);)b=Z,Z=m;for(;;){if(Z===o)break e;if(b===a&&++s===C&&(A=c),b===i&&++d===r&&(u=c),null!==(m=Z.nextSibling))break;b=(Z=b).parentNode}Z=m}a=-1===A||-1===u?null:{start:A,end:u}}else a=null;a=a||{start:0,end:0}}else a=null;zt={focusedElem:o,selectionRange:a},Pe=!1,ra=null,ca=!1,Po=t;do{try{Ha()}catch(W){if(null===Po)throw Error(l(330));xa(Po,W),Po=Po.nextEffect}}while(null!==Po);ra=null,Po=t;do{try{for(o=g;null!==Po;){var h=Po.flags;if(16&h&&mg(Po.stateNode,""),128&h){var G=Po.alternate;if(null!==G){var p=G.ref;null!==p&&("function"===typeof p?p(null):p.current=null)}}switch(1038&h){case 2:yo(Po),Po.flags&=-3;break;case 6:yo(Po),Po.flags&=-3,Wo(Po.alternate,Po);break;case 1024:Po.flags&=-1025;break;case 1028:Po.flags&=-1025,Wo(Po.alternate,Po);break;case 4:Wo(Po.alternate,Po);break;case 8:Vo(o,a=Po);var y=a.alternate;Go(a),null!==y&&Go(y)}Po=Po.nextEffect}}catch(W){if(null===Po)throw Error(l(330));xa(Po,W),Po=Po.nextEffect}}while(null!==Po);if(p=zt,G=dt(),h=p.focusedElem,o=p.selectionRange,G!==h&&h&&h.ownerDocument&&st(h.ownerDocument.documentElement,h)){null!==o&&Zt(h)&&(G=o.start,void 0===(p=o.end)&&(p=G),"selectionStart"in h?(h.selectionStart=G,h.selectionEnd=Math.min(p,h.value.length)):(p=(G=h.ownerDocument||document)&&G.defaultView||window).getSelection&&(p=p.getSelection(),a=h.textContent.length,y=Math.min(o.start,a),o=void 0===o.end?y:Math.min(o.end,a),!p.extend&&y>o&&(a=o,o=y,y=a),a=ut(h,y),C=ut(h,o),a&&C&&(1!==p.rangeCount||p.anchorNode!==a.node||p.anchorOffset!==a.offset||p.focusNode!==C.node||p.focusOffset!==C.offset)&&((G=G.createRange()).setStart(a.node,a.offset),p.removeAllRanges(),y>o?(p.addRange(G),p.extend(C.node,C.offset)):(G.setEnd(C.node,C.offset),p.addRange(G))))),G=[];for(p=h;p=p.parentNode;)1===p.nodeType&&G.push({element:p,left:p.scrollLeft,top:p.scrollTop});for("function"===typeof h.focus&&h.focus(),h=0;h<G.length;h++)(p=G[h]).element.scrollLeft=p.left,p.element.scrollTop=p.top}Pe=!!xt,zt=xt=null,g.current=I,Po=t;do{try{for(h=g;null!==Po;){var B=Po.flags;if(36&B&&bo(h,Po.alternate,Po),128&B){G=void 0;var v=Po.ref;if(null!==v){var V=Po.stateNode;Po.tag,G=V,"function"===typeof v?v(G):v.current=G}}Po=Po.nextEffect}}catch(W){if(null===Po)throw Error(l(330));xa(Po,W),Po=Po.nextEffect}}while(null!==Po);Po=null,Fn(),Jo=n}else g.current=I;if($o)$o=!1,ga=g,ea=e;else for(Po=t;null!==Po;)e=Po.nextEffect,Po.nextEffect=null,8&Po.flags&&((B=Po).sibling=null,B.stateNode=null),Po=e;if(0===(t=g.pendingLanes)&&(qo=null),1===t?g===la?Ca++:(Ca=0,la=g):Ca=0,I=I.stateNode,vn&&"function"===typeof vn.onCommitFiberRoot)try{vn.onCommitFiberRoot(Bn,I,void 0,64===(64&I.current.flags))}catch(W){}if(Za(g,Mn()),Oo)throw Oo=!1,g=_o,_o=null,g;return 0!==(8&Jo)||jn(),null}function Ha(){for(;null!==Po;){var g=Po.alternate;ca||null===ra||(0!==(8&Po.flags)?ge(Po,ra)&&(ca=!0):13===Po.tag&&fo(g,Po)&&ge(Po,ra)&&(ca=!0));var e=Po.flags;0!==(256&e)&&Zo(g,Po),0===(512&e)||$o||($o=!0,Dn(97,(function(){return wa(),null}))),Po=Po.nextEffect}}function wa(){if(90!==ea){var g=97<ea?97:ea;return ea=90,Qn(g,Fa)}return!1}function Na(g,e){Ia.push(e,g),$o||($o=!0,Dn(97,(function(){return wa(),null})))}function Ka(g,e){ta.push(e,g),$o||($o=!0,Dn(97,(function(){return wa(),null})))}function Fa(){if(null===ga)return!1;var g=ga;if(ga=null,0!==(48&Jo))throw Error(l(331));var e=Jo;Jo|=32;var I=ta;ta=[];for(var t=0;t<I.length;t+=2){var n=I[t],C=I[t+1],o=n.destroy;if(n.destroy=void 0,"function"===typeof o)try{o()}catch(i){if(null===C)throw Error(l(330));xa(C,i)}}for(I=Ia,Ia=[],t=0;t<I.length;t+=2){n=I[t],C=I[t+1];try{var a=n.create;n.destroy=a()}catch(i){if(null===C)throw Error(l(330));xa(C,i)}}for(a=g.current.firstEffect;null!==a;)g=a.nextEffect,a.nextEffect=null,8&a.flags&&(a.sibling=null,a.stateNode=null),a=g;return Jo=e,jn(),!0}function Ea(g,e,I){cC(g,e=co(0,e=ao(I,e),1)),e=Aa(),null!==(g=da(g,1))&&(Me(g,1,e),Za(g,e))}function xa(g,e){if(3===g.tag)Ea(g,g,e);else for(var I=g.return;null!==I;){if(3===I.tag){Ea(I,g,e);break}if(1===I.tag){var t=I.stateNode;if("function"===typeof I.type.getDerivedStateFromError||"function"===typeof t.componentDidCatch&&(null===qo||!qo.has(t))){var n=Ao(I,g=ao(e,g),1);if(cC(I,n),n=Aa(),null!==(I=da(I,1)))Me(I,1,n),Za(I,n);else if("function"===typeof t.componentDidCatch&&(null===qo||!qo.has(t)))try{t.componentDidCatch(e,g)}catch(C){}break}}I=I.return}}function za(g,e,I){var t=g.pingCache;null!==t&&t.delete(e),e=Aa(),g.pingedLanes|=g.suspendedLanes&I,Yo===g&&(wo&I)===I&&(4===Fo||3===Fo&&(62914560&wo)===wo&&500>Mn()-To?va(g,0):Mo|=I),Za(g,e)}function Ua(g,e){var I=g.stateNode;null!==I&&I.delete(e),0===(e=0)&&(0===(2&(e=g.mode))?e=1:0===(4&e)?e=99===Ln()?1:2:(0===aa&&(aa=xo),0===(e=ze(62914560&~aa))&&(e=4194304))),I=Aa(),null!==(g=da(g,e))&&(Me(g,e,I),Za(g,I))}function Ma(g,e,I,t){this.tag=g,this.key=I,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=t,this.flags=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childLanes=this.lanes=0,this.alternate=null}function La(g,e,I,t){return new Ma(g,e,I,t)}function Ta(g){return!(!(g=g.prototype)||!g.isReactComponent)}function Qa(g,e){var I=g.alternate;return null===I?((I=La(g.tag,e,g.key,g.mode)).elementType=g.elementType,I.type=g.type,I.stateNode=g.stateNode,I.alternate=g,g.alternate=I):(I.pendingProps=e,I.type=g.type,I.flags=0,I.nextEffect=null,I.firstEffect=null,I.lastEffect=null),I.childLanes=g.childLanes,I.lanes=g.lanes,I.child=g.child,I.memoizedProps=g.memoizedProps,I.memoizedState=g.memoizedState,I.updateQueue=g.updateQueue,e=g.dependencies,I.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext},I.sibling=g.sibling,I.index=g.index,I.ref=g.ref,I}function Da(g,e,I,t,n,C){var o=2;if(t=g,"function"===typeof g)Ta(g)&&(o=1);else if("string"===typeof g)o=5;else g:switch(g){case v:return ja(I.children,n,C,e);case N:o=8,n|=16;break;case V:o=8,n|=1;break;case W:return(g=La(12,I,e,8|n)).elementType=W,g.type=W,g.lanes=C,g;case R:return(g=La(13,I,e,n)).type=R,g.elementType=R,g.lanes=C,g;case X:return(g=La(19,I,e,n)).elementType=X,g.lanes=C,g;case K:return Pa(I,n,C,e);case F:return(g=La(24,I,e,n)).elementType=F,g.lanes=C,g;default:if("object"===typeof g&&null!==g)switch(g.$$typeof){case S:o=10;break g;case f:o=9;break g;case k:o=11;break g;case J:o=14;break g;case Y:o=16,t=null;break g;case H:o=22;break g}throw Error(l(130,null==g?g:typeof g,""))}return(e=La(o,I,e,n)).elementType=g,e.type=t,e.lanes=C,e}function ja(g,e,I,t){return(g=La(7,g,t,e)).lanes=I,g}function Pa(g,e,I,t){return(g=La(23,g,t,e)).elementType=K,g.lanes=I,g}function Oa(g,e,I){return(g=La(6,g,null,e)).lanes=I,g}function _a(g,e,I){return(e=La(4,null!==g.children?g.children:[],g.key,e)).lanes=I,e.stateNode={containerInfo:g.containerInfo,pendingChildren:null,implementation:g.implementation},e}function qa(g,e,I){this.tag=e,this.containerInfo=g,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=I,this.callbackNode=null,this.callbackPriority=0,this.eventTimes=Ue(0),this.expirationTimes=Ue(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ue(0),this.mutableSourceEagerHydrationData=null}function $a(g,e,I){var t=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:B,key:null==t?null:""+t,children:g,containerInfo:e,implementation:I}}function gi(g,e,I,t){var n=e.current,C=Aa(),o=ua(n);g:if(I){e:{if(Og(I=I._reactInternals)!==I||1!==I.tag)throw Error(l(170));var a=I;do{switch(a.tag){case 3:a=a.stateNode.context;break e;case 1:if(bn(a.type)){a=a.stateNode.__reactInternalMemoizedMergedChildContext;break e}}a=a.return}while(null!==a);throw Error(l(171))}if(1===I.tag){var i=I.type;if(bn(i)){I=Gn(I,i,a);break g}}I=a}else I=An;return null===e.context?e.context=I:e.pendingContext=I,(e=rC(C,o)).payload={element:g},null!==(t=void 0===t?null:t)&&(e.callback=t),cC(n,e),sa(n,o,C),o}function ei(g){return(g=g.current).child?(g.child.tag,g.child.stateNode):null}function Ii(g,e){if(null!==(g=g.memoizedState)&&null!==g.dehydrated){var I=g.retryLane;g.retryLane=0!==I&&I<e?I:e}}function ti(g,e){Ii(g,e),(g=g.alternate)&&Ii(g,e)}function ni(g,e,I){var t=null!=I&&null!=I.hydrationOptions&&I.hydrationOptions.mutableSources||null;if(I=new qa(g,e,null!=I&&!0===I.hydrate),e=La(3,null,null,2===e?7:1===e?3:0),I.current=e,e.stateNode=I,aC(e),g[$t]=I.current,Xt(8===g.nodeType?g.parentNode:g),t)for(g=0;g<t.length;g++){var n=(e=t[g])._getVersion;n=n(e._source),null==I.mutableSourceEagerHydrationData?I.mutableSourceEagerHydrationData=[e,n]:I.mutableSourceEagerHydrationData.push(e,n)}this._internalRoot=I}function Ci(g){return!(!g||1!==g.nodeType&&9!==g.nodeType&&11!==g.nodeType&&(8!==g.nodeType||" react-mount-point-unstable "!==g.nodeValue))}function li(g,e,I,t,n){var C=I._reactRootContainer;if(C){var l=C._internalRoot;if("function"===typeof n){var o=n;n=function(){var g=ei(l);o.call(g)}}gi(e,l,g,n)}else{if(C=I._reactRootContainer=function(g,e){if(e||(e=!(!(e=g?9===g.nodeType?g.documentElement:g.firstChild:null)||1!==e.nodeType||!e.hasAttribute("data-reactroot"))),!e)for(var I;I=g.lastChild;)g.removeChild(I);return new ni(g,0,e?{hydrate:!0}:void 0)}(I,t),l=C._internalRoot,"function"===typeof n){var a=n;n=function(){var g=ei(l);a.call(g)}}pa((function(){gi(e,l,g,n)}))}return ei(l)}function oi(g,e){var I=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Ci(e))throw Error(l(200));return $a(g,e,null,I)}jo=function(g,e,I){var t=e.lanes;if(null!==g)if(g.memoizedProps!==e.pendingProps||sn.current)Nl=!0;else{if(0===(I&t)){switch(Nl=!1,e.tag){case 3:Ql(e),DC();break;case 5:wC(e);break;case 1:bn(e.type)&&pn(e);break;case 4:YC(e,e.stateNode.containerInfo);break;case 10:t=e.memoizedProps.value;var n=e.type._context;cn(qn,n._currentValue),n._currentValue=t;break;case 13:if(null!==e.memoizedState)return 0!==(I&e.child.childLanes)?_l(g,e,I):(cn(KC,1&KC.current),null!==(e=no(g,e,I))?e.sibling:null);cn(KC,1&KC.current);break;case 19:if(t=0!==(I&e.childLanes),0!==(64&g.flags)){if(t)return to(g,e,I);e.flags|=64}if(null!==(n=e.memoizedState)&&(n.rendering=null,n.tail=null,n.lastEffect=null),cn(KC,KC.current),t)break;return null;case 23:case 24:return e.lanes=0,zl(g,e,I)}return no(g,e,I)}Nl=0!==(16384&g.flags)}else Nl=!1;switch(e.lanes=0,e.tag){case 2:if(t=e.type,null!==g&&(g.alternate=null,e.alternate=null,e.flags|=2),g=e.pendingProps,n=Zn(e,un.current),CC(e,I),n=ll(null,e,t,g,n,I),e.flags|=1,"object"===typeof n&&null!==n&&"function"===typeof n.render&&void 0===n.$$typeof){if(e.tag=1,e.memoizedState=null,e.updateQueue=null,bn(t)){var C=!0;pn(e)}else C=!1;e.memoizedState=null!==n.state&&void 0!==n.state?n.state:null,aC(e);var o=t.getDerivedStateFromProps;"function"===typeof o&&ZC(e,t,o,g),n.updater=bC,e.stateNode=n,n._reactInternals=e,pC(e,t,g,I),e=Tl(null,e,t,!0,C,I)}else e.tag=0,Kl(null,e,n,I),e=e.child;return e;case 16:n=e.elementType;g:{switch(null!==g&&(g.alternate=null,e.alternate=null,e.flags|=2),g=e.pendingProps,n=(C=n._init)(n._payload),e.type=n,C=e.tag=function(g){if("function"===typeof g)return Ta(g)?1:0;if(void 0!==g&&null!==g){if((g=g.$$typeof)===k)return 11;if(g===J)return 14}return 2}(n),g=_n(n,g),C){case 0:e=Ml(null,e,n,g,I);break g;case 1:e=Ll(null,e,n,g,I);break g;case 11:e=Fl(null,e,n,g,I);break g;case 14:e=El(null,e,n,_n(n.type,g),t,I);break g}throw Error(l(306,n,""))}return e;case 0:return t=e.type,n=e.pendingProps,Ml(g,e,t,n=e.elementType===t?n:_n(t,n),I);case 1:return t=e.type,n=e.pendingProps,Ll(g,e,t,n=e.elementType===t?n:_n(t,n),I);case 3:if(Ql(e),t=e.updateQueue,null===g||null===t)throw Error(l(282));if(t=e.pendingProps,n=null!==(n=e.memoizedState)?n.element:null,iC(g,e),uC(e,t,null,I),(t=e.memoizedState.element)===n)DC(),e=no(g,e,I);else{if((C=(n=e.stateNode).hydrate)&&(xC=Dt(e.stateNode.containerInfo.firstChild),EC=e,C=zC=!0),C){if(null!=(g=n.mutableSourceEagerHydrationData))for(n=0;n<g.length;n+=2)(C=g[n])._workInProgressVersionPrimary=g[n+1],jC.push(C);for(I=SC(e,null,t,I),e.child=I;I;)I.flags=-3&I.flags|1024,I=I.sibling}else Kl(g,e,t,I),DC();e=e.child}return e;case 5:return wC(e),null===g&&LC(e),t=e.type,n=e.pendingProps,C=null!==g?g.memoizedProps:null,o=n.children,Mt(t,n)?o=null:null!==C&&Mt(t,C)&&(e.flags|=16),Ul(g,e),Kl(g,e,o,I),e.child;case 6:return null===g&&LC(e),null;case 13:return _l(g,e,I);case 4:return YC(e,e.stateNode.containerInfo),t=e.pendingProps,null===g?e.child=WC(e,null,t,I):Kl(g,e,t,I),e.child;case 11:return t=e.type,n=e.pendingProps,Fl(g,e,t,n=e.elementType===t?n:_n(t,n),I);case 7:return Kl(g,e,e.pendingProps,I),e.child;case 8:case 12:return Kl(g,e,e.pendingProps.children,I),e.child;case 10:g:{t=e.type._context,n=e.pendingProps,o=e.memoizedProps,C=n.value;var a=e.type._context;if(cn(qn,a._currentValue),a._currentValue=C,null!==o)if(a=o.value,0===(C=it(a,C)?0:0|("function"===typeof t._calculateChangedBits?t._calculateChangedBits(a,C):1073741823))){if(o.children===n.children&&!sn.current){e=no(g,e,I);break g}}else for(null!==(a=e.child)&&(a.return=e);null!==a;){var i=a.dependencies;if(null!==i){o=a.child;for(var r=i.firstContext;null!==r;){if(r.context===t&&0!==(r.observedBits&C)){1===a.tag&&((r=rC(-1,I&-I)).tag=2,cC(a,r)),a.lanes|=I,null!==(r=a.alternate)&&(r.lanes|=I),nC(a.return,I),i.lanes|=I;break}r=r.next}}else o=10===a.tag&&a.type===e.type?null:a.child;if(null!==o)o.return=a;else for(o=a;null!==o;){if(o===e){o=null;break}if(null!==(a=o.sibling)){a.return=o.return,o=a;break}o=o.return}a=o}Kl(g,e,n.children,I),e=e.child}return e;case 9:return n=e.type,t=(C=e.pendingProps).children,CC(e,I),t=t(n=lC(n,C.unstable_observedBits)),e.flags|=1,Kl(g,e,t,I),e.child;case 14:return C=_n(n=e.type,e.pendingProps),El(g,e,n,C=_n(n.type,C),t,I);case 15:return xl(g,e,e.type,e.pendingProps,t,I);case 17:return t=e.type,n=e.pendingProps,n=e.elementType===t?n:_n(t,n),null!==g&&(g.alternate=null,e.alternate=null,e.flags|=2),e.tag=1,bn(t)?(g=!0,pn(e)):g=!1,CC(e,I),hC(e,t,n),pC(e,t,n,I),Tl(null,e,t,!0,g,I);case 19:return to(g,e,I);case 23:case 24:return zl(g,e,I)}throw Error(l(156,e.tag))},ni.prototype.render=function(g){gi(g,this._internalRoot,null,null)},ni.prototype.unmount=function(){var g=this._internalRoot,e=g.containerInfo;gi(null,g,null,(function(){e[$t]=null}))},ee=function(g){13===g.tag&&(sa(g,4,Aa()),ti(g,4))},Ie=function(g){13===g.tag&&(sa(g,67108864,Aa()),ti(g,67108864))},te=function(g){if(13===g.tag){var e=Aa(),I=ua(g);sa(g,I,e),ti(g,I)}},ne=function(g,e){return e()},Sg=function(g,e,I){switch(e){case"input":if(Ig(g,I),e=I.name,"radio"===I.type&&null!=e){for(I=g;I.parentNode;)I=I.parentNode;for(I=I.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<I.length;e++){var t=I[e];if(t!==g&&t.form===g.form){var n=nn(t);if(!n)throw Error(l(90));_(t),Ig(t,n)}}}break;case"textarea":ig(g,I);break;case"select":null!=(e=I.value)&&lg(g,!!I.multiple,e,!1)}},Yg=Ga,Hg=function(g,e,I,t,n){var C=Jo;Jo|=4;try{return Qn(98,g.bind(null,e,I,t,n))}finally{0===(Jo=C)&&(Do(),jn())}},wg=function(){0===(49&Jo)&&(function(){if(null!==na){var g=na;na=null,g.forEach((function(g){g.expiredLanes|=24&g.pendingLanes,Za(g,Mn())}))}jn()}(),wa())},Ng=function(g,e){var I=Jo;Jo|=2;try{return g(e)}finally{0===(Jo=I)&&(Do(),jn())}};var ai={Events:[In,tn,nn,Xg,Jg,wa,{current:!1}]},ii={findFiberByHostInstance:en,bundleType:0,version:"17.0.2",rendererPackageName:"react-dom"},ri={bundleType:ii.bundleType,version:ii.version,rendererPackageName:ii.rendererPackageName,rendererConfig:ii.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:p.ReactCurrentDispatcher,findHostInstanceByFiber:function(g){return null===(g=$g(g))?null:g.stateNode},findFiberByHostInstance:ii.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ci=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ci.isDisabled&&ci.supportsFiber)try{Bn=ci.inject(ri),vn=ci}catch(Zg){}}e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ai,e.createPortal=oi,e.findDOMNode=function(g){if(null==g)return null;if(1===g.nodeType)return g;var e=g._reactInternals;if(void 0===e){if("function"===typeof g.render)throw Error(l(188));throw Error(l(268,Object.keys(g)))}return g=null===(g=$g(e))?null:g.stateNode},e.flushSync=function(g,e){var I=Jo;if(0!==(48&I))return g(e);Jo|=1;try{if(g)return Qn(99,g.bind(null,e))}finally{Jo=I,jn()}},e.hydrate=function(g,e,I){if(!Ci(e))throw Error(l(200));return li(null,g,e,!0,I)},e.render=function(g,e,I){if(!Ci(e))throw Error(l(200));return li(null,g,e,!1,I)},e.unmountComponentAtNode=function(g){if(!Ci(g))throw Error(l(40));return!!g._reactRootContainer&&(pa((function(){li(null,null,g,!1,(function(){g._reactRootContainer=null,g[$t]=null}))})),!0)},e.unstable_batchedUpdates=Ga,e.unstable_createPortal=function(g,e){return oi(g,e,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)},e.unstable_renderSubtreeIntoContainer=function(g,e,I,t){if(!Ci(I))throw Error(l(200));if(null==g||void 0===g._reactInternals)throw Error(l(38));return li(g,e,I,!1,t)},e.version="17.0.2"},4164:function(g,e,I){"use strict";!function g(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(g)}catch(e){console.error(e)}}(),g.exports=I(4463)},1372:function(g,e){"use strict";var I=60103,t=60106,n=60107,C=60108,l=60114,o=60109,a=60110,i=60112,r=60113,c=60120,A=60115,u=60116,s=60121,d=60122,Z=60117,b=60129,m=60131;if("function"===typeof Symbol&&Symbol.for){var h=Symbol.for;I=h("react.element"),t=h("react.portal"),n=h("react.fragment"),C=h("react.strict_mode"),l=h("react.profiler"),o=h("react.provider"),a=h("react.context"),i=h("react.forward_ref"),r=h("react.suspense"),c=h("react.suspense_list"),A=h("react.memo"),u=h("react.lazy"),s=h("react.block"),d=h("react.server.block"),Z=h("react.fundamental"),b=h("react.debug_trace_mode"),m=h("react.legacy_hidden")}function G(g){if("object"===typeof g&&null!==g){var e=g.$$typeof;switch(e){case I:switch(g=g.type){case n:case l:case C:case r:case c:return g;default:switch(g=g&&g.$$typeof){case a:case i:case u:case A:case o:return g;default:return e}}case t:return e}}}},7441:function(g,e,I){"use strict";I(1372)},9008:function(g,e,I){g.exports=function(g,e){"use strict";function I(g){return g&&"object"===typeof g&&"default"in g?g:{default:g}}var t=I(g),n=I(e);function C(){return C=Object.assign||function(g){for(var e=1;e<arguments.length;e++){var I=arguments[e];for(var t in I)Object.prototype.hasOwnProperty.call(I,t)&&(g[t]=I[t])}return g},C.apply(this,arguments)}function l(g,e,I){return e in g?Object.defineProperty(g,e,{value:I,enumerable:!0,configurable:!0,writable:!0}):g[e]=I,g}function o(g){if(Array.isArray(g))return g}function a(g,e){var I=null==g?null:"undefined"!==typeof Symbol&&g[Symbol.iterator]||g["@@iterator"];if(null!=I){var t,n,C=[],l=!0,o=!1;try{for(I=I.call(g);!(l=(t=I.next()).done)&&(C.push(t.value),!e||C.length!==e);l=!0);}catch(a){o=!0,n=a}finally{try{l||null==I.return||I.return()}finally{if(o)throw n}}return C}}function i(g,e){(null==e||e>g.length)&&(e=g.length);for(var I=0,t=new Array(e);I<e;I++)t[I]=g[I];return t}function r(g,e){if(g){if("string"===typeof g)return i(g,e);var I=Object.prototype.toString.call(g).slice(8,-1);return"Object"===I&&g.constructor&&(I=g.constructor.name),"Map"===I||"Set"===I?Array.from(g):"Arguments"===I||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(I)?i(g,e):void 0}}function c(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function A(g,e){return o(g)||a(g,e)||r(g,e)||c()}function u(g,e){if(null==g)return{};var I,t,n={},C=Object.keys(g);for(t=0;t<C.length;t++)I=C[t],e.indexOf(I)>=0||(n[I]=g[I]);return n}function s(g,e){if(null==g)return{};var I,t,n=u(g,e);if(Object.getOwnPropertySymbols){var C=Object.getOwnPropertySymbols(g);for(t=0;t<C.length;t++)I=C[t],e.indexOf(I)>=0||Object.prototype.propertyIsEnumerable.call(g,I)&&(n[I]=g[I])}return n}function d(g,e){var I=atob(g);if(e){for(var t=new Uint8Array(I.length),n=0,C=I.length;n<C;++n)t[n]=I.charCodeAt(n);return String.fromCharCode.apply(null,new Uint16Array(t.buffer))}return I}function Z(g,e,I){var t=void 0===e?null:e,n=d(g,void 0!==I&&I),C=n.indexOf("\n",10)+1,l=n.substring(C)+(t?"//# sourceMappingURL="+t:""),o=new Blob([l],{type:"application/javascript"});return URL.createObjectURL(o)}function b(g,e,I){var t;return function(n){return t=t||Z(g,e,I),new Worker(t,n)}}var m=b("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewoJJ3VzZSBzdHJpY3QnOwoKCXZhciBjb21tb25qc0dsb2JhbCA9IHR5cGVvZiBnbG9iYWxUaGlzICE9PSAndW5kZWZpbmVkJyA/IGdsb2JhbFRoaXMgOiB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyA/IHdpbmRvdyA6IHR5cGVvZiBnbG9iYWwgIT09ICd1bmRlZmluZWQnID8gZ2xvYmFsIDogdHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnID8gc2VsZiA6IHt9OwoKCWZ1bmN0aW9uIGdldEF1Z21lbnRlZE5hbWVzcGFjZShuKSB7CgkJaWYgKG4uX19lc01vZHVsZSkgcmV0dXJuIG47CgkJdmFyIGEgPSBPYmplY3QuZGVmaW5lUHJvcGVydHkoe30sICdfX2VzTW9kdWxlJywge3ZhbHVlOiB0cnVlfSk7CgkJT2JqZWN0LmtleXMobikuZm9yRWFjaChmdW5jdGlvbiAoaykgewoJCQl2YXIgZCA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iobiwgayk7CgkJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShhLCBrLCBkLmdldCA/IGQgOiB7CgkJCQllbnVtZXJhYmxlOiB0cnVlLAoJCQkJZ2V0OiBmdW5jdGlvbiAoKSB7CgkJCQkJcmV0dXJuIG5ba107CgkJCQl9CgkJCX0pOwoJCX0pOwoJCXJldHVybiBhOwoJfQoKCXZhciBCaW5hcnlCaXRtYXAkMSA9IHt9OwoKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMSA9IHt9OwoKCXZhciBFeGNlcHRpb24kMSA9IHt9OwoKCWZ1bmN0aW9uIGZpeFByb3RvKHRhcmdldCwgcHJvdG90eXBlKSB7CgkgIHZhciBzZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZjsKCSAgc2V0UHJvdG90eXBlT2YgPyBzZXRQcm90b3R5cGVPZih0YXJnZXQsIHByb3RvdHlwZSkgOiB0YXJnZXQuX19wcm90b19fID0gcHJvdG90eXBlOwoJfQoJZnVuY3Rpb24gZml4U3RhY2sodGFyZ2V0LCBmbikgewoJICBpZiAoZm4gPT09IHZvaWQgMCkgewoJICAgIGZuID0gdGFyZ2V0LmNvbnN0cnVjdG9yOwoJICB9CgoJICB2YXIgY2FwdHVyZVN0YWNrVHJhY2UgPSBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZTsKCSAgY2FwdHVyZVN0YWNrVHJhY2UgJiYgY2FwdHVyZVN0YWNrVHJhY2UodGFyZ2V0LCBmbik7Cgl9CgoJdmFyIF9fZXh0ZW5kcyRrID0gZnVuY3Rpb24gKCkgewoJICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCB7CgkgICAgICBfX3Byb3RvX186IFtdCgkgICAgfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICBkLl9fcHJvdG9fXyA9IGI7CgkgICAgfSB8fCBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgZm9yICh2YXIgcCBpbiBiKSB7IGlmIChiLmhhc093blByb3BlcnR5KHApKSB7IGRbcF0gPSBiW3BdOyB9IH0KCSAgICB9OwoKCSAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgfTsKCgkgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgoJICAgIGZ1bmN0aW9uIF9fKCkgewoJICAgICAgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7CgkgICAgfQoKCSAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgIH07Cgl9KCk7CgoJdmFyIEN1c3RvbUVycm9yID0gZnVuY3Rpb24gKF9zdXBlcikgewoJICBfX2V4dGVuZHMkayhDdXN0b21FcnJvciwgX3N1cGVyKTsKCgkgIGZ1bmN0aW9uIEN1c3RvbUVycm9yKG1lc3NhZ2UpIHsKCSAgICB2YXIgX25ld1RhcmdldCA9IHRoaXMuY29uc3RydWN0b3I7CgoJICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIG1lc3NhZ2UpIHx8IHRoaXM7CgoJICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShfdGhpcywgJ25hbWUnLCB7CgkgICAgICB2YWx1ZTogX25ld1RhcmdldC5uYW1lLAoJICAgICAgZW51bWVyYWJsZTogZmFsc2UsCgkgICAgICBjb25maWd1cmFibGU6IHRydWUKCSAgICB9KTsKCSAgICBmaXhQcm90byhfdGhpcywgX25ld1RhcmdldC5wcm90b3R5cGUpOwoJICAgIGZpeFN0YWNrKF90aGlzKTsKCSAgICByZXR1cm4gX3RoaXM7CgkgIH0KCgkgIHJldHVybiBDdXN0b21FcnJvcjsKCX0oRXJyb3IpOwoKCXZhciBfX3NwcmVhZEFycmF5cyA9IGZ1bmN0aW9uICgpIHsKCSAgdmFyIGFyZ3VtZW50cyQxID0gYXJndW1lbnRzOwoKCSAgZm9yICh2YXIgcyA9IDAsIGkgPSAwLCBpbCA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBpbDsgaSsrKSB7IHMgKz0gYXJndW1lbnRzJDFbaV0ubGVuZ3RoOyB9CgoJICBmb3IgKHZhciByID0gQXJyYXkocyksIGsgPSAwLCBpID0gMDsgaSA8IGlsOyBpKyspIHsgZm9yICh2YXIgYSA9IGFyZ3VtZW50c1tpXSwgaiA9IDAsIGpsID0gYS5sZW5ndGg7IGogPCBqbDsgaisrLCBrKyspIHsgcltrXSA9IGFbal07IH0gfQoKCSAgcmV0dXJuIHI7Cgl9OwoJZnVuY3Rpb24gY3VzdG9tRXJyb3JGYWN0b3J5KGZuLCBwYXJlbnQpIHsKCSAgaWYgKHBhcmVudCA9PT0gdm9pZCAwKSB7CgkgICAgcGFyZW50ID0gRXJyb3I7CgkgIH0KCgkgIGZ1bmN0aW9uIEN1c3RvbUVycm9yKCkgewoJICAgIHZhciBhcmd1bWVudHMkMSA9IGFyZ3VtZW50czsKCgkgICAgdmFyIGFyZ3MgPSBbXTsKCgkgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHsKCSAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzJDFbX2ldOwoJICAgIH0KCgkgICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIEN1c3RvbUVycm9yKSkgeyByZXR1cm4gbmV3IChDdXN0b21FcnJvci5iaW5kLmFwcGx5KEN1c3RvbUVycm9yLCBfX3NwcmVhZEFycmF5cyhbdm9pZCAwXSwgYXJncykpKSgpOyB9CgkgICAgcGFyZW50LmFwcGx5KHRoaXMsIGFyZ3MpOwoJICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAnbmFtZScsIHsKCSAgICAgIHZhbHVlOiBmbi5uYW1lIHx8IHBhcmVudC5uYW1lLAoJICAgICAgZW51bWVyYWJsZTogZmFsc2UsCgkgICAgICBjb25maWd1cmFibGU6IHRydWUKCSAgICB9KTsKCSAgICBmbi5hcHBseSh0aGlzLCBhcmdzKTsKCSAgICBmaXhTdGFjayh0aGlzLCBDdXN0b21FcnJvcik7CgkgIH0KCgkgIHJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhDdXN0b21FcnJvciwgewoJICAgIHByb3RvdHlwZTogewoJICAgICAgdmFsdWU6IE9iamVjdC5jcmVhdGUocGFyZW50LnByb3RvdHlwZSwgewoJICAgICAgICBjb25zdHJ1Y3RvcjogewoJICAgICAgICAgIHZhbHVlOiBDdXN0b21FcnJvciwKCSAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKCSAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUKCSAgICAgICAgfQoJICAgICAgfSkKCSAgICB9CgkgIH0pOwoJfQoKCXZhciBjdXN0b21FcnJvciA9IC8qI19fUFVSRV9fKi9PYmplY3QuZnJlZXplKHsKCQlfX3Byb3RvX186IG51bGwsCgkJQ3VzdG9tRXJyb3I6IEN1c3RvbUVycm9yLAoJCWN1c3RvbUVycm9yRmFjdG9yeTogY3VzdG9tRXJyb3JGYWN0b3J5Cgl9KTsKCgl2YXIgcmVxdWlyZSQkMCA9IC8qQF9fUFVSRV9fKi9nZXRBdWdtZW50ZWROYW1lc3BhY2UoY3VzdG9tRXJyb3IpOwoKCXZhciBfX2V4dGVuZHMkaiA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShFeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIHRzX2N1c3RvbV9lcnJvcl8xID0gcmVxdWlyZSQkMDsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgRXhjZXB0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyRqKEV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICAvKioKCSAgICAgKiBBbGxvd3MgRXhjZXB0aW9uIHRvIGJlIGNvbnN0cnVjdGVkIGRpcmVjdGx5CgkgICAgICogd2l0aCBzb21lIG1lc3NhZ2UgYW5kIHByb3RvdHlwZSBkZWZpbml0aW9uLgoJICAgICAqLwoJICAgIGZ1bmN0aW9uIEV4Y2VwdGlvbihtZXNzYWdlKSB7CgkgICAgICAgIGlmIChtZXNzYWdlID09PSB2b2lkIDApIHsgbWVzc2FnZSA9IHVuZGVmaW5lZDsgfQoJICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBtZXNzYWdlKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5tZXNzYWdlID0gbWVzc2FnZTsKCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICBFeGNlcHRpb24ucHJvdG90eXBlLmdldEtpbmQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHZhciBleCA9IHRoaXMuY29uc3RydWN0b3I7CgkgICAgICAgIHJldHVybiBleC5raW5kOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogSXQncyB0eXBlZCBhcyBzdHJpbmcgc28gaXQgY2FuIGJlIGV4dGVuZGVkIGFuZCBvdmVycmlkZW4uCgkgICAgICovCgkgICAgRXhjZXB0aW9uLmtpbmQgPSAnRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gRXhjZXB0aW9uOwoJfSh0c19jdXN0b21fZXJyb3JfMS5DdXN0b21FcnJvcikpOwoJRXhjZXB0aW9uJDEuZGVmYXVsdCA9IEV4Y2VwdGlvbjsKCgl2YXIgX19leHRlbmRzJGkgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBFeGNlcHRpb25fMSQ5ID0gRXhjZXB0aW9uJDE7CgkvKioKCSAqIEN1c3RvbSBFcnJvciBjbGFzcyBvZiB0eXBlIEV4Y2VwdGlvbi4KCSAqLwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkaShJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24sIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKCkgewoJICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7CgkgICAgfQoJICAgIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbi5raW5kID0gJ0lsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbic7CgkgICAgcmV0dXJuIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbjsKCX0oRXhjZXB0aW9uXzEkOS5kZWZhdWx0KSk7CglJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMS5kZWZhdWx0ID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwOSBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoQmluYXJ5Qml0bWFwJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSRhID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDE7Cgl2YXIgQmluYXJ5Qml0bWFwID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEJpbmFyeUJpdG1hcChiaW5hcml6ZXIpIHsKCSAgICAgICAgdGhpcy5iaW5hcml6ZXIgPSBiaW5hcml6ZXI7CgkgICAgICAgIGlmIChiaW5hcml6ZXIgPT09IG51bGwpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSRhLmRlZmF1bHQoJ0JpbmFyaXplciBtdXN0IGJlIG5vbi1udWxsLicpOwoJICAgICAgICB9CgkgICAgfQoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gVGhlIHdpZHRoIG9mIHRoZSBiaXRtYXAuCgkgICAgICovCgkgICAgQmluYXJ5Qml0bWFwLnByb3RvdHlwZS5nZXRXaWR0aCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYmluYXJpemVyLmdldFdpZHRoKCk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSBoZWlnaHQgb2YgdGhlIGJpdG1hcC4KCSAgICAgKi8KCSAgICBCaW5hcnlCaXRtYXAucHJvdG90eXBlLmdldEhlaWdodCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYmluYXJpemVyLmdldEhlaWdodCgpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQ29udmVydHMgb25lIHJvdyBvZiBsdW1pbmFuY2UgZGF0YSB0byAxIGJpdCBkYXRhLiBNYXkgYWN0dWFsbHkgZG8gdGhlIGNvbnZlcnNpb24sIG9yIHJldHVybgoJICAgICAqIGNhY2hlZCBkYXRhLiBDYWxsZXJzIHNob3VsZCBhc3N1bWUgdGhpcyBtZXRob2QgaXMgZXhwZW5zaXZlIGFuZCBjYWxsIGl0IGFzIHNlbGRvbSBhcyBwb3NzaWJsZS4KCSAgICAgKiBUaGlzIG1ldGhvZCBpcyBpbnRlbmRlZCBmb3IgZGVjb2RpbmcgMUQgYmFyY29kZXMgYW5kIG1heSBjaG9vc2UgdG8gYXBwbHkgc2hhcnBlbmluZy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB5IFRoZSByb3cgdG8gZmV0Y2gsIHdoaWNoIG11c3QgYmUgaW4gWzAsIGJpdG1hcCBoZWlnaHQpCgkgICAgICogQHBhcmFtIHJvdyBBbiBvcHRpb25hbCBwcmVhbGxvY2F0ZWQgYXJyYXkuIElmIG51bGwgb3IgdG9vIHNtYWxsLCBpdCB3aWxsIGJlIGlnbm9yZWQuCgkgICAgICogICAgICAgICAgICBJZiB1c2VkLCB0aGUgQmluYXJpemVyIHdpbGwgY2FsbCBCaXRBcnJheS5jbGVhcigpLiBBbHdheXMgdXNlIHRoZSByZXR1cm5lZCBvYmplY3QuCgkgICAgICogQHJldHVybiBUaGUgYXJyYXkgb2YgYml0cyBmb3IgdGhpcyByb3cgKHRydWUgbWVhbnMgYmxhY2spLgoJICAgICAqIEB0aHJvd3MgTm90Rm91bmRFeGNlcHRpb24gaWYgcm93IGNhbid0IGJlIGJpbmFyaXplZAoJICAgICAqLwoJICAgIEJpbmFyeUJpdG1hcC5wcm90b3R5cGUuZ2V0QmxhY2tSb3cgPSBmdW5jdGlvbiAoeSAvKmludCovLCByb3cpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYmluYXJpemVyLmdldEJsYWNrUm93KHksIHJvdyk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBDb252ZXJ0cyBhIDJEIGFycmF5IG9mIGx1bWluYW5jZSBkYXRhIHRvIDEgYml0LiBBcyBhYm92ZSwgYXNzdW1lIHRoaXMgbWV0aG9kIGlzIGV4cGVuc2l2ZQoJICAgICAqIGFuZCBkbyBub3QgY2FsbCBpdCByZXBlYXRlZGx5LiBUaGlzIG1ldGhvZCBpcyBpbnRlbmRlZCBmb3IgZGVjb2RpbmcgMkQgYmFyY29kZXMgYW5kIG1heSBvcgoJICAgICAqIG1heSBub3QgYXBwbHkgc2hhcnBlbmluZy4gVGhlcmVmb3JlLCBhIHJvdyBmcm9tIHRoaXMgbWF0cml4IG1heSBub3QgYmUgaWRlbnRpY2FsIHRvIG9uZQoJICAgICAqIGZldGNoZWQgdXNpbmcgZ2V0QmxhY2tSb3coKSwgc28gZG9uJ3QgbWl4IGFuZCBtYXRjaCBiZXR3ZWVuIHRoZW0uCgkgICAgICoKCSAgICAgKiBAcmV0dXJuIFRoZSAyRCBhcnJheSBvZiBiaXRzIGZvciB0aGUgaW1hZ2UgKHRydWUgbWVhbnMgYmxhY2spLgoJICAgICAqIEB0aHJvd3MgTm90Rm91bmRFeGNlcHRpb24gaWYgaW1hZ2UgY2FuJ3QgYmUgYmluYXJpemVkIHRvIG1ha2UgYSBtYXRyaXgKCSAgICAgKi8KCSAgICBCaW5hcnlCaXRtYXAucHJvdG90eXBlLmdldEJsYWNrTWF0cml4ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICAvLyBUaGUgbWF0cml4IGlzIGNyZWF0ZWQgb24gZGVtYW5kIHRoZSBmaXJzdCB0aW1lIGl0IGlzIHJlcXVlc3RlZCwgdGhlbiBjYWNoZWQuIFRoZXJlIGFyZSB0d28KCSAgICAgICAgLy8gcmVhc29ucyBmb3IgdGhpczoKCSAgICAgICAgLy8gMS4gVGhpcyB3b3JrIHdpbGwgbmV2ZXIgYmUgZG9uZSBpZiB0aGUgY2FsbGVyIG9ubHkgaW5zdGFsbHMgMUQgUmVhZGVyIG9iamVjdHMsIG9yIGlmIGEKCSAgICAgICAgLy8gICAgMUQgUmVhZGVyIGZpbmRzIGEgYmFyY29kZSBiZWZvcmUgdGhlIDJEIFJlYWRlcnMgcnVuLgoJICAgICAgICAvLyAyLiBUaGlzIHdvcmsgd2lsbCBvbmx5IGJlIGRvbmUgb25jZSBldmVuIGlmIHRoZSBjYWxsZXIgaW5zdGFsbHMgbXVsdGlwbGUgMkQgUmVhZGVycy4KCSAgICAgICAgaWYgKHRoaXMubWF0cml4ID09PSBudWxsIHx8IHRoaXMubWF0cml4ID09PSB1bmRlZmluZWQpIHsKCSAgICAgICAgICAgIHRoaXMubWF0cml4ID0gdGhpcy5iaW5hcml6ZXIuZ2V0QmxhY2tNYXRyaXgoKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdGhpcy5tYXRyaXg7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFdoZXRoZXIgdGhpcyBiaXRtYXAgY2FuIGJlIGNyb3BwZWQuCgkgICAgICovCgkgICAgQmluYXJ5Qml0bWFwLnByb3RvdHlwZS5pc0Nyb3BTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmJpbmFyaXplci5nZXRMdW1pbmFuY2VTb3VyY2UoKS5pc0Nyb3BTdXBwb3J0ZWQoKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgYSBuZXcgb2JqZWN0IHdpdGggY3JvcHBlZCBpbWFnZSBkYXRhLiBJbXBsZW1lbnRhdGlvbnMgbWF5IGtlZXAgYSByZWZlcmVuY2UgdG8gdGhlCgkgICAgICogb3JpZ2luYWwgZGF0YSByYXRoZXIgdGhhbiBhIGNvcHkuIE9ubHkgY2FsbGFibGUgaWYgaXNDcm9wU3VwcG9ydGVkKCkgaXMgdHJ1ZS4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBsZWZ0IFRoZSBsZWZ0IGNvb3JkaW5hdGUsIHdoaWNoIG11c3QgYmUgaW4gWzAsZ2V0V2lkdGgoKSkKCSAgICAgKiBAcGFyYW0gdG9wIFRoZSB0b3AgY29vcmRpbmF0ZSwgd2hpY2ggbXVzdCBiZSBpbiBbMCxnZXRIZWlnaHQoKSkKCSAgICAgKiBAcGFyYW0gd2lkdGggVGhlIHdpZHRoIG9mIHRoZSByZWN0YW5nbGUgdG8gY3JvcC4KCSAgICAgKiBAcGFyYW0gaGVpZ2h0IFRoZSBoZWlnaHQgb2YgdGhlIHJlY3RhbmdsZSB0byBjcm9wLgoJICAgICAqIEByZXR1cm4gQSBjcm9wcGVkIHZlcnNpb24gb2YgdGhpcyBvYmplY3QuCgkgICAgICovCgkgICAgQmluYXJ5Qml0bWFwLnByb3RvdHlwZS5jcm9wID0gZnVuY3Rpb24gKGxlZnQgLyppbnQqLywgdG9wIC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovKSB7CgkgICAgICAgIHZhciBuZXdTb3VyY2UgPSB0aGlzLmJpbmFyaXplci5nZXRMdW1pbmFuY2VTb3VyY2UoKS5jcm9wKGxlZnQsIHRvcCwgd2lkdGgsIGhlaWdodCk7CgkgICAgICAgIHJldHVybiBuZXcgQmluYXJ5Qml0bWFwKHRoaXMuYmluYXJpemVyLmNyZWF0ZUJpbmFyaXplcihuZXdTb3VyY2UpKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gV2hldGhlciB0aGlzIGJpdG1hcCBzdXBwb3J0cyBjb3VudGVyLWNsb2Nrd2lzZSByb3RhdGlvbi4KCSAgICAgKi8KCSAgICBCaW5hcnlCaXRtYXAucHJvdG90eXBlLmlzUm90YXRlU3VwcG9ydGVkID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5iaW5hcml6ZXIuZ2V0THVtaW5hbmNlU291cmNlKCkuaXNSb3RhdGVTdXBwb3J0ZWQoKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgYSBuZXcgb2JqZWN0IHdpdGggcm90YXRlZCBpbWFnZSBkYXRhIGJ5IDkwIGRlZ3JlZXMgY291bnRlcmNsb2Nrd2lzZS4KCSAgICAgKiBPbmx5IGNhbGxhYmxlIGlmIHtAbGluayAjaXNSb3RhdGVTdXBwb3J0ZWQoKX0gaXMgdHJ1ZS4KCSAgICAgKgoJICAgICAqIEByZXR1cm4gQSByb3RhdGVkIHZlcnNpb24gb2YgdGhpcyBvYmplY3QuCgkgICAgICovCgkgICAgQmluYXJ5Qml0bWFwLnByb3RvdHlwZS5yb3RhdGVDb3VudGVyQ2xvY2t3aXNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgbmV3U291cmNlID0gdGhpcy5iaW5hcml6ZXIuZ2V0THVtaW5hbmNlU291cmNlKCkucm90YXRlQ291bnRlckNsb2Nrd2lzZSgpOwoJICAgICAgICByZXR1cm4gbmV3IEJpbmFyeUJpdG1hcCh0aGlzLmJpbmFyaXplci5jcmVhdGVCaW5hcml6ZXIobmV3U291cmNlKSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBSZXR1cm5zIGEgbmV3IG9iamVjdCB3aXRoIHJvdGF0ZWQgaW1hZ2UgZGF0YSBieSA0NSBkZWdyZWVzIGNvdW50ZXJjbG9ja3dpc2UuCgkgICAgICogT25seSBjYWxsYWJsZSBpZiB7QGxpbmsgI2lzUm90YXRlU3VwcG9ydGVkKCl9IGlzIHRydWUuCgkgICAgICoKCSAgICAgKiBAcmV0dXJuIEEgcm90YXRlZCB2ZXJzaW9uIG9mIHRoaXMgb2JqZWN0LgoJICAgICAqLwoJICAgIEJpbmFyeUJpdG1hcC5wcm90b3R5cGUucm90YXRlQ291bnRlckNsb2Nrd2lzZTQ1ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgbmV3U291cmNlID0gdGhpcy5iaW5hcml6ZXIuZ2V0THVtaW5hbmNlU291cmNlKCkucm90YXRlQ291bnRlckNsb2Nrd2lzZTQ1KCk7CgkgICAgICAgIHJldHVybiBuZXcgQmluYXJ5Qml0bWFwKHRoaXMuYmluYXJpemVyLmNyZWF0ZUJpbmFyaXplcihuZXdTb3VyY2UpKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBCaW5hcnlCaXRtYXAucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0QmxhY2tNYXRyaXgoKS50b1N0cmluZygpOwoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlIC8qOiBOb3RGb3VuZEV4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICByZXR1cm4gJyc7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIHJldHVybiBCaW5hcnlCaXRtYXA7Cgl9KCkpOwoJdmFyIF9kZWZhdWx0JDMgPSBCaW5hcnlCaXRtYXAkMS5kZWZhdWx0ID0gQmluYXJ5Qml0bWFwOwoKCXZhciBIeWJyaWRCaW5hcml6ZXIkMSA9IHt9OwoKCXZhciBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIkMSA9IHt9OwoKCXZhciBCaW5hcml6ZXIkMSA9IHt9OwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwOSBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoQmluYXJpemVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qKgoJICogVGhpcyBjbGFzcyBoaWVyYXJjaHkgcHJvdmlkZXMgYSBzZXQgb2YgbWV0aG9kcyB0byBjb252ZXJ0IGx1bWluYW5jZSBkYXRhIHRvIDEgYml0IGRhdGEuCgkgKiBJdCBhbGxvd3MgdGhlIGFsZ29yaXRobSB0byB2YXJ5IHBvbHltb3JwaGljYWxseSwgZm9yIGV4YW1wbGUgYWxsb3dpbmcgYSB2ZXJ5IGV4cGVuc2l2ZQoJICogdGhyZXNob2xkaW5nIHRlY2huaXF1ZSBmb3Igc2VydmVycyBhbmQgYSBmYXN0IG9uZSBmb3IgbW9iaWxlLiBJdCBhbHNvIHBlcm1pdHMgdGhlIGltcGxlbWVudGF0aW9uCgkgKiB0byB2YXJ5LCBlLmcuIGEgSk5JIHZlcnNpb24gZm9yIEFuZHJvaWQgYW5kIGEgSmF2YSBmYWxsYmFjayB2ZXJzaW9uIGZvciBvdGhlciBwbGF0Zm9ybXMuCgkgKgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqLwoJdmFyIEJpbmFyaXplciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBCaW5hcml6ZXIoc291cmNlKSB7CgkgICAgICAgIHRoaXMuc291cmNlID0gc291cmNlOwoJICAgIH0KCSAgICBCaW5hcml6ZXIucHJvdG90eXBlLmdldEx1bWluYW5jZVNvdXJjZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc291cmNlOwoJICAgIH07CgkgICAgQmluYXJpemVyLnByb3RvdHlwZS5nZXRXaWR0aCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc291cmNlLmdldFdpZHRoKCk7CgkgICAgfTsKCSAgICBCaW5hcml6ZXIucHJvdG90eXBlLmdldEhlaWdodCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc291cmNlLmdldEhlaWdodCgpOwoJICAgIH07CgkgICAgcmV0dXJuIEJpbmFyaXplcjsKCX0oKSk7CglCaW5hcml6ZXIkMS5kZWZhdWx0ID0gQmluYXJpemVyOwoKCXZhciBCaXRBcnJheSQxID0ge307CgoJdmFyIEFycmF5cyQxID0ge307CgoJdmFyIFN5c3RlbSQxID0ge307CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFN5c3RlbSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgU3lzdGVtID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIFN5c3RlbSgpIHsKCSAgICB9CgkgICAgLy8gcHVibGljIHN0YXRpYyB2b2lkIGFycmF5Y29weShPYmplY3Qgc3JjLCBpbnQgc3JjUG9zLCBPYmplY3QgZGVzdCwgaW50IGRlc3RQb3MsIGludCBsZW5ndGgpCgkgICAgLyoqCgkgICAgICogTWFrZXMgYSBjb3B5IG9mIGEgYXJyYXkuCgkgICAgICovCgkgICAgU3lzdGVtLmFycmF5Y29weSA9IGZ1bmN0aW9uIChzcmMsIHNyY1BvcywgZGVzdCwgZGVzdFBvcywgbGVuZ3RoKSB7CgkgICAgICAgIC8vIFRPRE86IGJldHRlciB1c2Ugc3BsaXQgb3Igc2V0PwoJICAgICAgICB3aGlsZSAobGVuZ3RoLS0pIHsKCSAgICAgICAgICAgIGRlc3RbZGVzdFBvcysrXSA9IHNyY1tzcmNQb3MrK107CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgdGhlIGN1cnJlbnQgdGltZSBpbiBtaWxsaXNlY29uZHMuCgkgICAgICovCgkgICAgU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gRGF0ZS5ub3coKTsKCSAgICB9OwoJICAgIHJldHVybiBTeXN0ZW07Cgl9KCkpOwoJU3lzdGVtJDEuZGVmYXVsdCA9IFN5c3RlbTsKCgl2YXIgQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uJDEgPSB7fTsKCgl2YXIgSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbiQxID0ge307CgoJdmFyIF9fZXh0ZW5kcyRoID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHsKCSAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKCSAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHwKCSAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9OwoJICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICB9OwoJICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KCSAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwoJICAgIH07Cgl9KSgpOwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIEV4Y2VwdGlvbl8xJDggPSBFeGNlcHRpb24kMTsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkaChJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIEluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24oKSB7CgkgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsKCSAgICB9CgkgICAgSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbi5raW5kID0gJ0luZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24nOwoJICAgIHJldHVybiBJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uOwoJfShFeGNlcHRpb25fMSQ4LmRlZmF1bHQpKTsKCUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24kMS5kZWZhdWx0ID0gSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbjsKCgl2YXIgX19leHRlbmRzJGcgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uXzEgPSBJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uJDE7CgkvKioKCSAqIEN1c3RvbSBFcnJvciBjbGFzcyBvZiB0eXBlIEV4Y2VwdGlvbi4KCSAqLwoJdmFyIEFycmF5SW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkZyhBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24sIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uKGluZGV4LCBtZXNzYWdlKSB7CgkgICAgICAgIGlmIChpbmRleCA9PT0gdm9pZCAwKSB7IGluZGV4ID0gdW5kZWZpbmVkOyB9CgkgICAgICAgIGlmIChtZXNzYWdlID09PSB2b2lkIDApIHsgbWVzc2FnZSA9IHVuZGVmaW5lZDsgfQoJICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBtZXNzYWdlKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5pbmRleCA9IGluZGV4OwoJICAgICAgICBfdGhpcy5tZXNzYWdlID0gbWVzc2FnZTsKCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24ua2luZCA9ICdBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24nOwoJICAgIHJldHVybiBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb247Cgl9KEluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb25fMS5kZWZhdWx0KSk7CglBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24kMS5kZWZhdWx0ID0gQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uOwoKCXZhciBfX3ZhbHVlcyQ3ID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fdmFsdWVzKSB8fCBmdW5jdGlvbihvKSB7CgkgICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7CgkgICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7CgkgICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSAibnVtYmVyIikgcmV0dXJuIHsKCSAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDsKCSAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gIk9iamVjdCBpcyBub3QgaXRlcmFibGUuIiA6ICJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuIik7Cgl9OwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEFycmF5cyQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgU3lzdGVtXzEkNSA9IFN5c3RlbSQxOwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDkgPSBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMTsKCXZhciBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb25fMSA9IEFycmF5SW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbiQxOwoJdmFyIEFycmF5cyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBBcnJheXMoKSB7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIEFzc2lnbnMgdGhlIHNwZWNpZmllZCBpbnQgdmFsdWUgdG8gZWFjaCBlbGVtZW50IG9mIHRoZSBzcGVjaWZpZWQgYXJyYXkKCSAgICAgKiBvZiBpbnRzLgoJICAgICAqCgkgICAgICogQHBhcmFtIGEgdGhlIGFycmF5IHRvIGJlIGZpbGxlZAoJICAgICAqIEBwYXJhbSB2YWwgdGhlIHZhbHVlIHRvIGJlIHN0b3JlZCBpbiBhbGwgZWxlbWVudHMgb2YgdGhlIGFycmF5CgkgICAgICovCgkgICAgQXJyYXlzLmZpbGwgPSBmdW5jdGlvbiAoYSwgdmFsKSB7CgkgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBhLmxlbmd0aDsgaSA8IGxlbjsgaSsrKQoJICAgICAgICAgICAgYVtpXSA9IHZhbDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEFzc2lnbnMgdGhlIHNwZWNpZmllZCBpbnQgdmFsdWUgdG8gZWFjaCBlbGVtZW50IG9mIHRoZSBzcGVjaWZpZWQKCSAgICAgKiByYW5nZSBvZiB0aGUgc3BlY2lmaWVkIGFycmF5IG9mIGludHMuICBUaGUgcmFuZ2UgdG8gYmUgZmlsbGVkCgkgICAgICogZXh0ZW5kcyBmcm9tIGluZGV4IHtAY29kZSBmcm9tSW5kZXh9LCBpbmNsdXNpdmUsIHRvIGluZGV4CgkgICAgICoge0Bjb2RlIHRvSW5kZXh9LCBleGNsdXNpdmUuICAoSWYge0Bjb2RlIGZyb21JbmRleD09dG9JbmRleH0sIHRoZQoJICAgICAqIHJhbmdlIHRvIGJlIGZpbGxlZCBpcyBlbXB0eS4pCgkgICAgICoKCSAgICAgKiBAcGFyYW0gYSB0aGUgYXJyYXkgdG8gYmUgZmlsbGVkCgkgICAgICogQHBhcmFtIGZyb21JbmRleCB0aGUgaW5kZXggb2YgdGhlIGZpcnN0IGVsZW1lbnQgKGluY2x1c2l2ZSkgdG8gYmUKCSAgICAgKiAgICAgICAgZmlsbGVkIHdpdGggdGhlIHNwZWNpZmllZCB2YWx1ZQoJICAgICAqIEBwYXJhbSB0b0luZGV4IHRoZSBpbmRleCBvZiB0aGUgbGFzdCBlbGVtZW50IChleGNsdXNpdmUpIHRvIGJlCgkgICAgICogICAgICAgIGZpbGxlZCB3aXRoIHRoZSBzcGVjaWZpZWQgdmFsdWUKCSAgICAgKiBAcGFyYW0gdmFsIHRoZSB2YWx1ZSB0byBiZSBzdG9yZWQgaW4gYWxsIGVsZW1lbnRzIG9mIHRoZSBhcnJheQoJICAgICAqIEB0aHJvd3MgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uIGlmIHtAY29kZSBmcm9tSW5kZXggPiB0b0luZGV4fQoJICAgICAqIEB0aHJvd3MgQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uIGlmIHtAY29kZSBmcm9tSW5kZXggPCAwfSBvcgoJICAgICAqICAgICAgICAge0Bjb2RlIHRvSW5kZXggPiBhLmxlbmd0aH0KCSAgICAgKi8KCSAgICBBcnJheXMuZmlsbFdpdGhpbiA9IGZ1bmN0aW9uIChhLCBmcm9tSW5kZXgsIHRvSW5kZXgsIHZhbCkgewoJICAgICAgICBBcnJheXMucmFuZ2VDaGVjayhhLmxlbmd0aCwgZnJvbUluZGV4LCB0b0luZGV4KTsKCSAgICAgICAgZm9yICh2YXIgaSA9IGZyb21JbmRleDsgaSA8IHRvSW5kZXg7IGkrKykKCSAgICAgICAgICAgIGFbaV0gPSB2YWw7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBDaGVja3MgdGhhdCB7QGNvZGUgZnJvbUluZGV4fSBhbmQge0Bjb2RlIHRvSW5kZXh9IGFyZSBpbgoJICAgICAqIHRoZSByYW5nZSBhbmQgdGhyb3dzIGFuIGV4Y2VwdGlvbiBpZiB0aGV5IGFyZW4ndC4KCSAgICAgKi8KCSAgICBBcnJheXMucmFuZ2VDaGVjayA9IGZ1bmN0aW9uIChhcnJheUxlbmd0aCwgZnJvbUluZGV4LCB0b0luZGV4KSB7CgkgICAgICAgIGlmIChmcm9tSW5kZXggPiB0b0luZGV4KSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkOS5kZWZhdWx0KCdmcm9tSW5kZXgoJyArIGZyb21JbmRleCArICcpID4gdG9JbmRleCgnICsgdG9JbmRleCArICcpJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGZyb21JbmRleCA8IDApIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb25fMS5kZWZhdWx0KGZyb21JbmRleCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHRvSW5kZXggPiBhcnJheUxlbmd0aCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEFycmF5SW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbl8xLmRlZmF1bHQodG9JbmRleCk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIEFycmF5cy5hc0xpc3QgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHZhciBhcmdzID0gW107CgkgICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7CgkgICAgICAgICAgICBhcmdzW19pXSA9IGFyZ3VtZW50c1tfaV07CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGFyZ3M7CgkgICAgfTsKCSAgICBBcnJheXMuY3JlYXRlID0gZnVuY3Rpb24gKHJvd3MsIGNvbHMsIHZhbHVlKSB7CgkgICAgICAgIHZhciBhcnIgPSBBcnJheS5mcm9tKHsgbGVuZ3RoOiByb3dzIH0pOwoJICAgICAgICByZXR1cm4gYXJyLm1hcChmdW5jdGlvbiAoeCkgeyByZXR1cm4gQXJyYXkuZnJvbSh7IGxlbmd0aDogY29scyB9KS5maWxsKHZhbHVlKTsgfSk7CgkgICAgfTsKCSAgICBBcnJheXMuY3JlYXRlSW50MzJBcnJheSA9IGZ1bmN0aW9uIChyb3dzLCBjb2xzLCB2YWx1ZSkgewoJICAgICAgICB2YXIgYXJyID0gQXJyYXkuZnJvbSh7IGxlbmd0aDogcm93cyB9KTsKCSAgICAgICAgcmV0dXJuIGFyci5tYXAoZnVuY3Rpb24gKHgpIHsgcmV0dXJuIEludDMyQXJyYXkuZnJvbSh7IGxlbmd0aDogY29scyB9KS5maWxsKHZhbHVlKTsgfSk7CgkgICAgfTsKCSAgICBBcnJheXMuZXF1YWxzID0gZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsKCSAgICAgICAgaWYgKCFmaXJzdCkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIGlmICghc2Vjb25kKSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKCFmaXJzdC5sZW5ndGgpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoIXNlY29uZC5sZW5ndGgpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoZmlyc3QubGVuZ3RoICE9PSBzZWNvbmQubGVuZ3RoKSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aF8xID0gZmlyc3QubGVuZ3RoOyBpIDwgbGVuZ3RoXzE7IGkrKykgewoJICAgICAgICAgICAgaWYgKGZpcnN0W2ldICE9PSBzZWNvbmRbaV0pIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRydWU7CgkgICAgfTsKCSAgICBBcnJheXMuaGFzaENvZGUgPSBmdW5jdGlvbiAoYSkgewoJICAgICAgICB2YXIgZV8xLCBfYTsKCSAgICAgICAgaWYgKGEgPT09IG51bGwpIHsKCSAgICAgICAgICAgIHJldHVybiAwOwoJICAgICAgICB9CgkgICAgICAgIHZhciByZXN1bHQgPSAxOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgYV8xID0gX192YWx1ZXMkNyhhKSwgYV8xXzEgPSBhXzEubmV4dCgpOyAhYV8xXzEuZG9uZTsgYV8xXzEgPSBhXzEubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSBhXzFfMS52YWx1ZTsKCSAgICAgICAgICAgICAgICByZXN1bHQgPSAzMSAqIHJlc3VsdCArIGVsZW1lbnQ7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGVfMV8xKSB7IGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07IH0KCSAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGlmIChhXzFfMSAmJiAhYV8xXzEuZG9uZSAmJiAoX2EgPSBhXzEucmV0dXJuKSkgX2EuY2FsbChhXzEpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZmluYWxseSB7IGlmIChlXzEpIHRocm93IGVfMS5lcnJvcjsgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiByZXN1bHQ7CgkgICAgfTsKCSAgICBBcnJheXMuZmlsbFVpbnQ4QXJyYXkgPSBmdW5jdGlvbiAoYSwgdmFsdWUpIHsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgIT09IGEubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIGFbaV0gPSB2YWx1ZTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgQXJyYXlzLmNvcHlPZiA9IGZ1bmN0aW9uIChvcmlnaW5hbCwgbmV3TGVuZ3RoKSB7CgkgICAgICAgIHJldHVybiBvcmlnaW5hbC5zbGljZSgwLCBuZXdMZW5ndGgpOwoJICAgIH07CgkgICAgQXJyYXlzLmNvcHlPZlVpbnQ4QXJyYXkgPSBmdW5jdGlvbiAob3JpZ2luYWwsIG5ld0xlbmd0aCkgewoJICAgICAgICBpZiAob3JpZ2luYWwubGVuZ3RoIDw9IG5ld0xlbmd0aCkgewoJICAgICAgICAgICAgdmFyIG5ld0FycmF5ID0gbmV3IFVpbnQ4QXJyYXkobmV3TGVuZ3RoKTsKCSAgICAgICAgICAgIG5ld0FycmF5LnNldChvcmlnaW5hbCk7CgkgICAgICAgICAgICByZXR1cm4gbmV3QXJyYXk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG9yaWdpbmFsLnNsaWNlKDAsIG5ld0xlbmd0aCk7CgkgICAgfTsKCSAgICBBcnJheXMuY29weU9mUmFuZ2UgPSBmdW5jdGlvbiAob3JpZ2luYWwsIGZyb20sIHRvKSB7CgkgICAgICAgIHZhciBuZXdMZW5ndGggPSB0byAtIGZyb207CgkgICAgICAgIHZhciBjb3B5ID0gbmV3IEludDMyQXJyYXkobmV3TGVuZ3RoKTsKCSAgICAgICAgU3lzdGVtXzEkNS5kZWZhdWx0LmFycmF5Y29weShvcmlnaW5hbCwgZnJvbSwgY29weSwgMCwgbmV3TGVuZ3RoKTsKCSAgICAgICAgcmV0dXJuIGNvcHk7CgkgICAgfTsKCSAgICAvKgoJICAgICogUmV0dXJucyB0aGUgaW5kZXggb2Ygb2YgdGhlIGVsZW1lbnQgaW4gYSBzb3J0ZWQgYXJyYXkgb3IgKC1uLTEpIHdoZXJlIG4gaXMgdGhlIGluc2VydGlvbiBwb2ludAoJICAgICogZm9yIHRoZSBuZXcgZWxlbWVudC4KCSAgICAqIFBhcmFtZXRlcnM6CgkgICAgKiAgICAgYXIgLSBBIHNvcnRlZCBhcnJheQoJICAgICogICAgIGVsIC0gQW4gZWxlbWVudCB0byBzZWFyY2ggZm9yCgkgICAgKiAgICAgY29tcGFyYXRvciAtIEEgY29tcGFyYXRvciBmdW5jdGlvbi4gVGhlIGZ1bmN0aW9uIHRha2VzIHR3byBhcmd1bWVudHM6IChhLCBiKSBhbmQgcmV0dXJuczoKCSAgICAqICAgICAgICBhIG5lZ2F0aXZlIG51bWJlciAgaWYgYSBpcyBsZXNzIHRoYW4gYjsKCSAgICAqICAgICAgICAwIGlmIGEgaXMgZXF1YWwgdG8gYjsKCSAgICAqICAgICAgICBhIHBvc2l0aXZlIG51bWJlciBvZiBhIGlzIGdyZWF0ZXIgdGhhbiBiLgoJICAgICogVGhlIGFycmF5IG1heSBjb250YWluIGR1cGxpY2F0ZSBlbGVtZW50cy4gSWYgdGhlcmUgYXJlIG1vcmUgdGhhbiBvbmUgZXF1YWwgZWxlbWVudHMgaW4gdGhlIGFycmF5LAoJICAgICogdGhlIHJldHVybmVkIHZhbHVlIGNhbiBiZSB0aGUgaW5kZXggb2YgYW55IG9uZSBvZiB0aGUgZXF1YWwgZWxlbWVudHMuCgkgICAgKgoJICAgICogaHR0cDovL2pzZmlkZGxlLm5ldC9hcnl6aG92L3BrZnN0NTUwLwoJICAgICovCgkgICAgQXJyYXlzLmJpbmFyeVNlYXJjaCA9IGZ1bmN0aW9uIChhciwgZWwsIGNvbXBhcmF0b3IpIHsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gY29tcGFyYXRvcikgewoJICAgICAgICAgICAgY29tcGFyYXRvciA9IEFycmF5cy5udW1iZXJDb21wYXJhdG9yOwoJICAgICAgICB9CgkgICAgICAgIHZhciBtID0gMDsKCSAgICAgICAgdmFyIG4gPSBhci5sZW5ndGggLSAxOwoJICAgICAgICB3aGlsZSAobSA8PSBuKSB7CgkgICAgICAgICAgICB2YXIgayA9IChuICsgbSkgPj4gMTsKCSAgICAgICAgICAgIHZhciBjbXAgPSBjb21wYXJhdG9yKGVsLCBhcltrXSk7CgkgICAgICAgICAgICBpZiAoY21wID4gMCkgewoJICAgICAgICAgICAgICAgIG0gPSBrICsgMTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGVsc2UgaWYgKGNtcCA8IDApIHsKCSAgICAgICAgICAgICAgICBuID0gayAtIDE7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gazsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gLW0gLSAxOwoJICAgIH07CgkgICAgQXJyYXlzLm51bWJlckNvbXBhcmF0b3IgPSBmdW5jdGlvbiAoYSwgYikgewoJICAgICAgICByZXR1cm4gYSAtIGI7CgkgICAgfTsKCSAgICByZXR1cm4gQXJyYXlzOwoJfSgpKTsKCUFycmF5cyQxLmRlZmF1bHQgPSBBcnJheXM7CgoJdmFyIEludGVnZXIkMSA9IHt9OwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbnRlZ2VyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qKgoJICogUG9ueWZpbGwgZm9yIEphdmEncyBJbnRlZ2VyIGNsYXNzLgoJICovCgl2YXIgSW50ZWdlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBJbnRlZ2VyKCkgewoJICAgIH0KCSAgICBJbnRlZ2VyLm51bWJlck9mVHJhaWxpbmdaZXJvcyA9IGZ1bmN0aW9uIChpKSB7CgkgICAgICAgIHZhciB5OwoJICAgICAgICBpZiAoaSA9PT0gMCkKCSAgICAgICAgICAgIHJldHVybiAzMjsKCSAgICAgICAgdmFyIG4gPSAzMTsKCSAgICAgICAgeSA9IGkgPDwgMTY7CgkgICAgICAgIGlmICh5ICE9PSAwKSB7CgkgICAgICAgICAgICBuIC09IDE2OwoJICAgICAgICAgICAgaSA9IHk7CgkgICAgICAgIH0KCSAgICAgICAgeSA9IGkgPDwgODsKCSAgICAgICAgaWYgKHkgIT09IDApIHsKCSAgICAgICAgICAgIG4gLT0gODsKCSAgICAgICAgICAgIGkgPSB5OwoJICAgICAgICB9CgkgICAgICAgIHkgPSBpIDw8IDQ7CgkgICAgICAgIGlmICh5ICE9PSAwKSB7CgkgICAgICAgICAgICBuIC09IDQ7CgkgICAgICAgICAgICBpID0geTsKCSAgICAgICAgfQoJICAgICAgICB5ID0gaSA8PCAyOwoJICAgICAgICBpZiAoeSAhPT0gMCkgewoJICAgICAgICAgICAgbiAtPSAyOwoJICAgICAgICAgICAgaSA9IHk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG4gLSAoKGkgPDwgMSkgPj4+IDMxKTsKCSAgICB9OwoJICAgIEludGVnZXIubnVtYmVyT2ZMZWFkaW5nWmVyb3MgPSBmdW5jdGlvbiAoaSkgewoJICAgICAgICAvLyBIRCwgRmlndXJlIDUtNgoJICAgICAgICBpZiAoaSA9PT0gMCkgewoJICAgICAgICAgICAgcmV0dXJuIDMyOwoJICAgICAgICB9CgkgICAgICAgIHZhciBuID0gMTsKCSAgICAgICAgaWYgKGkgPj4+IDE2ID09PSAwKSB7CgkgICAgICAgICAgICBuICs9IDE2OwoJICAgICAgICAgICAgaSA8PD0gMTY7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGkgPj4+IDI0ID09PSAwKSB7CgkgICAgICAgICAgICBuICs9IDg7CgkgICAgICAgICAgICBpIDw8PSA4OwoJICAgICAgICB9CgkgICAgICAgIGlmIChpID4+PiAyOCA9PT0gMCkgewoJICAgICAgICAgICAgbiArPSA0OwoJICAgICAgICAgICAgaSA8PD0gNDsKCSAgICAgICAgfQoJICAgICAgICBpZiAoaSA+Pj4gMzAgPT09IDApIHsKCSAgICAgICAgICAgIG4gKz0gMjsKCSAgICAgICAgICAgIGkgPDw9IDI7CgkgICAgICAgIH0KCSAgICAgICAgbiAtPSBpID4+PiAzMTsKCSAgICAgICAgcmV0dXJuIG47CgkgICAgfTsKCSAgICBJbnRlZ2VyLnRvSGV4U3RyaW5nID0gZnVuY3Rpb24gKGkpIHsKCSAgICAgICAgcmV0dXJuIGkudG9TdHJpbmcoMTYpOwoJICAgIH07CgkgICAgSW50ZWdlci50b0JpbmFyeVN0cmluZyA9IGZ1bmN0aW9uIChpbnROdW1iZXIpIHsKCSAgICAgICAgcmV0dXJuIFN0cmluZyhwYXJzZUludChTdHJpbmcoaW50TnVtYmVyKSwgMikpOwoJICAgIH07CgkgICAgLy8gUmV0dXJucyB0aGUgbnVtYmVyIG9mIG9uZS1iaXRzIGluIHRoZSB0d28ncyBjb21wbGVtZW50IGJpbmFyeSByZXByZXNlbnRhdGlvbiBvZiB0aGUgc3BlY2lmaWVkIGludCB2YWx1ZS4gVGhpcyBmdW5jdGlvbiBpcyBzb21ldGltZXMgcmVmZXJyZWQgdG8gYXMgdGhlIHBvcHVsYXRpb24gY291bnQuCgkgICAgLy8gUmV0dXJuczoKCSAgICAvLyB0aGUgbnVtYmVyIG9mIG9uZS1iaXRzIGluIHRoZSB0d28ncyBjb21wbGVtZW50IGJpbmFyeSByZXByZXNlbnRhdGlvbiBvZiB0aGUgc3BlY2lmaWVkIGludCB2YWx1ZS4KCSAgICBJbnRlZ2VyLmJpdENvdW50ID0gZnVuY3Rpb24gKGkpIHsKCSAgICAgICAgLy8gSEQsIEZpZ3VyZSA1LTIKCSAgICAgICAgaSA9IGkgLSAoKGkgPj4+IDEpICYgMHg1NTU1NTU1NSk7CgkgICAgICAgIGkgPSAoaSAmIDB4MzMzMzMzMzMpICsgKChpID4+PiAyKSAmIDB4MzMzMzMzMzMpOwoJICAgICAgICBpID0gKGkgKyAoaSA+Pj4gNCkpICYgMHgwZjBmMGYwZjsKCSAgICAgICAgaSA9IGkgKyAoaSA+Pj4gOCk7CgkgICAgICAgIGkgPSBpICsgKGkgPj4+IDE2KTsKCSAgICAgICAgcmV0dXJuIGkgJiAweDNmOwoJICAgIH07CgkgICAgSW50ZWdlci50cnVuY0RpdmlzaW9uID0gZnVuY3Rpb24gKGRpdmlkZW5kLCBkaXZpc29yKSB7CgkgICAgICAgIHJldHVybiBNYXRoLnRydW5jKGRpdmlkZW5kIC8gZGl2aXNvcik7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBDb252ZXJ0cyBBIHN0cmluZyB0byBhbiBpbnRlZ2VyLgoJICAgICAqIEBwYXJhbSBzIEEgc3RyaW5nIHRvIGNvbnZlcnQgaW50byBhIG51bWJlci4KCSAgICAgKiBAcGFyYW0gcmFkaXggQSB2YWx1ZSBiZXR3ZWVuIDIgYW5kIDM2IHRoYXQgc3BlY2lmaWVzIHRoZSBiYXNlIG9mIHRoZSBudW1iZXIgaW4gbnVtU3RyaW5nLiBJZiB0aGlzIGFyZ3VtZW50IGlzIG5vdCBzdXBwbGllZCwgc3RyaW5ncyB3aXRoIGEgcHJlZml4IG9mICcweCcgYXJlIGNvbnNpZGVyZWQgaGV4YWRlY2ltYWwuIEFsbCBvdGhlciBzdHJpbmdzIGFyZSBjb25zaWRlcmVkIGRlY2ltYWwuCgkgICAgICovCgkgICAgSW50ZWdlci5wYXJzZUludCA9IGZ1bmN0aW9uIChudW0sIHJhZGl4KSB7CgkgICAgICAgIGlmIChyYWRpeCA9PT0gdm9pZCAwKSB7IHJhZGl4ID0gdW5kZWZpbmVkOyB9CgkgICAgICAgIHJldHVybiBwYXJzZUludChudW0sIHJhZGl4KTsKCSAgICB9OwoJICAgIEludGVnZXIuTUlOX1ZBTFVFXzMyX0JJVFMgPSAtMjE0NzQ4MzY0ODsKCSAgICBJbnRlZ2VyLk1BWF9WQUxVRSA9IE51bWJlci5NQVhfU0FGRV9JTlRFR0VSOwoJICAgIHJldHVybiBJbnRlZ2VyOwoJfSgpKTsKCUludGVnZXIkMS5kZWZhdWx0ID0gSW50ZWdlcjsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEJpdEFycmF5JDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyppbXBvcnQgamF2YS51dGlsLkFycmF5czsqLwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDggPSBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMTsKCXZhciBBcnJheXNfMSQxID0gQXJyYXlzJDE7Cgl2YXIgSW50ZWdlcl8xJDIgPSBJbnRlZ2VyJDE7Cgl2YXIgU3lzdGVtXzEkNCA9IFN5c3RlbSQxOwoJLyoqCgkgKiA8cD5BIHNpbXBsZSwgZmFzdCBhcnJheSBvZiBiaXRzLCByZXByZXNlbnRlZCBjb21wYWN0bHkgYnkgYW4gYXJyYXkgb2YgaW50cyBpbnRlcm5hbGx5LjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgQml0QXJyYXkgLyppbXBsZW1lbnRzIENsb25lYWJsZSovID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIC8vIHB1YmxpYyBjb25zdHJ1Y3RvcigpIHsKCSAgICAvLyAgIHRoaXMuc2l6ZSA9IDAKCSAgICAvLyAgIHRoaXMuYml0cyA9IG5ldyBJbnQzMkFycmF5KDEpCgkgICAgLy8gfQoJICAgIC8vIHB1YmxpYyBjb25zdHJ1Y3RvcihzaXplPzogbnVtYmVyIC8qaW50Ki8pIHsKCSAgICAvLyAgIGlmICh1bmRlZmluZWQgPT09IHNpemUpIHsKCSAgICAvLyAgICAgdGhpcy5zaXplID0gMAoJICAgIC8vICAgfSBlbHNlIHsKCSAgICAvLyAgICAgdGhpcy5zaXplID0gc2l6ZQoJICAgIC8vICAgfQoJICAgIC8vICAgdGhpcy5iaXRzID0gdGhpcy5tYWtlQXJyYXkoc2l6ZSkKCSAgICAvLyB9CgkgICAgLy8gRm9yIHRlc3Rpbmcgb25seQoJICAgIGZ1bmN0aW9uIEJpdEFycmF5KHNpemUgLyppbnQqLywgYml0cykgewoJICAgICAgICBpZiAodW5kZWZpbmVkID09PSBzaXplKSB7CgkgICAgICAgICAgICB0aGlzLnNpemUgPSAwOwoJICAgICAgICAgICAgdGhpcy5iaXRzID0gbmV3IEludDMyQXJyYXkoMSk7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICB0aGlzLnNpemUgPSBzaXplOwoJICAgICAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gYml0cyB8fCBudWxsID09PSBiaXRzKSB7CgkgICAgICAgICAgICAgICAgdGhpcy5iaXRzID0gQml0QXJyYXkubWFrZUFycmF5KHNpemUpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgdGhpcy5iaXRzID0gYml0czsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgIH0KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuZ2V0U2l6ZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc2l6ZTsKCSAgICB9OwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5nZXRTaXplSW5CeXRlcyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IoKHRoaXMuc2l6ZSArIDcpIC8gOCk7CgkgICAgfTsKCSAgICBCaXRBcnJheS5wcm90b3R5cGUuZW5zdXJlQ2FwYWNpdHkgPSBmdW5jdGlvbiAoc2l6ZSAvKmludCovKSB7CgkgICAgICAgIGlmIChzaXplID4gdGhpcy5iaXRzLmxlbmd0aCAqIDMyKSB7CgkgICAgICAgICAgICB2YXIgbmV3Qml0cyA9IEJpdEFycmF5Lm1ha2VBcnJheShzaXplKTsKCSAgICAgICAgICAgIFN5c3RlbV8xJDQuZGVmYXVsdC5hcnJheWNvcHkodGhpcy5iaXRzLCAwLCBuZXdCaXRzLCAwLCB0aGlzLmJpdHMubGVuZ3RoKTsKCSAgICAgICAgICAgIHRoaXMuYml0cyA9IG5ld0JpdHM7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBpIGJpdCB0byBnZXQKCSAgICAgKiBAcmV0dXJuIHRydWUgaWZmIGJpdCBpIGlzIHNldAoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAoaSAvKmludCovKSB7CgkgICAgICAgIHJldHVybiAodGhpcy5iaXRzW01hdGguZmxvb3IoaSAvIDMyKV0gJiAoMSA8PCAoaSAmIDB4MUYpKSkgIT09IDA7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBTZXRzIGJpdCBpLgoJICAgICAqCgkgICAgICogQHBhcmFtIGkgYml0IHRvIHNldAoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAoaSAvKmludCovKSB7CgkgICAgICAgIHRoaXMuYml0c1tNYXRoLmZsb29yKGkgLyAzMildIHw9IDEgPDwgKGkgJiAweDFGKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEZsaXBzIGJpdCBpLgoJICAgICAqCgkgICAgICogQHBhcmFtIGkgYml0IHRvIHNldAoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5mbGlwID0gZnVuY3Rpb24gKGkgLyppbnQqLykgewoJICAgICAgICB0aGlzLmJpdHNbTWF0aC5mbG9vcihpIC8gMzIpXSBePSAxIDw8IChpICYgMHgxRik7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gZnJvbSBmaXJzdCBiaXQgdG8gY2hlY2sKCSAgICAgKiBAcmV0dXJuIGluZGV4IG9mIGZpcnN0IGJpdCB0aGF0IGlzIHNldCwgc3RhcnRpbmcgZnJvbSB0aGUgZ2l2ZW4gaW5kZXgsIG9yIHNpemUgaWYgbm9uZSBhcmUgc2V0CgkgICAgICogIGF0IG9yIGJleW9uZCB0aGlzIGdpdmVuIGluZGV4CgkgICAgICogQHNlZSAjZ2V0TmV4dFVuc2V0KGludCkKCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuZ2V0TmV4dFNldCA9IGZ1bmN0aW9uIChmcm9tIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIHNpemUgPSB0aGlzLnNpemU7CgkgICAgICAgIGlmIChmcm9tID49IHNpemUpIHsKCSAgICAgICAgICAgIHJldHVybiBzaXplOwoJICAgICAgICB9CgkgICAgICAgIHZhciBiaXRzID0gdGhpcy5iaXRzOwoJICAgICAgICB2YXIgYml0c09mZnNldCA9IE1hdGguZmxvb3IoZnJvbSAvIDMyKTsKCSAgICAgICAgdmFyIGN1cnJlbnRCaXRzID0gYml0c1tiaXRzT2Zmc2V0XTsKCSAgICAgICAgLy8gbWFzayBvZmYgbGVzc2VyIGJpdHMgZmlyc3QKCSAgICAgICAgY3VycmVudEJpdHMgJj0gfigoMSA8PCAoZnJvbSAmIDB4MUYpKSAtIDEpOwoJICAgICAgICB2YXIgbGVuZ3RoID0gYml0cy5sZW5ndGg7CgkgICAgICAgIHdoaWxlIChjdXJyZW50Qml0cyA9PT0gMCkgewoJICAgICAgICAgICAgaWYgKCsrYml0c09mZnNldCA9PT0gbGVuZ3RoKSB7CgkgICAgICAgICAgICAgICAgcmV0dXJuIHNpemU7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBjdXJyZW50Qml0cyA9IGJpdHNbYml0c09mZnNldF07CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHJlc3VsdCA9IChiaXRzT2Zmc2V0ICogMzIpICsgSW50ZWdlcl8xJDIuZGVmYXVsdC5udW1iZXJPZlRyYWlsaW5nWmVyb3MoY3VycmVudEJpdHMpOwoJICAgICAgICByZXR1cm4gcmVzdWx0ID4gc2l6ZSA/IHNpemUgOiByZXN1bHQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gZnJvbSBpbmRleCB0byBzdGFydCBsb29raW5nIGZvciB1bnNldCBiaXQKCSAgICAgKiBAcmV0dXJuIGluZGV4IG9mIG5leHQgdW5zZXQgYml0LCBvciB7QGNvZGUgc2l6ZX0gaWYgbm9uZSBhcmUgdW5zZXQgdW50aWwgdGhlIGVuZAoJICAgICAqIEBzZWUgI2dldE5leHRTZXQoaW50KQoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5nZXROZXh0VW5zZXQgPSBmdW5jdGlvbiAoZnJvbSAvKmludCovKSB7CgkgICAgICAgIHZhciBzaXplID0gdGhpcy5zaXplOwoJICAgICAgICBpZiAoZnJvbSA+PSBzaXplKSB7CgkgICAgICAgICAgICByZXR1cm4gc2l6ZTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgdmFyIGJpdHNPZmZzZXQgPSBNYXRoLmZsb29yKGZyb20gLyAzMik7CgkgICAgICAgIHZhciBjdXJyZW50Qml0cyA9IH5iaXRzW2JpdHNPZmZzZXRdOwoJICAgICAgICAvLyBtYXNrIG9mZiBsZXNzZXIgYml0cyBmaXJzdAoJICAgICAgICBjdXJyZW50Qml0cyAmPSB+KCgxIDw8IChmcm9tICYgMHgxRikpIC0gMSk7CgkgICAgICAgIHZhciBsZW5ndGggPSBiaXRzLmxlbmd0aDsKCSAgICAgICAgd2hpbGUgKGN1cnJlbnRCaXRzID09PSAwKSB7CgkgICAgICAgICAgICBpZiAoKytiaXRzT2Zmc2V0ID09PSBsZW5ndGgpIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gc2l6ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGN1cnJlbnRCaXRzID0gfmJpdHNbYml0c09mZnNldF07CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHJlc3VsdCA9IChiaXRzT2Zmc2V0ICogMzIpICsgSW50ZWdlcl8xJDIuZGVmYXVsdC5udW1iZXJPZlRyYWlsaW5nWmVyb3MoY3VycmVudEJpdHMpOwoJICAgICAgICByZXR1cm4gcmVzdWx0ID4gc2l6ZSA/IHNpemUgOiByZXN1bHQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBTZXRzIGEgYmxvY2sgb2YgMzIgYml0cywgc3RhcnRpbmcgYXQgYml0IGkuCgkgICAgICoKCSAgICAgKiBAcGFyYW0gaSBmaXJzdCBiaXQgdG8gc2V0CgkgICAgICogQHBhcmFtIG5ld0JpdHMgdGhlIG5ldyB2YWx1ZSBvZiB0aGUgbmV4dCAzMiBiaXRzLiBOb3RlIGFnYWluIHRoYXQgdGhlIGxlYXN0LXNpZ25pZmljYW50IGJpdAoJICAgICAqIGNvcnJlc3BvbmRzIHRvIGJpdCBpLCB0aGUgbmV4dC1sZWFzdC1zaWduaWZpY2FudCB0byBpKzEsIGFuZCBzbyBvbi4KCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuc2V0QnVsayA9IGZ1bmN0aW9uIChpIC8qaW50Ki8sIG5ld0JpdHMgLyppbnQqLykgewoJICAgICAgICB0aGlzLmJpdHNbTWF0aC5mbG9vcihpIC8gMzIpXSA9IG5ld0JpdHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBTZXRzIGEgcmFuZ2Ugb2YgYml0cy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBzdGFydCBzdGFydCBvZiByYW5nZSwgaW5jbHVzaXZlLgoJICAgICAqIEBwYXJhbSBlbmQgZW5kIG9mIHJhbmdlLCBleGNsdXNpdmUKCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuc2V0UmFuZ2UgPSBmdW5jdGlvbiAoc3RhcnQgLyppbnQqLywgZW5kIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKGVuZCA8IHN0YXJ0IHx8IHN0YXJ0IDwgMCB8fCBlbmQgPiB0aGlzLnNpemUpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ4LmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoZW5kID09PSBzdGFydCkgewoJICAgICAgICAgICAgcmV0dXJuOwoJICAgICAgICB9CgkgICAgICAgIGVuZC0tOyAvLyB3aWxsIGJlIGVhc2llciB0byB0cmVhdCB0aGlzIGFzIHRoZSBsYXN0IGFjdHVhbGx5IHNldCBiaXQgLS0gaW5jbHVzaXZlCgkgICAgICAgIHZhciBmaXJzdEludCA9IE1hdGguZmxvb3Ioc3RhcnQgLyAzMik7CgkgICAgICAgIHZhciBsYXN0SW50ID0gTWF0aC5mbG9vcihlbmQgLyAzMik7CgkgICAgICAgIHZhciBiaXRzID0gdGhpcy5iaXRzOwoJICAgICAgICBmb3IgKHZhciBpID0gZmlyc3RJbnQ7IGkgPD0gbGFzdEludDsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgZmlyc3RCaXQgPSBpID4gZmlyc3RJbnQgPyAwIDogc3RhcnQgJiAweDFGOwoJICAgICAgICAgICAgdmFyIGxhc3RCaXQgPSBpIDwgbGFzdEludCA/IDMxIDogZW5kICYgMHgxRjsKCSAgICAgICAgICAgIC8vIE9uZXMgZnJvbSBmaXJzdEJpdCB0byBsYXN0Qml0LCBpbmNsdXNpdmUKCSAgICAgICAgICAgIHZhciBtYXNrID0gKDIgPDwgbGFzdEJpdCkgLSAoMSA8PCBmaXJzdEJpdCk7CgkgICAgICAgICAgICBiaXRzW2ldIHw9IG1hc2s7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIENsZWFycyBhbGwgYml0cyAoc2V0cyB0byBmYWxzZSkuCgkgICAgICovCgkgICAgQml0QXJyYXkucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgbWF4ID0gdGhpcy5iaXRzLmxlbmd0aDsKCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbWF4OyBpKyspIHsKCSAgICAgICAgICAgIGJpdHNbaV0gPSAwOwoJICAgICAgICB9CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBFZmZpY2llbnQgbWV0aG9kIHRvIGNoZWNrIGlmIGEgcmFuZ2Ugb2YgYml0cyBpcyBzZXQsIG9yIG5vdCBzZXQuCgkgICAgICoKCSAgICAgKiBAcGFyYW0gc3RhcnQgc3RhcnQgb2YgcmFuZ2UsIGluY2x1c2l2ZS4KCSAgICAgKiBAcGFyYW0gZW5kIGVuZCBvZiByYW5nZSwgZXhjbHVzaXZlCgkgICAgICogQHBhcmFtIHZhbHVlIGlmIHRydWUsIGNoZWNrcyB0aGF0IGJpdHMgaW4gcmFuZ2UgYXJlIHNldCwgb3RoZXJ3aXNlIGNoZWNrcyB0aGF0IHRoZXkgYXJlIG5vdCBzZXQKCSAgICAgKiBAcmV0dXJuIHRydWUgaWZmIGFsbCBiaXRzIGFyZSBzZXQgb3Igbm90IHNldCBpbiByYW5nZSwgYWNjb3JkaW5nIHRvIHZhbHVlIGFyZ3VtZW50CgkgICAgICogQHRocm93cyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gaWYgZW5kIGlzIGxlc3MgdGhhbiBzdGFydCBvciB0aGUgcmFuZ2UgaXMgbm90IGNvbnRhaW5lZCBpbiB0aGUgYXJyYXkKCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuaXNSYW5nZSA9IGZ1bmN0aW9uIChzdGFydCAvKmludCovLCBlbmQgLyppbnQqLywgdmFsdWUpIHsKCSAgICAgICAgaWYgKGVuZCA8IHN0YXJ0IHx8IHN0YXJ0IDwgMCB8fCBlbmQgPiB0aGlzLnNpemUpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ4LmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoZW5kID09PSBzdGFydCkgewoJICAgICAgICAgICAgcmV0dXJuIHRydWU7IC8vIGVtcHR5IHJhbmdlIG1hdGNoZXMKCSAgICAgICAgfQoJICAgICAgICBlbmQtLTsgLy8gd2lsbCBiZSBlYXNpZXIgdG8gdHJlYXQgdGhpcyBhcyB0aGUgbGFzdCBhY3R1YWxseSBzZXQgYml0IC0tIGluY2x1c2l2ZQoJICAgICAgICB2YXIgZmlyc3RJbnQgPSBNYXRoLmZsb29yKHN0YXJ0IC8gMzIpOwoJICAgICAgICB2YXIgbGFzdEludCA9IE1hdGguZmxvb3IoZW5kIC8gMzIpOwoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgZm9yICh2YXIgaSA9IGZpcnN0SW50OyBpIDw9IGxhc3RJbnQ7IGkrKykgewoJICAgICAgICAgICAgdmFyIGZpcnN0Qml0ID0gaSA+IGZpcnN0SW50ID8gMCA6IHN0YXJ0ICYgMHgxRjsKCSAgICAgICAgICAgIHZhciBsYXN0Qml0ID0gaSA8IGxhc3RJbnQgPyAzMSA6IGVuZCAmIDB4MUY7CgkgICAgICAgICAgICAvLyBPbmVzIGZyb20gZmlyc3RCaXQgdG8gbGFzdEJpdCwgaW5jbHVzaXZlCgkgICAgICAgICAgICB2YXIgbWFzayA9ICgyIDw8IGxhc3RCaXQpIC0gKDEgPDwgZmlyc3RCaXQpICYgMHhGRkZGRkZGRjsKCSAgICAgICAgICAgIC8vIFRZUEVTQ1JJUFRQT1JUOiAmIDB4RkZGRkZGRkYgYWRkZWQgdG8gZGlzY2FyZCBhbnl0aGluZyBhZnRlciAzMiBiaXRzLCBhcyBFUyBoYXMgNTMgYml0cwoJICAgICAgICAgICAgLy8gUmV0dXJuIGZhbHNlIGlmIHdlJ3JlIGxvb2tpbmcgZm9yIDFzIGFuZCB0aGUgbWFza2VkIGJpdHNbaV0gaXNuJ3QgYWxsIDFzIChpczogdGhhdCwKCSAgICAgICAgICAgIC8vIGVxdWFscyB0aGUgbWFzaywgb3Igd2UncmUgbG9va2luZyBmb3IgMHMgYW5kIHRoZSBtYXNrZWQgcG9ydGlvbiBpcyBub3QgYWxsIDBzCgkgICAgICAgICAgICBpZiAoKGJpdHNbaV0gJiBtYXNrKSAhPT0gKHZhbHVlID8gbWFzayA6IDApKSB7CgkgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiB0cnVlOwoJICAgIH07CgkgICAgQml0QXJyYXkucHJvdG90eXBlLmFwcGVuZEJpdCA9IGZ1bmN0aW9uIChiaXQpIHsKCSAgICAgICAgdGhpcy5lbnN1cmVDYXBhY2l0eSh0aGlzLnNpemUgKyAxKTsKCSAgICAgICAgaWYgKGJpdCkgewoJICAgICAgICAgICAgdGhpcy5iaXRzW01hdGguZmxvb3IodGhpcy5zaXplIC8gMzIpXSB8PSAxIDw8ICh0aGlzLnNpemUgJiAweDFGKTsKCSAgICAgICAgfQoJICAgICAgICB0aGlzLnNpemUrKzsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEFwcGVuZHMgdGhlIGxlYXN0LXNpZ25pZmljYW50IGJpdHMsIGZyb20gdmFsdWUsIGluIG9yZGVyIGZyb20gbW9zdC1zaWduaWZpY2FudCB0bwoJICAgICAqIGxlYXN0LXNpZ25pZmljYW50LiBGb3IgZXhhbXBsZSwgYXBwZW5kaW5nIDYgYml0cyBmcm9tIDB4MDAwMDAxRSB3aWxsIGFwcGVuZCB0aGUgYml0cwoJICAgICAqIDAsIDEsIDEsIDEsIDEsIDAgaW4gdGhhdCBvcmRlci4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB2YWx1ZSB7QGNvZGUgaW50fSBjb250YWluaW5nIGJpdHMgdG8gYXBwZW5kCgkgICAgICogQHBhcmFtIG51bUJpdHMgYml0cyBmcm9tIHZhbHVlIHRvIGFwcGVuZAoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5hcHBlbmRCaXRzID0gZnVuY3Rpb24gKHZhbHVlIC8qaW50Ki8sIG51bUJpdHMgLyppbnQqLykgewoJICAgICAgICBpZiAobnVtQml0cyA8IDAgfHwgbnVtQml0cyA+IDMyKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkOC5kZWZhdWx0KCdOdW0gYml0cyBtdXN0IGJlIGJldHdlZW4gMCBhbmQgMzInKTsKCSAgICAgICAgfQoJICAgICAgICB0aGlzLmVuc3VyZUNhcGFjaXR5KHRoaXMuc2l6ZSArIG51bUJpdHMpOwoJICAgICAgICAvLyBjb25zdCBhcHBlbmRCaXQgPSB0aGlzLmFwcGVuZEJpdDsKCSAgICAgICAgZm9yICh2YXIgbnVtQml0c0xlZnQgPSBudW1CaXRzOyBudW1CaXRzTGVmdCA+IDA7IG51bUJpdHNMZWZ0LS0pIHsKCSAgICAgICAgICAgIHRoaXMuYXBwZW5kQml0KCgodmFsdWUgPj4gKG51bUJpdHNMZWZ0IC0gMSkpICYgMHgwMSkgPT09IDEpOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBCaXRBcnJheS5wcm90b3R5cGUuYXBwZW5kQml0QXJyYXkgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgdmFyIG90aGVyU2l6ZSA9IG90aGVyLnNpemU7CgkgICAgICAgIHRoaXMuZW5zdXJlQ2FwYWNpdHkodGhpcy5zaXplICsgb3RoZXJTaXplKTsKCSAgICAgICAgLy8gY29uc3QgYXBwZW5kQml0ID0gdGhpcy5hcHBlbmRCaXQ7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgb3RoZXJTaXplOyBpKyspIHsKCSAgICAgICAgICAgIHRoaXMuYXBwZW5kQml0KG90aGVyLmdldChpKSk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS54b3IgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgaWYgKHRoaXMuc2l6ZSAhPT0gb3RoZXIuc2l6ZSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDguZGVmYXVsdCgnU2l6ZXMgZG9uXCd0IG1hdGNoJyk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGhfMSA9IGJpdHMubGVuZ3RoOyBpIDwgbGVuZ3RoXzE7IGkrKykgewoJICAgICAgICAgICAgLy8gVGhlIGxhc3QgaW50IGNvdWxkIGJlIGluY29tcGxldGUgKGkuZS4gbm90IGhhdmUgMzIgYml0cyBpbgoJICAgICAgICAgICAgLy8gaXQpIGJ1dCB0aGVyZSBpcyBubyBwcm9ibGVtIHNpbmNlIDAgWE9SIDAgPT0gMC4KCSAgICAgICAgICAgIGJpdHNbaV0gXj0gb3RoZXIuYml0c1tpXTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgLyoqCgkgICAgICoKCSAgICAgKiBAcGFyYW0gYml0T2Zmc2V0IGZpcnN0IGJpdCB0byBzdGFydCB3cml0aW5nCgkgICAgICogQHBhcmFtIGFycmF5IGFycmF5IHRvIHdyaXRlIGludG8uIEJ5dGVzIGFyZSB3cml0dGVuIG1vc3Qtc2lnbmlmaWNhbnQgYnl0ZSBmaXJzdC4gVGhpcyBpcyB0aGUgb3Bwb3NpdGUKCSAgICAgKiAgb2YgdGhlIGludGVybmFsIHJlcHJlc2VudGF0aW9uLCB3aGljaCBpcyBleHBvc2VkIGJ5IHtAbGluayAjZ2V0Qml0QXJyYXkoKX0KCSAgICAgKiBAcGFyYW0gb2Zmc2V0IHBvc2l0aW9uIGluIGFycmF5IHRvIHN0YXJ0IHdyaXRpbmcKCSAgICAgKiBAcGFyYW0gbnVtQnl0ZXMgaG93IG1hbnkgYnl0ZXMgdG8gd3JpdGUKCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUudG9CeXRlcyA9IGZ1bmN0aW9uIChiaXRPZmZzZXQgLyppbnQqLywgYXJyYXksIG9mZnNldCAvKmludCovLCBudW1CeXRlcyAvKmludCovKSB7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbnVtQnl0ZXM7IGkrKykgewoJICAgICAgICAgICAgdmFyIHRoZUJ5dGUgPSAwOwoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCA4OyBqKyspIHsKCSAgICAgICAgICAgICAgICBpZiAodGhpcy5nZXQoYml0T2Zmc2V0KSkgewoJICAgICAgICAgICAgICAgICAgICB0aGVCeXRlIHw9IDEgPDwgKDcgLSBqKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgYml0T2Zmc2V0Kys7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBhcnJheVtvZmZzZXQgKyBpXSA9IC8qKGJ5dGUpKi8gdGhlQnl0ZTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiB1bmRlcmx5aW5nIGFycmF5IG9mIGludHMuIFRoZSBmaXJzdCBlbGVtZW50IGhvbGRzIHRoZSBmaXJzdCAzMiBiaXRzLCBhbmQgdGhlIGxlYXN0CgkgICAgICogICAgICAgICBzaWduaWZpY2FudCBiaXQgaXMgYml0IDAuCgkgICAgICovCgkgICAgQml0QXJyYXkucHJvdG90eXBlLmdldEJpdEFycmF5ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5iaXRzOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogUmV2ZXJzZXMgYWxsIGJpdHMgaW4gdGhlIGFycmF5LgoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5yZXZlcnNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgbmV3Qml0cyA9IG5ldyBJbnQzMkFycmF5KHRoaXMuYml0cy5sZW5ndGgpOwoJICAgICAgICAvLyByZXZlcnNlIGFsbCBpbnQncyBmaXJzdAoJICAgICAgICB2YXIgbGVuID0gTWF0aC5mbG9vcigodGhpcy5zaXplIC0gMSkgLyAzMik7CgkgICAgICAgIHZhciBvbGRCaXRzTGVuID0gbGVuICsgMTsKCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgb2xkQml0c0xlbjsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgeCA9IGJpdHNbaV07CgkgICAgICAgICAgICB4ID0gKCh4ID4+IDEpICYgMHg1NTU1NTU1NSkgfCAoKHggJiAweDU1NTU1NTU1KSA8PCAxKTsKCSAgICAgICAgICAgIHggPSAoKHggPj4gMikgJiAweDMzMzMzMzMzKSB8ICgoeCAmIDB4MzMzMzMzMzMpIDw8IDIpOwoJICAgICAgICAgICAgeCA9ICgoeCA+PiA0KSAmIDB4MGYwZjBmMGYpIHwgKCh4ICYgMHgwZjBmMGYwZikgPDwgNCk7CgkgICAgICAgICAgICB4ID0gKCh4ID4+IDgpICYgMHgwMGZmMDBmZikgfCAoKHggJiAweDAwZmYwMGZmKSA8PCA4KTsKCSAgICAgICAgICAgIHggPSAoKHggPj4gMTYpICYgMHgwMDAwZmZmZikgfCAoKHggJiAweDAwMDBmZmZmKSA8PCAxNik7CgkgICAgICAgICAgICBuZXdCaXRzW2xlbiAtIGldID0gLyooaW50KSovIHg7CgkgICAgICAgIH0KCSAgICAgICAgLy8gbm93IGNvcnJlY3QgdGhlIGludCdzIGlmIHRoZSBiaXQgc2l6ZSBpc24ndCBhIG11bHRpcGxlIG9mIDMyCgkgICAgICAgIGlmICh0aGlzLnNpemUgIT09IG9sZEJpdHNMZW4gKiAzMikgewoJICAgICAgICAgICAgdmFyIGxlZnRPZmZzZXQgPSBvbGRCaXRzTGVuICogMzIgLSB0aGlzLnNpemU7CgkgICAgICAgICAgICB2YXIgY3VycmVudEludCA9IG5ld0JpdHNbMF0gPj4+IGxlZnRPZmZzZXQ7CgkgICAgICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IG9sZEJpdHNMZW47IGkrKykgewoJICAgICAgICAgICAgICAgIHZhciBuZXh0SW50ID0gbmV3Qml0c1tpXTsKCSAgICAgICAgICAgICAgICBjdXJyZW50SW50IHw9IG5leHRJbnQgPDwgKDMyIC0gbGVmdE9mZnNldCk7CgkgICAgICAgICAgICAgICAgbmV3Qml0c1tpIC0gMV0gPSBjdXJyZW50SW50OwoJICAgICAgICAgICAgICAgIGN1cnJlbnRJbnQgPSBuZXh0SW50ID4+PiBsZWZ0T2Zmc2V0OwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgbmV3Qml0c1tvbGRCaXRzTGVuIC0gMV0gPSBjdXJyZW50SW50OwoJICAgICAgICB9CgkgICAgICAgIHRoaXMuYml0cyA9IG5ld0JpdHM7CgkgICAgfTsKCSAgICBCaXRBcnJheS5tYWtlQXJyYXkgPSBmdW5jdGlvbiAoc2l6ZSAvKmludCovKSB7CgkgICAgICAgIHJldHVybiBuZXcgSW50MzJBcnJheShNYXRoLmZsb29yKChzaXplICsgMzEpIC8gMzIpKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuZXF1YWxzID0gZnVuY3Rpb24gKG8pIHsKCSAgICAgICAgaWYgKCEobyBpbnN0YW5jZW9mIEJpdEFycmF5KSkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHZhciBvdGhlciA9IG87CgkgICAgICAgIHJldHVybiB0aGlzLnNpemUgPT09IG90aGVyLnNpemUgJiYgQXJyYXlzXzEkMS5kZWZhdWx0LmVxdWFscyh0aGlzLmJpdHMsIG90aGVyLmJpdHMpOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5oYXNoQ29kZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIDMxICogdGhpcy5zaXplICsgQXJyYXlzXzEkMS5kZWZhdWx0Lmhhc2hDb2RlKHRoaXMuYml0cyk7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgQml0QXJyYXkucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgcmVzdWx0ID0gJyc7CgkgICAgICAgIGZvciAodmFyIGkgPSAwLCBzaXplID0gdGhpcy5zaXplOyBpIDwgc2l6ZTsgaSsrKSB7CgkgICAgICAgICAgICBpZiAoKGkgJiAweDA3KSA9PT0gMCkgewoJICAgICAgICAgICAgICAgIHJlc3VsdCArPSAnICc7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICByZXN1bHQgKz0gdGhpcy5nZXQoaSkgPyAnWCcgOiAnLic7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuY2xvbmUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiBuZXcgQml0QXJyYXkodGhpcy5zaXplLCB0aGlzLmJpdHMuc2xpY2UoKSk7CgkgICAgfTsKCSAgICByZXR1cm4gQml0QXJyYXk7Cgl9KCkpOwoJQml0QXJyYXkkMS5kZWZhdWx0ID0gQml0QXJyYXk7CgoJdmFyIEJpdE1hdHJpeCQxID0ge307CgoJdmFyIFN0cmluZ0J1aWxkZXIkMSA9IHt9OwoKCXZhciBTdHJpbmdVdGlscyQxID0ge307CgoJdmFyIERlY29kZUhpbnRUeXBlJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDkgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KERlY29kZUhpbnRUeXBlJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcgeyovCgkvKioKCSAqIEVuY2Fwc3VsYXRlcyBhIHR5cGUgb2YgaGludCB0aGF0IGEgY2FsbGVyIG1heSBwYXNzIHRvIGEgYmFyY29kZSByZWFkZXIgdG8gaGVscCBpdAoJICogbW9yZSBxdWlja2x5IG9yIGFjY3VyYXRlbHkgZGVjb2RlIGl0LiBJdCBpcyB1cCB0byBpbXBsZW1lbnRhdGlvbnMgdG8gZGVjaWRlIHdoYXQsCgkgKiBpZiBhbnl0aGluZywgdG8gZG8gd2l0aCB0aGUgaW5mb3JtYXRpb24gdGhhdCBpcyBzdXBwbGllZC4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqIEBzZWUgUmVhZGVyI2RlY29kZShCaW5hcnlCaXRtYXAsamF2YS51dGlsLk1hcCkKCSAqLwoJdmFyIERlY29kZUhpbnRUeXBlOwoJKGZ1bmN0aW9uIChEZWNvZGVIaW50VHlwZSkgewoJICAgIC8qKgoJICAgICAqIFVuc3BlY2lmaWVkLCBhcHBsaWNhdGlvbi1zcGVjaWZpYyBoaW50LiBNYXBzIHRvIGFuIHVuc3BlY2lmaWVkIHtAbGluayBPYmplY3R9LgoJICAgICAqLwoJICAgIERlY29kZUhpbnRUeXBlW0RlY29kZUhpbnRUeXBlWyJPVEhFUiJdID0gMF0gPSAiT1RIRVIiOyAvKihPYmplY3QuY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBJbWFnZSBpcyBhIHB1cmUgbW9ub2Nocm9tZSBpbWFnZSBvZiBhIGJhcmNvZGUuIERvZXNuJ3QgbWF0dGVyIHdoYXQgaXQgbWFwcyB0bzsKCSAgICAgKiB1c2Uge0BsaW5rIEJvb2xlYW4jVFJVRX0uCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIlBVUkVfQkFSQ09ERSJdID0gMV0gPSAiUFVSRV9CQVJDT0RFIjsgLyooVm9pZC5jbGFzcykqLwoJICAgIC8qKgoJICAgICAqIEltYWdlIGlzIGtub3duIHRvIGJlIG9mIG9uZSBvZiBhIGZldyBwb3NzaWJsZSBmb3JtYXRzLgoJICAgICAqIE1hcHMgdG8gYSB7QGxpbmsgTGlzdH0gb2Yge0BsaW5rIEJhcmNvZGVGb3JtYXR9cy4KCSAgICAgKi8KCSAgICBEZWNvZGVIaW50VHlwZVtEZWNvZGVIaW50VHlwZVsiUE9TU0lCTEVfRk9STUFUUyJdID0gMl0gPSAiUE9TU0lCTEVfRk9STUFUUyI7IC8qKExpc3QuY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBTcGVuZCBtb3JlIHRpbWUgdG8gdHJ5IHRvIGZpbmQgYSBiYXJjb2RlOyBvcHRpbWl6ZSBmb3IgYWNjdXJhY3ksIG5vdCBzcGVlZC4KCSAgICAgKiBEb2Vzbid0IG1hdHRlciB3aGF0IGl0IG1hcHMgdG87IHVzZSB7QGxpbmsgQm9vbGVhbiNUUlVFfS4KCSAgICAgKi8KCSAgICBEZWNvZGVIaW50VHlwZVtEZWNvZGVIaW50VHlwZVsiVFJZX0hBUkRFUiJdID0gM10gPSAiVFJZX0hBUkRFUiI7IC8qKFZvaWQuY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBTcGVjaWZpZXMgd2hhdCBjaGFyYWN0ZXIgZW5jb2RpbmcgdG8gdXNlIHdoZW4gZGVjb2RpbmcsIHdoZXJlIGFwcGxpY2FibGUgKHR5cGUgU3RyaW5nKQoJICAgICAqLwoJICAgIERlY29kZUhpbnRUeXBlW0RlY29kZUhpbnRUeXBlWyJDSEFSQUNURVJfU0VUIl0gPSA0XSA9ICJDSEFSQUNURVJfU0VUIjsgLyooU3RyaW5nLmNsYXNzKSovCgkgICAgLyoqCgkgICAgICogQWxsb3dlZCBsZW5ndGhzIG9mIGVuY29kZWQgZGF0YSAtLSByZWplY3QgYW55dGhpbmcgZWxzZS4gTWFwcyB0byBhbiB7QGNvZGUgSW50MzJBcnJheX0uCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIkFMTE9XRURfTEVOR1RIUyJdID0gNV0gPSAiQUxMT1dFRF9MRU5HVEhTIjsgLyooSW50MzJBcnJheS5jbGFzcykqLwoJICAgIC8qKgoJICAgICAqIEFzc3VtZSBDb2RlIDM5IGNvZGVzIGVtcGxveSBhIGNoZWNrIGRpZ2l0LiBEb2Vzbid0IG1hdHRlciB3aGF0IGl0IG1hcHMgdG87CgkgICAgICogdXNlIHtAbGluayBCb29sZWFuI1RSVUV9LgoJICAgICAqLwoJICAgIERlY29kZUhpbnRUeXBlW0RlY29kZUhpbnRUeXBlWyJBU1NVTUVfQ09ERV8zOV9DSEVDS19ESUdJVCJdID0gNl0gPSAiQVNTVU1FX0NPREVfMzlfQ0hFQ0tfRElHSVQiOyAvKihWb2lkLmNsYXNzKSovCgkgICAgLyoqCgkgICAgICogQXNzdW1lIHRoZSBiYXJjb2RlIGlzIGJlaW5nIHByb2Nlc3NlZCBhcyBhIEdTMSBiYXJjb2RlLCBhbmQgbW9kaWZ5IGJlaGF2aW9yIGFzIG5lZWRlZC4KCSAgICAgKiBGb3IgZXhhbXBsZSB0aGlzIGFmZmVjdHMgRk5DMSBoYW5kbGluZyBmb3IgQ29kZSAxMjggKGFrYSBHUzEtMTI4KS4gRG9lc24ndCBtYXR0ZXIgd2hhdCBpdCBtYXBzIHRvOwoJICAgICAqIHVzZSB7QGxpbmsgQm9vbGVhbiNUUlVFfS4KCSAgICAgKi8KCSAgICBEZWNvZGVIaW50VHlwZVtEZWNvZGVIaW50VHlwZVsiQVNTVU1FX0dTMSJdID0gN10gPSAiQVNTVU1FX0dTMSI7IC8qKFZvaWQuY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBJZiB0cnVlLCByZXR1cm4gdGhlIHN0YXJ0IGFuZCBlbmQgZGlnaXRzIGluIGEgQ29kYWJhciBiYXJjb2RlIGluc3RlYWQgb2Ygc3RyaXBwaW5nIHRoZW0uIFRoZXkKCSAgICAgKiBhcmUgYWxwaGEsIHdoZXJlYXMgdGhlIHJlc3QgYXJlIG51bWVyaWMuIEJ5IGRlZmF1bHQsIHRoZXkgYXJlIHN0cmlwcGVkLCBidXQgdGhpcyBjYXVzZXMgdGhlbQoJICAgICAqIHRvIG5vdCBiZS4gRG9lc24ndCBtYXR0ZXIgd2hhdCBpdCBtYXBzIHRvOyB1c2Uge0BsaW5rIEJvb2xlYW4jVFJVRX0uCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIlJFVFVSTl9DT0RBQkFSX1NUQVJUX0VORCJdID0gOF0gPSAiUkVUVVJOX0NPREFCQVJfU1RBUlRfRU5EIjsgLyooVm9pZC5jbGFzcykqLwoJICAgIC8qKgoJICAgICAqIFRoZSBjYWxsZXIgbmVlZHMgdG8gYmUgbm90aWZpZWQgdmlhIGNhbGxiYWNrIHdoZW4gYSBwb3NzaWJsZSB7QGxpbmsgUmVzdWx0UG9pbnR9CgkgICAgICogaXMgZm91bmQuIE1hcHMgdG8gYSB7QGxpbmsgUmVzdWx0UG9pbnRDYWxsYmFja30uCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIk5FRURfUkVTVUxUX1BPSU5UX0NBTExCQUNLIl0gPSA5XSA9ICJORUVEX1JFU1VMVF9QT0lOVF9DQUxMQkFDSyI7IC8qKFJlc3VsdFBvaW50Q2FsbGJhY2suY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBBbGxvd2VkIGV4dGVuc2lvbiBsZW5ndGhzIGZvciBFQU4gb3IgVVBDIGJhcmNvZGVzLiBPdGhlciBmb3JtYXRzIHdpbGwgaWdub3JlIHRoaXMuCgkgICAgICogTWFwcyB0byBhbiB7QGNvZGUgSW50MzJBcnJheX0gb2YgdGhlIGFsbG93ZWQgZXh0ZW5zaW9uIGxlbmd0aHMsIGZvciBleGFtcGxlIFsyXSwgWzVdLCBvciBbMiwgNV0uCgkgICAgICogSWYgaXQgaXMgb3B0aW9uYWwgdG8gaGF2ZSBhbiBleHRlbnNpb24sIGRvIG5vdCBzZXQgdGhpcyBoaW50LiBJZiB0aGlzIGlzIHNldCwKCSAgICAgKiBhbmQgYSBVUEMgb3IgRUFOIGJhcmNvZGUgaXMgZm91bmQgYnV0IGFuIGV4dGVuc2lvbiBpcyBub3QsIHRoZW4gbm8gcmVzdWx0IHdpbGwgYmUgcmV0dXJuZWQKCSAgICAgKiBhdCBhbGwuCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIkFMTE9XRURfRUFOX0VYVEVOU0lPTlMiXSA9IDEwXSA9ICJBTExPV0VEX0VBTl9FWFRFTlNJT05TIjsgLyooSW50MzJBcnJheS5jbGFzcykqLwoJICAgIC8vIEVuZCBvZiBlbnVtZXJhdGlvbiB2YWx1ZXMuCgkgICAgLyoqCgkgICAgICogRGF0YSB0eXBlIHRoZSBoaW50IGlzIGV4cGVjdGluZy4KCSAgICAgKiBBbW9uZyB0aGUgcG9zc2libGUgdmFsdWVzIHRoZSB7QGxpbmsgVm9pZH0gc3RhbmRzIG91dCBhcyBiZWluZyB1c2VkIGZvcgoJICAgICAqIGhpbnRzIHRoYXQgZG8gbm90IGV4cGVjdCBhIHZhbHVlIHRvIGJlIHN1cHBsaWVkIChmbGFnIGhpbnRzKS4gU3VjaCBoaW50cwoJICAgICAqIHdpbGwgcG9zc2libHkgaGF2ZSB0aGVpciB2YWx1ZSBpZ25vcmVkLCBvciByZXBsYWNlZCBieSBhCgkgICAgICoge0BsaW5rIEJvb2xlYW4jVFJVRX0uIEhpbnQgc3VwcGxpZXJzIHNob3VsZCBwcm9iYWJseSB1c2UKCSAgICAgKiB7QGxpbmsgQm9vbGVhbiNUUlVFfSBhcyBkaXJlY3RlZCBieSB0aGUgYWN0dWFsIGhpbnQgZG9jdW1lbnRhdGlvbi4KCSAgICAgKi8KCSAgICAvLyBwcml2YXRlIHZhbHVlVHlwZTogQ2xhc3M8Pz4KCSAgICAvLyBEZWNvZGVIaW50VHlwZSh2YWx1ZVR5cGU6IENsYXNzPD8+KSB7CgkgICAgLy8gICB0aGlzLnZhbHVlVHlwZSA9IHZhbHVlVHlwZQoJICAgIC8vIH0KCSAgICAvLyBwdWJsaWMgZ2V0VmFsdWVUeXBlKCk6IENsYXNzPD8+IHsKCSAgICAvLyAgIHJldHVybiB2YWx1ZVR5cGUKCSAgICAvLyB9Cgl9KShEZWNvZGVIaW50VHlwZSB8fCAoRGVjb2RlSGludFR5cGUgPSB7fSkpOwoJRGVjb2RlSGludFR5cGUkMS5kZWZhdWx0ID0gRGVjb2RlSGludFR5cGU7CgoJdmFyIENoYXJhY3RlclNldEVDSSA9IHt9OwoKCXZhciBGb3JtYXRFeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkZiA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShGb3JtYXRFeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIEV4Y2VwdGlvbl8xJDcgPSBFeGNlcHRpb24kMTsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgRm9ybWF0RXhjZXB0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyRmKEZvcm1hdEV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBGb3JtYXRFeGNlcHRpb24oKSB7CgkgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsKCSAgICB9CgkgICAgRm9ybWF0RXhjZXB0aW9uLmdldEZvcm1hdEluc3RhbmNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IEZvcm1hdEV4Y2VwdGlvbigpOwoJICAgIH07CgkgICAgRm9ybWF0RXhjZXB0aW9uLmtpbmQgPSAnRm9ybWF0RXhjZXB0aW9uJzsKCSAgICByZXR1cm4gRm9ybWF0RXhjZXB0aW9uOwoJfShFeGNlcHRpb25fMSQ3LmRlZmF1bHQpKTsKCUZvcm1hdEV4Y2VwdGlvbiQxLmRlZmF1bHQgPSBGb3JtYXRFeGNlcHRpb247CgoJKGZ1bmN0aW9uIChleHBvcnRzKSB7CgkvKgoJICogQ29weXJpZ2h0IDIwMDggWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fdmFsdWVzKSB8fCBmdW5jdGlvbihvKSB7CgkgICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7CgkgICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7CgkgICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSAibnVtYmVyIikgcmV0dXJuIHsKCSAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDsKCSAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gIk9iamVjdCBpcyBub3QgaXRlcmFibGUuIiA6ICJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuIik7Cgl9OwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCWV4cG9ydHMuQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycyA9IHZvaWQgMDsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJdmFyIEZvcm1hdEV4Y2VwdGlvbl8xID0gRm9ybWF0RXhjZXB0aW9uJDE7CgkvKmltcG9ydCBqYXZhLnV0aWwuSGFzaE1hcDsqLwoJLyppbXBvcnQgamF2YS51dGlsLk1hcDsqLwoJdmFyIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnM7CgkoZnVuY3Rpb24gKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMpIHsKCSAgICBDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzW0NoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbIkNwNDM3Il0gPSAwXSA9ICJDcDQzNyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzEiXSA9IDFdID0gIklTTzg4NTlfMSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzIiXSA9IDJdID0gIklTTzg4NTlfMiI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzMiXSA9IDNdID0gIklTTzg4NTlfMyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzQiXSA9IDRdID0gIklTTzg4NTlfNCI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzUiXSA9IDVdID0gIklTTzg4NTlfNSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzYiXSA9IDZdID0gIklTTzg4NTlfNiI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzciXSA9IDddID0gIklTTzg4NTlfNyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzgiXSA9IDhdID0gIklTTzg4NTlfOCI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzkiXSA9IDldID0gIklTTzg4NTlfOSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzEwIl0gPSAxMF0gPSAiSVNPODg1OV8xMCI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzExIl0gPSAxMV0gPSAiSVNPODg1OV8xMSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzEzIl0gPSAxMl0gPSAiSVNPODg1OV8xMyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzE0Il0gPSAxM10gPSAiSVNPODg1OV8xNCI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzE1Il0gPSAxNF0gPSAiSVNPODg1OV8xNSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzE2Il0gPSAxNV0gPSAiSVNPODg1OV8xNiI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJTSklTIl0gPSAxNl0gPSAiU0pJUyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJDcDEyNTAiXSA9IDE3XSA9ICJDcDEyNTAiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siQ3AxMjUxIl0gPSAxOF0gPSAiQ3AxMjUxIjsKCSAgICBDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzW0NoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbIkNwMTI1MiJdID0gMTldID0gIkNwMTI1MiI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJDcDEyNTYiXSA9IDIwXSA9ICJDcDEyNTYiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siVW5pY29kZUJpZ1VubWFya2VkIl0gPSAyMV0gPSAiVW5pY29kZUJpZ1VubWFya2VkIjsKCSAgICBDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzW0NoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbIlVURjgiXSA9IDIyXSA9ICJVVEY4IjsKCSAgICBDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzW0NoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbIkFTQ0lJIl0gPSAyM10gPSAiQVNDSUkiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siQmlnNSJdID0gMjRdID0gIkJpZzUiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siR0IxODAzMCJdID0gMjVdID0gIkdCMTgwMzAiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siRVVDX0tSIl0gPSAyNl0gPSAiRVVDX0tSIjsKCX0pKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMgPSBleHBvcnRzLkNoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMgfHwgKGV4cG9ydHMuQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycyA9IHt9KSk7CgkvKioKCSAqIEVuY2Fwc3VsYXRlcyBhIENoYXJhY3RlciBTZXQgRUNJLCBhY2NvcmRpbmcgdG8gIkV4dGVuZGVkIENoYW5uZWwgSW50ZXJwcmV0YXRpb25zIiA1LjMuMS4xCgkgKiBvZiBJU08gMTgwMDQuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIENoYXJhY3RlclNldEVDSSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBDaGFyYWN0ZXJTZXRFQ0kodmFsdWVJZGVudGlmaWVyLCB2YWx1ZXNQYXJhbSwgbmFtZSkgewoJICAgICAgICB2YXIgZV8xLCBfYTsKCSAgICAgICAgdmFyIG90aGVyRW5jb2RpbmdOYW1lcyA9IFtdOwoJICAgICAgICBmb3IgKHZhciBfaSA9IDM7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykgewoJICAgICAgICAgICAgb3RoZXJFbmNvZGluZ05hbWVzW19pIC0gM10gPSBhcmd1bWVudHNbX2ldOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMudmFsdWVJZGVudGlmaWVyID0gdmFsdWVJZGVudGlmaWVyOwoJICAgICAgICB0aGlzLm5hbWUgPSBuYW1lOwoJICAgICAgICBpZiAodHlwZW9mIHZhbHVlc1BhcmFtID09PSAnbnVtYmVyJykgewoJICAgICAgICAgICAgdGhpcy52YWx1ZXMgPSBJbnQzMkFycmF5LmZyb20oW3ZhbHVlc1BhcmFtXSk7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICB0aGlzLnZhbHVlcyA9IHZhbHVlc1BhcmFtOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMub3RoZXJFbmNvZGluZ05hbWVzID0gb3RoZXJFbmNvZGluZ05hbWVzOwoJICAgICAgICBDaGFyYWN0ZXJTZXRFQ0kuVkFMVUVfSURFTlRJRklFUl9UT19FQ0kuc2V0KHZhbHVlSWRlbnRpZmllciwgdGhpcyk7CgkgICAgICAgIENoYXJhY3RlclNldEVDSS5OQU1FX1RPX0VDSS5zZXQobmFtZSwgdGhpcyk7CgkgICAgICAgIHZhciB2YWx1ZXMgPSB0aGlzLnZhbHVlczsKCSAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aF8xID0gdmFsdWVzLmxlbmd0aDsgaSAhPT0gbGVuZ3RoXzE7IGkrKykgewoJICAgICAgICAgICAgdmFyIHYgPSB2YWx1ZXNbaV07CgkgICAgICAgICAgICBDaGFyYWN0ZXJTZXRFQ0kuVkFMVUVTX1RPX0VDSS5zZXQodiwgdGhpcyk7CgkgICAgICAgIH0KCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIGZvciAodmFyIG90aGVyRW5jb2RpbmdOYW1lc18xID0gX192YWx1ZXMob3RoZXJFbmNvZGluZ05hbWVzKSwgb3RoZXJFbmNvZGluZ05hbWVzXzFfMSA9IG90aGVyRW5jb2RpbmdOYW1lc18xLm5leHQoKTsgIW90aGVyRW5jb2RpbmdOYW1lc18xXzEuZG9uZTsgb3RoZXJFbmNvZGluZ05hbWVzXzFfMSA9IG90aGVyRW5jb2RpbmdOYW1lc18xLm5leHQoKSkgewoJICAgICAgICAgICAgICAgIHZhciBvdGhlck5hbWUgPSBvdGhlckVuY29kaW5nTmFtZXNfMV8xLnZhbHVlOwoJICAgICAgICAgICAgICAgIENoYXJhY3RlclNldEVDSS5OQU1FX1RPX0VDSS5zZXQob3RoZXJOYW1lLCB0aGlzKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZV8xXzEpIHsgZV8xID0geyBlcnJvcjogZV8xXzEgfTsgfQoJICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgaWYgKG90aGVyRW5jb2RpbmdOYW1lc18xXzEgJiYgIW90aGVyRW5jb2RpbmdOYW1lc18xXzEuZG9uZSAmJiAoX2EgPSBvdGhlckVuY29kaW5nTmFtZXNfMS5yZXR1cm4pKSBfYS5jYWxsKG90aGVyRW5jb2RpbmdOYW1lc18xKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8xKSB0aHJvdyBlXzEuZXJyb3I7IH0KCSAgICAgICAgfQoJICAgIH0KCSAgICAvLyBDaGFyYWN0ZXJTZXRFQ0kodmFsdWU6IG51bWJlciAvKmludCovKSB7CgkgICAgLy8gICB0aGlzKG5ldyBJbnQzMkFycmF5IHt2YWx1ZX0pCgkgICAgLy8gfQoJICAgIC8vIENoYXJhY3RlclNldEVDSSh2YWx1ZTogbnVtYmVyIC8qaW50Ki8sIFN0cmluZy4uLiBvdGhlckVuY29kaW5nTmFtZXMpIHsKCSAgICAvLyAgIHRoaXMudmFsdWVzID0gbmV3IEludDMyQXJyYXkge3ZhbHVlfQoJICAgIC8vICAgdGhpcy5vdGhlckVuY29kaW5nTmFtZXMgPSBvdGhlckVuY29kaW5nTmFtZXMKCSAgICAvLyB9CgkgICAgLy8gQ2hhcmFjdGVyU2V0RUNJKHZhbHVlczogSW50MzJBcnJheSwgU3RyaW5nLi4uIG90aGVyRW5jb2RpbmdOYW1lcykgewoJICAgIC8vICAgdGhpcy52YWx1ZXMgPSB2YWx1ZXMKCSAgICAvLyAgIHRoaXMub3RoZXJFbmNvZGluZ05hbWVzID0gb3RoZXJFbmNvZGluZ05hbWVzCgkgICAgLy8gfQoJICAgIENoYXJhY3RlclNldEVDSS5wcm90b3R5cGUuZ2V0VmFsdWVJZGVudGlmaWVyID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZUlkZW50aWZpZXI7CgkgICAgfTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kucHJvdG90eXBlLmdldE5hbWUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm5hbWU7CgkgICAgfTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kucHJvdG90eXBlLmdldFZhbHVlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZXNbMF07CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gdmFsdWUgY2hhcmFjdGVyIHNldCBFQ0kgdmFsdWUKCSAgICAgKiBAcmV0dXJuIHtAY29kZSBDaGFyYWN0ZXJTZXRFQ0l9IHJlcHJlc2VudGluZyBFQ0kgb2YgZ2l2ZW4gdmFsdWUsIG9yIG51bGwgaWYgaXQgaXMgbGVnYWwgYnV0CgkgICAgICogICB1bnN1cHBvcnRlZAoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIEVDSSB2YWx1ZSBpcyBpbnZhbGlkCgkgICAgICovCgkgICAgQ2hhcmFjdGVyU2V0RUNJLmdldENoYXJhY3RlclNldEVDSUJ5VmFsdWUgPSBmdW5jdGlvbiAodmFsdWUgLyppbnQqLykgewoJICAgICAgICBpZiAodmFsdWUgPCAwIHx8IHZhbHVlID49IDkwMCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoJ2luY29yZWN0IHZhbHVlJyk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGNoYXJhY3RlclNldCA9IENoYXJhY3RlclNldEVDSS5WQUxVRVNfVE9fRUNJLmdldCh2YWx1ZSk7CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IGNoYXJhY3RlclNldCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoJ2luY29yZWN0IHZhbHVlJyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGNoYXJhY3RlclNldDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBuYW1lIGNoYXJhY3RlciBzZXQgRUNJIGVuY29kaW5nIG5hbWUKCSAgICAgKiBAcmV0dXJuIENoYXJhY3RlclNldEVDSSByZXByZXNlbnRpbmcgRUNJIGZvciBjaGFyYWN0ZXIgZW5jb2RpbmcsIG9yIG51bGwgaWYgaXQgaXMgbGVnYWwKCSAgICAgKiAgIGJ1dCB1bnN1cHBvcnRlZAoJICAgICAqLwoJICAgIENoYXJhY3RlclNldEVDSS5nZXRDaGFyYWN0ZXJTZXRFQ0lCeU5hbWUgPSBmdW5jdGlvbiAobmFtZSkgewoJICAgICAgICB2YXIgY2hhcmFjdGVyU2V0ID0gQ2hhcmFjdGVyU2V0RUNJLk5BTUVfVE9fRUNJLmdldChuYW1lKTsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gY2hhcmFjdGVyU2V0KSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgnaW5jb3JlY3QgdmFsdWUnKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gY2hhcmFjdGVyU2V0OwoJICAgIH07CgkgICAgQ2hhcmFjdGVyU2V0RUNJLnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAobykgewoJICAgICAgICBpZiAoIShvIGluc3RhbmNlb2YgQ2hhcmFjdGVyU2V0RUNJKSkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHZhciBvdGhlciA9IG87CgkgICAgICAgIHJldHVybiB0aGlzLmdldE5hbWUoKSA9PT0gb3RoZXIuZ2V0TmFtZSgpOwoJICAgIH07CgkgICAgQ2hhcmFjdGVyU2V0RUNJLlZBTFVFX0lERU5USUZJRVJfVE9fRUNJID0gbmV3IE1hcCgpOwoJICAgIENoYXJhY3RlclNldEVDSS5WQUxVRVNfVE9fRUNJID0gbmV3IE1hcCgpOwoJICAgIENoYXJhY3RlclNldEVDSS5OQU1FX1RPX0VDSSA9IG5ldyBNYXAoKTsKCSAgICAvLyBFbnVtIG5hbWUgaXMgYSBKYXZhIGVuY29kaW5nIHZhbGlkIGZvciBqYXZhLmxhbmcgYW5kIGphdmEuaW8KCSAgICAvLyBUWVBFU0NSSVBUUE9SVDogY2hhbmdlZCB0aGUgbWFpbiBsYWJlbCBmb3IgSVNPIGFzIHRoZSBUZXh0RW5jb2RlciBkaWQgbm90IHJlY29nbml6ZWQgdGhlbSBpbiB0aGUgZm9ybSBmcm9tIGphdmEKCSAgICAvLyAoZWcgSVNPODg1OV8xIG11c3QgYmUgSVNPODg1OTEgb3IgSVNPODg1OS0xIG9yIElTTy04ODU5LTEpCgkgICAgLy8gbGF0ZXIgb246IHdlbGwsIGV4Y2VwdCAxNiB3aWNoIGRvZXMgbm90IHdvcmsgd2l0aCBJU084ODU5MTYgc28gdXNlZCBJU08tODg1OS0xIGZvcm0gZm9yIGRlZmF1bHQKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuQ3A0MzcgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuQ3A0MzcsIEludDMyQXJyYXkuZnJvbShbMCwgMl0pLCAnQ3A0MzcnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV8xID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfMSwgSW50MzJBcnJheS5mcm9tKFsxLCAzXSksICdJU08tODg1OS0xJywgJ0lTTzg4NTkxJywgJ0lTTzg4NTlfMScpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzIgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV8yLCA0LCAnSVNPLTg4NTktMicsICdJU084ODU5MicsICdJU084ODU5XzInKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV8zID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfMywgNSwgJ0lTTy04ODU5LTMnLCAnSVNPODg1OTMnLCAnSVNPODg1OV8zJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfNCA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzQsIDYsICdJU08tODg1OS00JywgJ0lTTzg4NTk0JywgJ0lTTzg4NTlfNCcpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzUgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV81LCA3LCAnSVNPLTg4NTktNScsICdJU084ODU5NScsICdJU084ODU5XzUnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV82ID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfNiwgOCwgJ0lTTy04ODU5LTYnLCAnSVNPODg1OTYnLCAnSVNPODg1OV82Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfNyA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzcsIDksICdJU08tODg1OS03JywgJ0lTTzg4NTk3JywgJ0lTTzg4NTlfNycpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzggPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV84LCAxMCwgJ0lTTy04ODU5LTgnLCAnSVNPODg1OTgnLCAnSVNPODg1OV84Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfOSA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzksIDExLCAnSVNPLTg4NTktOScsICdJU084ODU5OScsICdJU084ODU5XzknKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV8xMCA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzEwLCAxMiwgJ0lTTy04ODU5LTEwJywgJ0lTTzg4NTkxMCcsICdJU084ODU5XzEwJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfMTEgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV8xMSwgMTMsICdJU08tODg1OS0xMScsICdJU084ODU5MTEnLCAnSVNPODg1OV8xMScpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzEzID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfMTMsIDE1LCAnSVNPLTg4NTktMTMnLCAnSVNPODg1OTEzJywgJ0lTTzg4NTlfMTMnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV8xNCA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzE0LCAxNiwgJ0lTTy04ODU5LTE0JywgJ0lTTzg4NTkxNCcsICdJU084ODU5XzE0Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfMTUgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV8xNSwgMTcsICdJU08tODg1OS0xNScsICdJU084ODU5MTUnLCAnSVNPODg1OV8xNScpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzE2ID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfMTYsIDE4LCAnSVNPLTg4NTktMTYnLCAnSVNPODg1OTE2JywgJ0lTTzg4NTlfMTYnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuU0pJUyA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5TSklTLCAyMCwgJ1NKSVMnLCAnU2hpZnRfSklTJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkNwMTI1MCA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5DcDEyNTAsIDIxLCAnQ3AxMjUwJywgJ3dpbmRvd3MtMTI1MCcpOwoJICAgIENoYXJhY3RlclNldEVDSS5DcDEyNTEgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuQ3AxMjUxLCAyMiwgJ0NwMTI1MScsICd3aW5kb3dzLTEyNTEnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuQ3AxMjUyID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLkNwMTI1MiwgMjMsICdDcDEyNTInLCAnd2luZG93cy0xMjUyJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkNwMTI1NiA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5DcDEyNTYsIDI0LCAnQ3AxMjU2JywgJ3dpbmRvd3MtMTI1NicpOwoJICAgIENoYXJhY3RlclNldEVDSS5Vbmljb2RlQmlnVW5tYXJrZWQgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuVW5pY29kZUJpZ1VubWFya2VkLCAyNSwgJ1VuaWNvZGVCaWdVbm1hcmtlZCcsICdVVEYtMTZCRScsICdVbmljb2RlQmlnJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLlVURjggPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuVVRGOCwgMjYsICdVVEY4JywgJ1VURi04Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkFTQ0lJID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLkFTQ0lJLCBJbnQzMkFycmF5LmZyb20oWzI3LCAxNzBdKSwgJ0FTQ0lJJywgJ1VTLUFTQ0lJJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkJpZzUgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuQmlnNSwgMjgsICdCaWc1Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkdCMTgwMzAgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuR0IxODAzMCwgMjksICdHQjE4MDMwJywgJ0dCMjMxMicsICdFVUNfQ04nLCAnR0JLJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkVVQ19LUiA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5FVUNfS1IsIDMwLCAnRVVDX0tSJywgJ0VVQy1LUicpOwoJICAgIHJldHVybiBDaGFyYWN0ZXJTZXRFQ0k7Cgl9KCkpOwoJZXhwb3J0cy5kZWZhdWx0ID0gQ2hhcmFjdGVyU2V0RUNJOwoKCX0oQ2hhcmFjdGVyU2V0RUNJKSk7CgoJdmFyIFN0cmluZ0VuY29kaW5nJDEgPSB7fTsKCgl2YXIgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkZSA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgRXhjZXB0aW9uXzEkNiA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkZShVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbi5raW5kID0gJ1Vuc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xJDYuZGVmYXVsdCkpOwoJVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb24kMS5kZWZhdWx0ID0gVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb247CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFN0cmluZ0VuY29kaW5nJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbl8xJDEgPSBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbiQxOwoJdmFyIENoYXJhY3RlclNldEVDSV8xJDIgPSBDaGFyYWN0ZXJTZXRFQ0k7CgkvKioKCSAqIFJlc3BvbnNpYmxlIGZvciBlbi9kZWNvZGluZyBzdHJpbmdzLgoJICovCgl2YXIgU3RyaW5nRW5jb2RpbmcgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gU3RyaW5nRW5jb2RpbmcoKSB7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIERlY29kZXMgc29tZSBVaW50OEFycmF5IHRvIGEgc3RyaW5nIGZvcm1hdC4KCSAgICAgKi8KCSAgICBTdHJpbmdFbmNvZGluZy5kZWNvZGUgPSBmdW5jdGlvbiAoYnl0ZXMsIGVuY29kaW5nKSB7CgkgICAgICAgIHZhciBlbmNvZGluZ05hbWUgPSB0aGlzLmVuY29kaW5nTmFtZShlbmNvZGluZyk7CgkgICAgICAgIGlmICh0aGlzLmN1c3RvbURlY29kZXIpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLmN1c3RvbURlY29kZXIoYnl0ZXMsIGVuY29kaW5nTmFtZSk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gSW5jcmVhc2VzIGJyb3dzZXIgc3VwcG9ydC4KCSAgICAgICAgaWYgKHR5cGVvZiBUZXh0RGVjb2RlciA9PT0gJ3VuZGVmaW5lZCcgfHwgdGhpcy5zaG91bGREZWNvZGVPbkZhbGxiYWNrKGVuY29kaW5nTmFtZSkpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLmRlY29kZUZhbGxiYWNrKGJ5dGVzLCBlbmNvZGluZ05hbWUpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgVGV4dERlY29kZXIoZW5jb2RpbmdOYW1lKS5kZWNvZGUoYnl0ZXMpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQ2hlY2tzIGlmIHRoZSBkZWNvZGluZyBtZXRob2Qgc2hvdWxkIHVzZSB0aGUgZmFsbGJhY2sgZm9yIGRlY29kaW5nCgkgICAgICogb25jZSBOb2RlIFRleHREZWNvZGVyIGRvZXNuJ3Qgc3VwcG9ydCBhbGwgZW5jb2RpbmcgZm9ybWF0cy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBlbmNvZGluZ05hbWUKCSAgICAgKi8KCSAgICBTdHJpbmdFbmNvZGluZy5zaG91bGREZWNvZGVPbkZhbGxiYWNrID0gZnVuY3Rpb24gKGVuY29kaW5nTmFtZSkgewoJICAgICAgICByZXR1cm4gIVN0cmluZ0VuY29kaW5nLmlzQnJvd3NlcigpICYmIGVuY29kaW5nTmFtZSA9PT0gJ0lTTy04ODU5LTEnOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogRW5jb2RlcyBzb21lIHN0cmluZyBpbnRvIGEgVWludDhBcnJheS4KCSAgICAgKi8KCSAgICBTdHJpbmdFbmNvZGluZy5lbmNvZGUgPSBmdW5jdGlvbiAocywgZW5jb2RpbmcpIHsKCSAgICAgICAgdmFyIGVuY29kaW5nTmFtZSA9IHRoaXMuZW5jb2RpbmdOYW1lKGVuY29kaW5nKTsKCSAgICAgICAgaWYgKHRoaXMuY3VzdG9tRW5jb2RlcikgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMuY3VzdG9tRW5jb2RlcihzLCBlbmNvZGluZ05hbWUpOwoJICAgICAgICB9CgkgICAgICAgIC8vIEluY3JlYXNlcyBicm93c2VyIHN1cHBvcnQuCgkgICAgICAgIGlmICh0eXBlb2YgVGV4dEVuY29kZXIgPT09ICd1bmRlZmluZWQnKSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5lbmNvZGVGYWxsYmFjayhzKTsKCSAgICAgICAgfQoJICAgICAgICAvLyBUZXh0RW5jb2RlciBvbmx5IGVuY29kZXMgdG8gVVRGOCBieSBkZWZhdWx0IGFzIHNwZWNpZmllZCBieSBlbmNvZGluZy5zcGVjLndoYXR3Zy5vcmcKCSAgICAgICAgcmV0dXJuIG5ldyBUZXh0RW5jb2RlcigpLmVuY29kZShzKTsKCSAgICB9OwoJICAgIFN0cmluZ0VuY29kaW5nLmlzQnJvd3NlciA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB7fS50b1N0cmluZy5jYWxsKHdpbmRvdykgPT09ICdbb2JqZWN0IFdpbmRvd10nKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgdGhlIHN0cmluZyB2YWx1ZSBmcm9tIHNvbWUgZW5jb2RpbmcgY2hhcmFjdGVyIHNldC4KCSAgICAgKi8KCSAgICBTdHJpbmdFbmNvZGluZy5lbmNvZGluZ05hbWUgPSBmdW5jdGlvbiAoZW5jb2RpbmcpIHsKCSAgICAgICAgcmV0dXJuIHR5cGVvZiBlbmNvZGluZyA9PT0gJ3N0cmluZycKCSAgICAgICAgICAgID8gZW5jb2RpbmcKCSAgICAgICAgICAgIDogZW5jb2RpbmcuZ2V0TmFtZSgpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogUmV0dXJucyBjaGFyYWN0ZXIgc2V0IGZyb20gc29tZSBlbmNvZGluZyBjaGFyYWN0ZXIgc2V0LgoJICAgICAqLwoJICAgIFN0cmluZ0VuY29kaW5nLmVuY29kaW5nQ2hhcmFjdGVyU2V0ID0gZnVuY3Rpb24gKGVuY29kaW5nKSB7CgkgICAgICAgIGlmIChlbmNvZGluZyBpbnN0YW5jZW9mIENoYXJhY3RlclNldEVDSV8xJDIuZGVmYXVsdCkgewoJICAgICAgICAgICAgcmV0dXJuIGVuY29kaW5nOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBDaGFyYWN0ZXJTZXRFQ0lfMSQyLmRlZmF1bHQuZ2V0Q2hhcmFjdGVyU2V0RUNJQnlOYW1lKGVuY29kaW5nKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJ1bnMgYSBmYWxsYmFjayBmb3IgdGhlIG5hdGl2ZSBkZWNvZGluZyBmdW5jaW9uLgoJICAgICAqLwoJICAgIFN0cmluZ0VuY29kaW5nLmRlY29kZUZhbGxiYWNrID0gZnVuY3Rpb24gKGJ5dGVzLCBlbmNvZGluZykgewoJICAgICAgICB2YXIgY2hhcmFjdGVyU2V0ID0gdGhpcy5lbmNvZGluZ0NoYXJhY3RlclNldChlbmNvZGluZyk7CgkgICAgICAgIGlmIChTdHJpbmdFbmNvZGluZy5pc0RlY29kZUZhbGxiYWNrU3VwcG9ydGVkKGNoYXJhY3RlclNldCkpIHsKCSAgICAgICAgICAgIHZhciBzID0gJyc7CgkgICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoXzEgPSBieXRlcy5sZW5ndGg7IGkgPCBsZW5ndGhfMTsgaSsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIGggPSBieXRlc1tpXS50b1N0cmluZygxNik7CgkgICAgICAgICAgICAgICAgaWYgKGgubGVuZ3RoIDwgMikgewoJICAgICAgICAgICAgICAgICAgICBoID0gJzAnICsgaDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgcyArPSAnJScgKyBoOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChzKTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoY2hhcmFjdGVyU2V0LmVxdWFscyhDaGFyYWN0ZXJTZXRFQ0lfMSQyLmRlZmF1bHQuVW5pY29kZUJpZ1VubWFya2VkKSkgewoJICAgICAgICAgICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkobnVsbCwgbmV3IFVpbnQxNkFycmF5KGJ5dGVzLmJ1ZmZlcikpOwoJICAgICAgICB9CgkgICAgICAgIHRocm93IG5ldyBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgiRW5jb2RpbmcgIiArIHRoaXMuZW5jb2RpbmdOYW1lKGVuY29kaW5nKSArICIgbm90IHN1cHBvcnRlZCBieSBmYWxsYmFjay4iKTsKCSAgICB9OwoJICAgIFN0cmluZ0VuY29kaW5nLmlzRGVjb2RlRmFsbGJhY2tTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoY2hhcmFjdGVyU2V0KSB7CgkgICAgICAgIHJldHVybiBjaGFyYWN0ZXJTZXQuZXF1YWxzKENoYXJhY3RlclNldEVDSV8xJDIuZGVmYXVsdC5VVEY4KSB8fAoJICAgICAgICAgICAgY2hhcmFjdGVyU2V0LmVxdWFscyhDaGFyYWN0ZXJTZXRFQ0lfMSQyLmRlZmF1bHQuSVNPODg1OV8xKSB8fAoJICAgICAgICAgICAgY2hhcmFjdGVyU2V0LmVxdWFscyhDaGFyYWN0ZXJTZXRFQ0lfMSQyLmRlZmF1bHQuQVNDSUkpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogUnVucyBhIGZhbGxiYWNrIGZvciB0aGUgbmF0aXZlIGVuY29kaW5nIGZ1bmNpb24uCgkgICAgICoKCSAgICAgKiBAc2VlIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8xNzE5Mjg0NS80MzY3NjgzCgkgICAgICovCgkgICAgU3RyaW5nRW5jb2RpbmcuZW5jb2RlRmFsbGJhY2sgPSBmdW5jdGlvbiAocykgewoJICAgICAgICB2YXIgZW5jb2RlZFVSSXN0cmluZyA9IGJ0b2EodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KHMpKSk7CgkgICAgICAgIHZhciBjaGFyTGlzdCA9IGVuY29kZWRVUklzdHJpbmcuc3BsaXQoJycpOwoJICAgICAgICB2YXIgdWludEFycmF5ID0gW107CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hhckxpc3QubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIHVpbnRBcnJheS5wdXNoKGNoYXJMaXN0W2ldLmNoYXJDb2RlQXQoMCkpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgVWludDhBcnJheSh1aW50QXJyYXkpOwoJICAgIH07CgkgICAgcmV0dXJuIFN0cmluZ0VuY29kaW5nOwoJfSgpKTsKCVN0cmluZ0VuY29kaW5nJDEuZGVmYXVsdCA9IFN0cmluZ0VuY29kaW5nOwoKCS8qCgkgKiBDb3B5cmlnaHQgKEMpIDIwMTAgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFN0cmluZ1V0aWxzJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyppbXBvcnQgamF2YS5uaW8uY2hhcnNldC5DaGFyc2V0OyovCgkvKmltcG9ydCBqYXZhLnV0aWwuTWFwOyovCgl2YXIgRGVjb2RlSGludFR5cGVfMSQzID0gRGVjb2RlSGludFR5cGUkMTsKCXZhciBDaGFyYWN0ZXJTZXRFQ0lfMSQxID0gQ2hhcmFjdGVyU2V0RUNJOwoJdmFyIFN0cmluZ0VuY29kaW5nXzEkMSA9IFN0cmluZ0VuY29kaW5nJDE7CgkvKioKCSAqIENvbW1vbiBzdHJpbmctcmVsYXRlZCBmdW5jdGlvbnMuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqIEBhdXRob3IgQWxleCBEdXByZQoJICovCgl2YXIgU3RyaW5nVXRpbHMgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gU3RyaW5nVXRpbHMoKSB7CgkgICAgfQoJICAgIC8vIFNISUZUX0pJUy5lcXVhbHNJZ25vcmVDYXNlKFBMQVRGT1JNX0RFRkFVTFRfRU5DT0RJTkcpIHx8CgkgICAgLy8gRVVDX0pQLmVxdWFsc0lnbm9yZUNhc2UoUExBVEZPUk1fREVGQVVMVF9FTkNPRElORyk7CgkgICAgU3RyaW5nVXRpbHMuY2FzdEFzTm9uVXRmOENoYXIgPSBmdW5jdGlvbiAoY29kZSwgZW5jb2RpbmcpIHsKCSAgICAgICAgaWYgKGVuY29kaW5nID09PSB2b2lkIDApIHsgZW5jb2RpbmcgPSBudWxsOyB9CgkgICAgICAgIC8vIElTTyA4ODU5LTEgaXMgdGhlIEphdmEgZGVmYXVsdCBhcyBVVEYtOCBpcyBKYXZhU2NyaXB0cwoJICAgICAgICAvLyB5b3UgY2FuIHNlZSB0aGlzIG1ldGhvZCBhcyBhIEphdmEgdmVyc2lvbiBvZiBTdHJpbmcuZnJvbUNoYXJDb2RlCgkgICAgICAgIHZhciBlID0gZW5jb2RpbmcgPyBlbmNvZGluZy5nZXROYW1lKCkgOiB0aGlzLklTTzg4NTkxOwoJICAgICAgICAvLyB1c2UgcGFzc2VkIGZvcm1hdCAoZnJvbUNoYXJDb2RlIHdpbGwgcmV0dXJuIFVURjggZW5jb2RpbmcpCgkgICAgICAgIHJldHVybiBTdHJpbmdFbmNvZGluZ18xJDEuZGVmYXVsdC5kZWNvZGUobmV3IFVpbnQ4QXJyYXkoW2NvZGVdKSwgZSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gYnl0ZXMgYnl0ZXMgZW5jb2RpbmcgYSBzdHJpbmcsIHdob3NlIGVuY29kaW5nIHNob3VsZCBiZSBndWVzc2VkCgkgICAgICogQHBhcmFtIGhpbnRzIGRlY29kZSBoaW50cyBpZiBhcHBsaWNhYmxlCgkgICAgICogQHJldHVybiBuYW1lIG9mIGd1ZXNzZWQgZW5jb2Rpbmc7IGF0IHRoZSBtb21lbnQgd2lsbCBvbmx5IGd1ZXNzIG9uZSBvZjoKCSAgICAgKiAge0BsaW5rICNTSElGVF9KSVN9LCB7QGxpbmsgI1VURjh9LCB7QGxpbmsgI0lTTzg4NTkxfSwgb3IgdGhlIHBsYXRmb3JtCgkgICAgICogIGRlZmF1bHQgZW5jb2RpbmcgaWYgbm9uZSBvZiB0aGVzZSBjYW4gcG9zc2libHkgYmUgY29ycmVjdAoJICAgICAqLwoJICAgIFN0cmluZ1V0aWxzLmd1ZXNzRW5jb2RpbmcgPSBmdW5jdGlvbiAoYnl0ZXMsIGhpbnRzKSB7CgkgICAgICAgIGlmIChoaW50cyAhPT0gbnVsbCAmJiBoaW50cyAhPT0gdW5kZWZpbmVkICYmIHVuZGVmaW5lZCAhPT0gaGludHMuZ2V0KERlY29kZUhpbnRUeXBlXzEkMy5kZWZhdWx0LkNIQVJBQ1RFUl9TRVQpKSB7CgkgICAgICAgICAgICByZXR1cm4gaGludHMuZ2V0KERlY29kZUhpbnRUeXBlXzEkMy5kZWZhdWx0LkNIQVJBQ1RFUl9TRVQpLnRvU3RyaW5nKCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gRm9yIG5vdywgbWVyZWx5IHRyaWVzIHRvIGRpc3Rpbmd1aXNoIElTTy04ODU5LTEsIFVURi04IGFuZCBTaGlmdF9KSVMsCgkgICAgICAgIC8vIHdoaWNoIHNob3VsZCBiZSBieSBmYXIgdGhlIG1vc3QgY29tbW9uIGVuY29kaW5ncy4KCSAgICAgICAgdmFyIGxlbmd0aCA9IGJ5dGVzLmxlbmd0aDsKCSAgICAgICAgdmFyIGNhbkJlSVNPODg1OTEgPSB0cnVlOwoJICAgICAgICB2YXIgY2FuQmVTaGlmdEpJUyA9IHRydWU7CgkgICAgICAgIHZhciBjYW5CZVVURjggPSB0cnVlOwoJICAgICAgICB2YXIgdXRmOEJ5dGVzTGVmdCA9IDA7CgkgICAgICAgIC8vIGludCB1dGY4TG93Q2hhcnMgPSAwCgkgICAgICAgIHZhciB1dGYyQnl0ZXNDaGFycyA9IDA7CgkgICAgICAgIHZhciB1dGYzQnl0ZXNDaGFycyA9IDA7CgkgICAgICAgIHZhciB1dGY0Qnl0ZXNDaGFycyA9IDA7CgkgICAgICAgIHZhciBzamlzQnl0ZXNMZWZ0ID0gMDsKCSAgICAgICAgLy8gaW50IHNqaXNMb3dDaGFycyA9IDAKCSAgICAgICAgdmFyIHNqaXNLYXRha2FuYUNoYXJzID0gMDsKCSAgICAgICAgLy8gaW50IHNqaXNEb3VibGVCeXRlc0NoYXJzID0gMAoJICAgICAgICB2YXIgc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCA9IDA7CgkgICAgICAgIHZhciBzamlzQ3VyRG91YmxlQnl0ZXNXb3JkTGVuZ3RoID0gMDsKCSAgICAgICAgdmFyIHNqaXNNYXhLYXRha2FuYVdvcmRMZW5ndGggPSAwOwoJICAgICAgICB2YXIgc2ppc01heERvdWJsZUJ5dGVzV29yZExlbmd0aCA9IDA7CgkgICAgICAgIC8vIGludCBpc29Mb3dDaGFycyA9IDAKCSAgICAgICAgLy8gaW50IGlzb0hpZ2hDaGFycyA9IDAKCSAgICAgICAgdmFyIGlzb0hpZ2hPdGhlciA9IDA7CgkgICAgICAgIHZhciB1dGY4Ym9tID0gYnl0ZXMubGVuZ3RoID4gMyAmJgoJICAgICAgICAgICAgYnl0ZXNbMF0gPT09IC8qKGJ5dGUpICovIDB4RUYgJiYKCSAgICAgICAgICAgIGJ5dGVzWzFdID09PSAvKihieXRlKSAqLyAweEJCICYmCgkgICAgICAgICAgICBieXRlc1syXSA9PT0gLyooYnl0ZSkgKi8gMHhCRjsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGggJiYgKGNhbkJlSVNPODg1OTEgfHwgY2FuQmVTaGlmdEpJUyB8fCBjYW5CZVVURjgpOyBpKyspIHsKCSAgICAgICAgICAgIHZhciB2YWx1ZSA9IGJ5dGVzW2ldICYgMHhGRjsKCSAgICAgICAgICAgIC8vIFVURi04IHN0dWZmCgkgICAgICAgICAgICBpZiAoY2FuQmVVVEY4KSB7CgkgICAgICAgICAgICAgICAgaWYgKHV0ZjhCeXRlc0xlZnQgPiAwKSB7CgkgICAgICAgICAgICAgICAgICAgIGlmICgodmFsdWUgJiAweDgwKSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgY2FuQmVVVEY4ID0gZmFsc2U7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICB1dGY4Qnl0ZXNMZWZ0LS07CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSBpZiAoKHZhbHVlICYgMHg4MCkgIT09IDApIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKCh2YWx1ZSAmIDB4NDApID09PSAwKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBjYW5CZVVURjggPSBmYWxzZTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHV0ZjhCeXRlc0xlZnQrKzsKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmICgodmFsdWUgJiAweDIwKSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHV0ZjJCeXRlc0NoYXJzKys7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB1dGY4Qnl0ZXNMZWZ0Kys7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCh2YWx1ZSAmIDB4MTApID09PSAwKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHV0ZjNCeXRlc0NoYXJzKys7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1dGY4Qnl0ZXNMZWZ0Kys7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgodmFsdWUgJiAweDA4KSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXRmNEJ5dGVzQ2hhcnMrKzsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbkJlVVRGOCA9IGZhbHNlOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfSAvLyBlbHNlIHsKCSAgICAgICAgICAgICAgICAvLyB1dGY4TG93Q2hhcnMrKwoJICAgICAgICAgICAgICAgIC8vIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIC8vIElTTy04ODU5LTEgc3R1ZmYKCSAgICAgICAgICAgIGlmIChjYW5CZUlTTzg4NTkxKSB7CgkgICAgICAgICAgICAgICAgaWYgKHZhbHVlID4gMHg3RiAmJiB2YWx1ZSA8IDB4QTApIHsKCSAgICAgICAgICAgICAgICAgICAgY2FuQmVJU084ODU5MSA9IGZhbHNlOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIGlmICh2YWx1ZSA+IDB4OUYpIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlIDwgMHhDMCB8fCB2YWx1ZSA9PT0gMHhENyB8fCB2YWx1ZSA9PT0gMHhGNykgewoJICAgICAgICAgICAgICAgICAgICAgICAgaXNvSGlnaE90aGVyKys7CgkgICAgICAgICAgICAgICAgICAgIH0gLy8gZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgIC8vIGlzb0hpZ2hDaGFycysrCgkgICAgICAgICAgICAgICAgICAgIC8vIH0KCSAgICAgICAgICAgICAgICB9IC8vIGVsc2UgewoJICAgICAgICAgICAgICAgIC8vIGlzb0xvd0NoYXJzKysKCSAgICAgICAgICAgICAgICAvLyB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICAvLyBTaGlmdF9KSVMgc3R1ZmYKCSAgICAgICAgICAgIGlmIChjYW5CZVNoaWZ0SklTKSB7CgkgICAgICAgICAgICAgICAgaWYgKHNqaXNCeXRlc0xlZnQgPiAwKSB7CgkgICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA8IDB4NDAgfHwgdmFsdWUgPT09IDB4N0YgfHwgdmFsdWUgPiAweEZDKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBjYW5CZVNoaWZ0SklTID0gZmFsc2U7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBzamlzQnl0ZXNMZWZ0LS07CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSBpZiAodmFsdWUgPT09IDB4ODAgfHwgdmFsdWUgPT09IDB4QTAgfHwgdmFsdWUgPiAweEVGKSB7CgkgICAgICAgICAgICAgICAgICAgIGNhbkJlU2hpZnRKSVMgPSBmYWxzZTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSBpZiAodmFsdWUgPiAweEEwICYmIHZhbHVlIDwgMHhFMCkgewoJICAgICAgICAgICAgICAgICAgICBzamlzS2F0YWthbmFDaGFycysrOwoJICAgICAgICAgICAgICAgICAgICBzamlzQ3VyRG91YmxlQnl0ZXNXb3JkTGVuZ3RoID0gMDsKCSAgICAgICAgICAgICAgICAgICAgc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCsrOwoJICAgICAgICAgICAgICAgICAgICBpZiAoc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCA+IHNqaXNNYXhLYXRha2FuYVdvcmRMZW5ndGgpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHNqaXNNYXhLYXRha2FuYVdvcmRMZW5ndGggPSBzamlzQ3VyS2F0YWthbmFXb3JkTGVuZ3RoOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGVsc2UgaWYgKHZhbHVlID4gMHg3RikgewoJICAgICAgICAgICAgICAgICAgICBzamlzQnl0ZXNMZWZ0Kys7CgkgICAgICAgICAgICAgICAgICAgIC8vIHNqaXNEb3VibGVCeXRlc0NoYXJzKysKCSAgICAgICAgICAgICAgICAgICAgc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCA9IDA7CgkgICAgICAgICAgICAgICAgICAgIHNqaXNDdXJEb3VibGVCeXRlc1dvcmRMZW5ndGgrKzsKCSAgICAgICAgICAgICAgICAgICAgaWYgKHNqaXNDdXJEb3VibGVCeXRlc1dvcmRMZW5ndGggPiBzamlzTWF4RG91YmxlQnl0ZXNXb3JkTGVuZ3RoKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBzamlzTWF4RG91YmxlQnl0ZXNXb3JkTGVuZ3RoID0gc2ppc0N1ckRvdWJsZUJ5dGVzV29yZExlbmd0aDsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgLy8gc2ppc0xvd0NoYXJzKysKCSAgICAgICAgICAgICAgICAgICAgc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCA9IDA7CgkgICAgICAgICAgICAgICAgICAgIHNqaXNDdXJEb3VibGVCeXRlc1dvcmRMZW5ndGggPSAwOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBpZiAoY2FuQmVVVEY4ICYmIHV0ZjhCeXRlc0xlZnQgPiAwKSB7CgkgICAgICAgICAgICBjYW5CZVVURjggPSBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoY2FuQmVTaGlmdEpJUyAmJiBzamlzQnl0ZXNMZWZ0ID4gMCkgewoJICAgICAgICAgICAgY2FuQmVTaGlmdEpJUyA9IGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIC8vIEVhc3kgLS0gaWYgdGhlcmUgaXMgQk9NIG9yIGF0IGxlYXN0IDEgdmFsaWQgbm90LXNpbmdsZSBieXRlIGNoYXJhY3RlciAoYW5kIG5vIGV2aWRlbmNlIGl0IGNhbid0IGJlIFVURi04KSwgZG9uZQoJICAgICAgICBpZiAoY2FuQmVVVEY4ICYmICh1dGY4Ym9tIHx8IHV0ZjJCeXRlc0NoYXJzICsgdXRmM0J5dGVzQ2hhcnMgKyB1dGY0Qnl0ZXNDaGFycyA+IDApKSB7CgkgICAgICAgICAgICByZXR1cm4gU3RyaW5nVXRpbHMuVVRGODsKCSAgICAgICAgfQoJICAgICAgICAvLyBFYXN5IC0tIGlmIGFzc3VtaW5nIFNoaWZ0X0pJUyBvciBhdCBsZWFzdCAzIHZhbGlkIGNvbnNlY3V0aXZlIG5vdC1hc2NpaSBjaGFyYWN0ZXJzIChhbmQgbm8gZXZpZGVuY2UgaXQgY2FuJ3QgYmUpLCBkb25lCgkgICAgICAgIGlmIChjYW5CZVNoaWZ0SklTICYmIChTdHJpbmdVdGlscy5BU1NVTUVfU0hJRlRfSklTIHx8IHNqaXNNYXhLYXRha2FuYVdvcmRMZW5ndGggPj0gMyB8fCBzamlzTWF4RG91YmxlQnl0ZXNXb3JkTGVuZ3RoID49IDMpKSB7CgkgICAgICAgICAgICByZXR1cm4gU3RyaW5nVXRpbHMuU0hJRlRfSklTOwoJICAgICAgICB9CgkgICAgICAgIC8vIERpc3Rpbmd1aXNoaW5nIFNoaWZ0X0pJUyBhbmQgSVNPLTg4NTktMSBjYW4gYmUgYSBsaXR0bGUgdG91Z2ggZm9yIHNob3J0IHdvcmRzLiBUaGUgY3J1ZGUgaGV1cmlzdGljIGlzOgoJICAgICAgICAvLyAtIElmIHdlIHNhdwoJICAgICAgICAvLyAgIC0gb25seSB0d28gY29uc2VjdXRpdmUga2F0YWthbmEgY2hhcnMgaW4gdGhlIHdob2xlIHRleHQsIG9yCgkgICAgICAgIC8vICAgLSBhdCBsZWFzdCAxMCUgb2YgYnl0ZXMgdGhhdCBjb3VsZCBiZSAidXBwZXIiIG5vdC1hbHBoYW51bWVyaWMgTGF0aW4xLAoJICAgICAgICAvLyAtIHRoZW4gd2UgY29uY2x1ZGUgU2hpZnRfSklTLCBlbHNlIElTTy04ODU5LTEKCSAgICAgICAgaWYgKGNhbkJlSVNPODg1OTEgJiYgY2FuQmVTaGlmdEpJUykgewoJICAgICAgICAgICAgcmV0dXJuIChzamlzTWF4S2F0YWthbmFXb3JkTGVuZ3RoID09PSAyICYmIHNqaXNLYXRha2FuYUNoYXJzID09PSAyKSB8fCBpc29IaWdoT3RoZXIgKiAxMCA+PSBsZW5ndGgKCSAgICAgICAgICAgICAgICA/IFN0cmluZ1V0aWxzLlNISUZUX0pJUyA6IFN0cmluZ1V0aWxzLklTTzg4NTkxOwoJICAgICAgICB9CgkgICAgICAgIC8vIE90aGVyd2lzZSwgdHJ5IGluIG9yZGVyIElTTy04ODU5LTEsIFNoaWZ0IEpJUywgVVRGLTggYW5kIGZhbGwgYmFjayB0byBkZWZhdWx0IHBsYXRmb3JtIGVuY29kaW5nCgkgICAgICAgIGlmIChjYW5CZUlTTzg4NTkxKSB7CgkgICAgICAgICAgICByZXR1cm4gU3RyaW5nVXRpbHMuSVNPODg1OTE7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNhbkJlU2hpZnRKSVMpIHsKCSAgICAgICAgICAgIHJldHVybiBTdHJpbmdVdGlscy5TSElGVF9KSVM7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNhbkJlVVRGOCkgewoJICAgICAgICAgICAgcmV0dXJuIFN0cmluZ1V0aWxzLlVURjg7CgkgICAgICAgIH0KCSAgICAgICAgLy8gT3RoZXJ3aXNlLCB3ZSB0YWtlIGEgd2lsZCBndWVzcyB3aXRoIHBsYXRmb3JtIGVuY29kaW5nCgkgICAgICAgIHJldHVybiBTdHJpbmdVdGlscy5QTEFURk9STV9ERUZBVUxUX0VOQ09ESU5HOwoJICAgIH07CgkgICAgLyoqCgkgICAgICoKCSAgICAgKiBAc2VlIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8xMzQzOTcxMS80MzY3NjgzCgkgICAgICoKCSAgICAgKiBAcGFyYW0gYXBwZW5kIFRoZSBuZXcgc3RyaW5nIHRvIGFwcGVuZC4KCSAgICAgKiBAcGFyYW0gYXJncyBBcmd1bWV0cyB2YWx1ZXMgdG8gYmUgZm9ybWF0ZWQuCgkgICAgICovCgkgICAgU3RyaW5nVXRpbHMuZm9ybWF0ID0gZnVuY3Rpb24gKGFwcGVuZCkgewoJICAgICAgICB2YXIgYXJncyA9IFtdOwoJICAgICAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykgewoJICAgICAgICAgICAgYXJnc1tfaSAtIDFdID0gYXJndW1lbnRzW19pXTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgaSA9IC0xOwoJICAgICAgICBmdW5jdGlvbiBjYWxsYmFjayhleHAsIHAwLCBwMSwgcDIsIHAzLCBwNCkgewoJICAgICAgICAgICAgaWYgKGV4cCA9PT0gJyUlJykKCSAgICAgICAgICAgICAgICByZXR1cm4gJyUnOwoJICAgICAgICAgICAgaWYgKGFyZ3NbKytpXSA9PT0gdW5kZWZpbmVkKQoJICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7CgkgICAgICAgICAgICBleHAgPSBwMiA/IHBhcnNlSW50KHAyLnN1YnN0cigxKSkgOiB1bmRlZmluZWQ7CgkgICAgICAgICAgICB2YXIgYmFzZSA9IHAzID8gcGFyc2VJbnQocDMuc3Vic3RyKDEpKSA6IHVuZGVmaW5lZDsKCSAgICAgICAgICAgIHZhciB2YWw7CgkgICAgICAgICAgICBzd2l0Y2ggKHA0KSB7CgkgICAgICAgICAgICAgICAgY2FzZSAncyc6CgkgICAgICAgICAgICAgICAgICAgIHZhbCA9IGFyZ3NbaV07CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgIGNhc2UgJ2MnOgoJICAgICAgICAgICAgICAgICAgICB2YWwgPSBhcmdzW2ldWzBdOwoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICBjYXNlICdmJzoKCSAgICAgICAgICAgICAgICAgICAgdmFsID0gcGFyc2VGbG9hdChhcmdzW2ldKS50b0ZpeGVkKGV4cCk7CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgIGNhc2UgJ3AnOgoJICAgICAgICAgICAgICAgICAgICB2YWwgPSBwYXJzZUZsb2F0KGFyZ3NbaV0pLnRvUHJlY2lzaW9uKGV4cCk7CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgIGNhc2UgJ2UnOgoJICAgICAgICAgICAgICAgICAgICB2YWwgPSBwYXJzZUZsb2F0KGFyZ3NbaV0pLnRvRXhwb25lbnRpYWwoZXhwKTsKCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgY2FzZSAneCc6CgkgICAgICAgICAgICAgICAgICAgIHZhbCA9IHBhcnNlSW50KGFyZ3NbaV0pLnRvU3RyaW5nKGJhc2UgPyBiYXNlIDogMTYpOwoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICBjYXNlICdkJzoKCSAgICAgICAgICAgICAgICAgICAgdmFsID0gcGFyc2VGbG9hdChwYXJzZUludChhcmdzW2ldLCBiYXNlID8gYmFzZSA6IDEwKS50b1ByZWNpc2lvbihleHApKS50b0ZpeGVkKDApOwoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHZhbCA9IHR5cGVvZiB2YWwgPT09ICdvYmplY3QnID8gSlNPTi5zdHJpbmdpZnkodmFsKSA6ICgrdmFsKS50b1N0cmluZyhiYXNlKTsKCSAgICAgICAgICAgIHZhciBzaXplID0gcGFyc2VJbnQocDEpOyAvKiBwYWRkaW5nIHNpemUgKi8KCSAgICAgICAgICAgIHZhciBjaCA9IHAxICYmIChwMVswXSArICcnKSA9PT0gJzAnID8gJzAnIDogJyAnOyAvKiBpc251bGw/ICovCgkgICAgICAgICAgICB3aGlsZSAodmFsLmxlbmd0aCA8IHNpemUpCgkgICAgICAgICAgICAgICAgdmFsID0gcDAgIT09IHVuZGVmaW5lZCA/IHZhbCArIGNoIDogY2ggKyB2YWw7IC8qIGlzbWludXM/ICovCgkgICAgICAgICAgICByZXR1cm4gdmFsOwoJICAgICAgICB9CgkgICAgICAgIHZhciByZWdleCA9IC8lKC0pPygwP1swLTldKyk/KFsuXVswLTldKyk/KFsjXVswLTldKyk/KFtzY2ZwZXhkJV0pL2c7CgkgICAgICAgIHJldHVybiBhcHBlbmQucmVwbGFjZShyZWdleCwgY2FsbGJhY2spOwoJICAgIH07CgkgICAgLyoqCgkgICAgICoKCSAgICAgKi8KCSAgICBTdHJpbmdVdGlscy5nZXRCeXRlcyA9IGZ1bmN0aW9uIChzdHIsIGVuY29kaW5nKSB7CgkgICAgICAgIHJldHVybiBTdHJpbmdFbmNvZGluZ18xJDEuZGVmYXVsdC5lbmNvZGUoc3RyLCBlbmNvZGluZyk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBSZXR1cm5zIHRoZSBjaGFyY29kZSBhdCB0aGUgc3BlY2lmaWVkIGluZGV4IG9yIGF0IGluZGV4IHplcm8uCgkgICAgICovCgkgICAgU3RyaW5nVXRpbHMuZ2V0Q2hhckNvZGUgPSBmdW5jdGlvbiAoc3RyLCBpbmRleCkgewoJICAgICAgICBpZiAoaW5kZXggPT09IHZvaWQgMCkgeyBpbmRleCA9IDA7IH0KCSAgICAgICAgcmV0dXJuIHN0ci5jaGFyQ29kZUF0KGluZGV4KTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgY2hhciBmb3IgZ2l2ZW4gY2hhcmNvZGUKCSAgICAgKi8KCSAgICBTdHJpbmdVdGlscy5nZXRDaGFyQXQgPSBmdW5jdGlvbiAoY2hhckNvZGUpIHsKCSAgICAgICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUoY2hhckNvZGUpOwoJICAgIH07CgkgICAgU3RyaW5nVXRpbHMuU0hJRlRfSklTID0gQ2hhcmFjdGVyU2V0RUNJXzEkMS5kZWZhdWx0LlNKSVMuZ2V0TmFtZSgpOyAvLyAiU0pJUyIKCSAgICBTdHJpbmdVdGlscy5HQjIzMTIgPSAnR0IyMzEyJzsKCSAgICBTdHJpbmdVdGlscy5JU084ODU5MSA9IENoYXJhY3RlclNldEVDSV8xJDEuZGVmYXVsdC5JU084ODU5XzEuZ2V0TmFtZSgpOyAvLyAiSVNPODg1OV8xIgoJICAgIFN0cmluZ1V0aWxzLkVVQ19KUCA9ICdFVUNfSlAnOwoJICAgIFN0cmluZ1V0aWxzLlVURjggPSBDaGFyYWN0ZXJTZXRFQ0lfMSQxLmRlZmF1bHQuVVRGOC5nZXROYW1lKCk7IC8vICJVVEY4IgoJICAgIFN0cmluZ1V0aWxzLlBMQVRGT1JNX0RFRkFVTFRfRU5DT0RJTkcgPSBTdHJpbmdVdGlscy5VVEY4OyAvLyAiVVRGOCIvL0NoYXJzZXQuZGVmYXVsdENoYXJzZXQoKS5uYW1lKCkKCSAgICBTdHJpbmdVdGlscy5BU1NVTUVfU0hJRlRfSklTID0gZmFsc2U7CgkgICAgcmV0dXJuIFN0cmluZ1V0aWxzOwoJfSgpKTsKCVN0cmluZ1V0aWxzJDEuZGVmYXVsdCA9IFN0cmluZ1V0aWxzOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdHJpbmdCdWlsZGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBTdHJpbmdVdGlsc18xJDEgPSBTdHJpbmdVdGlscyQxOwoJdmFyIFN0cmluZ0J1aWxkZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gU3RyaW5nQnVpbGRlcih2YWx1ZSkgewoJICAgICAgICBpZiAodmFsdWUgPT09IHZvaWQgMCkgeyB2YWx1ZSA9ICcnOyB9CgkgICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTsKCSAgICB9CgkgICAgU3RyaW5nQnVpbGRlci5wcm90b3R5cGUuZW5hYmxlRGVjb2RpbmcgPSBmdW5jdGlvbiAoZW5jb2RpbmcpIHsKCSAgICAgICAgdGhpcy5lbmNvZGluZyA9IGVuY29kaW5nOwoJICAgICAgICByZXR1cm4gdGhpczsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmFwcGVuZCA9IGZ1bmN0aW9uIChzKSB7CgkgICAgICAgIGlmICh0eXBlb2YgcyA9PT0gJ3N0cmluZycpIHsKCSAgICAgICAgICAgIHRoaXMudmFsdWUgKz0gcy50b1N0cmluZygpOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgaWYgKHRoaXMuZW5jb2RpbmcpIHsKCSAgICAgICAgICAgIC8vIHVzZSBwYXNzZWQgZm9ybWF0IChmcm9tQ2hhckNvZGUgd2lsbCByZXR1cm4gVVRGOCBlbmNvZGluZykKCSAgICAgICAgICAgIHRoaXMudmFsdWUgKz0gU3RyaW5nVXRpbHNfMSQxLmRlZmF1bHQuY2FzdEFzTm9uVXRmOENoYXIocywgdGhpcy5lbmNvZGluZyk7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAvLyBjb3JyZWN0bHkgY29udmVydHMgZnJvbSBVVEYtOCwgYnV0IG5vdCBvdGhlciBlbmNvZGluZ3MKCSAgICAgICAgICAgIHRoaXMudmFsdWUgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShzKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdGhpczsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmFwcGVuZENoYXJzID0gZnVuY3Rpb24gKHN0ciwgb2Zmc2V0LCBsZW4pIHsKCSAgICAgICAgZm9yICh2YXIgaSA9IG9mZnNldDsgb2Zmc2V0IDwgb2Zmc2V0ICsgbGVuOyBpKyspIHsKCSAgICAgICAgICAgIHRoaXMuYXBwZW5kKHN0cltpXSk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRoaXM7CgkgICAgfTsKCSAgICBTdHJpbmdCdWlsZGVyLnByb3RvdHlwZS5sZW5ndGggPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnZhbHVlLmxlbmd0aDsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmNoYXJBdCA9IGZ1bmN0aW9uIChuKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnZhbHVlLmNoYXJBdChuKTsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmRlbGV0ZUNoYXJBdCA9IGZ1bmN0aW9uIChuKSB7CgkgICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLnZhbHVlLnN1YnN0cigwLCBuKSArIHRoaXMudmFsdWUuc3Vic3RyaW5nKG4gKyAxKTsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLnNldENoYXJBdCA9IGZ1bmN0aW9uIChuLCBjKSB7CgkgICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLnZhbHVlLnN1YnN0cigwLCBuKSArIGMgKyB0aGlzLnZhbHVlLnN1YnN0cihuICsgMSk7CgkgICAgfTsKCSAgICBTdHJpbmdCdWlsZGVyLnByb3RvdHlwZS5zdWJzdHJpbmcgPSBmdW5jdGlvbiAoc3RhcnQsIGVuZCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZS5zdWJzdHJpbmcoc3RhcnQsIGVuZCk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAbm90ZSBoZWxwZXIgbWV0aG9kIGZvciBSU1MgRXhwYW5kZWQKCSAgICAgKi8KCSAgICBTdHJpbmdCdWlsZGVyLnByb3RvdHlwZS5zZXRMZW5ndGhUb1plcm8gPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHRoaXMudmFsdWUgPSAnJzsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZTsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmluc2VydCA9IGZ1bmN0aW9uIChuLCBjKSB7CgkgICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLnZhbHVlLnN1YnN0cigwLCBuKSArIGMgKyB0aGlzLnZhbHVlLnN1YnN0cihuICsgYy5sZW5ndGgpOwoJICAgIH07CgkgICAgcmV0dXJuIFN0cmluZ0J1aWxkZXI7Cgl9KCkpOwoJU3RyaW5nQnVpbGRlciQxLmRlZmF1bHQgPSBTdHJpbmdCdWlsZGVyOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoQml0TWF0cml4JDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyppbXBvcnQgamF2YS51dGlsLkFycmF5czsqLwoJdmFyIEJpdEFycmF5XzEkMSA9IEJpdEFycmF5JDE7Cgl2YXIgU3lzdGVtXzEkMyA9IFN5c3RlbSQxOwoJdmFyIEFycmF5c18xID0gQXJyYXlzJDE7Cgl2YXIgU3RyaW5nQnVpbGRlcl8xJDIgPSBTdHJpbmdCdWlsZGVyJDE7Cgl2YXIgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNyA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5SZXByZXNlbnRzIGEgMkQgbWF0cml4IG9mIGJpdHMuIEluIGZ1bmN0aW9uIGFyZ3VtZW50cyBiZWxvdywgYW5kIHRocm91Z2hvdXQgdGhlIGNvbW1vbgoJICogbW9kdWxlLCB4IGlzIHRoZSBjb2x1bW4gcG9zaXRpb24sIGFuZCB5IGlzIHRoZSByb3cgcG9zaXRpb24uIFRoZSBvcmRlcmluZyBpcyBhbHdheXMgeCwgeS4KCSAqIFRoZSBvcmlnaW4gaXMgYXQgdGhlIHRvcC1sZWZ0LjwvcD4KCSAqCgkgKiA8cD5JbnRlcm5hbGx5IHRoZSBiaXRzIGFyZSByZXByZXNlbnRlZCBpbiBhIDEtRCBhcnJheSBvZiAzMi1iaXQgaW50cy4gSG93ZXZlciwgZWFjaCByb3cgYmVnaW5zCgkgKiB3aXRoIGEgbmV3IGludC4gVGhpcyBpcyBkb25lIGludGVudGlvbmFsbHkgc28gdGhhdCB3ZSBjYW4gY29weSBvdXQgYSByb3cgaW50byBhIEJpdEFycmF5IHZlcnkKCSAqIGVmZmljaWVudGx5LjwvcD4KCSAqCgkgKiA8cD5UaGUgb3JkZXJpbmcgb2YgYml0cyBpcyByb3ctbWFqb3IuIFdpdGhpbiBlYWNoIGludCwgdGhlIGxlYXN0IHNpZ25pZmljYW50IGJpdHMgYXJlIHVzZWQgZmlyc3QsCgkgKiBtZWFuaW5nIHRoZXkgcmVwcmVzZW50IGxvd2VyIHggdmFsdWVzLiBUaGlzIGlzIGNvbXBhdGlibGUgd2l0aCBCaXRBcnJheSdzIGltcGxlbWVudGF0aW9uLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqLwoJdmFyIEJpdE1hdHJpeCAvKmltcGxlbWVudHMgQ2xvbmVhYmxlKi8gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgLyoqCgkgICAgICogQ3JlYXRlcyBhbiBlbXB0eSBzcXVhcmUge0BsaW5rIEJpdE1hdHJpeH0uCgkgICAgICoKCSAgICAgKiBAcGFyYW0gZGltZW5zaW9uIGhlaWdodCBhbmQgd2lkdGgKCSAgICAgKi8KCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IoZGltZW5zaW9uOiBudW1iZXIgLyppbnQqLykgewoJICAgIC8vICAgdGhpcyhkaW1lbnNpb24sIGRpbWVuc2lvbikKCSAgICAvLyB9CgkgICAgLyoqCgkgICAgICogQ3JlYXRlcyBhbiBlbXB0eSB7QGxpbmsgQml0TWF0cml4fS4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB3aWR0aCBiaXQgbWF0cml4IHdpZHRoCgkgICAgICogQHBhcmFtIGhlaWdodCBiaXQgbWF0cml4IGhlaWdodAoJICAgICAqLwoJICAgIC8vIHB1YmxpYyBjb25zdHJ1Y3Rvcih3aWR0aDogbnVtYmVyIC8qaW50Ki8sIGhlaWdodDogbnVtYmVyIC8qaW50Ki8pIHsKCSAgICAvLyAgIGlmICh3aWR0aCA8IDEgfHwgaGVpZ2h0IDwgMSkgewoJICAgIC8vICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKCJCb3RoIGRpbWVuc2lvbnMgbXVzdCBiZSBncmVhdGVyIHRoYW4gMCIpCgkgICAgLy8gICB9CgkgICAgLy8gICB0aGlzLndpZHRoID0gd2lkdGgKCSAgICAvLyAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0CgkgICAgLy8gICB0aGlzLnJvd1NpemUgPSAod2lkdGggKyAzMSkgLyAzMgoJICAgIC8vICAgYml0cyA9IG5ldyBpbnRbcm93U2l6ZSAqIGhlaWdodF07CgkgICAgLy8gfQoJICAgIGZ1bmN0aW9uIEJpdE1hdHJpeCh3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLywgcm93U2l6ZSAvKmludCovLCBiaXRzKSB7CgkgICAgICAgIHRoaXMud2lkdGggPSB3aWR0aDsKCSAgICAgICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7CgkgICAgICAgIHRoaXMucm93U2l6ZSA9IHJvd1NpemU7CgkgICAgICAgIHRoaXMuYml0cyA9IGJpdHM7CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IGhlaWdodCB8fCBudWxsID09PSBoZWlnaHQpIHsKCSAgICAgICAgICAgIGhlaWdodCA9IHdpZHRoOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0OwoJICAgICAgICBpZiAod2lkdGggPCAxIHx8IGhlaWdodCA8IDEpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ3LmRlZmF1bHQoJ0JvdGggZGltZW5zaW9ucyBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAwJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gcm93U2l6ZSB8fCBudWxsID09PSByb3dTaXplKSB7CgkgICAgICAgICAgICByb3dTaXplID0gTWF0aC5mbG9vcigod2lkdGggKyAzMSkgLyAzMik7CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy5yb3dTaXplID0gcm93U2l6ZTsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gYml0cyB8fCBudWxsID09PSBiaXRzKSB7CgkgICAgICAgICAgICB0aGlzLmJpdHMgPSBuZXcgSW50MzJBcnJheSh0aGlzLnJvd1NpemUgKiB0aGlzLmhlaWdodCk7CgkgICAgICAgIH0KCSAgICB9CgkgICAgLyoqCgkgICAgICogSW50ZXJwcmV0cyBhIDJEIGFycmF5IG9mIGJvb2xlYW5zIGFzIGEge0BsaW5rIEJpdE1hdHJpeH0sIHdoZXJlICJ0cnVlIiBtZWFucyBhbiAib24iIGJpdC4KCSAgICAgKgoJICAgICAqIEBmdW5jdGlvbiBwYXJzZQoJICAgICAqIEBwYXJhbSBpbWFnZSBiaXRzIG9mIHRoZSBpbWFnZSwgYXMgYSByb3ctbWFqb3IgMkQgYXJyYXkuIEVsZW1lbnRzIGFyZSBhcnJheXMgcmVwcmVzZW50aW5nIHJvd3MKCSAgICAgKiBAcmV0dXJuIHtAbGluayBCaXRNYXRyaXh9IHJlcHJlc2VudGF0aW9uIG9mIGltYWdlCgkgICAgICovCgkgICAgQml0TWF0cml4LnBhcnNlRnJvbUJvb2xlYW5BcnJheSA9IGZ1bmN0aW9uIChpbWFnZSkgewoJICAgICAgICB2YXIgaGVpZ2h0ID0gaW1hZ2UubGVuZ3RoOwoJICAgICAgICB2YXIgd2lkdGggPSBpbWFnZVswXS5sZW5ndGg7CgkgICAgICAgIHZhciBiaXRzID0gbmV3IEJpdE1hdHJpeCh3aWR0aCwgaGVpZ2h0KTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBoZWlnaHQ7IGkrKykgewoJICAgICAgICAgICAgdmFyIGltYWdlSSA9IGltYWdlW2ldOwoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB3aWR0aDsgaisrKSB7CgkgICAgICAgICAgICAgICAgaWYgKGltYWdlSVtqXSkgewoJICAgICAgICAgICAgICAgICAgICBiaXRzLnNldChqLCBpKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGJpdHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKgoJICAgICAqIEBmdW5jdGlvbiBwYXJzZQoJICAgICAqIEBwYXJhbSBzdHJpbmdSZXByZXNlbnRhdGlvbgoJICAgICAqIEBwYXJhbSBzZXRTdHJpbmcKCSAgICAgKiBAcGFyYW0gdW5zZXRTdHJpbmcKCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucGFyc2VGcm9tU3RyaW5nID0gZnVuY3Rpb24gKHN0cmluZ1JlcHJlc2VudGF0aW9uLCBzZXRTdHJpbmcsIHVuc2V0U3RyaW5nKSB7CgkgICAgICAgIGlmIChzdHJpbmdSZXByZXNlbnRhdGlvbiA9PT0gbnVsbCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDcuZGVmYXVsdCgnc3RyaW5nUmVwcmVzZW50YXRpb24gY2Fubm90IGJlIG51bGwnKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYml0cyA9IG5ldyBBcnJheShzdHJpbmdSZXByZXNlbnRhdGlvbi5sZW5ndGgpOwoJICAgICAgICB2YXIgYml0c1BvcyA9IDA7CgkgICAgICAgIHZhciByb3dTdGFydFBvcyA9IDA7CgkgICAgICAgIHZhciByb3dMZW5ndGggPSAtMTsKCSAgICAgICAgdmFyIG5Sb3dzID0gMDsKCSAgICAgICAgdmFyIHBvcyA9IDA7CgkgICAgICAgIHdoaWxlIChwb3MgPCBzdHJpbmdSZXByZXNlbnRhdGlvbi5sZW5ndGgpIHsKCSAgICAgICAgICAgIGlmIChzdHJpbmdSZXByZXNlbnRhdGlvbi5jaGFyQXQocG9zKSA9PT0gJ1xuJyB8fAoJICAgICAgICAgICAgICAgIHN0cmluZ1JlcHJlc2VudGF0aW9uLmNoYXJBdChwb3MpID09PSAnXHInKSB7CgkgICAgICAgICAgICAgICAgaWYgKGJpdHNQb3MgPiByb3dTdGFydFBvcykgewoJICAgICAgICAgICAgICAgICAgICBpZiAocm93TGVuZ3RoID09PSAtMSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgcm93TGVuZ3RoID0gYml0c1BvcyAtIHJvd1N0YXJ0UG9zOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGJpdHNQb3MgLSByb3dTdGFydFBvcyAhPT0gcm93TGVuZ3RoKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNy5kZWZhdWx0KCdyb3cgbGVuZ3RocyBkbyBub3QgbWF0Y2gnKTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICByb3dTdGFydFBvcyA9IGJpdHNQb3M7CgkgICAgICAgICAgICAgICAgICAgIG5Sb3dzKys7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIHBvcysrOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSBpZiAoc3RyaW5nUmVwcmVzZW50YXRpb24uc3Vic3RyaW5nKHBvcywgcG9zICsgc2V0U3RyaW5nLmxlbmd0aCkgPT09IHNldFN0cmluZykgewoJICAgICAgICAgICAgICAgIHBvcyArPSBzZXRTdHJpbmcubGVuZ3RoOwoJICAgICAgICAgICAgICAgIGJpdHNbYml0c1Bvc10gPSB0cnVlOwoJICAgICAgICAgICAgICAgIGJpdHNQb3MrKzsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGVsc2UgaWYgKHN0cmluZ1JlcHJlc2VudGF0aW9uLnN1YnN0cmluZyhwb3MsIHBvcyArIHVuc2V0U3RyaW5nLmxlbmd0aCkgPT09IHVuc2V0U3RyaW5nKSB7CgkgICAgICAgICAgICAgICAgcG9zICs9IHVuc2V0U3RyaW5nLmxlbmd0aDsKCSAgICAgICAgICAgICAgICBiaXRzW2JpdHNQb3NdID0gZmFsc2U7CgkgICAgICAgICAgICAgICAgYml0c1BvcysrOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDcuZGVmYXVsdCgnaWxsZWdhbCBjaGFyYWN0ZXIgZW5jb3VudGVyZWQ6ICcgKyBzdHJpbmdSZXByZXNlbnRhdGlvbi5zdWJzdHJpbmcocG9zKSk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gbm8gRU9MIGF0IGVuZD8KCSAgICAgICAgaWYgKGJpdHNQb3MgPiByb3dTdGFydFBvcykgewoJICAgICAgICAgICAgaWYgKHJvd0xlbmd0aCA9PT0gLTEpIHsKCSAgICAgICAgICAgICAgICByb3dMZW5ndGggPSBiaXRzUG9zIC0gcm93U3RhcnRQb3M7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIGlmIChiaXRzUG9zIC0gcm93U3RhcnRQb3MgIT09IHJvd0xlbmd0aCkgewoJICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ3LmRlZmF1bHQoJ3JvdyBsZW5ndGhzIGRvIG5vdCBtYXRjaCcpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgblJvd3MrKzsKCSAgICAgICAgfQoJICAgICAgICB2YXIgbWF0cml4ID0gbmV3IEJpdE1hdHJpeChyb3dMZW5ndGgsIG5Sb3dzKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBiaXRzUG9zOyBpKyspIHsKCSAgICAgICAgICAgIGlmIChiaXRzW2ldKSB7CgkgICAgICAgICAgICAgICAgbWF0cml4LnNldChNYXRoLmZsb29yKGkgJSByb3dMZW5ndGgpLCBNYXRoLmZsb29yKGkgLyByb3dMZW5ndGgpKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gbWF0cml4OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogPHA+R2V0cyB0aGUgcmVxdWVzdGVkIGJpdCwgd2hlcmUgdHJ1ZSBtZWFucyBibGFjay48L3A+CgkgICAgICoKCSAgICAgKiBAcGFyYW0geCBUaGUgaG9yaXpvbnRhbCBjb21wb25lbnQgKGkuZS4gd2hpY2ggY29sdW1uKQoJICAgICAqIEBwYXJhbSB5IFRoZSB2ZXJ0aWNhbCBjb21wb25lbnQgKGkuZS4gd2hpY2ggcm93KQoJICAgICAqIEByZXR1cm4gdmFsdWUgb2YgZ2l2ZW4gYml0IGluIG1hdHJpeAoJICAgICAqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKHggLyppbnQqLywgeSAvKmludCovKSB7CgkgICAgICAgIHZhciBvZmZzZXQgPSB5ICogdGhpcy5yb3dTaXplICsgTWF0aC5mbG9vcih4IC8gMzIpOwoJICAgICAgICByZXR1cm4gKCh0aGlzLmJpdHNbb2Zmc2V0XSA+Pj4gKHggJiAweDFmKSkgJiAxKSAhPT0gMDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlNldHMgdGhlIGdpdmVuIGJpdCB0byB0cnVlLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB4IFRoZSBob3Jpem9udGFsIGNvbXBvbmVudCAoaS5lLiB3aGljaCBjb2x1bW4pCgkgICAgICogQHBhcmFtIHkgVGhlIHZlcnRpY2FsIGNvbXBvbmVudCAoaS5lLiB3aGljaCByb3cpCgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAoeCAvKmludCovLCB5IC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIG9mZnNldCA9IHkgKiB0aGlzLnJvd1NpemUgKyBNYXRoLmZsb29yKHggLyAzMik7CgkgICAgICAgIHRoaXMuYml0c1tvZmZzZXRdIHw9ICgxIDw8ICh4ICYgMHgxZikpICYgMHhGRkZGRkZGRjsKCSAgICB9OwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUudW5zZXQgPSBmdW5jdGlvbiAoeCAvKmludCovLCB5IC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIG9mZnNldCA9IHkgKiB0aGlzLnJvd1NpemUgKyBNYXRoLmZsb29yKHggLyAzMik7CgkgICAgICAgIHRoaXMuYml0c1tvZmZzZXRdICY9IH4oKDEgPDwgKHggJiAweDFmKSkgJiAweEZGRkZGRkZGKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkZsaXBzIHRoZSBnaXZlbiBiaXQuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIHggVGhlIGhvcml6b250YWwgY29tcG9uZW50IChpLmUuIHdoaWNoIGNvbHVtbikKCSAgICAgKiBAcGFyYW0geSBUaGUgdmVydGljYWwgY29tcG9uZW50IChpLmUuIHdoaWNoIHJvdykKCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLmZsaXAgPSBmdW5jdGlvbiAoeCAvKmludCovLCB5IC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIG9mZnNldCA9IHkgKiB0aGlzLnJvd1NpemUgKyBNYXRoLmZsb29yKHggLyAzMik7CgkgICAgICAgIHRoaXMuYml0c1tvZmZzZXRdIF49ICgoMSA8PCAoeCAmIDB4MWYpKSAmIDB4RkZGRkZGRkYpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogRXhjbHVzaXZlLW9yIChYT1IpOiBGbGlwIHRoZSBiaXQgaW4gdGhpcyB7QGNvZGUgQml0TWF0cml4fSBpZiB0aGUgY29ycmVzcG9uZGluZwoJICAgICAqIG1hc2sgYml0IGlzIHNldC4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBtYXNrIFhPUiBtYXNrCgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS54b3IgPSBmdW5jdGlvbiAobWFzaykgewoJICAgICAgICBpZiAodGhpcy53aWR0aCAhPT0gbWFzay5nZXRXaWR0aCgpIHx8IHRoaXMuaGVpZ2h0ICE9PSBtYXNrLmdldEhlaWdodCgpCgkgICAgICAgICAgICB8fCB0aGlzLnJvd1NpemUgIT09IG1hc2suZ2V0Um93U2l6ZSgpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNy5kZWZhdWx0KCdpbnB1dCBtYXRyaXggZGltZW5zaW9ucyBkbyBub3QgbWF0Y2gnKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgcm93QXJyYXkgPSBuZXcgQml0QXJyYXlfMSQxLmRlZmF1bHQoTWF0aC5mbG9vcih0aGlzLndpZHRoIC8gMzIpICsgMSk7CgkgICAgICAgIHZhciByb3dTaXplID0gdGhpcy5yb3dTaXplOwoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgZm9yICh2YXIgeSA9IDAsIGhlaWdodCA9IHRoaXMuaGVpZ2h0OyB5IDwgaGVpZ2h0OyB5KyspIHsKCSAgICAgICAgICAgIHZhciBvZmZzZXQgPSB5ICogcm93U2l6ZTsKCSAgICAgICAgICAgIHZhciByb3cgPSBtYXNrLmdldFJvdyh5LCByb3dBcnJheSkuZ2V0Qml0QXJyYXkoKTsKCSAgICAgICAgICAgIGZvciAodmFyIHggPSAwOyB4IDwgcm93U2l6ZTsgeCsrKSB7CgkgICAgICAgICAgICAgICAgYml0c1tvZmZzZXQgKyB4XSBePSByb3dbeF07CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIENsZWFycyBhbGwgYml0cyAoc2V0cyB0byBmYWxzZSkuCgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIHZhciBtYXggPSBiaXRzLmxlbmd0aDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtYXg7IGkrKykgewoJICAgICAgICAgICAgYml0c1tpXSA9IDA7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlNldHMgYSBzcXVhcmUgcmVnaW9uIG9mIHRoZSBiaXQgbWF0cml4IHRvIHRydWUuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGxlZnQgVGhlIGhvcml6b250YWwgcG9zaXRpb24gdG8gYmVnaW4gYXQgKGluY2x1c2l2ZSkKCSAgICAgKiBAcGFyYW0gdG9wIFRoZSB2ZXJ0aWNhbCBwb3NpdGlvbiB0byBiZWdpbiBhdCAoaW5jbHVzaXZlKQoJICAgICAqIEBwYXJhbSB3aWR0aCBUaGUgd2lkdGggb2YgdGhlIHJlZ2lvbgoJICAgICAqIEBwYXJhbSBoZWlnaHQgVGhlIGhlaWdodCBvZiB0aGUgcmVnaW9uCgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5zZXRSZWdpb24gPSBmdW5jdGlvbiAobGVmdCAvKmludCovLCB0b3AgLyppbnQqLywgd2lkdGggLyppbnQqLywgaGVpZ2h0IC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKHRvcCA8IDAgfHwgbGVmdCA8IDApIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ3LmRlZmF1bHQoJ0xlZnQgYW5kIHRvcCBtdXN0IGJlIG5vbm5lZ2F0aXZlJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGhlaWdodCA8IDEgfHwgd2lkdGggPCAxKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNy5kZWZhdWx0KCdIZWlnaHQgYW5kIHdpZHRoIG11c3QgYmUgYXQgbGVhc3QgMScpOwoJICAgICAgICB9CgkgICAgICAgIHZhciByaWdodCA9IGxlZnQgKyB3aWR0aDsKCSAgICAgICAgdmFyIGJvdHRvbSA9IHRvcCArIGhlaWdodDsKCSAgICAgICAgaWYgKGJvdHRvbSA+IHRoaXMuaGVpZ2h0IHx8IHJpZ2h0ID4gdGhpcy53aWR0aCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDcuZGVmYXVsdCgnVGhlIHJlZ2lvbiBtdXN0IGZpdCBpbnNpZGUgdGhlIG1hdHJpeCcpOwoJICAgICAgICB9CgkgICAgICAgIHZhciByb3dTaXplID0gdGhpcy5yb3dTaXplOwoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgZm9yICh2YXIgeSA9IHRvcDsgeSA8IGJvdHRvbTsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgb2Zmc2V0ID0geSAqIHJvd1NpemU7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gbGVmdDsgeCA8IHJpZ2h0OyB4KyspIHsKCSAgICAgICAgICAgICAgICBiaXRzW29mZnNldCArIE1hdGguZmxvb3IoeCAvIDMyKV0gfD0gKCgxIDw8ICh4ICYgMHgxZikpICYgMHhGRkZGRkZGRik7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEEgZmFzdCBtZXRob2QgdG8gcmV0cmlldmUgb25lIHJvdyBvZiBkYXRhIGZyb20gdGhlIG1hdHJpeCBhcyBhIEJpdEFycmF5LgoJICAgICAqCgkgICAgICogQHBhcmFtIHkgVGhlIHJvdyB0byByZXRyaWV2ZQoJICAgICAqIEBwYXJhbSByb3cgQW4gb3B0aW9uYWwgY2FsbGVyLWFsbG9jYXRlZCBCaXRBcnJheSwgd2lsbCBiZSBhbGxvY2F0ZWQgaWYgbnVsbCBvciB0b28gc21hbGwKCSAgICAgKiBAcmV0dXJuIFRoZSByZXN1bHRpbmcgQml0QXJyYXkgLSB0aGlzIHJlZmVyZW5jZSBzaG91bGQgYWx3YXlzIGJlIHVzZWQgZXZlbiB3aGVuIHBhc3NpbmcKCSAgICAgKiAgICAgICAgIHlvdXIgb3duIHJvdwoJICAgICAqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZ2V0Um93ID0gZnVuY3Rpb24gKHkgLyppbnQqLywgcm93KSB7CgkgICAgICAgIGlmIChyb3cgPT09IG51bGwgfHwgcm93ID09PSB1bmRlZmluZWQgfHwgcm93LmdldFNpemUoKSA8IHRoaXMud2lkdGgpIHsKCSAgICAgICAgICAgIHJvdyA9IG5ldyBCaXRBcnJheV8xJDEuZGVmYXVsdCh0aGlzLndpZHRoKTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHJvdy5jbGVhcigpOwoJICAgICAgICB9CgkgICAgICAgIHZhciByb3dTaXplID0gdGhpcy5yb3dTaXplOwoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgdmFyIG9mZnNldCA9IHkgKiByb3dTaXplOwoJICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IHJvd1NpemU7IHgrKykgewoJICAgICAgICAgICAgcm93LnNldEJ1bGsoeCAqIDMyLCBiaXRzW29mZnNldCArIHhdKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gcm93OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHBhcmFtIHkgcm93IHRvIHNldAoJICAgICAqIEBwYXJhbSByb3cge0BsaW5rIEJpdEFycmF5fSB0byBjb3B5IGZyb20KCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLnNldFJvdyA9IGZ1bmN0aW9uICh5IC8qaW50Ki8sIHJvdykgewoJICAgICAgICBTeXN0ZW1fMSQzLmRlZmF1bHQuYXJyYXljb3B5KHJvdy5nZXRCaXRBcnJheSgpLCAwLCB0aGlzLmJpdHMsIHkgKiB0aGlzLnJvd1NpemUsIHRoaXMucm93U2l6ZSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBNb2RpZmllcyB0aGlzIHtAY29kZSBCaXRNYXRyaXh9IHRvIHJlcHJlc2VudCB0aGUgc2FtZSBidXQgcm90YXRlZCAxODAgZGVncmVlcwoJICAgICAqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUucm90YXRlMTgwID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgd2lkdGggPSB0aGlzLmdldFdpZHRoKCk7CgkgICAgICAgIHZhciBoZWlnaHQgPSB0aGlzLmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgdG9wUm93ID0gbmV3IEJpdEFycmF5XzEkMS5kZWZhdWx0KHdpZHRoKTsKCSAgICAgICAgdmFyIGJvdHRvbVJvdyA9IG5ldyBCaXRBcnJheV8xJDEuZGVmYXVsdCh3aWR0aCk7CgkgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGhfMSA9IE1hdGguZmxvb3IoKGhlaWdodCArIDEpIC8gMik7IGkgPCBsZW5ndGhfMTsgaSsrKSB7CgkgICAgICAgICAgICB0b3BSb3cgPSB0aGlzLmdldFJvdyhpLCB0b3BSb3cpOwoJICAgICAgICAgICAgYm90dG9tUm93ID0gdGhpcy5nZXRSb3coaGVpZ2h0IC0gMSAtIGksIGJvdHRvbVJvdyk7CgkgICAgICAgICAgICB0b3BSb3cucmV2ZXJzZSgpOwoJICAgICAgICAgICAgYm90dG9tUm93LnJldmVyc2UoKTsKCSAgICAgICAgICAgIHRoaXMuc2V0Um93KGksIGJvdHRvbVJvdyk7CgkgICAgICAgICAgICB0aGlzLnNldFJvdyhoZWlnaHQgLSAxIC0gaSwgdG9wUm93KTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgLyoqCgkgICAgICogVGhpcyBpcyB1c2VmdWwgaW4gZGV0ZWN0aW5nIHRoZSBlbmNsb3NpbmcgcmVjdGFuZ2xlIG9mIGEgJ3B1cmUnIGJhcmNvZGUuCgkgICAgICoKCSAgICAgKiBAcmV0dXJuIHtAY29kZSBsZWZ0LHRvcCx3aWR0aCxoZWlnaHR9IGVuY2xvc2luZyByZWN0YW5nbGUgb2YgYWxsIDEgYml0cywgb3IgbnVsbCBpZiBpdCBpcyBhbGwgd2hpdGUKCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLmdldEVuY2xvc2luZ1JlY3RhbmdsZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIHdpZHRoID0gdGhpcy53aWR0aDsKCSAgICAgICAgdmFyIGhlaWdodCA9IHRoaXMuaGVpZ2h0OwoJICAgICAgICB2YXIgcm93U2l6ZSA9IHRoaXMucm93U2l6ZTsKCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIHZhciBsZWZ0ID0gd2lkdGg7CgkgICAgICAgIHZhciB0b3AgPSBoZWlnaHQ7CgkgICAgICAgIHZhciByaWdodCA9IC0xOwoJICAgICAgICB2YXIgYm90dG9tID0gLTE7CgkgICAgICAgIGZvciAodmFyIHkgPSAwOyB5IDwgaGVpZ2h0OyB5KyspIHsKCSAgICAgICAgICAgIGZvciAodmFyIHgzMiA9IDA7IHgzMiA8IHJvd1NpemU7IHgzMisrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHRoZUJpdHMgPSBiaXRzW3kgKiByb3dTaXplICsgeDMyXTsKCSAgICAgICAgICAgICAgICBpZiAodGhlQml0cyAhPT0gMCkgewoJICAgICAgICAgICAgICAgICAgICBpZiAoeSA8IHRvcCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgdG9wID0geTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBpZiAoeSA+IGJvdHRvbSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgYm90dG9tID0geTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBpZiAoeDMyICogMzIgPCBsZWZ0KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYml0ID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgoKHRoZUJpdHMgPDwgKDMxIC0gYml0KSkgJiAweEZGRkZGRkZGKSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpdCsrOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCh4MzIgKiAzMiArIGJpdCkgPCBsZWZ0KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVmdCA9IHgzMiAqIDMyICsgYml0OwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGlmICh4MzIgKiAzMiArIDMxID4gcmlnaHQpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHZhciBiaXQgPSAzMTsKCSAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgodGhlQml0cyA+Pj4gYml0KSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpdC0tOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCh4MzIgKiAzMiArIGJpdCkgPiByaWdodCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJpZ2h0ID0geDMyICogMzIgKyBiaXQ7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHJpZ2h0IDwgbGVmdCB8fCBib3R0b20gPCB0b3ApIHsKCSAgICAgICAgICAgIHJldHVybiBudWxsOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBJbnQzMkFycmF5LmZyb20oW2xlZnQsIHRvcCwgcmlnaHQgLSBsZWZ0ICsgMSwgYm90dG9tIC0gdG9wICsgMV0pOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogVGhpcyBpcyB1c2VmdWwgaW4gZGV0ZWN0aW5nIGEgY29ybmVyIG9mIGEgJ3B1cmUnIGJhcmNvZGUuCgkgICAgICoKCSAgICAgKiBAcmV0dXJuIHtAY29kZSB4LHl9IGNvb3JkaW5hdGUgb2YgdG9wLWxlZnQtbW9zdCAxIGJpdCwgb3IgbnVsbCBpZiBpdCBpcyBhbGwgd2hpdGUKCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLmdldFRvcExlZnRPbkJpdCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIHJvd1NpemUgPSB0aGlzLnJvd1NpemU7CgkgICAgICAgIHZhciBiaXRzID0gdGhpcy5iaXRzOwoJICAgICAgICB2YXIgYml0c09mZnNldCA9IDA7CgkgICAgICAgIHdoaWxlIChiaXRzT2Zmc2V0IDwgYml0cy5sZW5ndGggJiYgYml0c1tiaXRzT2Zmc2V0XSA9PT0gMCkgewoJICAgICAgICAgICAgYml0c09mZnNldCsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChiaXRzT2Zmc2V0ID09PSBiaXRzLmxlbmd0aCkgewoJICAgICAgICAgICAgcmV0dXJuIG51bGw7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHkgPSBiaXRzT2Zmc2V0IC8gcm93U2l6ZTsKCSAgICAgICAgdmFyIHggPSAoYml0c09mZnNldCAlIHJvd1NpemUpICogMzI7CgkgICAgICAgIHZhciB0aGVCaXRzID0gYml0c1tiaXRzT2Zmc2V0XTsKCSAgICAgICAgdmFyIGJpdCA9IDA7CgkgICAgICAgIHdoaWxlICgoKHRoZUJpdHMgPDwgKDMxIC0gYml0KSkgJiAweEZGRkZGRkZGKSA9PT0gMCkgewoJICAgICAgICAgICAgYml0Kys7CgkgICAgICAgIH0KCSAgICAgICAgeCArPSBiaXQ7CgkgICAgICAgIHJldHVybiBJbnQzMkFycmF5LmZyb20oW3gsIHldKTsKCSAgICB9OwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZ2V0Qm90dG9tUmlnaHRPbkJpdCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIHJvd1NpemUgPSB0aGlzLnJvd1NpemU7CgkgICAgICAgIHZhciBiaXRzID0gdGhpcy5iaXRzOwoJICAgICAgICB2YXIgYml0c09mZnNldCA9IGJpdHMubGVuZ3RoIC0gMTsKCSAgICAgICAgd2hpbGUgKGJpdHNPZmZzZXQgPj0gMCAmJiBiaXRzW2JpdHNPZmZzZXRdID09PSAwKSB7CgkgICAgICAgICAgICBiaXRzT2Zmc2V0LS07CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGJpdHNPZmZzZXQgPCAwKSB7CgkgICAgICAgICAgICByZXR1cm4gbnVsbDsKCSAgICAgICAgfQoJICAgICAgICB2YXIgeSA9IE1hdGguZmxvb3IoYml0c09mZnNldCAvIHJvd1NpemUpOwoJICAgICAgICB2YXIgeCA9IE1hdGguZmxvb3IoYml0c09mZnNldCAlIHJvd1NpemUpICogMzI7CgkgICAgICAgIHZhciB0aGVCaXRzID0gYml0c1tiaXRzT2Zmc2V0XTsKCSAgICAgICAgdmFyIGJpdCA9IDMxOwoJICAgICAgICB3aGlsZSAoKHRoZUJpdHMgPj4+IGJpdCkgPT09IDApIHsKCSAgICAgICAgICAgIGJpdC0tOwoJICAgICAgICB9CgkgICAgICAgIHggKz0gYml0OwoJICAgICAgICByZXR1cm4gSW50MzJBcnJheS5mcm9tKFt4LCB5XSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSB3aWR0aCBvZiB0aGUgbWF0cml4CgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5nZXRXaWR0aCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMud2lkdGg7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSBoZWlnaHQgb2YgdGhlIG1hdHJpeAoJICAgICAqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZ2V0SGVpZ2h0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5oZWlnaHQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSByb3cgc2l6ZSBvZiB0aGUgbWF0cml4CgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5nZXRSb3dTaXplID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yb3dTaXplOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZXF1YWxzID0gZnVuY3Rpb24gKG8pIHsKCSAgICAgICAgaWYgKCEobyBpbnN0YW5jZW9mIEJpdE1hdHJpeCkpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgb3RoZXIgPSBvOwoJICAgICAgICByZXR1cm4gdGhpcy53aWR0aCA9PT0gb3RoZXIud2lkdGggJiYgdGhpcy5oZWlnaHQgPT09IG90aGVyLmhlaWdodCAmJiB0aGlzLnJvd1NpemUgPT09IG90aGVyLnJvd1NpemUgJiYKCSAgICAgICAgICAgIEFycmF5c18xLmRlZmF1bHQuZXF1YWxzKHRoaXMuYml0cywgb3RoZXIuYml0cyk7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5oYXNoQ29kZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIGhhc2ggPSB0aGlzLndpZHRoOwoJICAgICAgICBoYXNoID0gMzEgKiBoYXNoICsgdGhpcy53aWR0aDsKCSAgICAgICAgaGFzaCA9IDMxICogaGFzaCArIHRoaXMuaGVpZ2h0OwoJICAgICAgICBoYXNoID0gMzEgKiBoYXNoICsgdGhpcy5yb3dTaXplOwoJICAgICAgICBoYXNoID0gMzEgKiBoYXNoICsgQXJyYXlzXzEuZGVmYXVsdC5oYXNoQ29kZSh0aGlzLmJpdHMpOwoJICAgICAgICByZXR1cm4gaGFzaDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gc3RyaW5nIHJlcHJlc2VudGF0aW9uIHVzaW5nICJYIiBmb3Igc2V0IGFuZCAiICIgZm9yIHVuc2V0IGJpdHMKCSAgICAgKi8KCSAgICAvKkBPdmVycmlkZSovCgkgICAgLy8gcHVibGljIHRvU3RyaW5nKCk6IHN0cmluZyB7CgkgICAgLy8gICByZXR1cm4gdG9TdHJpbmcoIjogIlgsICIgICIpCgkgICAgLy8gfQoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBzZXRTdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgYSBzZXQgYml0CgkgICAgICogQHBhcmFtIHVuc2V0U3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIGFuIHVuc2V0IGJpdAoJICAgICAqIEByZXR1cm4gc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIGVudGlyZSBtYXRyaXggdXRpbGl6aW5nIGdpdmVuIHN0cmluZ3MKCSAgICAgKi8KCSAgICAvLyBwdWJsaWMgdG9TdHJpbmcoc2V0U3RyaW5nOiBzdHJpbmcgPSAiWCAiLCB1bnNldFN0cmluZzogc3RyaW5nID0gIiAgIik6IHN0cmluZyB7CgkgICAgLy8gICByZXR1cm4gdGhpcy5idWlsZFRvU3RyaW5nKHNldFN0cmluZywgdW5zZXRTdHJpbmcsICJcbiIpCgkgICAgLy8gfQoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBzZXRTdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgYSBzZXQgYml0CgkgICAgICogQHBhcmFtIHVuc2V0U3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIGFuIHVuc2V0IGJpdAoJICAgICAqIEBwYXJhbSBsaW5lU2VwYXJhdG9yIG5ld2xpbmUgY2hhcmFjdGVyIGluIHN0cmluZyByZXByZXNlbnRhdGlvbgoJICAgICAqIEByZXR1cm4gc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIGVudGlyZSBtYXRyaXggdXRpbGl6aW5nIGdpdmVuIHN0cmluZ3MgYW5kIGxpbmUgc2VwYXJhdG9yCgkgICAgICogQGRlcHJlY2F0ZWQgY2FsbCB7QGxpbmsgI3RvU3RyaW5nKFN0cmluZyxTdHJpbmcpfSBvbmx5LCB3aGljaCB1c2VzIFxuIGxpbmUgc2VwYXJhdG9yIGFsd2F5cwoJICAgICAqLwoJICAgIC8vIEBEZXByZWNhdGVkCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uIChzZXRTdHJpbmcsIHVuc2V0U3RyaW5nLCBsaW5lU2VwYXJhdG9yKSB7CgkgICAgICAgIGlmIChzZXRTdHJpbmcgPT09IHZvaWQgMCkgeyBzZXRTdHJpbmcgPSAnWCAnOyB9CgkgICAgICAgIGlmICh1bnNldFN0cmluZyA9PT0gdm9pZCAwKSB7IHVuc2V0U3RyaW5nID0gJyAgJzsgfQoJICAgICAgICBpZiAobGluZVNlcGFyYXRvciA9PT0gdm9pZCAwKSB7IGxpbmVTZXBhcmF0b3IgPSAnXG4nOyB9CgkgICAgICAgIHJldHVybiB0aGlzLmJ1aWxkVG9TdHJpbmcoc2V0U3RyaW5nLCB1bnNldFN0cmluZywgbGluZVNlcGFyYXRvcik7CgkgICAgfTsKCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLmJ1aWxkVG9TdHJpbmcgPSBmdW5jdGlvbiAoc2V0U3RyaW5nLCB1bnNldFN0cmluZywgbGluZVNlcGFyYXRvcikgewoJICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IFN0cmluZ0J1aWxkZXJfMSQyLmRlZmF1bHQoKTsKCSAgICAgICAgLy8gcmVzdWx0LmFwcGVuZChsaW5lU2VwYXJhdG9yKTsKCSAgICAgICAgZm9yICh2YXIgeSA9IDAsIGhlaWdodCA9IHRoaXMuaGVpZ2h0OyB5IDwgaGVpZ2h0OyB5KyspIHsKCSAgICAgICAgICAgIGZvciAodmFyIHggPSAwLCB3aWR0aCA9IHRoaXMud2lkdGg7IHggPCB3aWR0aDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgcmVzdWx0LmFwcGVuZCh0aGlzLmdldCh4LCB5KSA/IHNldFN0cmluZyA6IHVuc2V0U3RyaW5nKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQobGluZVNlcGFyYXRvcik7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdC50b1N0cmluZygpOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuY2xvbmUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiBuZXcgQml0TWF0cml4KHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0LCB0aGlzLnJvd1NpemUsIHRoaXMuYml0cy5zbGljZSgpKTsKCSAgICB9OwoJICAgIHJldHVybiBCaXRNYXRyaXg7Cgl9KCkpOwoJQml0TWF0cml4JDEuZGVmYXVsdCA9IEJpdE1hdHJpeDsKCgl2YXIgTm90Rm91bmRFeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkZCA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShOb3RGb3VuZEV4Y2VwdGlvbiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgRXhjZXB0aW9uXzEkNSA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBOb3RGb3VuZEV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkZChOb3RGb3VuZEV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBOb3RGb3VuZEV4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBOb3RGb3VuZEV4Y2VwdGlvbi5nZXROb3RGb3VuZEluc3RhbmNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IE5vdEZvdW5kRXhjZXB0aW9uKCk7CgkgICAgfTsKCSAgICBOb3RGb3VuZEV4Y2VwdGlvbi5raW5kID0gJ05vdEZvdW5kRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gTm90Rm91bmRFeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xJDUuZGVmYXVsdCkpOwoJTm90Rm91bmRFeGNlcHRpb24kMS5kZWZhdWx0ID0gTm90Rm91bmRFeGNlcHRpb247CgoJLyoKCSAqIENvcHlyaWdodCAyMDA5IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCXZhciBfX2V4dGVuZHMkYyA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5jb21tb24geyovCgl2YXIgQmluYXJpemVyXzEgPSBCaW5hcml6ZXIkMTsKCXZhciBCaXRBcnJheV8xID0gQml0QXJyYXkkMTsKCXZhciBCaXRNYXRyaXhfMSQ1ID0gQml0TWF0cml4JDE7Cgl2YXIgTm90Rm91bmRFeGNlcHRpb25fMSQ2ID0gTm90Rm91bmRFeGNlcHRpb24kMTsKCS8qKgoJICogVGhpcyBCaW5hcml6ZXIgaW1wbGVtZW50YXRpb24gdXNlcyB0aGUgb2xkIFpYaW5nIGdsb2JhbCBoaXN0b2dyYW0gYXBwcm9hY2guIEl0IGlzIHN1aXRhYmxlCgkgKiBmb3IgbG93LWVuZCBtb2JpbGUgZGV2aWNlcyB3aGljaCBkb24ndCBoYXZlIGVub3VnaCBDUFUgb3IgbWVtb3J5IHRvIHVzZSBhIGxvY2FsIHRocmVzaG9sZGluZwoJICogYWxnb3JpdGhtLiBIb3dldmVyLCBiZWNhdXNlIGl0IHBpY2tzIGEgZ2xvYmFsIGJsYWNrIHBvaW50LCBpdCBjYW5ub3QgaGFuZGxlIGRpZmZpY3VsdCBzaGFkb3dzCgkgKiBhbmQgZ3JhZGllbnRzLgoJICoKCSAqIEZhc3RlciBtb2JpbGUgZGV2aWNlcyBhbmQgYWxsIGRlc2t0b3AgYXBwbGljYXRpb25zIHNob3VsZCBwcm9iYWJseSB1c2UgSHlicmlkQmluYXJpemVyIGluc3RlYWQuCgkgKgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJGMoR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplcihzb3VyY2UpIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgc291cmNlKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5sdW1pbmFuY2VzID0gR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLkVNUFRZOwoJICAgICAgICBfdGhpcy5idWNrZXRzID0gbmV3IEludDMyQXJyYXkoR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLkxVTUlOQU5DRV9CVUNLRVRTKTsKCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICAvLyBBcHBsaWVzIHNpbXBsZSBzaGFycGVuaW5nIHRvIHRoZSByb3cgZGF0YSB0byBpbXByb3ZlIHBlcmZvcm1hbmNlIG9mIHRoZSAxRCBSZWFkZXJzLgoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIucHJvdG90eXBlLmdldEJsYWNrUm93ID0gZnVuY3Rpb24gKHkgLyppbnQqLywgcm93KSB7CgkgICAgICAgIHZhciBzb3VyY2UgPSB0aGlzLmdldEx1bWluYW5jZVNvdXJjZSgpOwoJICAgICAgICB2YXIgd2lkdGggPSBzb3VyY2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgaWYgKHJvdyA9PT0gdW5kZWZpbmVkIHx8IHJvdyA9PT0gbnVsbCB8fCByb3cuZ2V0U2l6ZSgpIDwgd2lkdGgpIHsKCSAgICAgICAgICAgIHJvdyA9IG5ldyBCaXRBcnJheV8xLmRlZmF1bHQod2lkdGgpOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgcm93LmNsZWFyKCk7CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy5pbml0QXJyYXlzKHdpZHRoKTsKCSAgICAgICAgdmFyIGxvY2FsTHVtaW5hbmNlcyA9IHNvdXJjZS5nZXRSb3coeSwgdGhpcy5sdW1pbmFuY2VzKTsKCSAgICAgICAgdmFyIGxvY2FsQnVja2V0cyA9IHRoaXMuYnVja2V0czsKCSAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCB3aWR0aDsgeCsrKSB7CgkgICAgICAgICAgICBsb2NhbEJ1Y2tldHNbKGxvY2FsTHVtaW5hbmNlc1t4XSAmIDB4ZmYpID4+IEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5MVU1JTkFOQ0VfU0hJRlRdKys7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGJsYWNrUG9pbnQgPSBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuZXN0aW1hdGVCbGFja1BvaW50KGxvY2FsQnVja2V0cyk7CgkgICAgICAgIGlmICh3aWR0aCA8IDMpIHsKCSAgICAgICAgICAgIC8vIFNwZWNpYWwgY2FzZSBmb3IgdmVyeSBzbWFsbCBpbWFnZXMKCSAgICAgICAgICAgIGZvciAodmFyIHggPSAwOyB4IDwgd2lkdGg7IHgrKykgewoJICAgICAgICAgICAgICAgIGlmICgobG9jYWxMdW1pbmFuY2VzW3hdICYgMHhmZikgPCBibGFja1BvaW50KSB7CgkgICAgICAgICAgICAgICAgICAgIHJvdy5zZXQoeCk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgdmFyIGxlZnQgPSBsb2NhbEx1bWluYW5jZXNbMF0gJiAweGZmOwoJICAgICAgICAgICAgdmFyIGNlbnRlciA9IGxvY2FsTHVtaW5hbmNlc1sxXSAmIDB4ZmY7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMTsgeCA8IHdpZHRoIC0gMTsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHJpZ2h0ID0gbG9jYWxMdW1pbmFuY2VzW3ggKyAxXSAmIDB4ZmY7CgkgICAgICAgICAgICAgICAgLy8gQSBzaW1wbGUgLTEgNCAtMSBib3ggZmlsdGVyIHdpdGggYSB3ZWlnaHQgb2YgMi4KCSAgICAgICAgICAgICAgICBpZiAoKChjZW50ZXIgKiA0KSAtIGxlZnQgLSByaWdodCkgLyAyIDwgYmxhY2tQb2ludCkgewoJICAgICAgICAgICAgICAgICAgICByb3cuc2V0KHgpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBsZWZ0ID0gY2VudGVyOwoJICAgICAgICAgICAgICAgIGNlbnRlciA9IHJpZ2h0OwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiByb3c7CgkgICAgfTsKCSAgICAvLyBEb2VzIG5vdCBzaGFycGVuIHRoZSBkYXRhLCBhcyB0aGlzIGNhbGwgaXMgaW50ZW5kZWQgdG8gb25seSBiZSB1c2VkIGJ5IDJEIFJlYWRlcnMuCgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5wcm90b3R5cGUuZ2V0QmxhY2tNYXRyaXggPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHZhciBzb3VyY2UgPSB0aGlzLmdldEx1bWluYW5jZVNvdXJjZSgpOwoJICAgICAgICB2YXIgd2lkdGggPSBzb3VyY2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIGhlaWdodCA9IHNvdXJjZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgdmFyIG1hdHJpeCA9IG5ldyBCaXRNYXRyaXhfMSQ1LmRlZmF1bHQod2lkdGgsIGhlaWdodCk7CgkgICAgICAgIC8vIFF1aWNrbHkgY2FsY3VsYXRlcyB0aGUgaGlzdG9ncmFtIGJ5IHNhbXBsaW5nIGZvdXIgcm93cyBmcm9tIHRoZSBpbWFnZS4gVGhpcyBwcm92ZWQgdG8gYmUKCSAgICAgICAgLy8gbW9yZSByb2J1c3Qgb24gdGhlIGJsYWNrYm94IHRlc3RzIHRoYW4gc2FtcGxpbmcgYSBkaWFnb25hbCBhcyB3ZSB1c2VkIHRvIGRvLgoJICAgICAgICB0aGlzLmluaXRBcnJheXMod2lkdGgpOwoJICAgICAgICB2YXIgbG9jYWxCdWNrZXRzID0gdGhpcy5idWNrZXRzOwoJICAgICAgICBmb3IgKHZhciB5ID0gMTsgeSA8IDU7IHkrKykgewoJICAgICAgICAgICAgdmFyIHJvdyA9IE1hdGguZmxvb3IoKGhlaWdodCAqIHkpIC8gNSk7CgkgICAgICAgICAgICB2YXIgbG9jYWxMdW1pbmFuY2VzXzEgPSBzb3VyY2UuZ2V0Um93KHJvdywgdGhpcy5sdW1pbmFuY2VzKTsKCSAgICAgICAgICAgIHZhciByaWdodCA9IE1hdGguZmxvb3IoKHdpZHRoICogNCkgLyA1KTsKCSAgICAgICAgICAgIGZvciAodmFyIHggPSBNYXRoLmZsb29yKHdpZHRoIC8gNSk7IHggPCByaWdodDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBpeGVsID0gbG9jYWxMdW1pbmFuY2VzXzFbeF0gJiAweGZmOwoJICAgICAgICAgICAgICAgIGxvY2FsQnVja2V0c1twaXhlbCA+PiBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuTFVNSU5BTkNFX1NISUZUXSsrOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHZhciBibGFja1BvaW50ID0gR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLmVzdGltYXRlQmxhY2tQb2ludChsb2NhbEJ1Y2tldHMpOwoJICAgICAgICAvLyBXZSBkZWxheSByZWFkaW5nIHRoZSBlbnRpcmUgaW1hZ2UgbHVtaW5hbmNlIHVudGlsIHRoZSBibGFjayBwb2ludCBlc3RpbWF0aW9uIHN1Y2NlZWRzLgoJICAgICAgICAvLyBBbHRob3VnaCB3ZSBlbmQgdXAgcmVhZGluZyBmb3VyIHJvd3MgdHdpY2UsIGl0IGlzIGNvbnNpc3RlbnQgd2l0aCBvdXIgbW90dG8gb2YKCSAgICAgICAgLy8gImZhaWwgcXVpY2tseSIgd2hpY2ggaXMgbmVjZXNzYXJ5IGZvciBjb250aW51b3VzIHNjYW5uaW5nLgoJICAgICAgICB2YXIgbG9jYWxMdW1pbmFuY2VzID0gc291cmNlLmdldE1hdHJpeCgpOwoJICAgICAgICBmb3IgKHZhciB5ID0gMDsgeSA8IGhlaWdodDsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgb2Zmc2V0ID0geSAqIHdpZHRoOwoJICAgICAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCB3aWR0aDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBpeGVsID0gbG9jYWxMdW1pbmFuY2VzW29mZnNldCArIHhdICYgMHhmZjsKCSAgICAgICAgICAgICAgICBpZiAocGl4ZWwgPCBibGFja1BvaW50KSB7CgkgICAgICAgICAgICAgICAgICAgIG1hdHJpeC5zZXQoeCwgeSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBtYXRyaXg7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLnByb3RvdHlwZS5jcmVhdGVCaW5hcml6ZXIgPSBmdW5jdGlvbiAoc291cmNlKSB7CgkgICAgICAgIHJldHVybiBuZXcgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyKHNvdXJjZSk7CgkgICAgfTsKCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIucHJvdG90eXBlLmluaXRBcnJheXMgPSBmdW5jdGlvbiAobHVtaW5hbmNlU2l6ZSAvKmludCovKSB7CgkgICAgICAgIGlmICh0aGlzLmx1bWluYW5jZXMubGVuZ3RoIDwgbHVtaW5hbmNlU2l6ZSkgewoJICAgICAgICAgICAgdGhpcy5sdW1pbmFuY2VzID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KGx1bWluYW5jZVNpemUpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBidWNrZXRzID0gdGhpcy5idWNrZXRzOwoJICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5MVU1JTkFOQ0VfQlVDS0VUUzsgeCsrKSB7CgkgICAgICAgICAgICBidWNrZXRzW3hdID0gMDsKCSAgICAgICAgfQoJICAgIH07CgkgICAgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLmVzdGltYXRlQmxhY2tQb2ludCA9IGZ1bmN0aW9uIChidWNrZXRzKSB7CgkgICAgICAgIC8vIEZpbmQgdGhlIHRhbGxlc3QgcGVhayBpbiB0aGUgaGlzdG9ncmFtLgoJICAgICAgICB2YXIgbnVtQnVja2V0cyA9IGJ1Y2tldHMubGVuZ3RoOwoJICAgICAgICB2YXIgbWF4QnVja2V0Q291bnQgPSAwOwoJICAgICAgICB2YXIgZmlyc3RQZWFrID0gMDsKCSAgICAgICAgdmFyIGZpcnN0UGVha1NpemUgPSAwOwoJICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IG51bUJ1Y2tldHM7IHgrKykgewoJICAgICAgICAgICAgaWYgKGJ1Y2tldHNbeF0gPiBmaXJzdFBlYWtTaXplKSB7CgkgICAgICAgICAgICAgICAgZmlyc3RQZWFrID0geDsKCSAgICAgICAgICAgICAgICBmaXJzdFBlYWtTaXplID0gYnVja2V0c1t4XTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGlmIChidWNrZXRzW3hdID4gbWF4QnVja2V0Q291bnQpIHsKCSAgICAgICAgICAgICAgICBtYXhCdWNrZXRDb3VudCA9IGJ1Y2tldHNbeF07CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gRmluZCB0aGUgc2Vjb25kLXRhbGxlc3QgcGVhayB3aGljaCBpcyBzb21ld2hhdCBmYXIgZnJvbSB0aGUgdGFsbGVzdCBwZWFrLgoJICAgICAgICB2YXIgc2Vjb25kUGVhayA9IDA7CgkgICAgICAgIHZhciBzZWNvbmRQZWFrU2NvcmUgPSAwOwoJICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IG51bUJ1Y2tldHM7IHgrKykgewoJICAgICAgICAgICAgdmFyIGRpc3RhbmNlVG9CaWdnZXN0ID0geCAtIGZpcnN0UGVhazsKCSAgICAgICAgICAgIC8vIEVuY291cmFnZSBtb3JlIGRpc3RhbnQgc2Vjb25kIHBlYWtzIGJ5IG11bHRpcGx5aW5nIGJ5IHNxdWFyZSBvZiBkaXN0YW5jZS4KCSAgICAgICAgICAgIHZhciBzY29yZSA9IGJ1Y2tldHNbeF0gKiBkaXN0YW5jZVRvQmlnZ2VzdCAqIGRpc3RhbmNlVG9CaWdnZXN0OwoJICAgICAgICAgICAgaWYgKHNjb3JlID4gc2Vjb25kUGVha1Njb3JlKSB7CgkgICAgICAgICAgICAgICAgc2Vjb25kUGVhayA9IHg7CgkgICAgICAgICAgICAgICAgc2Vjb25kUGVha1Njb3JlID0gc2NvcmU7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gTWFrZSBzdXJlIGZpcnN0UGVhayBjb3JyZXNwb25kcyB0byB0aGUgYmxhY2sgcGVhay4KCSAgICAgICAgaWYgKGZpcnN0UGVhayA+IHNlY29uZFBlYWspIHsKCSAgICAgICAgICAgIHZhciB0ZW1wID0gZmlyc3RQZWFrOwoJICAgICAgICAgICAgZmlyc3RQZWFrID0gc2Vjb25kUGVhazsKCSAgICAgICAgICAgIHNlY29uZFBlYWsgPSB0ZW1wOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIHRoZXJlIGlzIHRvbyBsaXR0bGUgY29udHJhc3QgaW4gdGhlIGltYWdlIHRvIHBpY2sgYSBtZWFuaW5nZnVsIGJsYWNrIHBvaW50LCB0aHJvdyByYXRoZXIKCSAgICAgICAgLy8gdGhhbiB3YXN0ZSB0aW1lIHRyeWluZyB0byBkZWNvZGUgdGhlIGltYWdlLCBhbmQgcmlzayBmYWxzZSBwb3NpdGl2ZXMuCgkgICAgICAgIGlmIChzZWNvbmRQZWFrIC0gZmlyc3RQZWFrIDw9IG51bUJ1Y2tldHMgLyAxNikgewoJICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkNi5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gRmluZCBhIHZhbGxleSBiZXR3ZWVuIHRoZW0gdGhhdCBpcyBsb3cgYW5kIGNsb3NlciB0byB0aGUgd2hpdGUgcGVhay4KCSAgICAgICAgdmFyIGJlc3RWYWxsZXkgPSBzZWNvbmRQZWFrIC0gMTsKCSAgICAgICAgdmFyIGJlc3RWYWxsZXlTY29yZSA9IC0xOwoJICAgICAgICBmb3IgKHZhciB4ID0gc2Vjb25kUGVhayAtIDE7IHggPiBmaXJzdFBlYWs7IHgtLSkgewoJICAgICAgICAgICAgdmFyIGZyb21GaXJzdCA9IHggLSBmaXJzdFBlYWs7CgkgICAgICAgICAgICB2YXIgc2NvcmUgPSBmcm9tRmlyc3QgKiBmcm9tRmlyc3QgKiAoc2Vjb25kUGVhayAtIHgpICogKG1heEJ1Y2tldENvdW50IC0gYnVja2V0c1t4XSk7CgkgICAgICAgICAgICBpZiAoc2NvcmUgPiBiZXN0VmFsbGV5U2NvcmUpIHsKCSAgICAgICAgICAgICAgICBiZXN0VmFsbGV5ID0geDsKCSAgICAgICAgICAgICAgICBiZXN0VmFsbGV5U2NvcmUgPSBzY29yZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gYmVzdFZhbGxleSA8PCBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuTFVNSU5BTkNFX1NISUZUOwoJICAgIH07CgkgICAgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLkxVTUlOQU5DRV9CSVRTID0gNTsKCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuTFVNSU5BTkNFX1NISUZUID0gOCAtIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5MVU1JTkFOQ0VfQklUUzsKCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuTFVNSU5BTkNFX0JVQ0tFVFMgPSAxIDw8IEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5MVU1JTkFOQ0VfQklUUzsKCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuRU1QVFkgPSBVaW50OENsYW1wZWRBcnJheS5mcm9tKFswXSk7CgkgICAgcmV0dXJuIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplcjsKCX0oQmluYXJpemVyXzEuZGVmYXVsdCkpOwoJR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyJDEuZGVmYXVsdCA9IEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplcjsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDkgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fZXh0ZW5kcyRiID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHsKCSAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKCSAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHwKCSAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9OwoJICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICB9OwoJICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KCSAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwoJICAgIH07Cgl9KSgpOwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEh5YnJpZEJpbmFyaXplciQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyXzEgPSBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIkMTsKCXZhciBCaXRNYXRyaXhfMSQ0ID0gQml0TWF0cml4JDE7CgkvKioKCSAqIFRoaXMgY2xhc3MgaW1wbGVtZW50cyBhIGxvY2FsIHRocmVzaG9sZGluZyBhbGdvcml0aG0sIHdoaWNoIHdoaWxlIHNsb3dlciB0aGFuIHRoZQoJICogR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLCBpcyBmYWlybHkgZWZmaWNpZW50IGZvciB3aGF0IGl0IGRvZXMuIEl0IGlzIGRlc2lnbmVkIGZvcgoJICogaGlnaCBmcmVxdWVuY3kgaW1hZ2VzIG9mIGJhcmNvZGVzIHdpdGggYmxhY2sgZGF0YSBvbiB3aGl0ZSBiYWNrZ3JvdW5kcy4gRm9yIHRoaXMgYXBwbGljYXRpb24sCgkgKiBpdCBkb2VzIGEgbXVjaCBiZXR0ZXIgam9iIHRoYW4gYSBnbG9iYWwgYmxhY2twb2ludCB3aXRoIHNldmVyZSBzaGFkb3dzIGFuZCBncmFkaWVudHMuCgkgKiBIb3dldmVyIGl0IHRlbmRzIHRvIHByb2R1Y2UgYXJ0aWZhY3RzIG9uIGxvd2VyIGZyZXF1ZW5jeSBpbWFnZXMgYW5kIGlzIHRoZXJlZm9yZSBub3QKCSAqIGEgZ29vZCBnZW5lcmFsIHB1cnBvc2UgYmluYXJpemVyIGZvciB1c2VzIG91dHNpZGUgWlhpbmcuCgkgKgoJICogVGhpcyBjbGFzcyBleHRlbmRzIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplciwgdXNpbmcgdGhlIG9sZGVyIGhpc3RvZ3JhbSBhcHByb2FjaCBmb3IgMUQgcmVhZGVycywKCSAqIGFuZCB0aGUgbmV3ZXIgbG9jYWwgYXBwcm9hY2ggZm9yIDJEIHJlYWRlcnMuIDFEIGRlY29kaW5nIHVzaW5nIGEgcGVyLXJvdyBoaXN0b2dyYW0gaXMgYWxyZWFkeQoJICogaW5oZXJlbnRseSBsb2NhbCwgYW5kIG9ubHkgZmFpbHMgZm9yIGhvcml6b250YWwgZ3JhZGllbnRzLiBXZSBjYW4gcmV2aXNpdCB0aGF0IHByb2JsZW0gbGF0ZXIsCgkgKiBidXQgZm9yIG5vdyBpdCB3YXMgbm90IGEgd2luIHRvIHVzZSBsb2NhbCBibG9ja3MgZm9yIDFELgoJICoKCSAqIFRoaXMgQmluYXJpemVyIGlzIHRoZSBkZWZhdWx0IGZvciB0aGUgdW5pdCB0ZXN0cyBhbmQgdGhlIHJlY29tbWVuZGVkIGNsYXNzIGZvciBsaWJyYXJ5IHVzZXJzLgoJICoKCSAqIEBhdXRob3IgZHN3aXRraW5AZ29vZ2xlLmNvbSAoRGFuaWVsIFN3aXRraW4pCgkgKi8KCXZhciBIeWJyaWRCaW5hcml6ZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJGIoSHlicmlkQmluYXJpemVyLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIEh5YnJpZEJpbmFyaXplcihzb3VyY2UpIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgc291cmNlKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5tYXRyaXggPSBudWxsOwoJICAgICAgICByZXR1cm4gX3RoaXM7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIENhbGN1bGF0ZXMgdGhlIGZpbmFsIEJpdE1hdHJpeCBvbmNlIGZvciBhbGwgcmVxdWVzdHMuIFRoaXMgY291bGQgYmUgY2FsbGVkIG9uY2UgZnJvbSB0aGUKCSAgICAgKiBjb25zdHJ1Y3RvciBpbnN0ZWFkLCBidXQgdGhlcmUgYXJlIHNvbWUgYWR2YW50YWdlcyB0byBkb2luZyBpdCBsYXppbHksIHN1Y2ggYXMgbWFraW5nCgkgICAgICogcHJvZmlsaW5nIGVhc2llciwgYW5kIG5vdCBkb2luZyBoZWF2eSBsaWZ0aW5nIHdoZW4gY2FsbGVycyBkb24ndCBleHBlY3QgaXQuCgkgICAgICovCgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEh5YnJpZEJpbmFyaXplci5wcm90b3R5cGUuZ2V0QmxhY2tNYXRyaXggPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIGlmICh0aGlzLm1hdHJpeCAhPT0gbnVsbCkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMubWF0cml4OwoJICAgICAgICB9CgkgICAgICAgIHZhciBzb3VyY2UgPSB0aGlzLmdldEx1bWluYW5jZVNvdXJjZSgpOwoJICAgICAgICB2YXIgd2lkdGggPSBzb3VyY2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIGhlaWdodCA9IHNvdXJjZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgaWYgKHdpZHRoID49IEh5YnJpZEJpbmFyaXplci5NSU5JTVVNX0RJTUVOU0lPTiAmJiBoZWlnaHQgPj0gSHlicmlkQmluYXJpemVyLk1JTklNVU1fRElNRU5TSU9OKSB7CgkgICAgICAgICAgICB2YXIgbHVtaW5hbmNlcyA9IHNvdXJjZS5nZXRNYXRyaXgoKTsKCSAgICAgICAgICAgIHZhciBzdWJXaWR0aCA9IHdpZHRoID4+IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSOwoJICAgICAgICAgICAgaWYgKCh3aWR0aCAmIEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX01BU0spICE9PSAwKSB7CgkgICAgICAgICAgICAgICAgc3ViV2lkdGgrKzsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHZhciBzdWJIZWlnaHQgPSBoZWlnaHQgPj4gSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkVfUE9XRVI7CgkgICAgICAgICAgICBpZiAoKGhlaWdodCAmIEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX01BU0spICE9PSAwKSB7CgkgICAgICAgICAgICAgICAgc3ViSGVpZ2h0Kys7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB2YXIgYmxhY2tQb2ludHMgPSBIeWJyaWRCaW5hcml6ZXIuY2FsY3VsYXRlQmxhY2tQb2ludHMobHVtaW5hbmNlcywgc3ViV2lkdGgsIHN1YkhlaWdodCwgd2lkdGgsIGhlaWdodCk7CgkgICAgICAgICAgICB2YXIgbmV3TWF0cml4ID0gbmV3IEJpdE1hdHJpeF8xJDQuZGVmYXVsdCh3aWR0aCwgaGVpZ2h0KTsKCSAgICAgICAgICAgIEh5YnJpZEJpbmFyaXplci5jYWxjdWxhdGVUaHJlc2hvbGRGb3JCbG9jayhsdW1pbmFuY2VzLCBzdWJXaWR0aCwgc3ViSGVpZ2h0LCB3aWR0aCwgaGVpZ2h0LCBibGFja1BvaW50cywgbmV3TWF0cml4KTsKCSAgICAgICAgICAgIHRoaXMubWF0cml4ID0gbmV3TWF0cml4OwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgLy8gSWYgdGhlIGltYWdlIGlzIHRvbyBzbWFsbCwgZmFsbCBiYWNrIHRvIHRoZSBnbG9iYWwgaGlzdG9ncmFtIGFwcHJvYWNoLgoJICAgICAgICAgICAgdGhpcy5tYXRyaXggPSBfc3VwZXIucHJvdG90eXBlLmdldEJsYWNrTWF0cml4LmNhbGwodGhpcyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRoaXMubWF0cml4OwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEh5YnJpZEJpbmFyaXplci5wcm90b3R5cGUuY3JlYXRlQmluYXJpemVyID0gZnVuY3Rpb24gKHNvdXJjZSkgewoJICAgICAgICByZXR1cm4gbmV3IEh5YnJpZEJpbmFyaXplcihzb3VyY2UpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogRm9yIGVhY2ggYmxvY2sgaW4gdGhlIGltYWdlLCBjYWxjdWxhdGUgdGhlIGF2ZXJhZ2UgYmxhY2sgcG9pbnQgdXNpbmcgYSA1eDUgZ3JpZAoJICAgICAqIG9mIHRoZSBibG9ja3MgYXJvdW5kIGl0LiBBbHNvIGhhbmRsZXMgdGhlIGNvcm5lciBjYXNlcyAoZnJhY3Rpb25hbCBibG9ja3MgYXJlIGNvbXB1dGVkIGJhc2VkCgkgICAgICogb24gdGhlIGxhc3QgcGl4ZWxzIGluIHRoZSByb3cvY29sdW1uIHdoaWNoIGFyZSBhbHNvIHVzZWQgaW4gdGhlIHByZXZpb3VzIGJsb2NrKS4KCSAgICAgKi8KCSAgICBIeWJyaWRCaW5hcml6ZXIuY2FsY3VsYXRlVGhyZXNob2xkRm9yQmxvY2sgPSBmdW5jdGlvbiAobHVtaW5hbmNlcywgc3ViV2lkdGggLyppbnQqLywgc3ViSGVpZ2h0IC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovLCBibGFja1BvaW50cywgbWF0cml4KSB7CgkgICAgICAgIHZhciBtYXhZT2Zmc2V0ID0gaGVpZ2h0IC0gSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7CgkgICAgICAgIHZhciBtYXhYT2Zmc2V0ID0gd2lkdGggLSBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRTsKCSAgICAgICAgZm9yICh2YXIgeSA9IDA7IHkgPCBzdWJIZWlnaHQ7IHkrKykgewoJICAgICAgICAgICAgdmFyIHlvZmZzZXQgPSB5IDw8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSOwoJICAgICAgICAgICAgaWYgKHlvZmZzZXQgPiBtYXhZT2Zmc2V0KSB7CgkgICAgICAgICAgICAgICAgeW9mZnNldCA9IG1heFlPZmZzZXQ7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB2YXIgdG9wXzEgPSBIeWJyaWRCaW5hcml6ZXIuY2FwKHksIDIsIHN1YkhlaWdodCAtIDMpOwoJICAgICAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCBzdWJXaWR0aDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHhvZmZzZXQgPSB4IDw8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSOwoJICAgICAgICAgICAgICAgIGlmICh4b2Zmc2V0ID4gbWF4WE9mZnNldCkgewoJICAgICAgICAgICAgICAgICAgICB4b2Zmc2V0ID0gbWF4WE9mZnNldDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgdmFyIGxlZnQgPSBIeWJyaWRCaW5hcml6ZXIuY2FwKHgsIDIsIHN1YldpZHRoIC0gMyk7CgkgICAgICAgICAgICAgICAgdmFyIHN1bSA9IDA7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgeiA9IC0yOyB6IDw9IDI7IHorKykgewoJICAgICAgICAgICAgICAgICAgICB2YXIgYmxhY2tSb3cgPSBibGFja1BvaW50c1t0b3BfMSArIHpdOwoJICAgICAgICAgICAgICAgICAgICBzdW0gKz0gYmxhY2tSb3dbbGVmdCAtIDJdICsgYmxhY2tSb3dbbGVmdCAtIDFdICsgYmxhY2tSb3dbbGVmdF0gKyBibGFja1Jvd1tsZWZ0ICsgMV0gKyBibGFja1Jvd1tsZWZ0ICsgMl07CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIHZhciBhdmVyYWdlID0gc3VtIC8gMjU7CgkgICAgICAgICAgICAgICAgSHlicmlkQmluYXJpemVyLnRocmVzaG9sZEJsb2NrKGx1bWluYW5jZXMsIHhvZmZzZXQsIHlvZmZzZXQsIGF2ZXJhZ2UsIHdpZHRoLCBtYXRyaXgpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICBIeWJyaWRCaW5hcml6ZXIuY2FwID0gZnVuY3Rpb24gKHZhbHVlIC8qaW50Ki8sIG1pbiAvKmludCovLCBtYXggLyppbnQqLykgewoJICAgICAgICByZXR1cm4gdmFsdWUgPCBtaW4gPyBtaW4gOiB2YWx1ZSA+IG1heCA/IG1heCA6IHZhbHVlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQXBwbGllcyBhIHNpbmdsZSB0aHJlc2hvbGQgdG8gYSBibG9jayBvZiBwaXhlbHMuCgkgICAgICovCgkgICAgSHlicmlkQmluYXJpemVyLnRocmVzaG9sZEJsb2NrID0gZnVuY3Rpb24gKGx1bWluYW5jZXMsIHhvZmZzZXQgLyppbnQqLywgeW9mZnNldCAvKmludCovLCB0aHJlc2hvbGQgLyppbnQqLywgc3RyaWRlIC8qaW50Ki8sIG1hdHJpeCkgewoJICAgICAgICBmb3IgKHZhciB5ID0gMCwgb2Zmc2V0ID0geW9mZnNldCAqIHN0cmlkZSArIHhvZmZzZXQ7IHkgPCBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRTsgeSsrLCBvZmZzZXQgKz0gc3RyaWRlKSB7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFOyB4KyspIHsKCSAgICAgICAgICAgICAgICAvLyBDb21wYXJpc29uIG5lZWRzIHRvIGJlIDw9IHNvIHRoYXQgYmxhY2sgPT0gMCBwaXhlbHMgYXJlIGJsYWNrIGV2ZW4gaWYgdGhlIHRocmVzaG9sZCBpcyAwLgoJICAgICAgICAgICAgICAgIGlmICgobHVtaW5hbmNlc1tvZmZzZXQgKyB4XSAmIDB4RkYpIDw9IHRocmVzaG9sZCkgewoJICAgICAgICAgICAgICAgICAgICBtYXRyaXguc2V0KHhvZmZzZXQgKyB4LCB5b2Zmc2V0ICsgeSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBDYWxjdWxhdGVzIGEgc2luZ2xlIGJsYWNrIHBvaW50IGZvciBlYWNoIGJsb2NrIG9mIHBpeGVscyBhbmQgc2F2ZXMgaXQgYXdheS4KCSAgICAgKiBTZWUgdGhlIGZvbGxvd2luZyB0aHJlYWQgZm9yIGEgZGlzY3Vzc2lvbiBvZiB0aGlzIGFsZ29yaXRobToKCSAgICAgKiAgaHR0cDovL2dyb3Vwcy5nb29nbGUuY29tL2dyb3VwL3p4aW5nL2Jyb3dzZV90aHJlYWQvdGhyZWFkL2QwNmVmYTJjMzVhN2RkYzAKCSAgICAgKi8KCSAgICBIeWJyaWRCaW5hcml6ZXIuY2FsY3VsYXRlQmxhY2tQb2ludHMgPSBmdW5jdGlvbiAobHVtaW5hbmNlcywgc3ViV2lkdGggLyppbnQqLywgc3ViSGVpZ2h0IC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovKSB7CgkgICAgICAgIHZhciBtYXhZT2Zmc2V0ID0gaGVpZ2h0IC0gSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7CgkgICAgICAgIHZhciBtYXhYT2Zmc2V0ID0gd2lkdGggLSBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRTsKCSAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOndoaXRlc3BhY2UKCSAgICAgICAgdmFyIGJsYWNrUG9pbnRzID0gbmV3IEFycmF5KHN1YkhlaWdodCk7IC8vIHN1YldpZHRoCgkgICAgICAgIGZvciAodmFyIHkgPSAwOyB5IDwgc3ViSGVpZ2h0OyB5KyspIHsKCSAgICAgICAgICAgIGJsYWNrUG9pbnRzW3ldID0gbmV3IEludDMyQXJyYXkoc3ViV2lkdGgpOwoJICAgICAgICAgICAgdmFyIHlvZmZzZXQgPSB5IDw8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSOwoJICAgICAgICAgICAgaWYgKHlvZmZzZXQgPiBtYXhZT2Zmc2V0KSB7CgkgICAgICAgICAgICAgICAgeW9mZnNldCA9IG1heFlPZmZzZXQ7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IHN1YldpZHRoOyB4KyspIHsKCSAgICAgICAgICAgICAgICB2YXIgeG9mZnNldCA9IHggPDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkVfUE9XRVI7CgkgICAgICAgICAgICAgICAgaWYgKHhvZmZzZXQgPiBtYXhYT2Zmc2V0KSB7CgkgICAgICAgICAgICAgICAgICAgIHhvZmZzZXQgPSBtYXhYT2Zmc2V0OwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB2YXIgc3VtID0gMDsKCSAgICAgICAgICAgICAgICB2YXIgbWluID0gMHhGRjsKCSAgICAgICAgICAgICAgICB2YXIgbWF4ID0gMDsKCSAgICAgICAgICAgICAgICBmb3IgKHZhciB5eSA9IDAsIG9mZnNldCA9IHlvZmZzZXQgKiB3aWR0aCArIHhvZmZzZXQ7IHl5IDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7IHl5KyssIG9mZnNldCArPSB3aWR0aCkgewoJICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciB4eCA9IDA7IHh4IDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7IHh4KyspIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwaXhlbCA9IGx1bWluYW5jZXNbb2Zmc2V0ICsgeHhdICYgMHhGRjsKCSAgICAgICAgICAgICAgICAgICAgICAgIHN1bSArPSBwaXhlbDsKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIHN0aWxsIGxvb2tpbmcgZm9yIGdvb2QgY29udHJhc3QKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwaXhlbCA8IG1pbikgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pbiA9IHBpeGVsOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBpeGVsID4gbWF4KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4ID0gcGl4ZWw7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgLy8gc2hvcnQtY2lyY3VpdCBtaW4vbWF4IHRlc3RzIG9uY2UgZHluYW1pYyByYW5nZSBpcyBtZXQKCSAgICAgICAgICAgICAgICAgICAgaWYgKG1heCAtIG1pbiA+IEh5YnJpZEJpbmFyaXplci5NSU5fRFlOQU1JQ19SQU5HRSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gZmluaXNoIHRoZSByZXN0IG9mIHRoZSByb3dzIHF1aWNrbHkKCSAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoeXkrKywgb2Zmc2V0ICs9IHdpZHRoOyB5eSA8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFOyB5eSsrLCBvZmZzZXQgKz0gd2lkdGgpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciB4eCA9IDA7IHh4IDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7IHh4KyspIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VtICs9IGx1bWluYW5jZXNbb2Zmc2V0ICsgeHhdICYgMHhGRjsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgLy8gVGhlIGRlZmF1bHQgZXN0aW1hdGUgaXMgdGhlIGF2ZXJhZ2Ugb2YgdGhlIHZhbHVlcyBpbiB0aGUgYmxvY2suCgkgICAgICAgICAgICAgICAgdmFyIGF2ZXJhZ2UgPSBzdW0gPj4gKEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSICogMik7CgkgICAgICAgICAgICAgICAgaWYgKG1heCAtIG1pbiA8PSBIeWJyaWRCaW5hcml6ZXIuTUlOX0RZTkFNSUNfUkFOR0UpIHsKCSAgICAgICAgICAgICAgICAgICAgLy8gSWYgdmFyaWF0aW9uIHdpdGhpbiB0aGUgYmxvY2sgaXMgbG93LCBhc3N1bWUgdGhpcyBpcyBhIGJsb2NrIHdpdGggb25seSBsaWdodCBvciBvbmx5CgkgICAgICAgICAgICAgICAgICAgIC8vIGRhcmsgcGl4ZWxzLiBJbiB0aGF0IGNhc2Ugd2UgZG8gbm90IHdhbnQgdG8gdXNlIHRoZSBhdmVyYWdlLCBhcyBpdCB3b3VsZCBkaXZpZGUgdGhpcwoJICAgICAgICAgICAgICAgICAgICAvLyBsb3cgY29udHJhc3QgYXJlYSBpbnRvIGJsYWNrIGFuZCB3aGl0ZSBwaXhlbHMsIGVzc2VudGlhbGx5IGNyZWF0aW5nIGRhdGEgb3V0IG9mIG5vaXNlLgoJICAgICAgICAgICAgICAgICAgICAvLwoJICAgICAgICAgICAgICAgICAgICAvLyBUaGUgZGVmYXVsdCBhc3N1bXB0aW9uIGlzIHRoYXQgdGhlIGJsb2NrIGlzIGxpZ2h0L2JhY2tncm91bmQuIFNpbmNlIG5vIGVzdGltYXRlIGZvcgoJICAgICAgICAgICAgICAgICAgICAvLyB0aGUgbGV2ZWwgb2YgZGFyayBwaXhlbHMgZXhpc3RzIGxvY2FsbHksIHVzZSBoYWxmIHRoZSBtaW4gZm9yIHRoZSBibG9jay4KCSAgICAgICAgICAgICAgICAgICAgYXZlcmFnZSA9IG1pbiAvIDI7CgkgICAgICAgICAgICAgICAgICAgIGlmICh5ID4gMCAmJiB4ID4gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ29ycmVjdCB0aGUgIndoaXRlIGJhY2tncm91bmQiIGFzc3VtcHRpb24gZm9yIGJsb2NrcyB0aGF0IGhhdmUgbmVpZ2hib3JzIGJ5IGNvbXBhcmluZwoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlIHBpeGVscyBpbiB0aGlzIGJsb2NrIHRvIHRoZSBwcmV2aW91c2x5IGNhbGN1bGF0ZWQgYmxhY2sgcG9pbnRzLiBUaGlzIGlzIGJhc2VkIG9uCgkgICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGUgZmFjdCB0aGF0IGRhcmsgYmFyY29kZSBzeW1ib2xvZ3kgaXMgYWx3YXlzIHN1cnJvdW5kZWQgYnkgc29tZSBhbW91bnQgb2YgbGlnaHQKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJhY2tncm91bmQgZm9yIHdoaWNoIHJlYXNvbmFibGUgYmxhY2sgcG9pbnQgZXN0aW1hdGVzIHdlcmUgbWFkZS4gVGhlIGJwIGVzdGltYXRlZCBhdAoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlIGJvdW5kYXJpZXMgaXMgdXNlZCBmb3IgdGhlIGludGVyaW9yLgoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlIChtaW4gPCBicCkgaXMgYXJiaXRyYXJ5IGJ1dCB3b3JrcyBiZXR0ZXIgdGhhbiBvdGhlciBoZXVyaXN0aWNzIHRoYXQgd2VyZSB0cmllZC4KCSAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdmVyYWdlTmVpZ2hib3JCbGFja1BvaW50ID0gKGJsYWNrUG9pbnRzW3kgLSAxXVt4XSArICgyICogYmxhY2tQb2ludHNbeV1beCAtIDFdKSArIGJsYWNrUG9pbnRzW3kgLSAxXVt4IC0gMV0pIC8gNDsKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtaW4gPCBhdmVyYWdlTmVpZ2hib3JCbGFja1BvaW50KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXZlcmFnZSA9IGF2ZXJhZ2VOZWlnaGJvckJsYWNrUG9pbnQ7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgYmxhY2tQb2ludHNbeV1beF0gPSBhdmVyYWdlOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBibGFja1BvaW50czsKCSAgICB9OwoJICAgIC8vIFRoaXMgY2xhc3MgdXNlcyA1eDUgYmxvY2tzIHRvIGNvbXB1dGUgbG9jYWwgbHVtaW5hbmNlLCB3aGVyZSBlYWNoIGJsb2NrIGlzIDh4OCBwaXhlbHMuCgkgICAgLy8gU28gdGhpcyBpcyB0aGUgc21hbGxlc3QgZGltZW5zaW9uIGluIGVhY2ggYXhpcyB3ZSBjYW4gYWNjZXB0LgoJICAgIEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSID0gMzsKCSAgICBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRSA9IDEgPDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkVfUE9XRVI7IC8vIC4uLjAxMDAuLi4wMAoJICAgIEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX01BU0sgPSBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRSAtIDE7IC8vIC4uLjAwMTEuLi4xMQoJICAgIEh5YnJpZEJpbmFyaXplci5NSU5JTVVNX0RJTUVOU0lPTiA9IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFICogNTsKCSAgICBIeWJyaWRCaW5hcml6ZXIuTUlOX0RZTkFNSUNfUkFOR0UgPSAyNDsKCSAgICByZXR1cm4gSHlicmlkQmluYXJpemVyOwoJfShHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXJfMS5kZWZhdWx0KSk7Cgl2YXIgX2RlZmF1bHQkMiA9IEh5YnJpZEJpbmFyaXplciQxLmRlZmF1bHQgPSBIeWJyaWRCaW5hcml6ZXI7CgoJdmFyIFJHQkx1bWluYW5jZVNvdXJjZSQxID0ge307CgoJdmFyIEludmVydGVkTHVtaW5hbmNlU291cmNlJDEgPSB7fTsKCgl2YXIgTHVtaW5hbmNlU291cmNlJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDkgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEx1bWluYW5jZVNvdXJjZSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgU3RyaW5nQnVpbGRlcl8xJDEgPSBTdHJpbmdCdWlsZGVyJDE7Cgl2YXIgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb25fMSA9IFVuc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0aW9uJDE7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nIHsqLwoJLyoqCgkgKiBUaGUgcHVycG9zZSBvZiB0aGlzIGNsYXNzIGhpZXJhcmNoeSBpcyB0byBhYnN0cmFjdCBkaWZmZXJlbnQgYml0bWFwIGltcGxlbWVudGF0aW9ucyBhY3Jvc3MKCSAqIHBsYXRmb3JtcyBpbnRvIGEgc3RhbmRhcmQgaW50ZXJmYWNlIGZvciByZXF1ZXN0aW5nIGdyZXlzY2FsZSBsdW1pbmFuY2UgdmFsdWVzLiBUaGUgaW50ZXJmYWNlCgkgKiBvbmx5IHByb3ZpZGVzIGltbXV0YWJsZSBtZXRob2RzOyB0aGVyZWZvcmUgY3JvcCBhbmQgcm90YXRpb24gY3JlYXRlIGNvcGllcy4gVGhpcyBpcyB0byBlbnN1cmUKCSAqIHRoYXQgb25lIFJlYWRlciBkb2VzIG5vdCBtb2RpZnkgdGhlIG9yaWdpbmFsIGx1bWluYW5jZSBzb3VyY2UgYW5kIGxlYXZlIGl0IGluIGFuIHVua25vd24gc3RhdGUKCSAqIGZvciBvdGhlciBSZWFkZXJzIGluIHRoZSBjaGFpbi4KCSAqCgkgKiBAYXV0aG9yIGRzd2l0a2luQGdvb2dsZS5jb20gKERhbmllbCBTd2l0a2luKQoJICovCgl2YXIgTHVtaW5hbmNlU291cmNlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEx1bWluYW5jZVNvdXJjZSh3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLykgewoJICAgICAgICB0aGlzLndpZHRoID0gd2lkdGg7CgkgICAgICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0OwoJICAgIH0KCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSB3aWR0aCBvZiB0aGUgYml0bWFwLgoJICAgICAqLwoJICAgIEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuZ2V0V2lkdGggPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLndpZHRoOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBUaGUgaGVpZ2h0IG9mIHRoZSBiaXRtYXAuCgkgICAgICovCgkgICAgTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5nZXRIZWlnaHQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmhlaWdodDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gV2hldGhlciB0aGlzIHN1YmNsYXNzIHN1cHBvcnRzIGNyb3BwaW5nLgoJICAgICAqLwoJICAgIEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuaXNDcm9wU3VwcG9ydGVkID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBSZXR1cm5zIGEgbmV3IG9iamVjdCB3aXRoIGNyb3BwZWQgaW1hZ2UgZGF0YS4gSW1wbGVtZW50YXRpb25zIG1heSBrZWVwIGEgcmVmZXJlbmNlIHRvIHRoZQoJICAgICAqIG9yaWdpbmFsIGRhdGEgcmF0aGVyIHRoYW4gYSBjb3B5LiBPbmx5IGNhbGxhYmxlIGlmIGlzQ3JvcFN1cHBvcnRlZCgpIGlzIHRydWUuCgkgICAgICoKCSAgICAgKiBAcGFyYW0gbGVmdCBUaGUgbGVmdCBjb29yZGluYXRlLCB3aGljaCBtdXN0IGJlIGluIFswLGdldFdpZHRoKCkpCgkgICAgICogQHBhcmFtIHRvcCBUaGUgdG9wIGNvb3JkaW5hdGUsIHdoaWNoIG11c3QgYmUgaW4gWzAsZ2V0SGVpZ2h0KCkpCgkgICAgICogQHBhcmFtIHdpZHRoIFRoZSB3aWR0aCBvZiB0aGUgcmVjdGFuZ2xlIHRvIGNyb3AuCgkgICAgICogQHBhcmFtIGhlaWdodCBUaGUgaGVpZ2h0IG9mIHRoZSByZWN0YW5nbGUgdG8gY3JvcC4KCSAgICAgKiBAcmV0dXJuIEEgY3JvcHBlZCB2ZXJzaW9uIG9mIHRoaXMgb2JqZWN0LgoJICAgICAqLwoJICAgIEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuY3JvcCA9IGZ1bmN0aW9uIChsZWZ0IC8qaW50Ki8sIHRvcCAvKmludCovLCB3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLykgewoJICAgICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb25fMS5kZWZhdWx0KCdUaGlzIGx1bWluYW5jZSBzb3VyY2UgZG9lcyBub3Qgc3VwcG9ydCBjcm9wcGluZy4nKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gV2hldGhlciB0aGlzIHN1YmNsYXNzIHN1cHBvcnRzIGNvdW50ZXItY2xvY2t3aXNlIHJvdGF0aW9uLgoJICAgICAqLwoJICAgIEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuaXNSb3RhdGVTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgYSBuZXcgb2JqZWN0IHdpdGggcm90YXRlZCBpbWFnZSBkYXRhIGJ5IDkwIGRlZ3JlZXMgY291bnRlcmNsb2Nrd2lzZS4KCSAgICAgKiBPbmx5IGNhbGxhYmxlIGlmIHtAbGluayAjaXNSb3RhdGVTdXBwb3J0ZWQoKX0gaXMgdHJ1ZS4KCSAgICAgKgoJICAgICAqIEByZXR1cm4gQSByb3RhdGVkIHZlcnNpb24gb2YgdGhpcyBvYmplY3QuCgkgICAgICovCgkgICAgTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5yb3RhdGVDb3VudGVyQ2xvY2t3aXNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb25fMS5kZWZhdWx0KCdUaGlzIGx1bWluYW5jZSBzb3VyY2UgZG9lcyBub3Qgc3VwcG9ydCByb3RhdGlvbiBieSA5MCBkZWdyZWVzLicpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogUmV0dXJucyBhIG5ldyBvYmplY3Qgd2l0aCByb3RhdGVkIGltYWdlIGRhdGEgYnkgNDUgZGVncmVlcyBjb3VudGVyY2xvY2t3aXNlLgoJICAgICAqIE9ubHkgY2FsbGFibGUgaWYge0BsaW5rICNpc1JvdGF0ZVN1cHBvcnRlZCgpfSBpcyB0cnVlLgoJICAgICAqCgkgICAgICogQHJldHVybiBBIHJvdGF0ZWQgdmVyc2lvbiBvZiB0aGlzIG9iamVjdC4KCSAgICAgKi8KCSAgICBMdW1pbmFuY2VTb3VyY2UucHJvdG90eXBlLnJvdGF0ZUNvdW50ZXJDbG9ja3dpc2U0NSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdGhyb3cgbmV3IFVuc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0aW9uXzEuZGVmYXVsdCgnVGhpcyBsdW1pbmFuY2Ugc291cmNlIGRvZXMgbm90IHN1cHBvcnQgcm90YXRpb24gYnkgNDUgZGVncmVlcy4nKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBMdW1pbmFuY2VTb3VyY2UucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgcm93ID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KHRoaXMud2lkdGgpOwoJICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IFN0cmluZ0J1aWxkZXJfMSQxLmRlZmF1bHQoKTsKCSAgICAgICAgZm9yICh2YXIgeSA9IDA7IHkgPCB0aGlzLmhlaWdodDsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgc291cmNlUm93ID0gdGhpcy5nZXRSb3coeSwgcm93KTsKCSAgICAgICAgICAgIGZvciAodmFyIHggPSAwOyB4IDwgdGhpcy53aWR0aDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIGx1bWluYW5jZSA9IHNvdXJjZVJvd1t4XSAmIDB4RkY7CgkgICAgICAgICAgICAgICAgdmFyIGMgPSB2b2lkIDA7CgkgICAgICAgICAgICAgICAgaWYgKGx1bWluYW5jZSA8IDB4NDApIHsKCSAgICAgICAgICAgICAgICAgICAgYyA9ICcjJzsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSBpZiAobHVtaW5hbmNlIDwgMHg4MCkgewoJICAgICAgICAgICAgICAgICAgICBjID0gJysnOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIGlmIChsdW1pbmFuY2UgPCAweEMwKSB7CgkgICAgICAgICAgICAgICAgICAgIGMgPSAnLic7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgICAgICAgICBjID0gJyAnOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICByZXN1bHQuYXBwZW5kKGMpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZCgnXG4nKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gcmVzdWx0LnRvU3RyaW5nKCk7CgkgICAgfTsKCSAgICByZXR1cm4gTHVtaW5hbmNlU291cmNlOwoJfSgpKTsKCUx1bWluYW5jZVNvdXJjZSQxLmRlZmF1bHQgPSBMdW1pbmFuY2VTb3VyY2U7CgoJLyoKCSAqIENvcHlyaWdodCAyMDA5IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCXZhciBfX2V4dGVuZHMkYSA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbnZlcnRlZEx1bWluYW5jZVNvdXJjZSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgTHVtaW5hbmNlU291cmNlXzEkMSA9IEx1bWluYW5jZVNvdXJjZSQxOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZyB7Ki8KCS8qKgoJICogQSB3cmFwcGVyIGltcGxlbWVudGF0aW9uIG9mIHtAbGluayBMdW1pbmFuY2VTb3VyY2V9IHdoaWNoIGludmVydHMgdGhlIGx1bWluYW5jZXMgaXQgcmV0dXJucyAtLSBibGFjayBiZWNvbWVzCgkgKiB3aGl0ZSBhbmQgdmljZSB2ZXJzYSwgYW5kIGVhY2ggdmFsdWUgYmVjb21lcyAoMjU1LXZhbHVlKS4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJGEoSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2UsIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2UoZGVsZWdhdGUpIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgZGVsZWdhdGUuZ2V0V2lkdGgoKSwgZGVsZWdhdGUuZ2V0SGVpZ2h0KCkpIHx8IHRoaXM7CgkgICAgICAgIF90aGlzLmRlbGVnYXRlID0gZGVsZWdhdGU7CgkgICAgICAgIHJldHVybiBfdGhpczsKCSAgICB9CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEludmVydGVkTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5nZXRSb3cgPSBmdW5jdGlvbiAoeSAvKmludCovLCByb3cpIHsKCSAgICAgICAgdmFyIHNvdXJjZVJvdyA9IHRoaXMuZGVsZWdhdGUuZ2V0Um93KHksIHJvdyk7CgkgICAgICAgIHZhciB3aWR0aCA9IHRoaXMuZ2V0V2lkdGgoKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB3aWR0aDsgaSsrKSB7CgkgICAgICAgICAgICBzb3VyY2VSb3dbaV0gPSAvKihieXRlKSovICgyNTUgLSAoc291cmNlUm93W2ldICYgMHhGRikpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBzb3VyY2VSb3c7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2UucHJvdG90eXBlLmdldE1hdHJpeCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIG1hdHJpeCA9IHRoaXMuZGVsZWdhdGUuZ2V0TWF0cml4KCk7CgkgICAgICAgIHZhciBsZW5ndGggPSB0aGlzLmdldFdpZHRoKCkgKiB0aGlzLmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgaW52ZXJ0ZWRNYXRyaXggPSBuZXcgVWludDhDbGFtcGVkQXJyYXkobGVuZ3RoKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewoJICAgICAgICAgICAgaW52ZXJ0ZWRNYXRyaXhbaV0gPSAvKihieXRlKSovICgyNTUgLSAobWF0cml4W2ldICYgMHhGRikpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBpbnZlcnRlZE1hdHJpeDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBJbnZlcnRlZEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuaXNDcm9wU3VwcG9ydGVkID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5kZWxlZ2F0ZS5pc0Nyb3BTdXBwb3J0ZWQoKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBJbnZlcnRlZEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuY3JvcCA9IGZ1bmN0aW9uIChsZWZ0IC8qaW50Ki8sIHRvcCAvKmludCovLCB3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLykgewoJICAgICAgICByZXR1cm4gbmV3IEludmVydGVkTHVtaW5hbmNlU291cmNlKHRoaXMuZGVsZWdhdGUuY3JvcChsZWZ0LCB0b3AsIHdpZHRoLCBoZWlnaHQpKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBJbnZlcnRlZEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuaXNSb3RhdGVTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRlbGVnYXRlLmlzUm90YXRlU3VwcG9ydGVkKCk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIG9yaWdpbmFsIGRlbGVnYXRlIHtAbGluayBMdW1pbmFuY2VTb3VyY2V9IHNpbmNlIGludmVydCB1bmRvZXMgaXRzZWxmCgkgICAgICovCgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEludmVydGVkTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5pbnZlcnQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRlbGVnYXRlOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEludmVydGVkTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5yb3RhdGVDb3VudGVyQ2xvY2t3aXNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IEludmVydGVkTHVtaW5hbmNlU291cmNlKHRoaXMuZGVsZWdhdGUucm90YXRlQ291bnRlckNsb2Nrd2lzZSgpKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBJbnZlcnRlZEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUucm90YXRlQ291bnRlckNsb2Nrd2lzZTQ1ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IEludmVydGVkTHVtaW5hbmNlU291cmNlKHRoaXMuZGVsZWdhdGUucm90YXRlQ291bnRlckNsb2Nrd2lzZTQ1KCkpOwoJICAgIH07CgkgICAgcmV0dXJuIEludmVydGVkTHVtaW5hbmNlU291cmNlOwoJfShMdW1pbmFuY2VTb3VyY2VfMSQxLmRlZmF1bHQpKTsKCUludmVydGVkTHVtaW5hbmNlU291cmNlJDEuZGVmYXVsdCA9IEludmVydGVkTHVtaW5hbmNlU291cmNlOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwOSBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCgl2YXIgX19leHRlbmRzJDkgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoUkdCTHVtaW5hbmNlU291cmNlJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcgeyovCgkgLy8gcmVxdWlyZWQgYmVjYXVzZSBvZiBjaXJjdWxhciBkZXBlbmRlbmNpZXMgYmV0d2VlbiBMdW1pbmFuY2VTb3VyY2UgYW5kIEludmVydGVkTHVtaW5hbmNlU291cmNlCgl2YXIgSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2VfMSA9IEludmVydGVkTHVtaW5hbmNlU291cmNlJDE7Cgl2YXIgTHVtaW5hbmNlU291cmNlXzEgPSBMdW1pbmFuY2VTb3VyY2UkMTsKCXZhciBTeXN0ZW1fMSQyID0gU3lzdGVtJDE7Cgl2YXIgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNiA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBUaGlzIGNsYXNzIGlzIHVzZWQgdG8gaGVscCBkZWNvZGUgaW1hZ2VzIGZyb20gZmlsZXMgd2hpY2ggYXJyaXZlIGFzIFJHQiBkYXRhIGZyb20KCSAqIGFuIEFSR0IgcGl4ZWwgYXJyYXkuIEl0IGRvZXMgbm90IHN1cHBvcnQgcm90YXRpb24uCgkgKgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqIEBhdXRob3IgQmV0YW1pbm9zCgkgKi8KCXZhciBSR0JMdW1pbmFuY2VTb3VyY2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJDkoUkdCTHVtaW5hbmNlU291cmNlLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIFJHQkx1bWluYW5jZVNvdXJjZShsdW1pbmFuY2VzLCB3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLywgZGF0YVdpZHRoIC8qaW50Ki8sIGRhdGFIZWlnaHQgLyppbnQqLywgbGVmdCAvKmludCovLCB0b3AgLyppbnQqLykgewoJICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCB3aWR0aCwgaGVpZ2h0KSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5kYXRhV2lkdGggPSBkYXRhV2lkdGg7CgkgICAgICAgIF90aGlzLmRhdGFIZWlnaHQgPSBkYXRhSGVpZ2h0OwoJICAgICAgICBfdGhpcy5sZWZ0ID0gbGVmdDsKCSAgICAgICAgX3RoaXMudG9wID0gdG9wOwoJICAgICAgICBpZiAobHVtaW5hbmNlcy5CWVRFU19QRVJfRUxFTUVOVCA9PT0gNCkgeyAvLyBJbnQzMkFycmF5CgkgICAgICAgICAgICB2YXIgc2l6ZSA9IHdpZHRoICogaGVpZ2h0OwoJICAgICAgICAgICAgdmFyIGx1bWluYW5jZXNVaW50OEFycmF5ID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KHNpemUpOwoJICAgICAgICAgICAgZm9yICh2YXIgb2Zmc2V0ID0gMDsgb2Zmc2V0IDwgc2l6ZTsgb2Zmc2V0KyspIHsKCSAgICAgICAgICAgICAgICB2YXIgcGl4ZWwgPSBsdW1pbmFuY2VzW29mZnNldF07CgkgICAgICAgICAgICAgICAgdmFyIHIgPSAocGl4ZWwgPj4gMTYpICYgMHhmZjsgLy8gcmVkCgkgICAgICAgICAgICAgICAgdmFyIGcyID0gKHBpeGVsID4+IDcpICYgMHgxZmU7IC8vIDIgKiBncmVlbgoJICAgICAgICAgICAgICAgIHZhciBiID0gcGl4ZWwgJiAweGZmOyAvLyBibHVlCgkgICAgICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIGdyZWVuLWZhdm91cmluZyBhdmVyYWdlIGNoZWFwbHkKCSAgICAgICAgICAgICAgICBsdW1pbmFuY2VzVWludDhBcnJheVtvZmZzZXRdID0gLyooYnl0ZSkgKi8gKChyICsgZzIgKyBiKSAvIDQpICYgMHhGRjsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIF90aGlzLmx1bWluYW5jZXMgPSBsdW1pbmFuY2VzVWludDhBcnJheTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIF90aGlzLmx1bWluYW5jZXMgPSBsdW1pbmFuY2VzOwoJICAgICAgICB9CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IGRhdGFXaWR0aCkgewoJICAgICAgICAgICAgX3RoaXMuZGF0YVdpZHRoID0gd2lkdGg7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gZGF0YUhlaWdodCkgewoJICAgICAgICAgICAgX3RoaXMuZGF0YUhlaWdodCA9IGhlaWdodDsKCSAgICAgICAgfQoJICAgICAgICBpZiAodW5kZWZpbmVkID09PSBsZWZ0KSB7CgkgICAgICAgICAgICBfdGhpcy5sZWZ0ID0gMDsKCSAgICAgICAgfQoJICAgICAgICBpZiAodW5kZWZpbmVkID09PSB0b3ApIHsKCSAgICAgICAgICAgIF90aGlzLnRvcCA9IDA7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKF90aGlzLmxlZnQgKyB3aWR0aCA+IF90aGlzLmRhdGFXaWR0aCB8fCBfdGhpcy50b3AgKyBoZWlnaHQgPiBfdGhpcy5kYXRhSGVpZ2h0KSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNi5kZWZhdWx0KCdDcm9wIHJlY3RhbmdsZSBkb2VzIG5vdCBmaXQgd2l0aGluIGltYWdlIGRhdGEuJyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICAvKkBPdmVycmlkZSovCgkgICAgUkdCTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5nZXRSb3cgPSBmdW5jdGlvbiAoeSAvKmludCovLCByb3cpIHsKCSAgICAgICAgaWYgKHkgPCAwIHx8IHkgPj0gdGhpcy5nZXRIZWlnaHQoKSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDYuZGVmYXVsdCgnUmVxdWVzdGVkIHJvdyBpcyBvdXRzaWRlIHRoZSBpbWFnZTogJyArIHkpOwoJICAgICAgICB9CgkgICAgICAgIHZhciB3aWR0aCA9IHRoaXMuZ2V0V2lkdGgoKTsKCSAgICAgICAgaWYgKHJvdyA9PT0gbnVsbCB8fCByb3cgPT09IHVuZGVmaW5lZCB8fCByb3cubGVuZ3RoIDwgd2lkdGgpIHsKCSAgICAgICAgICAgIHJvdyA9IG5ldyBVaW50OENsYW1wZWRBcnJheSh3aWR0aCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIG9mZnNldCA9ICh5ICsgdGhpcy50b3ApICogdGhpcy5kYXRhV2lkdGggKyB0aGlzLmxlZnQ7CgkgICAgICAgIFN5c3RlbV8xJDIuZGVmYXVsdC5hcnJheWNvcHkodGhpcy5sdW1pbmFuY2VzLCBvZmZzZXQsIHJvdywgMCwgd2lkdGgpOwoJICAgICAgICByZXR1cm4gcm93OwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIFJHQkx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuZ2V0TWF0cml4ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgd2lkdGggPSB0aGlzLmdldFdpZHRoKCk7CgkgICAgICAgIHZhciBoZWlnaHQgPSB0aGlzLmdldEhlaWdodCgpOwoJICAgICAgICAvLyBJZiB0aGUgY2FsbGVyIGFza3MgZm9yIHRoZSBlbnRpcmUgdW5kZXJseWluZyBpbWFnZSwgc2F2ZSB0aGUgY29weSBhbmQgZ2l2ZSB0aGVtIHRoZQoJICAgICAgICAvLyBvcmlnaW5hbCBkYXRhLiBUaGUgZG9jcyBzcGVjaWZpY2FsbHkgd2FybiB0aGF0IHJlc3VsdC5sZW5ndGggbXVzdCBiZSBpZ25vcmVkLgoJICAgICAgICBpZiAod2lkdGggPT09IHRoaXMuZGF0YVdpZHRoICYmIGhlaWdodCA9PT0gdGhpcy5kYXRhSGVpZ2h0KSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5sdW1pbmFuY2VzOwoJICAgICAgICB9CgkgICAgICAgIHZhciBhcmVhID0gd2lkdGggKiBoZWlnaHQ7CgkgICAgICAgIHZhciBtYXRyaXggPSBuZXcgVWludDhDbGFtcGVkQXJyYXkoYXJlYSk7CgkgICAgICAgIHZhciBpbnB1dE9mZnNldCA9IHRoaXMudG9wICogdGhpcy5kYXRhV2lkdGggKyB0aGlzLmxlZnQ7CgkgICAgICAgIC8vIElmIHRoZSB3aWR0aCBtYXRjaGVzIHRoZSBmdWxsIHdpZHRoIG9mIHRoZSB1bmRlcmx5aW5nIGRhdGEsIHBlcmZvcm0gYSBzaW5nbGUgY29weS4KCSAgICAgICAgaWYgKHdpZHRoID09PSB0aGlzLmRhdGFXaWR0aCkgewoJICAgICAgICAgICAgU3lzdGVtXzEkMi5kZWZhdWx0LmFycmF5Y29weSh0aGlzLmx1bWluYW5jZXMsIGlucHV0T2Zmc2V0LCBtYXRyaXgsIDAsIGFyZWEpOwoJICAgICAgICAgICAgcmV0dXJuIG1hdHJpeDsKCSAgICAgICAgfQoJICAgICAgICAvLyBPdGhlcndpc2UgY29weSBvbmUgY3JvcHBlZCByb3cgYXQgYSB0aW1lLgoJICAgICAgICBmb3IgKHZhciB5ID0gMDsgeSA8IGhlaWdodDsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgb3V0cHV0T2Zmc2V0ID0geSAqIHdpZHRoOwoJICAgICAgICAgICAgU3lzdGVtXzEkMi5kZWZhdWx0LmFycmF5Y29weSh0aGlzLmx1bWluYW5jZXMsIGlucHV0T2Zmc2V0LCBtYXRyaXgsIG91dHB1dE9mZnNldCwgd2lkdGgpOwoJICAgICAgICAgICAgaW5wdXRPZmZzZXQgKz0gdGhpcy5kYXRhV2lkdGg7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG1hdHJpeDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBSR0JMdW1pbmFuY2VTb3VyY2UucHJvdG90eXBlLmlzQ3JvcFN1cHBvcnRlZCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRydWU7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgUkdCTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5jcm9wID0gZnVuY3Rpb24gKGxlZnQgLyppbnQqLywgdG9wIC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovKSB7CgkgICAgICAgIHJldHVybiBuZXcgUkdCTHVtaW5hbmNlU291cmNlKHRoaXMubHVtaW5hbmNlcywgd2lkdGgsIGhlaWdodCwgdGhpcy5kYXRhV2lkdGgsIHRoaXMuZGF0YUhlaWdodCwgdGhpcy5sZWZ0ICsgbGVmdCwgdGhpcy50b3AgKyB0b3ApOwoJICAgIH07CgkgICAgUkdCTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5pbnZlcnQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiBuZXcgSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2VfMS5kZWZhdWx0KHRoaXMpOwoJICAgIH07CgkgICAgcmV0dXJuIFJHQkx1bWluYW5jZVNvdXJjZTsKCX0oTHVtaW5hbmNlU291cmNlXzEuZGVmYXVsdCkpOwoJdmFyIF9kZWZhdWx0JDEgPSBSR0JMdW1pbmFuY2VTb3VyY2UkMS5kZWZhdWx0ID0gUkdCTHVtaW5hbmNlU291cmNlOwoKCXZhciBRUkNvZGVSZWFkZXIkMSA9IHt9OwoKCXZhciBCYXJjb2RlRm9ybWF0JDEgPSB7fTsKCgkvKgoJICogRGlyZWN0IHBvcnQgdG8gVHlwZVNjcmlwdCBvZiBaWGluZyBieSBBZHJpYW4gVG/ImWPEgwoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoQmFyY29kZUZvcm1hdCQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKgoJICogQ29weXJpZ2h0IDIwMDkgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZyB7Ki8KCS8qKgoJICogRW51bWVyYXRlcyBiYXJjb2RlIGZvcm1hdHMga25vd24gdG8gdGhpcyBwYWNrYWdlLiBQbGVhc2Uga2VlcCBhbHBoYWJldGl6ZWQuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEJhcmNvZGVGb3JtYXQ7CgkoZnVuY3Rpb24gKEJhcmNvZGVGb3JtYXQpIHsKCSAgICAvKiogQXp0ZWMgMkQgYmFyY29kZSBmb3JtYXQuICovCgkgICAgQmFyY29kZUZvcm1hdFtCYXJjb2RlRm9ybWF0WyJBWlRFQyJdID0gMF0gPSAiQVpURUMiOwoJICAgIC8qKiBDT0RBQkFSIDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkNPREFCQVIiXSA9IDFdID0gIkNPREFCQVIiOwoJICAgIC8qKiBDb2RlIDM5IDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkNPREVfMzkiXSA9IDJdID0gIkNPREVfMzkiOwoJICAgIC8qKiBDb2RlIDkzIDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkNPREVfOTMiXSA9IDNdID0gIkNPREVfOTMiOwoJICAgIC8qKiBDb2RlIDEyOCAxRCBmb3JtYXQuICovCgkgICAgQmFyY29kZUZvcm1hdFtCYXJjb2RlRm9ybWF0WyJDT0RFXzEyOCJdID0gNF0gPSAiQ09ERV8xMjgiOwoJICAgIC8qKiBEYXRhIE1hdHJpeCAyRCBiYXJjb2RlIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkRBVEFfTUFUUklYIl0gPSA1XSA9ICJEQVRBX01BVFJJWCI7CgkgICAgLyoqIEVBTi04IDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkVBTl84Il0gPSA2XSA9ICJFQU5fOCI7CgkgICAgLyoqIEVBTi0xMyAxRCBmb3JtYXQuICovCgkgICAgQmFyY29kZUZvcm1hdFtCYXJjb2RlRm9ybWF0WyJFQU5fMTMiXSA9IDddID0gIkVBTl8xMyI7CgkgICAgLyoqIElURiAoSW50ZXJsZWF2ZWQgVHdvIG9mIEZpdmUpIDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIklURiJdID0gOF0gPSAiSVRGIjsKCSAgICAvKiogTWF4aUNvZGUgMkQgYmFyY29kZSBmb3JtYXQuICovCgkgICAgQmFyY29kZUZvcm1hdFtCYXJjb2RlRm9ybWF0WyJNQVhJQ09ERSJdID0gOV0gPSAiTUFYSUNPREUiOwoJICAgIC8qKiBQREY0MTcgZm9ybWF0LiAqLwoJICAgIEJhcmNvZGVGb3JtYXRbQmFyY29kZUZvcm1hdFsiUERGXzQxNyJdID0gMTBdID0gIlBERl80MTciOwoJICAgIC8qKiBRUiBDb2RlIDJEIGJhcmNvZGUgZm9ybWF0LiAqLwoJICAgIEJhcmNvZGVGb3JtYXRbQmFyY29kZUZvcm1hdFsiUVJfQ09ERSJdID0gMTFdID0gIlFSX0NPREUiOwoJICAgIC8qKiBSU1MgMTQgKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIlJTU18xNCJdID0gMTJdID0gIlJTU18xNCI7CgkgICAgLyoqIFJTUyBFWFBBTkRFRCAqLwoJICAgIEJhcmNvZGVGb3JtYXRbQmFyY29kZUZvcm1hdFsiUlNTX0VYUEFOREVEIl0gPSAxM10gPSAiUlNTX0VYUEFOREVEIjsKCSAgICAvKiogVVBDLUEgMUQgZm9ybWF0LiAqLwoJICAgIEJhcmNvZGVGb3JtYXRbQmFyY29kZUZvcm1hdFsiVVBDX0EiXSA9IDE0XSA9ICJVUENfQSI7CgkgICAgLyoqIFVQQy1FIDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIlVQQ19FIl0gPSAxNV0gPSAiVVBDX0UiOwoJICAgIC8qKiBVUEMvRUFOIGV4dGVuc2lvbiBmb3JtYXQuIE5vdCBhIHN0YW5kLWFsb25lIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIlVQQ19FQU5fRVhURU5TSU9OIl0gPSAxNl0gPSAiVVBDX0VBTl9FWFRFTlNJT04iOwoJfSkoQmFyY29kZUZvcm1hdCB8fCAoQmFyY29kZUZvcm1hdCA9IHt9KSk7CglCYXJjb2RlRm9ybWF0JDEuZGVmYXVsdCA9IEJhcmNvZGVGb3JtYXQ7CgoJdmFyIFJlc3VsdCQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZXN1bHQkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIFN5c3RlbV8xJDEgPSBTeXN0ZW0kMTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIHRoZSByZXN1bHQgb2YgZGVjb2RpbmcgYSBiYXJjb2RlIHdpdGhpbiBhbiBpbWFnZS48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIFJlc3VsdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IocHJpdmF0ZSB0ZXh0OiBzdHJpbmcsCgkgICAgLy8gICAgICAgICAgICAgICBVaW50OEFycmF5IHJhd0J5dGVzLAoJICAgIC8vICAgICAgICAgICAgICAgUmVzdWx0UG9jb25zdCByZXN1bHRQb2ludHM6IEludDMyQXJyYXksCgkgICAgLy8gICAgICAgICAgICAgICBCYXJjb2RlRm9ybWF0IGZvcm1hdCkgewoJICAgIC8vICAgdGhpcyh0ZXh0LCByYXdCeXRlcywgcmVzdWx0UG9pbnRzLCBmb3JtYXQsIFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygpKQoJICAgIC8vIH0KCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IodGV4dDogc3RyaW5nLAoJICAgIC8vICAgICAgICAgICAgICAgVWludDhBcnJheSByYXdCeXRlcywKCSAgICAvLyAgICAgICAgICAgICAgIFJlc3VsdFBvY29uc3QgcmVzdWx0UG9pbnRzOiBJbnQzMkFycmF5LAoJICAgIC8vICAgICAgICAgICAgICAgQmFyY29kZUZvcm1hdCBmb3JtYXQsCgkgICAgLy8gICAgICAgICAgICAgICBsb25nIHRpbWVzdGFtcCkgewoJICAgIC8vICAgdGhpcyh0ZXh0LCByYXdCeXRlcywgcmF3Qnl0ZXMgPT0gbnVsbCA/IDAgOiA4ICogcmF3Qnl0ZXMubGVuZ3RoLAoJICAgIC8vICAgICAgICByZXN1bHRQb2ludHMsIGZvcm1hdCwgdGltZXN0YW1wKQoJICAgIC8vIH0KCSAgICBmdW5jdGlvbiBSZXN1bHQodGV4dCwgcmF3Qnl0ZXMsIG51bUJpdHMsIHJlc3VsdFBvaW50cywgZm9ybWF0LCB0aW1lc3RhbXApIHsKCSAgICAgICAgaWYgKG51bUJpdHMgPT09IHZvaWQgMCkgeyBudW1CaXRzID0gcmF3Qnl0ZXMgPT0gbnVsbCA/IDAgOiA4ICogcmF3Qnl0ZXMubGVuZ3RoOyB9CgkgICAgICAgIGlmICh0aW1lc3RhbXAgPT09IHZvaWQgMCkgeyB0aW1lc3RhbXAgPSBTeXN0ZW1fMSQxLmRlZmF1bHQuY3VycmVudFRpbWVNaWxsaXMoKTsgfQoJICAgICAgICB0aGlzLnRleHQgPSB0ZXh0OwoJICAgICAgICB0aGlzLnJhd0J5dGVzID0gcmF3Qnl0ZXM7CgkgICAgICAgIHRoaXMubnVtQml0cyA9IG51bUJpdHM7CgkgICAgICAgIHRoaXMucmVzdWx0UG9pbnRzID0gcmVzdWx0UG9pbnRzOwoJICAgICAgICB0aGlzLmZvcm1hdCA9IGZvcm1hdDsKCSAgICAgICAgdGhpcy50aW1lc3RhbXAgPSB0aW1lc3RhbXA7CgkgICAgICAgIHRoaXMudGV4dCA9IHRleHQ7CgkgICAgICAgIHRoaXMucmF3Qnl0ZXMgPSByYXdCeXRlczsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gbnVtQml0cyB8fCBudWxsID09PSBudW1CaXRzKSB7CgkgICAgICAgICAgICB0aGlzLm51bUJpdHMgPSAocmF3Qnl0ZXMgPT09IG51bGwgfHwgcmF3Qnl0ZXMgPT09IHVuZGVmaW5lZCkgPyAwIDogOCAqIHJhd0J5dGVzLmxlbmd0aDsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHRoaXMubnVtQml0cyA9IG51bUJpdHM7CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy5yZXN1bHRQb2ludHMgPSByZXN1bHRQb2ludHM7CgkgICAgICAgIHRoaXMuZm9ybWF0ID0gZm9ybWF0OwoJICAgICAgICB0aGlzLnJlc3VsdE1ldGFkYXRhID0gbnVsbDsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gdGltZXN0YW1wIHx8IG51bGwgPT09IHRpbWVzdGFtcCkgewoJICAgICAgICAgICAgdGhpcy50aW1lc3RhbXAgPSBTeXN0ZW1fMSQxLmRlZmF1bHQuY3VycmVudFRpbWVNaWxsaXMoKTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHRoaXMudGltZXN0YW1wID0gdGltZXN0YW1wOwoJICAgICAgICB9CgkgICAgfQoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gcmF3IHRleHQgZW5jb2RlZCBieSB0aGUgYmFyY29kZQoJICAgICAqLwoJICAgIFJlc3VsdC5wcm90b3R5cGUuZ2V0VGV4dCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMudGV4dDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gcmF3IGJ5dGVzIGVuY29kZWQgYnkgdGhlIGJhcmNvZGUsIGlmIGFwcGxpY2FibGUsIG90aGVyd2lzZSB7QGNvZGUgbnVsbH0KCSAgICAgKi8KCSAgICBSZXN1bHQucHJvdG90eXBlLmdldFJhd0J5dGVzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yYXdCeXRlczsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gaG93IG1hbnkgYml0cyBvZiB7QGxpbmsgI2dldFJhd0J5dGVzKCl9IGFyZSB2YWxpZDsgdHlwaWNhbGx5IDggdGltZXMgaXRzIGxlbmd0aAoJICAgICAqIEBzaW5jZSAzLjMuMAoJICAgICAqLwoJICAgIFJlc3VsdC5wcm90b3R5cGUuZ2V0TnVtQml0cyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMubnVtQml0czsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gcG9pbnRzIHJlbGF0ZWQgdG8gdGhlIGJhcmNvZGUgaW4gdGhlIGltYWdlLiBUaGVzZSBhcmUgdHlwaWNhbGx5IHBvaW50cwoJICAgICAqICAgICAgICAgaWRlbnRpZnlpbmcgZmluZGVyIHBhdHRlcm5zIG9yIHRoZSBjb3JuZXJzIG9mIHRoZSBiYXJjb2RlLiBUaGUgZXhhY3QgbWVhbmluZyBpcwoJICAgICAqICAgICAgICAgc3BlY2lmaWMgdG8gdGhlIHR5cGUgb2YgYmFyY29kZSB0aGF0IHdhcyBkZWNvZGVkLgoJICAgICAqLwoJICAgIFJlc3VsdC5wcm90b3R5cGUuZ2V0UmVzdWx0UG9pbnRzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHRQb2ludHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHtAbGluayBCYXJjb2RlRm9ybWF0fSByZXByZXNlbnRpbmcgdGhlIGZvcm1hdCBvZiB0aGUgYmFyY29kZSB0aGF0IHdhcyBkZWNvZGVkCgkgICAgICovCgkgICAgUmVzdWx0LnByb3RvdHlwZS5nZXRCYXJjb2RlRm9ybWF0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5mb3JtYXQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHtAbGluayBNYXB9IG1hcHBpbmcge0BsaW5rIFJlc3VsdE1ldGFkYXRhVHlwZX0ga2V5cyB0byB2YWx1ZXMuIE1heSBiZQoJICAgICAqICAge0Bjb2RlIG51bGx9LiBUaGlzIGNvbnRhaW5zIG9wdGlvbmFsIG1ldGFkYXRhIGFib3V0IHdoYXQgd2FzIGRldGVjdGVkIGFib3V0IHRoZSBiYXJjb2RlLAoJICAgICAqICAgbGlrZSBvcmllbnRhdGlvbi4KCSAgICAgKi8KCSAgICBSZXN1bHQucHJvdG90eXBlLmdldFJlc3VsdE1ldGFkYXRhID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHRNZXRhZGF0YTsKCSAgICB9OwoJICAgIFJlc3VsdC5wcm90b3R5cGUucHV0TWV0YWRhdGEgPSBmdW5jdGlvbiAodHlwZSwgdmFsdWUpIHsKCSAgICAgICAgaWYgKHRoaXMucmVzdWx0TWV0YWRhdGEgPT09IG51bGwpIHsKCSAgICAgICAgICAgIHRoaXMucmVzdWx0TWV0YWRhdGEgPSBuZXcgTWFwKCk7CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy5yZXN1bHRNZXRhZGF0YS5zZXQodHlwZSwgdmFsdWUpOwoJICAgIH07CgkgICAgUmVzdWx0LnByb3RvdHlwZS5wdXRBbGxNZXRhZGF0YSA9IGZ1bmN0aW9uIChtZXRhZGF0YSkgewoJICAgICAgICBpZiAobWV0YWRhdGEgIT09IG51bGwpIHsKCSAgICAgICAgICAgIGlmICh0aGlzLnJlc3VsdE1ldGFkYXRhID09PSBudWxsKSB7CgkgICAgICAgICAgICAgICAgdGhpcy5yZXN1bHRNZXRhZGF0YSA9IG1ldGFkYXRhOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgdGhpcy5yZXN1bHRNZXRhZGF0YSA9IG5ldyBNYXAobWV0YWRhdGEpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICBSZXN1bHQucHJvdG90eXBlLmFkZFJlc3VsdFBvaW50cyA9IGZ1bmN0aW9uIChuZXdQb2ludHMpIHsKCSAgICAgICAgdmFyIG9sZFBvaW50cyA9IHRoaXMucmVzdWx0UG9pbnRzOwoJICAgICAgICBpZiAob2xkUG9pbnRzID09PSBudWxsKSB7CgkgICAgICAgICAgICB0aGlzLnJlc3VsdFBvaW50cyA9IG5ld1BvaW50czsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmIChuZXdQb2ludHMgIT09IG51bGwgJiYgbmV3UG9pbnRzLmxlbmd0aCA+IDApIHsKCSAgICAgICAgICAgIHZhciBhbGxQb2ludHMgPSBuZXcgQXJyYXkob2xkUG9pbnRzLmxlbmd0aCArIG5ld1BvaW50cy5sZW5ndGgpOwoJICAgICAgICAgICAgU3lzdGVtXzEkMS5kZWZhdWx0LmFycmF5Y29weShvbGRQb2ludHMsIDAsIGFsbFBvaW50cywgMCwgb2xkUG9pbnRzLmxlbmd0aCk7CgkgICAgICAgICAgICBTeXN0ZW1fMSQxLmRlZmF1bHQuYXJyYXljb3B5KG5ld1BvaW50cywgMCwgYWxsUG9pbnRzLCBvbGRQb2ludHMubGVuZ3RoLCBuZXdQb2ludHMubGVuZ3RoKTsKCSAgICAgICAgICAgIHRoaXMucmVzdWx0UG9pbnRzID0gYWxsUG9pbnRzOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBSZXN1bHQucHJvdG90eXBlLmdldFRpbWVzdGFtcCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMudGltZXN0YW1wOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIFJlc3VsdC5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnRleHQ7CgkgICAgfTsKCSAgICByZXR1cm4gUmVzdWx0OwoJfSgpKTsKCVJlc3VsdCQxLmRlZmF1bHQgPSBSZXN1bHQ7CgoJdmFyIFJlc3VsdE1ldGFkYXRhVHlwZSQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA4IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZXN1bHRNZXRhZGF0YVR5cGUkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZyB7Ki8KCS8qKgoJICogUmVwcmVzZW50cyBzb21lIHR5cGUgb2YgbWV0YWRhdGEgYWJvdXQgdGhlIHJlc3VsdCBvZiB0aGUgZGVjb2RpbmcgdGhhdCB0aGUgZGVjb2RlcgoJICogd2lzaGVzIHRvIGNvbW11bmljYXRlIGJhY2sgdG8gdGhlIGNhbGxlci4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgUmVzdWx0TWV0YWRhdGFUeXBlOwoJKGZ1bmN0aW9uIChSZXN1bHRNZXRhZGF0YVR5cGUpIHsKCSAgICAvKioKCSAgICAgKiBVbnNwZWNpZmllZCwgYXBwbGljYXRpb24tc3BlY2lmaWMgbWV0YWRhdGEuIE1hcHMgdG8gYW4gdW5zcGVjaWZpZWQge0BsaW5rIE9iamVjdH0uCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiT1RIRVIiXSA9IDBdID0gIk9USEVSIjsKCSAgICAvKioKCSAgICAgKiBEZW5vdGVzIHRoZSBsaWtlbHkgYXBwcm94aW1hdGUgb3JpZW50YXRpb24gb2YgdGhlIGJhcmNvZGUgaW4gdGhlIGltYWdlLiBUaGlzIHZhbHVlCgkgICAgICogaXMgZ2l2ZW4gYXMgZGVncmVlcyByb3RhdGVkIGNsb2Nrd2lzZSBmcm9tIHRoZSBub3JtYWwsIHVwcmlnaHQgb3JpZW50YXRpb24uCgkgICAgICogRm9yIGV4YW1wbGUgYSAxRCBiYXJjb2RlIHdoaWNoIHdhcyBmb3VuZCBieSByZWFkaW5nIHRvcC10by1ib3R0b20gd291bGQgYmUKCSAgICAgKiBzYWlkIHRvIGhhdmUgb3JpZW50YXRpb24gIjkwIi4gVGhpcyBrZXkgbWFwcyB0byBhbiB7QGxpbmsgSW50ZWdlcn0gd2hvc2UKCSAgICAgKiB2YWx1ZSBpcyBpbiB0aGUgcmFuZ2UgWzAsMzYwKS4KCSAgICAgKi8KCSAgICBSZXN1bHRNZXRhZGF0YVR5cGVbUmVzdWx0TWV0YWRhdGFUeXBlWyJPUklFTlRBVElPTiJdID0gMV0gPSAiT1JJRU5UQVRJT04iOwoJICAgIC8qKgoJICAgICAqIDxwPjJEIGJhcmNvZGUgZm9ybWF0cyB0eXBpY2FsbHkgZW5jb2RlIHRleHQsIGJ1dCBhbGxvdyBmb3IgYSBzb3J0IG9mICdieXRlIG1vZGUnCgkgICAgICogd2hpY2ggaXMgc29tZXRpbWVzIHVzZWQgdG8gZW5jb2RlIGJpbmFyeSBkYXRhLiBXaGlsZSB7QGxpbmsgUmVzdWx0fSBtYWtlcyBhdmFpbGFibGUKCSAgICAgKiB0aGUgY29tcGxldGUgcmF3IGJ5dGVzIGluIHRoZSBiYXJjb2RlIGZvciB0aGVzZSBmb3JtYXRzLCBpdCBkb2VzIG5vdCBvZmZlciB0aGUgYnl0ZXMKCSAgICAgKiBmcm9tIHRoZSBieXRlIHNlZ21lbnRzIGFsb25lLjwvcD4KCSAgICAgKgoJICAgICAqIDxwPlRoaXMgbWFwcyB0byBhIHtAbGluayBqYXZhLnV0aWwuTGlzdH0gb2YgYnl0ZSBhcnJheXMgY29ycmVzcG9uZGluZyB0byB0aGUKCSAgICAgKiByYXcgYnl0ZXMgaW4gdGhlIGJ5dGUgc2VnbWVudHMgaW4gdGhlIGJhcmNvZGUsIGluIG9yZGVyLjwvcD4KCSAgICAgKi8KCSAgICBSZXN1bHRNZXRhZGF0YVR5cGVbUmVzdWx0TWV0YWRhdGFUeXBlWyJCWVRFX1NFR01FTlRTIl0gPSAyXSA9ICJCWVRFX1NFR01FTlRTIjsKCSAgICAvKioKCSAgICAgKiBFcnJvciBjb3JyZWN0aW9uIGxldmVsIHVzZWQsIGlmIGFwcGxpY2FibGUuIFRoZSB2YWx1ZSB0eXBlIGRlcGVuZHMgb24gdGhlCgkgICAgICogZm9ybWF0LCBidXQgaXMgdHlwaWNhbGx5IGEgU3RyaW5nLgoJICAgICAqLwoJICAgIFJlc3VsdE1ldGFkYXRhVHlwZVtSZXN1bHRNZXRhZGF0YVR5cGVbIkVSUk9SX0NPUlJFQ1RJT05fTEVWRUwiXSA9IDNdID0gIkVSUk9SX0NPUlJFQ1RJT05fTEVWRUwiOwoJICAgIC8qKgoJICAgICAqIEZvciBzb21lIHBlcmlvZGljYWxzLCBpbmRpY2F0ZXMgdGhlIGlzc3VlIG51bWJlciBhcyBhbiB7QGxpbmsgSW50ZWdlcn0uCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiSVNTVUVfTlVNQkVSIl0gPSA0XSA9ICJJU1NVRV9OVU1CRVIiOwoJICAgIC8qKgoJICAgICAqIEZvciBzb21lIHByb2R1Y3RzLCBpbmRpY2F0ZXMgdGhlIHN1Z2dlc3RlZCByZXRhaWwgcHJpY2UgaW4gdGhlIGJhcmNvZGUgYXMgYQoJICAgICAqIGZvcm1hdHRlZCB7QGxpbmsgU3RyaW5nfS4KCSAgICAgKi8KCSAgICBSZXN1bHRNZXRhZGF0YVR5cGVbUmVzdWx0TWV0YWRhdGFUeXBlWyJTVUdHRVNURURfUFJJQ0UiXSA9IDVdID0gIlNVR0dFU1RFRF9QUklDRSI7CgkgICAgLyoqCgkgICAgICogRm9yIHNvbWUgcHJvZHVjdHMsIHRoZSBwb3NzaWJsZSBjb3VudHJ5IG9mIG1hbnVmYWN0dXJlIGFzIGEge0BsaW5rIFN0cmluZ30gZGVub3RpbmcgdGhlCgkgICAgICogSVNPIGNvdW50cnkgY29kZS4gU29tZSBtYXAgdG8gbXVsdGlwbGUgcG9zc2libGUgY291bnRyaWVzLCBsaWtlICJVUy9DQSIuCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiUE9TU0lCTEVfQ09VTlRSWSJdID0gNl0gPSAiUE9TU0lCTEVfQ09VTlRSWSI7CgkgICAgLyoqCgkgICAgICogRm9yIHNvbWUgcHJvZHVjdHMsIHRoZSBleHRlbnNpb24gdGV4dAoJICAgICAqLwoJICAgIFJlc3VsdE1ldGFkYXRhVHlwZVtSZXN1bHRNZXRhZGF0YVR5cGVbIlVQQ19FQU5fRVhURU5TSU9OIl0gPSA3XSA9ICJVUENfRUFOX0VYVEVOU0lPTiI7CgkgICAgLyoqCgkgICAgICogUERGNDE3LXNwZWNpZmljIG1ldGFkYXRhCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiUERGNDE3X0VYVFJBX01FVEFEQVRBIl0gPSA4XSA9ICJQREY0MTdfRVhUUkFfTUVUQURBVEEiOwoJICAgIC8qKgoJICAgICAqIElmIHRoZSBjb2RlIGZvcm1hdCBzdXBwb3J0cyBzdHJ1Y3R1cmVkIGFwcGVuZCBhbmQgdGhlIGN1cnJlbnQgc2Nhbm5lZCBjb2RlIGlzIHBhcnQgb2Ygb25lIHRoZW4gdGhlCgkgICAgICogc2VxdWVuY2UgbnVtYmVyIGlzIGdpdmVuIHdpdGggaXQuCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiU1RSVUNUVVJFRF9BUFBFTkRfU0VRVUVOQ0UiXSA9IDldID0gIlNUUlVDVFVSRURfQVBQRU5EX1NFUVVFTkNFIjsKCSAgICAvKioKCSAgICAgKiBJZiB0aGUgY29kZSBmb3JtYXQgc3VwcG9ydHMgc3RydWN0dXJlZCBhcHBlbmQgYW5kIHRoZSBjdXJyZW50IHNjYW5uZWQgY29kZSBpcyBwYXJ0IG9mIG9uZSB0aGVuIHRoZQoJICAgICAqIHBhcml0eSBpcyBnaXZlbiB3aXRoIGl0LgoJICAgICAqLwoJICAgIFJlc3VsdE1ldGFkYXRhVHlwZVtSZXN1bHRNZXRhZGF0YVR5cGVbIlNUUlVDVFVSRURfQVBQRU5EX1BBUklUWSJdID0gMTBdID0gIlNUUlVDVFVSRURfQVBQRU5EX1BBUklUWSI7Cgl9KShSZXN1bHRNZXRhZGF0YVR5cGUgfHwgKFJlc3VsdE1ldGFkYXRhVHlwZSA9IHt9KSk7CglSZXN1bHRNZXRhZGF0YVR5cGUkMS5kZWZhdWx0ID0gUmVzdWx0TWV0YWRhdGFUeXBlOwoKCXZhciBEZWNvZGVyJDEgPSB7fTsKCgl2YXIgQ2hlY2tzdW1FeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkOCA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShDaGVja3N1bUV4Y2VwdGlvbiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgRXhjZXB0aW9uXzEkNCA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBDaGVja3N1bUV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkOChDaGVja3N1bUV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBDaGVja3N1bUV4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBDaGVja3N1bUV4Y2VwdGlvbi5nZXRDaGVja3N1bUluc3RhbmNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IENoZWNrc3VtRXhjZXB0aW9uKCk7CgkgICAgfTsKCSAgICBDaGVja3N1bUV4Y2VwdGlvbi5raW5kID0gJ0NoZWNrc3VtRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gQ2hlY2tzdW1FeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xJDQuZGVmYXVsdCkpOwoJQ2hlY2tzdW1FeGNlcHRpb24kMS5kZWZhdWx0ID0gQ2hlY2tzdW1FeGNlcHRpb247CgoJdmFyIEdlbmVyaWNHRiQxID0ge307CgoJdmFyIEdlbmVyaWNHRlBvbHkkMSA9IHt9OwoKCXZhciBBYnN0cmFjdEdlbmVyaWNHRiQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShBYnN0cmFjdEdlbmVyaWNHRiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNSA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5UaGlzIGNsYXNzIGNvbnRhaW5zIHV0aWxpdHkgbWV0aG9kcyBmb3IgcGVyZm9ybWluZyBtYXRoZW1hdGljYWwgb3BlcmF0aW9ucyBvdmVyCgkgKiB0aGUgR2Fsb2lzIEZpZWxkcy4gT3BlcmF0aW9ucyB1c2UgYSBnaXZlbiBwcmltaXRpdmUgcG9seW5vbWlhbCBpbiBjYWxjdWxhdGlvbnMuPC9wPgoJICoKCSAqIDxwPlRocm91Z2hvdXQgdGhpcyBwYWNrYWdlLCBlbGVtZW50cyBvZiB0aGUgR0YgYXJlIHJlcHJlc2VudGVkIGFzIGFuIHtAY29kZSBpbnR9CgkgKiBmb3IgY29udmVuaWVuY2UgYW5kIHNwZWVkIChidXQgYXQgdGhlIGNvc3Qgb2YgbWVtb3J5KS4KCSAqIDwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICogQGF1dGhvciBEYXZpZCBPbGl2aWVyCgkgKi8KCXZhciBBYnN0cmFjdEdlbmVyaWNHRiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBBYnN0cmFjdEdlbmVyaWNHRigpIHsKCSAgICB9CgkgICAgLyoqCgkgICAgICogQHJldHVybiAyIHRvIHRoZSBwb3dlciBvZiBhIGluIEdGKHNpemUpCgkgICAgICovCgkgICAgQWJzdHJhY3RHZW5lcmljR0YucHJvdG90eXBlLmV4cCA9IGZ1bmN0aW9uIChhKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmV4cFRhYmxlW2FdOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBiYXNlIDIgbG9nIG9mIGEgaW4gR0Yoc2l6ZSkKCSAgICAgKi8KCSAgICBBYnN0cmFjdEdlbmVyaWNHRi5wcm90b3R5cGUubG9nID0gZnVuY3Rpb24gKGEgLyppbnQqLykgewoJICAgICAgICBpZiAoYSA9PT0gMCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDUuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiB0aGlzLmxvZ1RhYmxlW2FdOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogSW1wbGVtZW50cyBib3RoIGFkZGl0aW9uIGFuZCBzdWJ0cmFjdGlvbiAtLSB0aGV5IGFyZSB0aGUgc2FtZSBpbiBHRihzaXplKS4KCSAgICAgKgoJICAgICAqIEByZXR1cm4gc3VtL2RpZmZlcmVuY2Ugb2YgYSBhbmQgYgoJICAgICAqLwoJICAgIEFic3RyYWN0R2VuZXJpY0dGLmFkZE9yU3VidHJhY3QgPSBmdW5jdGlvbiAoYSAvKmludCovLCBiIC8qaW50Ki8pIHsKCSAgICAgICAgcmV0dXJuIGEgXiBiOwoJICAgIH07CgkgICAgcmV0dXJuIEFic3RyYWN0R2VuZXJpY0dGOwoJfSgpKTsKCUFic3RyYWN0R2VuZXJpY0dGJDEuZGVmYXVsdCA9IEFic3RyYWN0R2VuZXJpY0dGOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoR2VuZXJpY0dGUG9seSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLmNvbW1vbi5yZWVkc29sb21vbiB7Ki8KCXZhciBBYnN0cmFjdEdlbmVyaWNHRl8xJDEgPSBBYnN0cmFjdEdlbmVyaWNHRiQxOwoJdmFyIFN5c3RlbV8xID0gU3lzdGVtJDE7Cgl2YXIgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNCA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5SZXByZXNlbnRzIGEgcG9seW5vbWlhbCB3aG9zZSBjb2VmZmljaWVudHMgYXJlIGVsZW1lbnRzIG9mIGEgR0YuCgkgKiBJbnN0YW5jZXMgb2YgdGhpcyBjbGFzcyBhcmUgaW1tdXRhYmxlLjwvcD4KCSAqCgkgKiA8cD5NdWNoIGNyZWRpdCBpcyBkdWUgdG8gV2lsbGlhbSBSdWNrbGlkZ2Ugc2luY2UgcG9ydGlvbnMgb2YgdGhpcyBjb2RlIGFyZSBhbiBpbmRpcmVjdAoJICogcG9ydCBvZiBoaXMgQysrIFJlZWQtU29sb21vbiBpbXBsZW1lbnRhdGlvbi48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEdlbmVyaWNHRlBvbHkgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgLyoqCgkgICAgICogQHBhcmFtIGZpZWxkIHRoZSB7QGxpbmsgR2VuZXJpY0dGfSBpbnN0YW5jZSByZXByZXNlbnRpbmcgdGhlIGZpZWxkIHRvIHVzZQoJICAgICAqIHRvIHBlcmZvcm0gY29tcHV0YXRpb25zCgkgICAgICogQHBhcmFtIGNvZWZmaWNpZW50cyBjb2VmZmljaWVudHMgYXMgaW50cyByZXByZXNlbnRpbmcgZWxlbWVudHMgb2YgR0Yoc2l6ZSksIGFycmFuZ2VkCgkgICAgICogZnJvbSBtb3N0IHNpZ25pZmljYW50IChoaWdoZXN0LXBvd2VyIHRlcm0pIGNvZWZmaWNpZW50IHRvIGxlYXN0IHNpZ25pZmljYW50CgkgICAgICogQHRocm93cyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gaWYgYXJndW1lbnQgaXMgbnVsbCBvciBlbXB0eSwKCSAgICAgKiBvciBpZiBsZWFkaW5nIGNvZWZmaWNpZW50IGlzIDAgYW5kIHRoaXMgaXMgbm90IGEKCSAgICAgKiBjb25zdGFudCBwb2x5bm9taWFsICh0aGF0IGlzLCBpdCBpcyBub3QgdGhlIG1vbm9taWFsICIwIikKCSAgICAgKi8KCSAgICBmdW5jdGlvbiBHZW5lcmljR0ZQb2x5KGZpZWxkLCBjb2VmZmljaWVudHMpIHsKCSAgICAgICAgaWYgKGNvZWZmaWNpZW50cy5sZW5ndGggPT09IDApIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ0LmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICB0aGlzLmZpZWxkID0gZmllbGQ7CgkgICAgICAgIHZhciBjb2VmZmljaWVudHNMZW5ndGggPSBjb2VmZmljaWVudHMubGVuZ3RoOwoJICAgICAgICBpZiAoY29lZmZpY2llbnRzTGVuZ3RoID4gMSAmJiBjb2VmZmljaWVudHNbMF0gPT09IDApIHsKCSAgICAgICAgICAgIC8vIExlYWRpbmcgdGVybSBtdXN0IGJlIG5vbi16ZXJvIGZvciBhbnl0aGluZyBleGNlcHQgdGhlIGNvbnN0YW50IHBvbHlub21pYWwgIjAiCgkgICAgICAgICAgICB2YXIgZmlyc3ROb25aZXJvID0gMTsKCSAgICAgICAgICAgIHdoaWxlIChmaXJzdE5vblplcm8gPCBjb2VmZmljaWVudHNMZW5ndGggJiYgY29lZmZpY2llbnRzW2ZpcnN0Tm9uWmVyb10gPT09IDApIHsKCSAgICAgICAgICAgICAgICBmaXJzdE5vblplcm8rKzsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGlmIChmaXJzdE5vblplcm8gPT09IGNvZWZmaWNpZW50c0xlbmd0aCkgewoJICAgICAgICAgICAgICAgIHRoaXMuY29lZmZpY2llbnRzID0gSW50MzJBcnJheS5mcm9tKFswXSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICB0aGlzLmNvZWZmaWNpZW50cyA9IG5ldyBJbnQzMkFycmF5KGNvZWZmaWNpZW50c0xlbmd0aCAtIGZpcnN0Tm9uWmVybyk7CgkgICAgICAgICAgICAgICAgU3lzdGVtXzEuZGVmYXVsdC5hcnJheWNvcHkoY29lZmZpY2llbnRzLCBmaXJzdE5vblplcm8sIHRoaXMuY29lZmZpY2llbnRzLCAwLCB0aGlzLmNvZWZmaWNpZW50cy5sZW5ndGgpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgdGhpcy5jb2VmZmljaWVudHMgPSBjb2VmZmljaWVudHM7CgkgICAgICAgIH0KCSAgICB9CgkgICAgR2VuZXJpY0dGUG9seS5wcm90b3R5cGUuZ2V0Q29lZmZpY2llbnRzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5jb2VmZmljaWVudHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIGRlZ3JlZSBvZiB0aGlzIHBvbHlub21pYWwKCSAgICAgKi8KCSAgICBHZW5lcmljR0ZQb2x5LnByb3RvdHlwZS5nZXREZWdyZWUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmNvZWZmaWNpZW50cy5sZW5ndGggLSAxOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiB0cnVlIGlmZiB0aGlzIHBvbHlub21pYWwgaXMgdGhlIG1vbm9taWFsICIwIgoJICAgICAqLwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLmlzWmVybyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuY29lZmZpY2llbnRzWzBdID09PSAwOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBjb2VmZmljaWVudCBvZiB4XmRlZ3JlZSB0ZXJtIGluIHRoaXMgcG9seW5vbWlhbAoJICAgICAqLwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLmdldENvZWZmaWNpZW50ID0gZnVuY3Rpb24gKGRlZ3JlZSAvKmludCovKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmNvZWZmaWNpZW50c1t0aGlzLmNvZWZmaWNpZW50cy5sZW5ndGggLSAxIC0gZGVncmVlXTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gZXZhbHVhdGlvbiBvZiB0aGlzIHBvbHlub21pYWwgYXQgYSBnaXZlbiBwb2ludAoJICAgICAqLwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLmV2YWx1YXRlQXQgPSBmdW5jdGlvbiAoYSAvKmludCovKSB7CgkgICAgICAgIGlmIChhID09PSAwKSB7CgkgICAgICAgICAgICAvLyBKdXN0IHJldHVybiB0aGUgeF4wIGNvZWZmaWNpZW50CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRDb2VmZmljaWVudCgwKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgY29lZmZpY2llbnRzID0gdGhpcy5jb2VmZmljaWVudHM7CgkgICAgICAgIHZhciByZXN1bHQ7CgkgICAgICAgIGlmIChhID09PSAxKSB7CgkgICAgICAgICAgICAvLyBKdXN0IHRoZSBzdW0gb2YgdGhlIGNvZWZmaWNpZW50cwoJICAgICAgICAgICAgcmVzdWx0ID0gMDsKCSAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGhfMSA9IGNvZWZmaWNpZW50cy5sZW5ndGg7IGkgIT09IGxlbmd0aF8xOyBpKyspIHsKCSAgICAgICAgICAgICAgICB2YXIgY29lZmZpY2llbnQgPSBjb2VmZmljaWVudHNbaV07CgkgICAgICAgICAgICAgICAgcmVzdWx0ID0gQWJzdHJhY3RHZW5lcmljR0ZfMSQxLmRlZmF1bHQuYWRkT3JTdWJ0cmFjdChyZXN1bHQsIGNvZWZmaWNpZW50KTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJldHVybiByZXN1bHQ7CgkgICAgICAgIH0KCSAgICAgICAgcmVzdWx0ID0gY29lZmZpY2llbnRzWzBdOwoJICAgICAgICB2YXIgc2l6ZSA9IGNvZWZmaWNpZW50cy5sZW5ndGg7CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgc2l6ZTsgaSsrKSB7CgkgICAgICAgICAgICByZXN1bHQgPSBBYnN0cmFjdEdlbmVyaWNHRl8xJDEuZGVmYXVsdC5hZGRPclN1YnRyYWN0KGZpZWxkLm11bHRpcGx5KGEsIHJlc3VsdCksIGNvZWZmaWNpZW50c1tpXSk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLmFkZE9yU3VidHJhY3QgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgaWYgKCF0aGlzLmZpZWxkLmVxdWFscyhvdGhlci5maWVsZCkpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ0LmRlZmF1bHQoJ0dlbmVyaWNHRlBvbHlzIGRvIG5vdCBoYXZlIHNhbWUgR2VuZXJpY0dGIGZpZWxkJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHRoaXMuaXNaZXJvKCkpIHsKCSAgICAgICAgICAgIHJldHVybiBvdGhlcjsKCSAgICAgICAgfQoJICAgICAgICBpZiAob3RoZXIuaXNaZXJvKCkpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzOwoJICAgICAgICB9CgkgICAgICAgIHZhciBzbWFsbGVyQ29lZmZpY2llbnRzID0gdGhpcy5jb2VmZmljaWVudHM7CgkgICAgICAgIHZhciBsYXJnZXJDb2VmZmljaWVudHMgPSBvdGhlci5jb2VmZmljaWVudHM7CgkgICAgICAgIGlmIChzbWFsbGVyQ29lZmZpY2llbnRzLmxlbmd0aCA+IGxhcmdlckNvZWZmaWNpZW50cy5sZW5ndGgpIHsKCSAgICAgICAgICAgIHZhciB0ZW1wID0gc21hbGxlckNvZWZmaWNpZW50czsKCSAgICAgICAgICAgIHNtYWxsZXJDb2VmZmljaWVudHMgPSBsYXJnZXJDb2VmZmljaWVudHM7CgkgICAgICAgICAgICBsYXJnZXJDb2VmZmljaWVudHMgPSB0ZW1wOwoJICAgICAgICB9CgkgICAgICAgIHZhciBzdW1EaWZmID0gbmV3IEludDMyQXJyYXkobGFyZ2VyQ29lZmZpY2llbnRzLmxlbmd0aCk7CgkgICAgICAgIHZhciBsZW5ndGhEaWZmID0gbGFyZ2VyQ29lZmZpY2llbnRzLmxlbmd0aCAtIHNtYWxsZXJDb2VmZmljaWVudHMubGVuZ3RoOwoJICAgICAgICAvLyBDb3B5IGhpZ2gtb3JkZXIgdGVybXMgb25seSBmb3VuZCBpbiBoaWdoZXItZGVncmVlIHBvbHlub21pYWwncyBjb2VmZmljaWVudHMKCSAgICAgICAgU3lzdGVtXzEuZGVmYXVsdC5hcnJheWNvcHkobGFyZ2VyQ29lZmZpY2llbnRzLCAwLCBzdW1EaWZmLCAwLCBsZW5ndGhEaWZmKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IGxlbmd0aERpZmY7IGkgPCBsYXJnZXJDb2VmZmljaWVudHMubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIHN1bURpZmZbaV0gPSBBYnN0cmFjdEdlbmVyaWNHRl8xJDEuZGVmYXVsdC5hZGRPclN1YnRyYWN0KHNtYWxsZXJDb2VmZmljaWVudHNbaSAtIGxlbmd0aERpZmZdLCBsYXJnZXJDb2VmZmljaWVudHNbaV0pOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgR2VuZXJpY0dGUG9seSh0aGlzLmZpZWxkLCBzdW1EaWZmKTsKCSAgICB9OwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLm11bHRpcGx5ID0gZnVuY3Rpb24gKG90aGVyKSB7CgkgICAgICAgIGlmICghdGhpcy5maWVsZC5lcXVhbHMob3RoZXIuZmllbGQpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNC5kZWZhdWx0KCdHZW5lcmljR0ZQb2x5cyBkbyBub3QgaGF2ZSBzYW1lIEdlbmVyaWNHRiBmaWVsZCcpOwoJICAgICAgICB9CgkgICAgICAgIGlmICh0aGlzLmlzWmVybygpIHx8IG90aGVyLmlzWmVybygpKSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5maWVsZC5nZXRaZXJvKCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGFDb2VmZmljaWVudHMgPSB0aGlzLmNvZWZmaWNpZW50czsKCSAgICAgICAgdmFyIGFMZW5ndGggPSBhQ29lZmZpY2llbnRzLmxlbmd0aDsKCSAgICAgICAgdmFyIGJDb2VmZmljaWVudHMgPSBvdGhlci5jb2VmZmljaWVudHM7CgkgICAgICAgIHZhciBiTGVuZ3RoID0gYkNvZWZmaWNpZW50cy5sZW5ndGg7CgkgICAgICAgIHZhciBwcm9kdWN0ID0gbmV3IEludDMyQXJyYXkoYUxlbmd0aCArIGJMZW5ndGggLSAxKTsKCSAgICAgICAgdmFyIGZpZWxkID0gdGhpcy5maWVsZDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhTGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIHZhciBhQ29lZmYgPSBhQ29lZmZpY2llbnRzW2ldOwoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBiTGVuZ3RoOyBqKyspIHsKCSAgICAgICAgICAgICAgICBwcm9kdWN0W2kgKyBqXSA9IEFic3RyYWN0R2VuZXJpY0dGXzEkMS5kZWZhdWx0LmFkZE9yU3VidHJhY3QocHJvZHVjdFtpICsgal0sIGZpZWxkLm11bHRpcGx5KGFDb2VmZiwgYkNvZWZmaWNpZW50c1tqXSkpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgR2VuZXJpY0dGUG9seShmaWVsZCwgcHJvZHVjdCk7CgkgICAgfTsKCSAgICBHZW5lcmljR0ZQb2x5LnByb3RvdHlwZS5tdWx0aXBseVNjYWxhciA9IGZ1bmN0aW9uIChzY2FsYXIgLyppbnQqLykgewoJICAgICAgICBpZiAoc2NhbGFyID09PSAwKSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5maWVsZC5nZXRaZXJvKCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHNjYWxhciA9PT0gMSkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXM7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHNpemUgPSB0aGlzLmNvZWZmaWNpZW50cy5sZW5ndGg7CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIHZhciBwcm9kdWN0ID0gbmV3IEludDMyQXJyYXkoc2l6ZSk7CgkgICAgICAgIHZhciBjb2VmZmljaWVudHMgPSB0aGlzLmNvZWZmaWNpZW50czsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzaXplOyBpKyspIHsKCSAgICAgICAgICAgIHByb2R1Y3RbaV0gPSBmaWVsZC5tdWx0aXBseShjb2VmZmljaWVudHNbaV0sIHNjYWxhcik7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG5ldyBHZW5lcmljR0ZQb2x5KGZpZWxkLCBwcm9kdWN0KTsKCSAgICB9OwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLm11bHRpcGx5QnlNb25vbWlhbCA9IGZ1bmN0aW9uIChkZWdyZWUgLyppbnQqLywgY29lZmZpY2llbnQgLyppbnQqLykgewoJICAgICAgICBpZiAoZGVncmVlIDwgMCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDQuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIGlmIChjb2VmZmljaWVudCA9PT0gMCkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMuZmllbGQuZ2V0WmVybygpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBjb2VmZmljaWVudHMgPSB0aGlzLmNvZWZmaWNpZW50czsKCSAgICAgICAgdmFyIHNpemUgPSBjb2VmZmljaWVudHMubGVuZ3RoOwoJICAgICAgICB2YXIgcHJvZHVjdCA9IG5ldyBJbnQzMkFycmF5KHNpemUgKyBkZWdyZWUpOwoJICAgICAgICB2YXIgZmllbGQgPSB0aGlzLmZpZWxkOwoJICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNpemU7IGkrKykgewoJICAgICAgICAgICAgcHJvZHVjdFtpXSA9IGZpZWxkLm11bHRpcGx5KGNvZWZmaWNpZW50c1tpXSwgY29lZmZpY2llbnQpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgR2VuZXJpY0dGUG9seShmaWVsZCwgcHJvZHVjdCk7CgkgICAgfTsKCSAgICBHZW5lcmljR0ZQb2x5LnByb3RvdHlwZS5kaXZpZGUgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgaWYgKCF0aGlzLmZpZWxkLmVxdWFscyhvdGhlci5maWVsZCkpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ0LmRlZmF1bHQoJ0dlbmVyaWNHRlBvbHlzIGRvIG5vdCBoYXZlIHNhbWUgR2VuZXJpY0dGIGZpZWxkJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKG90aGVyLmlzWmVybygpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNC5kZWZhdWx0KCdEaXZpZGUgYnkgMCcpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIHZhciBxdW90aWVudCA9IGZpZWxkLmdldFplcm8oKTsKCSAgICAgICAgdmFyIHJlbWFpbmRlciA9IHRoaXM7CgkgICAgICAgIHZhciBkZW5vbWluYXRvckxlYWRpbmdUZXJtID0gb3RoZXIuZ2V0Q29lZmZpY2llbnQob3RoZXIuZ2V0RGVncmVlKCkpOwoJICAgICAgICB2YXIgaW52ZXJzZURlbm9taW5hdG9yTGVhZGluZ1Rlcm0gPSBmaWVsZC5pbnZlcnNlKGRlbm9taW5hdG9yTGVhZGluZ1Rlcm0pOwoJICAgICAgICB3aGlsZSAocmVtYWluZGVyLmdldERlZ3JlZSgpID49IG90aGVyLmdldERlZ3JlZSgpICYmICFyZW1haW5kZXIuaXNaZXJvKCkpIHsKCSAgICAgICAgICAgIHZhciBkZWdyZWVEaWZmZXJlbmNlID0gcmVtYWluZGVyLmdldERlZ3JlZSgpIC0gb3RoZXIuZ2V0RGVncmVlKCk7CgkgICAgICAgICAgICB2YXIgc2NhbGUgPSBmaWVsZC5tdWx0aXBseShyZW1haW5kZXIuZ2V0Q29lZmZpY2llbnQocmVtYWluZGVyLmdldERlZ3JlZSgpKSwgaW52ZXJzZURlbm9taW5hdG9yTGVhZGluZ1Rlcm0pOwoJICAgICAgICAgICAgdmFyIHRlcm0gPSBvdGhlci5tdWx0aXBseUJ5TW9ub21pYWwoZGVncmVlRGlmZmVyZW5jZSwgc2NhbGUpOwoJICAgICAgICAgICAgdmFyIGl0ZXJhdGlvblF1b3RpZW50ID0gZmllbGQuYnVpbGRNb25vbWlhbChkZWdyZWVEaWZmZXJlbmNlLCBzY2FsZSk7CgkgICAgICAgICAgICBxdW90aWVudCA9IHF1b3RpZW50LmFkZE9yU3VidHJhY3QoaXRlcmF0aW9uUXVvdGllbnQpOwoJICAgICAgICAgICAgcmVtYWluZGVyID0gcmVtYWluZGVyLmFkZE9yU3VidHJhY3QodGVybSk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIFtxdW90aWVudCwgcmVtYWluZGVyXTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBHZW5lcmljR0ZQb2x5LnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIHJlc3VsdCA9ICcnOwoJICAgICAgICBmb3IgKHZhciBkZWdyZWUgPSB0aGlzLmdldERlZ3JlZSgpOyBkZWdyZWUgPj0gMDsgZGVncmVlLS0pIHsKCSAgICAgICAgICAgIHZhciBjb2VmZmljaWVudCA9IHRoaXMuZ2V0Q29lZmZpY2llbnQoZGVncmVlKTsKCSAgICAgICAgICAgIGlmIChjb2VmZmljaWVudCAhPT0gMCkgewoJICAgICAgICAgICAgICAgIGlmIChjb2VmZmljaWVudCA8IDApIHsKCSAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9ICcgLSAnOwoJICAgICAgICAgICAgICAgICAgICBjb2VmZmljaWVudCA9IC1jb2VmZmljaWVudDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQubGVuZ3RoID4gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9ICcgKyAnOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGlmIChkZWdyZWUgPT09IDAgfHwgY29lZmZpY2llbnQgIT09IDEpIHsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGFscGhhUG93ZXIgPSB0aGlzLmZpZWxkLmxvZyhjb2VmZmljaWVudCk7CgkgICAgICAgICAgICAgICAgICAgIGlmIChhbHBoYVBvd2VyID09PSAwKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgKz0gJzEnOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGFscGhhUG93ZXIgPT09IDEpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCArPSAnYSc7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgKz0gJ2FeJzsKCSAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCArPSBhbHBoYVBvd2VyOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGlmIChkZWdyZWUgIT09IDApIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKGRlZ3JlZSA9PT0gMSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9ICd4JzsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCArPSAneF4nOwoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9IGRlZ3JlZTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gcmVzdWx0OwoJICAgIH07CgkgICAgcmV0dXJuIEdlbmVyaWNHRlBvbHk7Cgl9KCkpOwoJR2VuZXJpY0dGUG9seSQxLmRlZmF1bHQgPSBHZW5lcmljR0ZQb2x5OwoKCXZhciBBcml0aG1ldGljRXhjZXB0aW9uJDEgPSB7fTsKCgl2YXIgX19leHRlbmRzJDcgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoQXJpdGhtZXRpY0V4Y2VwdGlvbiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgRXhjZXB0aW9uXzEkMyA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBBcml0aG1ldGljRXhjZXB0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyQ3KEFyaXRobWV0aWNFeGNlcHRpb24sIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gQXJpdGhtZXRpY0V4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBBcml0aG1ldGljRXhjZXB0aW9uLmtpbmQgPSAnQXJpdGhtZXRpY0V4Y2VwdGlvbic7CgkgICAgcmV0dXJuIEFyaXRobWV0aWNFeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xJDMuZGVmYXVsdCkpOwoJQXJpdGhtZXRpY0V4Y2VwdGlvbiQxLmRlZmF1bHQgPSBBcml0aG1ldGljRXhjZXB0aW9uOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCgl2YXIgX19leHRlbmRzJDYgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoR2VuZXJpY0dGJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uLnJlZWRzb2xvbW9uIHsqLwoJdmFyIEdlbmVyaWNHRlBvbHlfMSQxID0gR2VuZXJpY0dGUG9seSQxOwoJdmFyIEFic3RyYWN0R2VuZXJpY0dGXzEgPSBBYnN0cmFjdEdlbmVyaWNHRiQxOwoJdmFyIEludGVnZXJfMSQxID0gSW50ZWdlciQxOwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDMgPSBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMTsKCXZhciBBcml0aG1ldGljRXhjZXB0aW9uXzEgPSBBcml0aG1ldGljRXhjZXB0aW9uJDE7CgkvKioKCSAqIDxwPlRoaXMgY2xhc3MgY29udGFpbnMgdXRpbGl0eSBtZXRob2RzIGZvciBwZXJmb3JtaW5nIG1hdGhlbWF0aWNhbCBvcGVyYXRpb25zIG92ZXIKCSAqIHRoZSBHYWxvaXMgRmllbGRzLiBPcGVyYXRpb25zIHVzZSBhIGdpdmVuIHByaW1pdGl2ZSBwb2x5bm9taWFsIGluIGNhbGN1bGF0aW9ucy48L3A+CgkgKgoJICogPHA+VGhyb3VnaG91dCB0aGlzIHBhY2thZ2UsIGVsZW1lbnRzIG9mIHRoZSBHRiBhcmUgcmVwcmVzZW50ZWQgYXMgYW4ge0Bjb2RlIGludH0KCSAqIGZvciBjb252ZW5pZW5jZSBhbmQgc3BlZWQgKGJ1dCBhdCB0aGUgY29zdCBvZiBtZW1vcnkpLgoJICogPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKiBAYXV0aG9yIERhdmlkIE9saXZpZXIKCSAqLwoJdmFyIEdlbmVyaWNHRiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkNihHZW5lcmljR0YsIF9zdXBlcik7CgkgICAgLyoqCgkgICAgICogQ3JlYXRlIGEgcmVwcmVzZW50YXRpb24gb2YgR0Yoc2l6ZSkgdXNpbmcgdGhlIGdpdmVuIHByaW1pdGl2ZSBwb2x5bm9taWFsLgoJICAgICAqCgkgICAgICogQHBhcmFtIHByaW1pdGl2ZSBpcnJlZHVjaWJsZSBwb2x5bm9taWFsIHdob3NlIGNvZWZmaWNpZW50cyBhcmUgcmVwcmVzZW50ZWQgYnkKCSAgICAgKiAgdGhlIGJpdHMgb2YgYW4gaW50LCB3aGVyZSB0aGUgbGVhc3Qtc2lnbmlmaWNhbnQgYml0IHJlcHJlc2VudHMgdGhlIGNvbnN0YW50CgkgICAgICogIGNvZWZmaWNpZW50CgkgICAgICogQHBhcmFtIHNpemUgdGhlIHNpemUgb2YgdGhlIGZpZWxkCgkgICAgICogQHBhcmFtIGIgdGhlIGZhY3RvciBiIGluIHRoZSBnZW5lcmF0b3IgcG9seW5vbWlhbCBjYW4gYmUgMC0gb3IgMS1iYXNlZAoJICAgICAqICAoZyh4KSA9ICh4K2FeYikoeCthXihiKzEpKS4uLih4K2FeKGIrMnQtMSkpKS4KCSAgICAgKiAgSW4gbW9zdCBjYXNlcyBpdCBzaG91bGQgYmUgMSwgYnV0IGZvciBRUiBjb2RlIGl0IGlzIDAuCgkgICAgICovCgkgICAgZnVuY3Rpb24gR2VuZXJpY0dGKHByaW1pdGl2ZSAvKmludCovLCBzaXplIC8qaW50Ki8sIGdlbmVyYXRvckJhc2UgLyppbnQqLykgewoJICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5wcmltaXRpdmUgPSBwcmltaXRpdmU7CgkgICAgICAgIF90aGlzLnNpemUgPSBzaXplOwoJICAgICAgICBfdGhpcy5nZW5lcmF0b3JCYXNlID0gZ2VuZXJhdG9yQmFzZTsKCSAgICAgICAgdmFyIGV4cFRhYmxlID0gbmV3IEludDMyQXJyYXkoc2l6ZSk7CgkgICAgICAgIHZhciB4ID0gMTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzaXplOyBpKyspIHsKCSAgICAgICAgICAgIGV4cFRhYmxlW2ldID0geDsKCSAgICAgICAgICAgIHggKj0gMjsgLy8gd2UncmUgYXNzdW1pbmcgdGhlIGdlbmVyYXRvciBhbHBoYSBpcyAyCgkgICAgICAgICAgICBpZiAoeCA+PSBzaXplKSB7CgkgICAgICAgICAgICAgICAgeCBePSBwcmltaXRpdmU7CgkgICAgICAgICAgICAgICAgeCAmPSBzaXplIC0gMTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBfdGhpcy5leHBUYWJsZSA9IGV4cFRhYmxlOwoJICAgICAgICB2YXIgbG9nVGFibGUgPSBuZXcgSW50MzJBcnJheShzaXplKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzaXplIC0gMTsgaSsrKSB7CgkgICAgICAgICAgICBsb2dUYWJsZVtleHBUYWJsZVtpXV0gPSBpOwoJICAgICAgICB9CgkgICAgICAgIF90aGlzLmxvZ1RhYmxlID0gbG9nVGFibGU7CgkgICAgICAgIC8vIGxvZ1RhYmxlWzBdID09IDAgYnV0IHRoaXMgc2hvdWxkIG5ldmVyIGJlIHVzZWQKCSAgICAgICAgX3RoaXMuemVybyA9IG5ldyBHZW5lcmljR0ZQb2x5XzEkMS5kZWZhdWx0KF90aGlzLCBJbnQzMkFycmF5LmZyb20oWzBdKSk7CgkgICAgICAgIF90aGlzLm9uZSA9IG5ldyBHZW5lcmljR0ZQb2x5XzEkMS5kZWZhdWx0KF90aGlzLCBJbnQzMkFycmF5LmZyb20oWzFdKSk7CgkgICAgICAgIHJldHVybiBfdGhpczsKCSAgICB9CgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS5nZXRaZXJvID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy56ZXJvOwoJICAgIH07CgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS5nZXRPbmUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm9uZTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gdGhlIG1vbm9taWFsIHJlcHJlc2VudGluZyBjb2VmZmljaWVudCAqIHheZGVncmVlCgkgICAgICovCgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS5idWlsZE1vbm9taWFsID0gZnVuY3Rpb24gKGRlZ3JlZSAvKmludCovLCBjb2VmZmljaWVudCAvKmludCovKSB7CgkgICAgICAgIGlmIChkZWdyZWUgPCAwKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkMy5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNvZWZmaWNpZW50ID09PSAwKSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy56ZXJvOwoJICAgICAgICB9CgkgICAgICAgIHZhciBjb2VmZmljaWVudHMgPSBuZXcgSW50MzJBcnJheShkZWdyZWUgKyAxKTsKCSAgICAgICAgY29lZmZpY2llbnRzWzBdID0gY29lZmZpY2llbnQ7CgkgICAgICAgIHJldHVybiBuZXcgR2VuZXJpY0dGUG9seV8xJDEuZGVmYXVsdCh0aGlzLCBjb2VmZmljaWVudHMpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBtdWx0aXBsaWNhdGl2ZSBpbnZlcnNlIG9mIGEKCSAgICAgKi8KCSAgICBHZW5lcmljR0YucHJvdG90eXBlLmludmVyc2UgPSBmdW5jdGlvbiAoYSAvKmludCovKSB7CgkgICAgICAgIGlmIChhID09PSAwKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgQXJpdGhtZXRpY0V4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdGhpcy5leHBUYWJsZVt0aGlzLnNpemUgLSB0aGlzLmxvZ1RhYmxlW2FdIC0gMV07CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHByb2R1Y3Qgb2YgYSBhbmQgYiBpbiBHRihzaXplKQoJICAgICAqLwoJICAgIEdlbmVyaWNHRi5wcm90b3R5cGUubXVsdGlwbHkgPSBmdW5jdGlvbiAoYSAvKmludCovLCBiIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKGEgPT09IDAgfHwgYiA9PT0gMCkgewoJICAgICAgICAgICAgcmV0dXJuIDA7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRoaXMuZXhwVGFibGVbKHRoaXMubG9nVGFibGVbYV0gKyB0aGlzLmxvZ1RhYmxlW2JdKSAlICh0aGlzLnNpemUgLSAxKV07CgkgICAgfTsKCSAgICBHZW5lcmljR0YucHJvdG90eXBlLmdldFNpemUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnNpemU7CgkgICAgfTsKCSAgICBHZW5lcmljR0YucHJvdG90eXBlLmdldEdlbmVyYXRvckJhc2UgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmdlbmVyYXRvckJhc2U7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuICgnR0YoMHgnICsgSW50ZWdlcl8xJDEuZGVmYXVsdC50b0hleFN0cmluZyh0aGlzLnByaW1pdGl2ZSkgKyAnLCcgKyB0aGlzLnNpemUgKyAnKScpOwoJICAgIH07CgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAobykgewoJICAgICAgICByZXR1cm4gbyA9PT0gdGhpczsKCSAgICB9OwoJICAgIEdlbmVyaWNHRi5BWlRFQ19EQVRBXzEyID0gbmV3IEdlbmVyaWNHRigweDEwNjksIDQwOTYsIDEpOyAvLyB4XjEyICsgeF42ICsgeF41ICsgeF4zICsgMQoJICAgIEdlbmVyaWNHRi5BWlRFQ19EQVRBXzEwID0gbmV3IEdlbmVyaWNHRigweDQwOSwgMTAyNCwgMSk7IC8vIHheMTAgKyB4XjMgKyAxCgkgICAgR2VuZXJpY0dGLkFaVEVDX0RBVEFfNiA9IG5ldyBHZW5lcmljR0YoMHg0MywgNjQsIDEpOyAvLyB4XjYgKyB4ICsgMQoJICAgIEdlbmVyaWNHRi5BWlRFQ19QQVJBTSA9IG5ldyBHZW5lcmljR0YoMHgxMywgMTYsIDEpOyAvLyB4XjQgKyB4ICsgMQoJICAgIEdlbmVyaWNHRi5RUl9DT0RFX0ZJRUxEXzI1NiA9IG5ldyBHZW5lcmljR0YoMHgwMTFkLCAyNTYsIDApOyAvLyB4XjggKyB4XjQgKyB4XjMgKyB4XjIgKyAxCgkgICAgR2VuZXJpY0dGLkRBVEFfTUFUUklYX0ZJRUxEXzI1NiA9IG5ldyBHZW5lcmljR0YoMHgwMTJkLCAyNTYsIDEpOyAvLyB4XjggKyB4XjUgKyB4XjMgKyB4XjIgKyAxCgkgICAgR2VuZXJpY0dGLkFaVEVDX0RBVEFfOCA9IEdlbmVyaWNHRi5EQVRBX01BVFJJWF9GSUVMRF8yNTY7CgkgICAgR2VuZXJpY0dGLk1BWElDT0RFX0ZJRUxEXzY0ID0gR2VuZXJpY0dGLkFaVEVDX0RBVEFfNjsKCSAgICByZXR1cm4gR2VuZXJpY0dGOwoJfShBYnN0cmFjdEdlbmVyaWNHRl8xLmRlZmF1bHQpKTsKCUdlbmVyaWNHRiQxLmRlZmF1bHQgPSBHZW5lcmljR0Y7CgoJdmFyIFJlZWRTb2xvbW9uRGVjb2RlciQxID0ge307CgoJdmFyIFJlZWRTb2xvbW9uRXhjZXB0aW9uJDEgPSB7fTsKCgl2YXIgX19leHRlbmRzJDUgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoUmVlZFNvbG9tb25FeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIEV4Y2VwdGlvbl8xJDIgPSBFeGNlcHRpb24kMTsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgUmVlZFNvbG9tb25FeGNlcHRpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJDUoUmVlZFNvbG9tb25FeGNlcHRpb24sIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gUmVlZFNvbG9tb25FeGNlcHRpb24oKSB7CgkgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsKCSAgICB9CgkgICAgUmVlZFNvbG9tb25FeGNlcHRpb24ua2luZCA9ICdSZWVkU29sb21vbkV4Y2VwdGlvbic7CgkgICAgcmV0dXJuIFJlZWRTb2xvbW9uRXhjZXB0aW9uOwoJfShFeGNlcHRpb25fMSQyLmRlZmF1bHQpKTsKCVJlZWRTb2xvbW9uRXhjZXB0aW9uJDEuZGVmYXVsdCA9IFJlZWRTb2xvbW9uRXhjZXB0aW9uOwoKCXZhciBJbGxlZ2FsU3RhdGVFeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkNCA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbGxlZ2FsU3RhdGVFeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIEV4Y2VwdGlvbl8xJDEgPSBFeGNlcHRpb24kMTsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgSWxsZWdhbFN0YXRlRXhjZXB0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyQ0KElsbGVnYWxTdGF0ZUV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBJbGxlZ2FsU3RhdGVFeGNlcHRpb24oKSB7CgkgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsKCSAgICB9CgkgICAgSWxsZWdhbFN0YXRlRXhjZXB0aW9uLmtpbmQgPSAnSWxsZWdhbFN0YXRlRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gSWxsZWdhbFN0YXRlRXhjZXB0aW9uOwoJfShFeGNlcHRpb25fMSQxLmRlZmF1bHQpKTsKCUlsbGVnYWxTdGF0ZUV4Y2VwdGlvbiQxLmRlZmF1bHQgPSBJbGxlZ2FsU3RhdGVFeGNlcHRpb247CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZWVkU29sb21vbkRlY29kZXIkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5jb21tb24ucmVlZHNvbG9tb24geyovCgl2YXIgR2VuZXJpY0dGXzEkMSA9IEdlbmVyaWNHRiQxOwoJdmFyIEdlbmVyaWNHRlBvbHlfMSA9IEdlbmVyaWNHRlBvbHkkMTsKCXZhciBSZWVkU29sb21vbkV4Y2VwdGlvbl8xID0gUmVlZFNvbG9tb25FeGNlcHRpb24kMTsKCXZhciBJbGxlZ2FsU3RhdGVFeGNlcHRpb25fMSA9IElsbGVnYWxTdGF0ZUV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5JbXBsZW1lbnRzIFJlZWQtU29sb21vbiBkZWNvZGluZywgYXMgdGhlIG5hbWUgaW1wbGllcy48L3A+CgkgKgoJICogPHA+VGhlIGFsZ29yaXRobSB3aWxsIG5vdCBiZSBleHBsYWluZWQgaGVyZSwgYnV0IHRoZSBmb2xsb3dpbmcgcmVmZXJlbmNlcyB3ZXJlIGhlbHBmdWwKCSAqIGluIGNyZWF0aW5nIHRoaXMgaW1wbGVtZW50YXRpb246PC9wPgoJICoKCSAqIDx1bD4KCSAqIDxsaT5CcnVjZSBNYWdncy4KCSAqIDxhIGhyZWY9Imh0dHA6Ly93d3cuY3MuY211LmVkdS9hZnMvY3MuY211LmVkdS9wcm9qZWN0L3BzY2ljby1ndXliL3JlYWx3b3JsZC93d3cvcnNfZGVjb2RlLnBzIj4KCSAqICJEZWNvZGluZyBSZWVkLVNvbG9tb24gQ29kZXMiPC9hPiAoc2VlIGRpc2N1c3Npb24gb2YgRm9ybmV5J3MgRm9ybXVsYSk8L2xpPgoJICogPGxpPkouSS4gSGFsbC4gPGEgaHJlZj0id3d3Lm10aC5tc3UuZWR1L35qaGFsbC9jbGFzc2VzL2NvZGVub3Rlcy9HUlMucGRmIj4KCSAqICJDaGFwdGVyIDUuIEdlbmVyYWxpemVkIFJlZWQtU29sb21vbiBDb2RlcyI8L2E+CgkgKiAoc2VlIGRpc2N1c3Npb24gb2YgRXVjbGlkZWFuIGFsZ29yaXRobSk8L2xpPgoJICogPC91bD4KCSAqCgkgKiA8cD5NdWNoIGNyZWRpdCBpcyBkdWUgdG8gV2lsbGlhbSBSdWNrbGlkZ2Ugc2luY2UgcG9ydGlvbnMgb2YgdGhpcyBjb2RlIGFyZSBhbiBpbmRpcmVjdAoJICogcG9ydCBvZiBoaXMgQysrIFJlZWQtU29sb21vbiBpbXBsZW1lbnRhdGlvbi48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqIEBhdXRob3IgV2lsbGlhbSBSdWNrbGlkZ2UKCSAqIEBhdXRob3Igc2FuZm9yZHNxdWlyZXMKCSAqLwoJdmFyIFJlZWRTb2xvbW9uRGVjb2RlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBSZWVkU29sb21vbkRlY29kZXIoZmllbGQpIHsKCSAgICAgICAgdGhpcy5maWVsZCA9IGZpZWxkOwoJICAgIH0KCSAgICAvKioKCSAgICAgKiA8cD5EZWNvZGVzIGdpdmVuIHNldCBvZiByZWNlaXZlZCBjb2Rld29yZHMsIHdoaWNoIGluY2x1ZGUgYm90aCBkYXRhIGFuZCBlcnJvci1jb3JyZWN0aW9uCgkgICAgICogY29kZXdvcmRzLiBSZWFsbHksIHRoaXMgbWVhbnMgaXQgdXNlcyBSZWVkLVNvbG9tb24gdG8gZGV0ZWN0IGFuZCBjb3JyZWN0IGVycm9ycywgaW4tcGxhY2UsCgkgICAgICogaW4gdGhlIGlucHV0LjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSByZWNlaXZlZCBkYXRhIGFuZCBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3JkcwoJICAgICAqIEBwYXJhbSB0d29TIG51bWJlciBvZiBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3JkcyBhdmFpbGFibGUKCSAgICAgKiBAdGhyb3dzIFJlZWRTb2xvbW9uRXhjZXB0aW9uIGlmIGRlY29kaW5nIGZhaWxzIGZvciBhbnkgcmVhc29uCgkgICAgICovCgkgICAgUmVlZFNvbG9tb25EZWNvZGVyLnByb3RvdHlwZS5kZWNvZGUgPSBmdW5jdGlvbiAocmVjZWl2ZWQsIHR3b1MgLyppbnQqLykgewoJICAgICAgICB2YXIgZmllbGQgPSB0aGlzLmZpZWxkOwoJICAgICAgICB2YXIgcG9seSA9IG5ldyBHZW5lcmljR0ZQb2x5XzEuZGVmYXVsdChmaWVsZCwgcmVjZWl2ZWQpOwoJICAgICAgICB2YXIgc3luZHJvbWVDb2VmZmljaWVudHMgPSBuZXcgSW50MzJBcnJheSh0d29TKTsKCSAgICAgICAgdmFyIG5vRXJyb3IgPSB0cnVlOwoJICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHR3b1M7IGkrKykgewoJICAgICAgICAgICAgdmFyIGV2YWxSZXN1bHQgPSBwb2x5LmV2YWx1YXRlQXQoZmllbGQuZXhwKGkgKyBmaWVsZC5nZXRHZW5lcmF0b3JCYXNlKCkpKTsKCSAgICAgICAgICAgIHN5bmRyb21lQ29lZmZpY2llbnRzW3N5bmRyb21lQ29lZmZpY2llbnRzLmxlbmd0aCAtIDEgLSBpXSA9IGV2YWxSZXN1bHQ7CgkgICAgICAgICAgICBpZiAoZXZhbFJlc3VsdCAhPT0gMCkgewoJICAgICAgICAgICAgICAgIG5vRXJyb3IgPSBmYWxzZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBpZiAobm9FcnJvcikgewoJICAgICAgICAgICAgcmV0dXJuOwoJICAgICAgICB9CgkgICAgICAgIHZhciBzeW5kcm9tZSA9IG5ldyBHZW5lcmljR0ZQb2x5XzEuZGVmYXVsdChmaWVsZCwgc3luZHJvbWVDb2VmZmljaWVudHMpOwoJICAgICAgICB2YXIgc2lnbWFPbWVnYSA9IHRoaXMucnVuRXVjbGlkZWFuQWxnb3JpdGhtKGZpZWxkLmJ1aWxkTW9ub21pYWwodHdvUywgMSksIHN5bmRyb21lLCB0d29TKTsKCSAgICAgICAgdmFyIHNpZ21hID0gc2lnbWFPbWVnYVswXTsKCSAgICAgICAgdmFyIG9tZWdhID0gc2lnbWFPbWVnYVsxXTsKCSAgICAgICAgdmFyIGVycm9yTG9jYXRpb25zID0gdGhpcy5maW5kRXJyb3JMb2NhdGlvbnMoc2lnbWEpOwoJICAgICAgICB2YXIgZXJyb3JNYWduaXR1ZGVzID0gdGhpcy5maW5kRXJyb3JNYWduaXR1ZGVzKG9tZWdhLCBlcnJvckxvY2F0aW9ucyk7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZXJyb3JMb2NhdGlvbnMubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIHZhciBwb3NpdGlvbiA9IHJlY2VpdmVkLmxlbmd0aCAtIDEgLSBmaWVsZC5sb2coZXJyb3JMb2NhdGlvbnNbaV0pOwoJICAgICAgICAgICAgaWYgKHBvc2l0aW9uIDwgMCkgewoJICAgICAgICAgICAgICAgIHRocm93IG5ldyBSZWVkU29sb21vbkV4Y2VwdGlvbl8xLmRlZmF1bHQoJ0JhZCBlcnJvciBsb2NhdGlvbicpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmVjZWl2ZWRbcG9zaXRpb25dID0gR2VuZXJpY0dGXzEkMS5kZWZhdWx0LmFkZE9yU3VidHJhY3QocmVjZWl2ZWRbcG9zaXRpb25dLCBlcnJvck1hZ25pdHVkZXNbaV0pOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBSZWVkU29sb21vbkRlY29kZXIucHJvdG90eXBlLnJ1bkV1Y2xpZGVhbkFsZ29yaXRobSA9IGZ1bmN0aW9uIChhLCBiLCBSIC8qaW50Ki8pIHsKCSAgICAgICAgLy8gQXNzdW1lIGEncyBkZWdyZWUgaXMgPj0gYidzCgkgICAgICAgIGlmIChhLmdldERlZ3JlZSgpIDwgYi5nZXREZWdyZWUoKSkgewoJICAgICAgICAgICAgdmFyIHRlbXAgPSBhOwoJICAgICAgICAgICAgYSA9IGI7CgkgICAgICAgICAgICBiID0gdGVtcDsKCSAgICAgICAgfQoJICAgICAgICB2YXIgZmllbGQgPSB0aGlzLmZpZWxkOwoJICAgICAgICB2YXIgckxhc3QgPSBhOwoJICAgICAgICB2YXIgciA9IGI7CgkgICAgICAgIHZhciB0TGFzdCA9IGZpZWxkLmdldFplcm8oKTsKCSAgICAgICAgdmFyIHQgPSBmaWVsZC5nZXRPbmUoKTsKCSAgICAgICAgLy8gUnVuIEV1Y2xpZGVhbiBhbGdvcml0aG0gdW50aWwgcidzIGRlZ3JlZSBpcyBsZXNzIHRoYW4gUi8yCgkgICAgICAgIHdoaWxlIChyLmdldERlZ3JlZSgpID49IChSIC8gMiB8IDApKSB7CgkgICAgICAgICAgICB2YXIgckxhc3RMYXN0ID0gckxhc3Q7CgkgICAgICAgICAgICB2YXIgdExhc3RMYXN0ID0gdExhc3Q7CgkgICAgICAgICAgICByTGFzdCA9IHI7CgkgICAgICAgICAgICB0TGFzdCA9IHQ7CgkgICAgICAgICAgICAvLyBEaXZpZGUgckxhc3RMYXN0IGJ5IHJMYXN0LCB3aXRoIHF1b3RpZW50IGluIHEgYW5kIHJlbWFpbmRlciBpbiByCgkgICAgICAgICAgICBpZiAockxhc3QuaXNaZXJvKCkpIHsKCSAgICAgICAgICAgICAgICAvLyBPb3BzLCBFdWNsaWRlYW4gYWxnb3JpdGhtIGFscmVhZHkgdGVybWluYXRlZD8KCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgUmVlZFNvbG9tb25FeGNlcHRpb25fMS5kZWZhdWx0KCdyX3tpLTF9IHdhcyB6ZXJvJyk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICByID0gckxhc3RMYXN0OwoJICAgICAgICAgICAgdmFyIHEgPSBmaWVsZC5nZXRaZXJvKCk7CgkgICAgICAgICAgICB2YXIgZGVub21pbmF0b3JMZWFkaW5nVGVybSA9IHJMYXN0LmdldENvZWZmaWNpZW50KHJMYXN0LmdldERlZ3JlZSgpKTsKCSAgICAgICAgICAgIHZhciBkbHRJbnZlcnNlID0gZmllbGQuaW52ZXJzZShkZW5vbWluYXRvckxlYWRpbmdUZXJtKTsKCSAgICAgICAgICAgIHdoaWxlIChyLmdldERlZ3JlZSgpID49IHJMYXN0LmdldERlZ3JlZSgpICYmICFyLmlzWmVybygpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGRlZ3JlZURpZmYgPSByLmdldERlZ3JlZSgpIC0gckxhc3QuZ2V0RGVncmVlKCk7CgkgICAgICAgICAgICAgICAgdmFyIHNjYWxlID0gZmllbGQubXVsdGlwbHkoci5nZXRDb2VmZmljaWVudChyLmdldERlZ3JlZSgpKSwgZGx0SW52ZXJzZSk7CgkgICAgICAgICAgICAgICAgcSA9IHEuYWRkT3JTdWJ0cmFjdChmaWVsZC5idWlsZE1vbm9taWFsKGRlZ3JlZURpZmYsIHNjYWxlKSk7CgkgICAgICAgICAgICAgICAgciA9IHIuYWRkT3JTdWJ0cmFjdChyTGFzdC5tdWx0aXBseUJ5TW9ub21pYWwoZGVncmVlRGlmZiwgc2NhbGUpKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHQgPSBxLm11bHRpcGx5KHRMYXN0KS5hZGRPclN1YnRyYWN0KHRMYXN0TGFzdCk7CgkgICAgICAgICAgICBpZiAoci5nZXREZWdyZWUoKSA+PSByTGFzdC5nZXREZWdyZWUoKSkgewoJICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsU3RhdGVFeGNlcHRpb25fMS5kZWZhdWx0KCdEaXZpc2lvbiBhbGdvcml0aG0gZmFpbGVkIHRvIHJlZHVjZSBwb2x5bm9taWFsPycpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHZhciBzaWdtYVRpbGRlQXRaZXJvID0gdC5nZXRDb2VmZmljaWVudCgwKTsKCSAgICAgICAgaWYgKHNpZ21hVGlsZGVBdFplcm8gPT09IDApIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBSZWVkU29sb21vbkV4Y2VwdGlvbl8xLmRlZmF1bHQoJ3NpZ21hVGlsZGUoMCkgd2FzIHplcm8nKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgaW52ZXJzZSA9IGZpZWxkLmludmVyc2Uoc2lnbWFUaWxkZUF0WmVybyk7CgkgICAgICAgIHZhciBzaWdtYSA9IHQubXVsdGlwbHlTY2FsYXIoaW52ZXJzZSk7CgkgICAgICAgIHZhciBvbWVnYSA9IHIubXVsdGlwbHlTY2FsYXIoaW52ZXJzZSk7CgkgICAgICAgIHJldHVybiBbc2lnbWEsIG9tZWdhXTsKCSAgICB9OwoJICAgIFJlZWRTb2xvbW9uRGVjb2Rlci5wcm90b3R5cGUuZmluZEVycm9yTG9jYXRpb25zID0gZnVuY3Rpb24gKGVycm9yTG9jYXRvcikgewoJICAgICAgICAvLyBUaGlzIGlzIGEgZGlyZWN0IGFwcGxpY2F0aW9uIG9mIENoaWVuJ3Mgc2VhcmNoCgkgICAgICAgIHZhciBudW1FcnJvcnMgPSBlcnJvckxvY2F0b3IuZ2V0RGVncmVlKCk7CgkgICAgICAgIGlmIChudW1FcnJvcnMgPT09IDEpIHsgLy8gc2hvcnRjdXQKCSAgICAgICAgICAgIHJldHVybiBJbnQzMkFycmF5LmZyb20oW2Vycm9yTG9jYXRvci5nZXRDb2VmZmljaWVudCgxKV0pOwoJICAgICAgICB9CgkgICAgICAgIHZhciByZXN1bHQgPSBuZXcgSW50MzJBcnJheShudW1FcnJvcnMpOwoJICAgICAgICB2YXIgZSA9IDA7CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgZmllbGQuZ2V0U2l6ZSgpICYmIGUgPCBudW1FcnJvcnM7IGkrKykgewoJICAgICAgICAgICAgaWYgKGVycm9yTG9jYXRvci5ldmFsdWF0ZUF0KGkpID09PSAwKSB7CgkgICAgICAgICAgICAgICAgcmVzdWx0W2VdID0gZmllbGQuaW52ZXJzZShpKTsKCSAgICAgICAgICAgICAgICBlKys7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGUgIT09IG51bUVycm9ycykgewoJICAgICAgICAgICAgdGhyb3cgbmV3IFJlZWRTb2xvbW9uRXhjZXB0aW9uXzEuZGVmYXVsdCgnRXJyb3IgbG9jYXRvciBkZWdyZWUgZG9lcyBub3QgbWF0Y2ggbnVtYmVyIG9mIHJvb3RzJyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIFJlZWRTb2xvbW9uRGVjb2Rlci5wcm90b3R5cGUuZmluZEVycm9yTWFnbml0dWRlcyA9IGZ1bmN0aW9uIChlcnJvckV2YWx1YXRvciwgZXJyb3JMb2NhdGlvbnMpIHsKCSAgICAgICAgLy8gVGhpcyBpcyBkaXJlY3RseSBhcHBseWluZyBGb3JuZXkncyBGb3JtdWxhCgkgICAgICAgIHZhciBzID0gZXJyb3JMb2NhdGlvbnMubGVuZ3RoOwoJICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IEludDMyQXJyYXkocyk7CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgczsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgeGlJbnZlcnNlID0gZmllbGQuaW52ZXJzZShlcnJvckxvY2F0aW9uc1tpXSk7CgkgICAgICAgICAgICB2YXIgZGVub21pbmF0b3IgPSAxOwoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzOyBqKyspIHsKCSAgICAgICAgICAgICAgICBpZiAoaSAhPT0gaikgewoJICAgICAgICAgICAgICAgICAgICAvLyBkZW5vbWluYXRvciA9IGZpZWxkLm11bHRpcGx5KGRlbm9taW5hdG9yLAoJICAgICAgICAgICAgICAgICAgICAvLyAgICBHZW5lcmljR0YuYWRkT3JTdWJ0cmFjdCgxLCBmaWVsZC5tdWx0aXBseShlcnJvckxvY2F0aW9uc1tqXSwgeGlJbnZlcnNlKSkpCgkgICAgICAgICAgICAgICAgICAgIC8vIEFib3ZlIHNob3VsZCB3b3JrIGJ1dCBmYWlscyBvbiBzb21lIEFwcGxlIGFuZCBMaW51eCBKREtzIGR1ZSB0byBhIEhvdHNwb3QgYnVnLgoJICAgICAgICAgICAgICAgICAgICAvLyBCZWxvdyBpcyBhIGZ1bm55LWxvb2tpbmcgd29ya2Fyb3VuZCBmcm9tIFN0ZXZlbiBQYXJrZXMKCSAgICAgICAgICAgICAgICAgICAgdmFyIHRlcm0gPSBmaWVsZC5tdWx0aXBseShlcnJvckxvY2F0aW9uc1tqXSwgeGlJbnZlcnNlKTsKCSAgICAgICAgICAgICAgICAgICAgdmFyIHRlcm1QbHVzMSA9ICh0ZXJtICYgMHgxKSA9PT0gMCA/IHRlcm0gfCAxIDogdGVybSAmIH4xOwoJICAgICAgICAgICAgICAgICAgICBkZW5vbWluYXRvciA9IGZpZWxkLm11bHRpcGx5KGRlbm9taW5hdG9yLCB0ZXJtUGx1czEpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJlc3VsdFtpXSA9IGZpZWxkLm11bHRpcGx5KGVycm9yRXZhbHVhdG9yLmV2YWx1YXRlQXQoeGlJbnZlcnNlKSwgZmllbGQuaW52ZXJzZShkZW5vbWluYXRvcikpOwoJICAgICAgICAgICAgaWYgKGZpZWxkLmdldEdlbmVyYXRvckJhc2UoKSAhPT0gMCkgewoJICAgICAgICAgICAgICAgIHJlc3VsdFtpXSA9IGZpZWxkLm11bHRpcGx5KHJlc3VsdFtpXSwgeGlJbnZlcnNlKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gcmVzdWx0OwoJICAgIH07CgkgICAgcmV0dXJuIFJlZWRTb2xvbW9uRGVjb2RlcjsKCX0oKSk7CglSZWVkU29sb21vbkRlY29kZXIkMS5kZWZhdWx0ID0gUmVlZFNvbG9tb25EZWNvZGVyOwoKCXZhciBCaXRNYXRyaXhQYXJzZXIkMSA9IHt9OwoKCXZhciBWZXJzaW9uJDEgPSB7fTsKCgl2YXIgRm9ybWF0SW5mb3JtYXRpb24kMSA9IHt9OwoKCXZhciBFcnJvckNvcnJlY3Rpb25MZXZlbCA9IHt9OwoKCXZhciBBcmd1bWVudEV4Y2VwdGlvbiQxID0ge307CgoJdmFyIF9fZXh0ZW5kcyQzID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHsKCSAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKCSAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHwKCSAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9OwoJICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICB9OwoJICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KCSAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwoJICAgIH07Cgl9KSgpOwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEFyZ3VtZW50RXhjZXB0aW9uJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBFeGNlcHRpb25fMSA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBBcmd1bWVudEV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkMyhBcmd1bWVudEV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBBcmd1bWVudEV4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBBcmd1bWVudEV4Y2VwdGlvbi5raW5kID0gJ0FyZ3VtZW50RXhjZXB0aW9uJzsKCSAgICByZXR1cm4gQXJndW1lbnRFeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xLmRlZmF1bHQpKTsKCUFyZ3VtZW50RXhjZXB0aW9uJDEuZGVmYXVsdCA9IEFyZ3VtZW50RXhjZXB0aW9uOwoKCShmdW5jdGlvbiAoZXhwb3J0cykgewoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CglleHBvcnRzLkVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzID0gdm9pZCAwOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGVjb2RlciB7Ki8KCXZhciBBcmd1bWVudEV4Y2VwdGlvbl8xID0gQXJndW1lbnRFeGNlcHRpb24kMTsKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJdmFyIEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzOwoJKGZ1bmN0aW9uIChFcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlcykgewoJICAgIEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzW0Vycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzWyJMIl0gPSAwXSA9ICJMIjsKCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlc1tFcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlc1siTSJdID0gMV0gPSAiTSI7CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWxWYWx1ZXNbRXJyb3JDb3JyZWN0aW9uTGV2ZWxWYWx1ZXNbIlEiXSA9IDJdID0gIlEiOwoJICAgIEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzW0Vycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzWyJIIl0gPSAzXSA9ICJIIjsKCX0pKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzID0gZXhwb3J0cy5FcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlcyB8fCAoZXhwb3J0cy5FcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlcyA9IHt9KSk7CgkvKioKCSAqIDxwPlNlZSBJU08gMTgwMDQ6MjAwNiwgNi41LjEuIFRoaXMgZW51bSBlbmNhcHN1bGF0ZXMgdGhlIGZvdXIgZXJyb3IgY29ycmVjdGlvbiBsZXZlbHMKCSAqIGRlZmluZWQgYnkgdGhlIFFSIGNvZGUgc3RhbmRhcmQuPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBFcnJvckNvcnJlY3Rpb25MZXZlbCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBFcnJvckNvcnJlY3Rpb25MZXZlbCh2YWx1ZSwgc3RyaW5nVmFsdWUsIGJpdHMgLyppbnQqLykgewoJICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7CgkgICAgICAgIHRoaXMuc3RyaW5nVmFsdWUgPSBzdHJpbmdWYWx1ZTsKCSAgICAgICAgdGhpcy5iaXRzID0gYml0czsKCSAgICAgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX0JJVFMuc2V0KGJpdHMsIHRoaXMpOwoJICAgICAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5GT1JfVkFMVUUuc2V0KHZhbHVlLCB0aGlzKTsKCSAgICB9CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwucHJvdG90eXBlLmdldFZhbHVlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZTsKCSAgICB9OwoJICAgIEVycm9yQ29ycmVjdGlvbkxldmVsLnByb3RvdHlwZS5nZXRCaXRzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5iaXRzOwoJICAgIH07CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuZnJvbVN0cmluZyA9IGZ1bmN0aW9uIChzKSB7CgkgICAgICAgIHN3aXRjaCAocykgewoJICAgICAgICAgICAgY2FzZSAnTCc6IHJldHVybiBFcnJvckNvcnJlY3Rpb25MZXZlbC5MOwoJICAgICAgICAgICAgY2FzZSAnTSc6IHJldHVybiBFcnJvckNvcnJlY3Rpb25MZXZlbC5NOwoJICAgICAgICAgICAgY2FzZSAnUSc6IHJldHVybiBFcnJvckNvcnJlY3Rpb25MZXZlbC5ROwoJICAgICAgICAgICAgY2FzZSAnSCc6IHJldHVybiBFcnJvckNvcnJlY3Rpb25MZXZlbC5IOwoJICAgICAgICAgICAgZGVmYXVsdDogdGhyb3cgbmV3IEFyZ3VtZW50RXhjZXB0aW9uXzEuZGVmYXVsdChzICsgJ25vdCBhdmFpbGFibGUnKTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5zdHJpbmdWYWx1ZTsKCSAgICB9OwoJICAgIEVycm9yQ29ycmVjdGlvbkxldmVsLnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAobykgewoJICAgICAgICBpZiAoIShvIGluc3RhbmNlb2YgRXJyb3JDb3JyZWN0aW9uTGV2ZWwpKSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIG90aGVyID0gbzsKCSAgICAgICAgcmV0dXJuIHRoaXMudmFsdWUgPT09IG90aGVyLnZhbHVlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHBhcmFtIGJpdHMgaW50IGNvbnRhaW5pbmcgdGhlIHR3byBiaXRzIGVuY29kaW5nIGEgUVIgQ29kZSdzIGVycm9yIGNvcnJlY3Rpb24gbGV2ZWwKCSAgICAgKiBAcmV0dXJuIEVycm9yQ29ycmVjdGlvbkxldmVsIHJlcHJlc2VudGluZyB0aGUgZW5jb2RlZCBlcnJvciBjb3JyZWN0aW9uIGxldmVsCgkgICAgICovCgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuZm9yQml0cyA9IGZ1bmN0aW9uIChiaXRzIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKGJpdHMgPCAwIHx8IGJpdHMgPj0gRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX0JJVFMuc2l6ZSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX0JJVFMuZ2V0KGJpdHMpOwoJICAgIH07CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX0JJVFMgPSBuZXcgTWFwKCk7CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX1ZBTFVFID0gbmV3IE1hcCgpOwoJICAgIC8qKiBMID0gfjclIGNvcnJlY3Rpb24gKi8KCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5MID0gbmV3IEVycm9yQ29ycmVjdGlvbkxldmVsKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzLkwsICdMJywgMHgwMSk7CgkgICAgLyoqIE0gPSB+MTUlIGNvcnJlY3Rpb24gKi8KCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5NID0gbmV3IEVycm9yQ29ycmVjdGlvbkxldmVsKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzLk0sICdNJywgMHgwMCk7CgkgICAgLyoqIFEgPSB+MjUlIGNvcnJlY3Rpb24gKi8KCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5RID0gbmV3IEVycm9yQ29ycmVjdGlvbkxldmVsKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzLlEsICdRJywgMHgwMyk7CgkgICAgLyoqIEggPSB+MzAlIGNvcnJlY3Rpb24gKi8KCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5IID0gbmV3IEVycm9yQ29ycmVjdGlvbkxldmVsKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzLkgsICdIJywgMHgwMik7CgkgICAgcmV0dXJuIEVycm9yQ29ycmVjdGlvbkxldmVsOwoJfSgpKTsKCWV4cG9ydHMuZGVmYXVsdCA9IEVycm9yQ29ycmVjdGlvbkxldmVsOwoKCX0oRXJyb3JDb3JyZWN0aW9uTGV2ZWwpKTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzJDYgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX192YWx1ZXMpIHx8IGZ1bmN0aW9uKG8pIHsKCSAgICB2YXIgcyA9IHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgU3ltYm9sLml0ZXJhdG9yLCBtID0gcyAmJiBvW3NdLCBpID0gMDsKCSAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTsKCSAgICBpZiAobyAmJiB0eXBlb2Ygby5sZW5ndGggPT09ICJudW1iZXIiKSByZXR1cm4gewoJICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwOwoJICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9OwoJICAgICAgICB9CgkgICAgfTsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKHMgPyAiT2JqZWN0IGlzIG5vdCBpdGVyYWJsZS4iIDogIlN5bWJvbC5pdGVyYXRvciBpcyBub3QgZGVmaW5lZC4iKTsKCX07CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRm9ybWF0SW5mb3JtYXRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGVjb2RlciB7Ki8KCXZhciBFcnJvckNvcnJlY3Rpb25MZXZlbF8xID0gRXJyb3JDb3JyZWN0aW9uTGV2ZWw7Cgl2YXIgSW50ZWdlcl8xID0gSW50ZWdlciQxOwoJLyoqCgkgKiA8cD5FbmNhcHN1bGF0ZXMgYSBRUiBDb2RlJ3MgZm9ybWF0IGluZm9ybWF0aW9uLCBpbmNsdWRpbmcgdGhlIGRhdGEgbWFzayB1c2VkIGFuZAoJICogZXJyb3IgY29ycmVjdGlvbiBsZXZlbC48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqIEBzZWUgRGF0YU1hc2sKCSAqIEBzZWUgRXJyb3JDb3JyZWN0aW9uTGV2ZWwKCSAqLwoJdmFyIEZvcm1hdEluZm9ybWF0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEZvcm1hdEluZm9ybWF0aW9uKGZvcm1hdEluZm8gLyppbnQqLykgewoJICAgICAgICAvLyBCaXRzIDMsNAoJICAgICAgICB0aGlzLmVycm9yQ29ycmVjdGlvbkxldmVsID0gRXJyb3JDb3JyZWN0aW9uTGV2ZWxfMS5kZWZhdWx0LmZvckJpdHMoKGZvcm1hdEluZm8gPj4gMykgJiAweDAzKTsKCSAgICAgICAgLy8gQm90dG9tIDMgYml0cwoJICAgICAgICB0aGlzLmRhdGFNYXNrID0gLyooYnl0ZSkgKi8gKGZvcm1hdEluZm8gJiAweDA3KTsKCSAgICB9CgkgICAgRm9ybWF0SW5mb3JtYXRpb24ubnVtQml0c0RpZmZlcmluZyA9IGZ1bmN0aW9uIChhIC8qaW50Ki8sIGIgLyppbnQqLykgewoJICAgICAgICByZXR1cm4gSW50ZWdlcl8xLmRlZmF1bHQuYml0Q291bnQoYSBeIGIpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHBhcmFtIG1hc2tlZEZvcm1hdEluZm8xIGZvcm1hdCBpbmZvIGluZGljYXRvciwgd2l0aCBtYXNrIHN0aWxsIGFwcGxpZWQKCSAgICAgKiBAcGFyYW0gbWFza2VkRm9ybWF0SW5mbzIgc2Vjb25kIGNvcHkgb2Ygc2FtZSBpbmZvOyBib3RoIGFyZSBjaGVja2VkIGF0IHRoZSBzYW1lIHRpbWUKCSAgICAgKiAgdG8gZXN0YWJsaXNoIGJlc3QgbWF0Y2gKCSAgICAgKiBAcmV0dXJuIGluZm9ybWF0aW9uIGFib3V0IHRoZSBmb3JtYXQgaXQgc3BlY2lmaWVzLCBvciB7QGNvZGUgbnVsbH0KCSAgICAgKiAgaWYgZG9lc24ndCBzZWVtIHRvIG1hdGNoIGFueSBrbm93biBwYXR0ZXJuCgkgICAgICovCgkgICAgRm9ybWF0SW5mb3JtYXRpb24uZGVjb2RlRm9ybWF0SW5mb3JtYXRpb24gPSBmdW5jdGlvbiAobWFza2VkRm9ybWF0SW5mbzEgLyppbnQqLywgbWFza2VkRm9ybWF0SW5mbzIgLyppbnQqLykgewoJICAgICAgICB2YXIgZm9ybWF0SW5mbyA9IEZvcm1hdEluZm9ybWF0aW9uLmRvRGVjb2RlRm9ybWF0SW5mb3JtYXRpb24obWFza2VkRm9ybWF0SW5mbzEsIG1hc2tlZEZvcm1hdEluZm8yKTsKCSAgICAgICAgaWYgKGZvcm1hdEluZm8gIT09IG51bGwpIHsKCSAgICAgICAgICAgIHJldHVybiBmb3JtYXRJbmZvOwoJICAgICAgICB9CgkgICAgICAgIC8vIFNob3VsZCByZXR1cm4gbnVsbCwgYnV0LCBzb21lIFFSIGNvZGVzIGFwcGFyZW50bHkKCSAgICAgICAgLy8gZG8gbm90IG1hc2sgdGhpcyBpbmZvLiBUcnkgYWdhaW4gYnkgYWN0dWFsbHkgbWFza2luZyB0aGUgcGF0dGVybgoJICAgICAgICAvLyBmaXJzdAoJICAgICAgICByZXR1cm4gRm9ybWF0SW5mb3JtYXRpb24uZG9EZWNvZGVGb3JtYXRJbmZvcm1hdGlvbihtYXNrZWRGb3JtYXRJbmZvMSBeIEZvcm1hdEluZm9ybWF0aW9uLkZPUk1BVF9JTkZPX01BU0tfUVIsIG1hc2tlZEZvcm1hdEluZm8yIF4gRm9ybWF0SW5mb3JtYXRpb24uRk9STUFUX0lORk9fTUFTS19RUik7CgkgICAgfTsKCSAgICBGb3JtYXRJbmZvcm1hdGlvbi5kb0RlY29kZUZvcm1hdEluZm9ybWF0aW9uID0gZnVuY3Rpb24gKG1hc2tlZEZvcm1hdEluZm8xIC8qaW50Ki8sIG1hc2tlZEZvcm1hdEluZm8yIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGVfMSwgX2E7CgkgICAgICAgIC8vIEZpbmQgdGhlIGludCBpbiBGT1JNQVRfSU5GT19ERUNPREVfTE9PS1VQIHdpdGggZmV3ZXN0IGJpdHMgZGlmZmVyaW5nCgkgICAgICAgIHZhciBiZXN0RGlmZmVyZW5jZSA9IE51bWJlci5NQVhfU0FGRV9JTlRFR0VSOwoJICAgICAgICB2YXIgYmVzdEZvcm1hdEluZm8gPSAwOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgX2IgPSBfX3ZhbHVlcyQ2KEZvcm1hdEluZm9ybWF0aW9uLkZPUk1BVF9JTkZPX0RFQ09ERV9MT09LVVApLCBfYyA9IF9iLm5leHQoKTsgIV9jLmRvbmU7IF9jID0gX2IubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGRlY29kZUluZm8gPSBfYy52YWx1ZTsKCSAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0SW5mbyA9IGRlY29kZUluZm9bMF07CgkgICAgICAgICAgICAgICAgaWYgKHRhcmdldEluZm8gPT09IG1hc2tlZEZvcm1hdEluZm8xIHx8IHRhcmdldEluZm8gPT09IG1hc2tlZEZvcm1hdEluZm8yKSB7CgkgICAgICAgICAgICAgICAgICAgIC8vIEZvdW5kIGFuIGV4YWN0IG1hdGNoCgkgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRm9ybWF0SW5mb3JtYXRpb24oZGVjb2RlSW5mb1sxXSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIHZhciBiaXRzRGlmZmVyZW5jZSA9IEZvcm1hdEluZm9ybWF0aW9uLm51bUJpdHNEaWZmZXJpbmcobWFza2VkRm9ybWF0SW5mbzEsIHRhcmdldEluZm8pOwoJICAgICAgICAgICAgICAgIGlmIChiaXRzRGlmZmVyZW5jZSA8IGJlc3REaWZmZXJlbmNlKSB7CgkgICAgICAgICAgICAgICAgICAgIGJlc3RGb3JtYXRJbmZvID0gZGVjb2RlSW5mb1sxXTsKCSAgICAgICAgICAgICAgICAgICAgYmVzdERpZmZlcmVuY2UgPSBiaXRzRGlmZmVyZW5jZTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgaWYgKG1hc2tlZEZvcm1hdEluZm8xICE9PSBtYXNrZWRGb3JtYXRJbmZvMikgewoJICAgICAgICAgICAgICAgICAgICAvLyBhbHNvIHRyeSB0aGUgb3RoZXIgb3B0aW9uCgkgICAgICAgICAgICAgICAgICAgIGJpdHNEaWZmZXJlbmNlID0gRm9ybWF0SW5mb3JtYXRpb24ubnVtQml0c0RpZmZlcmluZyhtYXNrZWRGb3JtYXRJbmZvMiwgdGFyZ2V0SW5mbyk7CgkgICAgICAgICAgICAgICAgICAgIGlmIChiaXRzRGlmZmVyZW5jZSA8IGJlc3REaWZmZXJlbmNlKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBiZXN0Rm9ybWF0SW5mbyA9IGRlY29kZUluZm9bMV07CgkgICAgICAgICAgICAgICAgICAgICAgICBiZXN0RGlmZmVyZW5jZSA9IGJpdHNEaWZmZXJlbmNlOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlXzFfMSkgeyBlXzEgPSB7IGVycm9yOiBlXzFfMSB9OyB9CgkgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBpZiAoX2MgJiYgIV9jLmRvbmUgJiYgKF9hID0gX2IucmV0dXJuKSkgX2EuY2FsbChfYik7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gSGFtbWluZyBkaXN0YW5jZSBvZiB0aGUgMzIgbWFza2VkIGNvZGVzIGlzIDcsIGJ5IGNvbnN0cnVjdGlvbiwgc28gPD0gMyBiaXRzCgkgICAgICAgIC8vIGRpZmZlcmluZyBtZWFucyB3ZSBmb3VuZCBhIG1hdGNoCgkgICAgICAgIGlmIChiZXN0RGlmZmVyZW5jZSA8PSAzKSB7CgkgICAgICAgICAgICByZXR1cm4gbmV3IEZvcm1hdEluZm9ybWF0aW9uKGJlc3RGb3JtYXRJbmZvKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gbnVsbDsKCSAgICB9OwoJICAgIEZvcm1hdEluZm9ybWF0aW9uLnByb3RvdHlwZS5nZXRFcnJvckNvcnJlY3Rpb25MZXZlbCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuZXJyb3JDb3JyZWN0aW9uTGV2ZWw7CgkgICAgfTsKCSAgICBGb3JtYXRJbmZvcm1hdGlvbi5wcm90b3R5cGUuZ2V0RGF0YU1hc2sgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRhdGFNYXNrOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEZvcm1hdEluZm9ybWF0aW9uLnByb3RvdHlwZS5oYXNoQ29kZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuICh0aGlzLmVycm9yQ29ycmVjdGlvbkxldmVsLmdldEJpdHMoKSA8PCAzKSB8IHRoaXMuZGF0YU1hc2s7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgRm9ybWF0SW5mb3JtYXRpb24ucHJvdG90eXBlLmVxdWFscyA9IGZ1bmN0aW9uIChvKSB7CgkgICAgICAgIGlmICghKG8gaW5zdGFuY2VvZiBGb3JtYXRJbmZvcm1hdGlvbikpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgb3RoZXIgPSBvOwoJICAgICAgICByZXR1cm4gdGhpcy5lcnJvckNvcnJlY3Rpb25MZXZlbCA9PT0gb3RoZXIuZXJyb3JDb3JyZWN0aW9uTGV2ZWwgJiYKCSAgICAgICAgICAgIHRoaXMuZGF0YU1hc2sgPT09IG90aGVyLmRhdGFNYXNrOwoJICAgIH07CgkgICAgRm9ybWF0SW5mb3JtYXRpb24uRk9STUFUX0lORk9fTUFTS19RUiA9IDB4NTQxMjsKCSAgICAvKioKCSAgICAgKiBTZWUgSVNPIDE4MDA0OjIwMDYsIEFubmV4IEMsIFRhYmxlIEMuMQoJICAgICAqLwoJICAgIEZvcm1hdEluZm9ybWF0aW9uLkZPUk1BVF9JTkZPX0RFQ09ERV9MT09LVVAgPSBbCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg1NDEyLCAweDAwXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg1MTI1LCAweDAxXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg1RTdDLCAweDAyXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg1QjRCLCAweDAzXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg0NUY5LCAweDA0XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg0MENFLCAweDA1XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg0Rjk3LCAweDA2XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg0QUEwLCAweDA3XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg3N0M0LCAweDA4XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg3MkYzLCAweDA5XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg3REFBLCAweDBBXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg3ODlELCAweDBCXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg2NjJGLCAweDBDXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg2MzE4LCAweDBEXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg2QzQxLCAweDBFXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg2OTc2LCAweDBGXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgxNjg5LCAweDEwXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgxM0JFLCAweDExXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgxQ0U3LCAweDEyXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgxOUQwLCAweDEzXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgwNzYyLCAweDE0XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgwMjU1LCAweDE1XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgwRDBDLCAweDE2XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgwODNCLCAweDE3XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgzNTVGLCAweDE4XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgzMDY4LCAweDE5XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgzRjMxLCAweDFBXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgzQTA2LCAweDFCXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgyNEI0LCAweDFDXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgyMTgzLCAweDFEXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgyRURBLCAweDFFXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgyQkVELCAweDFGXSksCgkgICAgXTsKCSAgICByZXR1cm4gRm9ybWF0SW5mb3JtYXRpb247Cgl9KCkpOwoJRm9ybWF0SW5mb3JtYXRpb24kMS5kZWZhdWx0ID0gRm9ybWF0SW5mb3JtYXRpb247CgoJdmFyIEVDQmxvY2tzJDEgPSB7fTsKCgl2YXIgX192YWx1ZXMkNSA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX3ZhbHVlcykgfHwgZnVuY3Rpb24obykgewoJICAgIHZhciBzID0gdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBTeW1ib2wuaXRlcmF0b3IsIG0gPSBzICYmIG9bc10sIGkgPSAwOwoJICAgIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pOwoJICAgIGlmIChvICYmIHR5cGVvZiBvLmxlbmd0aCA9PT0gIm51bWJlciIpIHJldHVybiB7CgkgICAgICAgIG5leHQ6IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgICAgIGlmIChvICYmIGkgPj0gby5sZW5ndGgpIG8gPSB2b2lkIDA7CgkgICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogbyAmJiBvW2krK10sIGRvbmU6ICFvIH07CgkgICAgICAgIH0KCSAgICB9OwoJICAgIHRocm93IG5ldyBUeXBlRXJyb3IocyA/ICJPYmplY3QgaXMgbm90IGl0ZXJhYmxlLiIgOiAiU3ltYm9sLml0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLiIpOwoJfTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShFQ0Jsb2NrcyQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKioKCSAqIDxwPkVuY2Fwc3VsYXRlcyBhIHNldCBvZiBlcnJvci1jb3JyZWN0aW9uIGJsb2NrcyBpbiBvbmUgc3ltYm9sIHZlcnNpb24uIE1vc3QgdmVyc2lvbnMgd2lsbAoJICogdXNlIGJsb2NrcyBvZiBkaWZmZXJpbmcgc2l6ZXMgd2l0aGluIG9uZSB2ZXJzaW9uLCBzbywgdGhpcyBlbmNhcHN1bGF0ZXMgdGhlIHBhcmFtZXRlcnMgZm9yCgkgKiBlYWNoIHNldCBvZiBibG9ja3MuIEl0IGFsc28gaG9sZHMgdGhlIG51bWJlciBvZiBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3JkcyBwZXIgYmxvY2sgc2luY2UgaXQKCSAqIHdpbGwgYmUgdGhlIHNhbWUgYWNyb3NzIGFsbCBibG9ja3Mgd2l0aGluIG9uZSB2ZXJzaW9uLjwvcD4KCSAqLwoJdmFyIEVDQmxvY2tzID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEVDQmxvY2tzKGVjQ29kZXdvcmRzUGVyQmxvY2sgLyppbnQqLykgewoJICAgICAgICB2YXIgZWNCbG9ja3MgPSBbXTsKCSAgICAgICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHsKCSAgICAgICAgICAgIGVjQmxvY2tzW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMuZWNDb2Rld29yZHNQZXJCbG9jayA9IGVjQ29kZXdvcmRzUGVyQmxvY2s7CgkgICAgICAgIHRoaXMuZWNCbG9ja3MgPSBlY0Jsb2NrczsKCSAgICB9CgkgICAgRUNCbG9ja3MucHJvdG90eXBlLmdldEVDQ29kZXdvcmRzUGVyQmxvY2sgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmVjQ29kZXdvcmRzUGVyQmxvY2s7CgkgICAgfTsKCSAgICBFQ0Jsb2Nrcy5wcm90b3R5cGUuZ2V0TnVtQmxvY2tzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgZV8xLCBfYTsKCSAgICAgICAgdmFyIHRvdGFsID0gMDsKCSAgICAgICAgdmFyIGVjQmxvY2tzID0gdGhpcy5lY0Jsb2NrczsKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIGZvciAodmFyIGVjQmxvY2tzXzEgPSBfX3ZhbHVlcyQ1KGVjQmxvY2tzKSwgZWNCbG9ja3NfMV8xID0gZWNCbG9ja3NfMS5uZXh0KCk7ICFlY0Jsb2Nrc18xXzEuZG9uZTsgZWNCbG9ja3NfMV8xID0gZWNCbG9ja3NfMS5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgZWNCbG9jayA9IGVjQmxvY2tzXzFfMS52YWx1ZTsKCSAgICAgICAgICAgICAgICB0b3RhbCArPSBlY0Jsb2NrLmdldENvdW50KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGVfMV8xKSB7IGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07IH0KCSAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGlmIChlY0Jsb2Nrc18xXzEgJiYgIWVjQmxvY2tzXzFfMS5kb25lICYmIChfYSA9IGVjQmxvY2tzXzEucmV0dXJuKSkgX2EuY2FsbChlY0Jsb2Nrc18xKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8xKSB0aHJvdyBlXzEuZXJyb3I7IH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdG90YWw7CgkgICAgfTsKCSAgICBFQ0Jsb2Nrcy5wcm90b3R5cGUuZ2V0VG90YWxFQ0NvZGV3b3JkcyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuZWNDb2Rld29yZHNQZXJCbG9jayAqIHRoaXMuZ2V0TnVtQmxvY2tzKCk7CgkgICAgfTsKCSAgICBFQ0Jsb2Nrcy5wcm90b3R5cGUuZ2V0RUNCbG9ja3MgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmVjQmxvY2tzOwoJICAgIH07CgkgICAgcmV0dXJuIEVDQmxvY2tzOwoJfSgpKTsKCUVDQmxvY2tzJDEuZGVmYXVsdCA9IEVDQmxvY2tzOwoKCXZhciBFQ0IkMSA9IHt9OwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShFQ0IkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLyoqCgkgKiA8cD5FbmNhcHN1bGF0ZXMgdGhlIHBhcmFtZXRlcnMgZm9yIG9uZSBlcnJvci1jb3JyZWN0aW9uIGJsb2NrIGluIG9uZSBzeW1ib2wgdmVyc2lvbi4KCSAqIFRoaXMgaW5jbHVkZXMgdGhlIG51bWJlciBvZiBkYXRhIGNvZGV3b3JkcywgYW5kIHRoZSBudW1iZXIgb2YgdGltZXMgYSBibG9jayB3aXRoIHRoZXNlCgkgKiBwYXJhbWV0ZXJzIGlzIHVzZWQgY29uc2VjdXRpdmVseSBpbiB0aGUgUVIgY29kZSB2ZXJzaW9uJ3MgZm9ybWF0LjwvcD4KCSAqLwoJdmFyIEVDQiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBFQ0IoY291bnQgLyppbnQqLywgZGF0YUNvZGV3b3JkcyAvKmludCovKSB7CgkgICAgICAgIHRoaXMuY291bnQgPSBjb3VudDsKCSAgICAgICAgdGhpcy5kYXRhQ29kZXdvcmRzID0gZGF0YUNvZGV3b3JkczsKCSAgICB9CgkgICAgRUNCLnByb3RvdHlwZS5nZXRDb3VudCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuY291bnQ7CgkgICAgfTsKCSAgICBFQ0IucHJvdG90eXBlLmdldERhdGFDb2Rld29yZHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRhdGFDb2Rld29yZHM7CgkgICAgfTsKCSAgICByZXR1cm4gRUNCOwoJfSgpKTsKCUVDQiQxLmRlZmF1bHQgPSBFQ0I7CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCXZhciBfX3ZhbHVlcyQ0ID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fdmFsdWVzKSB8fCBmdW5jdGlvbihvKSB7CgkgICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7CgkgICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7CgkgICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSAibnVtYmVyIikgcmV0dXJuIHsKCSAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDsKCSAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gIk9iamVjdCBpcyBub3QgaXRlcmFibGUuIiA6ICJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuIik7Cgl9OwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFZlcnNpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGVjb2RlciB7Ki8KCXZhciBCaXRNYXRyaXhfMSQzID0gQml0TWF0cml4JDE7Cgl2YXIgRm9ybWF0SW5mb3JtYXRpb25fMSQxID0gRm9ybWF0SW5mb3JtYXRpb24kMTsKCXZhciBFQ0Jsb2Nrc18xID0gRUNCbG9ja3MkMTsKCXZhciBFQ0JfMSA9IEVDQiQxOwoJdmFyIEZvcm1hdEV4Y2VwdGlvbl8xJDIgPSBGb3JtYXRFeGNlcHRpb24kMTsKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQyID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDE7CgkvKioKCSAqIFNlZSBJU08gMTgwMDQ6MjAwNiBBbm5leCBECgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIFZlcnNpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gVmVyc2lvbih2ZXJzaW9uTnVtYmVyIC8qaW50Ki8sIGFsaWdubWVudFBhdHRlcm5DZW50ZXJzKSB7CgkgICAgICAgIHZhciBlXzEsIF9hOwoJICAgICAgICB2YXIgZWNCbG9ja3MgPSBbXTsKCSAgICAgICAgZm9yICh2YXIgX2kgPSAyOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHsKCSAgICAgICAgICAgIGVjQmxvY2tzW19pIC0gMl0gPSBhcmd1bWVudHNbX2ldOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMudmVyc2lvbk51bWJlciA9IHZlcnNpb25OdW1iZXI7CgkgICAgICAgIHRoaXMuYWxpZ25tZW50UGF0dGVybkNlbnRlcnMgPSBhbGlnbm1lbnRQYXR0ZXJuQ2VudGVyczsKCSAgICAgICAgdGhpcy5lY0Jsb2NrcyA9IGVjQmxvY2tzOwoJICAgICAgICB2YXIgdG90YWwgPSAwOwoJICAgICAgICB2YXIgZWNDb2Rld29yZHMgPSBlY0Jsb2Nrc1swXS5nZXRFQ0NvZGV3b3Jkc1BlckJsb2NrKCk7CgkgICAgICAgIHZhciBlY2JBcnJheSA9IGVjQmxvY2tzWzBdLmdldEVDQmxvY2tzKCk7CgkgICAgICAgIHRyeSB7CgkgICAgICAgICAgICBmb3IgKHZhciBlY2JBcnJheV8xID0gX192YWx1ZXMkNChlY2JBcnJheSksIGVjYkFycmF5XzFfMSA9IGVjYkFycmF5XzEubmV4dCgpOyAhZWNiQXJyYXlfMV8xLmRvbmU7IGVjYkFycmF5XzFfMSA9IGVjYkFycmF5XzEubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGVjQmxvY2sgPSBlY2JBcnJheV8xXzEudmFsdWU7CgkgICAgICAgICAgICAgICAgdG90YWwgKz0gZWNCbG9jay5nZXRDb3VudCgpICogKGVjQmxvY2suZ2V0RGF0YUNvZGV3b3JkcygpICsgZWNDb2Rld29yZHMpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlXzFfMSkgeyBlXzEgPSB7IGVycm9yOiBlXzFfMSB9OyB9CgkgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBpZiAoZWNiQXJyYXlfMV8xICYmICFlY2JBcnJheV8xXzEuZG9uZSAmJiAoX2EgPSBlY2JBcnJheV8xLnJldHVybikpIF9hLmNhbGwoZWNiQXJyYXlfMSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy50b3RhbENvZGV3b3JkcyA9IHRvdGFsOwoJICAgIH0KCSAgICBWZXJzaW9uLnByb3RvdHlwZS5nZXRWZXJzaW9uTnVtYmVyID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52ZXJzaW9uTnVtYmVyOwoJICAgIH07CgkgICAgVmVyc2lvbi5wcm90b3R5cGUuZ2V0QWxpZ25tZW50UGF0dGVybkNlbnRlcnMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmFsaWdubWVudFBhdHRlcm5DZW50ZXJzOwoJICAgIH07CgkgICAgVmVyc2lvbi5wcm90b3R5cGUuZ2V0VG90YWxDb2Rld29yZHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnRvdGFsQ29kZXdvcmRzOwoJICAgIH07CgkgICAgVmVyc2lvbi5wcm90b3R5cGUuZ2V0RGltZW5zaW9uRm9yVmVyc2lvbiA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIDE3ICsgNCAqIHRoaXMudmVyc2lvbk51bWJlcjsKCSAgICB9OwoJICAgIFZlcnNpb24ucHJvdG90eXBlLmdldEVDQmxvY2tzRm9yTGV2ZWwgPSBmdW5jdGlvbiAoZWNMZXZlbCkgewoJICAgICAgICByZXR1cm4gdGhpcy5lY0Jsb2Nrc1tlY0xldmVsLmdldFZhbHVlKCldOwoJICAgICAgICAvLyBUWVBFU0NSSVBUUE9SVDogb3JpZ2luYWwgd2FzIHVzaW5nIG9yZGluYWwsIGFuZCB1c2luZyB0aGUgb3JkZXIgb2YgbGV2ZWxzIGFzIGRlZmluZWQgaW4gRXJyb3JDb3JyZWN0aW9uTGV2ZWwgZW51bSAoTE1RSCkKCSAgICAgICAgLy8gSSB3aWxsIHVzZSB0aGUgZGlyZWN0IHZhbHVlIGZyb20gRXJyb3JDb3JyZWN0aW9uTGV2ZWxWYWx1ZXMgZW51bSB3aGljaCBpbiB0eXBlc2NyaXB0IGdvZXMgdG8gYSBudW1iZXIKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkRlZHVjZXMgdmVyc2lvbiBpbmZvcm1hdGlvbiBwdXJlbHkgZnJvbSBRUiBDb2RlIGRpbWVuc2lvbnMuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGRpbWVuc2lvbiBkaW1lbnNpb24gaW4gbW9kdWxlcwoJICAgICAqIEByZXR1cm4gVmVyc2lvbiBmb3IgYSBRUiBDb2RlIG9mIHRoYXQgZGltZW5zaW9uCgkgICAgICogQHRocm93cyBGb3JtYXRFeGNlcHRpb24gaWYgZGltZW5zaW9uIGlzIG5vdCAxIG1vZCA0CgkgICAgICovCgkgICAgVmVyc2lvbi5nZXRQcm92aXNpb25hbFZlcnNpb25Gb3JEaW1lbnNpb24gPSBmdW5jdGlvbiAoZGltZW5zaW9uIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKGRpbWVuc2lvbiAlIDQgIT09IDEpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMSQyLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0VmVyc2lvbkZvck51bWJlcigoZGltZW5zaW9uIC0gMTcpIC8gNCk7CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGlnbm9yZWQgLyo6IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEkMi5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIFZlcnNpb24uZ2V0VmVyc2lvbkZvck51bWJlciA9IGZ1bmN0aW9uICh2ZXJzaW9uTnVtYmVyIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKHZlcnNpb25OdW1iZXIgPCAxIHx8IHZlcnNpb25OdW1iZXIgPiA0MCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDIuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBWZXJzaW9uLlZFUlNJT05TW3ZlcnNpb25OdW1iZXIgLSAxXTsKCSAgICB9OwoJICAgIFZlcnNpb24uZGVjb2RlVmVyc2lvbkluZm9ybWF0aW9uID0gZnVuY3Rpb24gKHZlcnNpb25CaXRzIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGJlc3REaWZmZXJlbmNlID0gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVI7CgkgICAgICAgIHZhciBiZXN0VmVyc2lvbiA9IDA7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgVmVyc2lvbi5WRVJTSU9OX0RFQ09ERV9JTkZPLmxlbmd0aDsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgdGFyZ2V0VmVyc2lvbiA9IFZlcnNpb24uVkVSU0lPTl9ERUNPREVfSU5GT1tpXTsKCSAgICAgICAgICAgIC8vIERvIHRoZSB2ZXJzaW9uIGluZm8gYml0cyBtYXRjaCBleGFjdGx5PyBkb25lLgoJICAgICAgICAgICAgaWYgKHRhcmdldFZlcnNpb24gPT09IHZlcnNpb25CaXRzKSB7CgkgICAgICAgICAgICAgICAgcmV0dXJuIFZlcnNpb24uZ2V0VmVyc2lvbkZvck51bWJlcihpICsgNyk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICAvLyBPdGhlcndpc2Ugc2VlIGlmIHRoaXMgaXMgdGhlIGNsb3Nlc3QgdG8gYSByZWFsIHZlcnNpb24gaW5mbyBiaXQgc3RyaW5nCgkgICAgICAgICAgICAvLyB3ZSBoYXZlIHNlZW4gc28gZmFyCgkgICAgICAgICAgICB2YXIgYml0c0RpZmZlcmVuY2UgPSBGb3JtYXRJbmZvcm1hdGlvbl8xJDEuZGVmYXVsdC5udW1CaXRzRGlmZmVyaW5nKHZlcnNpb25CaXRzLCB0YXJnZXRWZXJzaW9uKTsKCSAgICAgICAgICAgIGlmIChiaXRzRGlmZmVyZW5jZSA8IGJlc3REaWZmZXJlbmNlKSB7CgkgICAgICAgICAgICAgICAgYmVzdFZlcnNpb24gPSBpICsgNzsKCSAgICAgICAgICAgICAgICBiZXN0RGlmZmVyZW5jZSA9IGJpdHNEaWZmZXJlbmNlOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIC8vIFdlIGNhbiB0b2xlcmF0ZSB1cCB0byAzIGJpdHMgb2YgZXJyb3Igc2luY2Ugbm8gdHdvIHZlcnNpb24gaW5mbyBjb2Rld29yZHMgd2lsbAoJICAgICAgICAvLyBkaWZmZXIgaW4gbGVzcyB0aGFuIDggYml0cy4KCSAgICAgICAgaWYgKGJlc3REaWZmZXJlbmNlIDw9IDMpIHsKCSAgICAgICAgICAgIHJldHVybiBWZXJzaW9uLmdldFZlcnNpb25Gb3JOdW1iZXIoYmVzdFZlcnNpb24pOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIHdlIGRpZG4ndCBmaW5kIGEgY2xvc2UgZW5vdWdoIG1hdGNoLCBmYWlsCgkgICAgICAgIHJldHVybiBudWxsOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogU2VlIElTTyAxODAwNDoyMDA2IEFubmV4IEUKCSAgICAgKi8KCSAgICBWZXJzaW9uLnByb3RvdHlwZS5idWlsZEZ1bmN0aW9uUGF0dGVybiA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IHRoaXMuZ2V0RGltZW5zaW9uRm9yVmVyc2lvbigpOwoJICAgICAgICB2YXIgYml0TWF0cml4ID0gbmV3IEJpdE1hdHJpeF8xJDMuZGVmYXVsdChkaW1lbnNpb24pOwoJICAgICAgICAvLyBUb3AgbGVmdCBmaW5kZXIgcGF0dGVybiArIHNlcGFyYXRvciArIGZvcm1hdAoJICAgICAgICBiaXRNYXRyaXguc2V0UmVnaW9uKDAsIDAsIDksIDkpOwoJICAgICAgICAvLyBUb3AgcmlnaHQgZmluZGVyIHBhdHRlcm4gKyBzZXBhcmF0b3IgKyBmb3JtYXQKCSAgICAgICAgYml0TWF0cml4LnNldFJlZ2lvbihkaW1lbnNpb24gLSA4LCAwLCA4LCA5KTsKCSAgICAgICAgLy8gQm90dG9tIGxlZnQgZmluZGVyIHBhdHRlcm4gKyBzZXBhcmF0b3IgKyBmb3JtYXQKCSAgICAgICAgYml0TWF0cml4LnNldFJlZ2lvbigwLCBkaW1lbnNpb24gLSA4LCA5LCA4KTsKCSAgICAgICAgLy8gQWxpZ25tZW50IHBhdHRlcm5zCgkgICAgICAgIHZhciBtYXggPSB0aGlzLmFsaWdubWVudFBhdHRlcm5DZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCBtYXg7IHgrKykgewoJICAgICAgICAgICAgdmFyIGkgPSB0aGlzLmFsaWdubWVudFBhdHRlcm5DZW50ZXJzW3hdIC0gMjsKCSAgICAgICAgICAgIGZvciAodmFyIHkgPSAwOyB5IDwgbWF4OyB5KyspIHsKCSAgICAgICAgICAgICAgICBpZiAoKHggPT09IDAgJiYgKHkgPT09IDAgfHwgeSA9PT0gbWF4IC0gMSkpIHx8ICh4ID09PSBtYXggLSAxICYmIHkgPT09IDApKSB7CgkgICAgICAgICAgICAgICAgICAgIC8vIE5vIGFsaWdubWVudCBwYXR0ZXJucyBuZWFyIHRoZSB0aHJlZSBmaW5kZXIgcGF0dGVybnMKCSAgICAgICAgICAgICAgICAgICAgY29udGludWU7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGJpdE1hdHJpeC5zZXRSZWdpb24odGhpcy5hbGlnbm1lbnRQYXR0ZXJuQ2VudGVyc1t5XSAtIDIsIGksIDUsIDUpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIC8vIFZlcnRpY2FsIHRpbWluZyBwYXR0ZXJuCgkgICAgICAgIGJpdE1hdHJpeC5zZXRSZWdpb24oNiwgOSwgMSwgZGltZW5zaW9uIC0gMTcpOwoJICAgICAgICAvLyBIb3Jpem9udGFsIHRpbWluZyBwYXR0ZXJuCgkgICAgICAgIGJpdE1hdHJpeC5zZXRSZWdpb24oOSwgNiwgZGltZW5zaW9uIC0gMTcsIDEpOwoJICAgICAgICBpZiAodGhpcy52ZXJzaW9uTnVtYmVyID4gNikgewoJICAgICAgICAgICAgLy8gVmVyc2lvbiBpbmZvLCB0b3AgcmlnaHQKCSAgICAgICAgICAgIGJpdE1hdHJpeC5zZXRSZWdpb24oZGltZW5zaW9uIC0gMTEsIDAsIDMsIDYpOwoJICAgICAgICAgICAgLy8gVmVyc2lvbiBpbmZvLCBib3R0b20gbGVmdAoJICAgICAgICAgICAgYml0TWF0cml4LnNldFJlZ2lvbigwLCBkaW1lbnNpb24gLSAxMSwgNiwgMyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGJpdE1hdHJpeDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBWZXJzaW9uLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuICcnICsgdGhpcy52ZXJzaW9uTnVtYmVyOwoJICAgIH07CgkgICAgLyoqCgkgICAgICAgKiBTZWUgSVNPIDE4MDA0OjIwMDYgQW5uZXggRC4KCSAgICAgICAqIEVsZW1lbnQgaSByZXByZXNlbnRzIHRoZSByYXcgdmVyc2lvbiBiaXRzIHRoYXQgc3BlY2lmeSB2ZXJzaW9uIGkgKyA3CgkgICAgICAgKi8KCSAgICBWZXJzaW9uLlZFUlNJT05fREVDT0RFX0lORk8gPSBJbnQzMkFycmF5LmZyb20oWwoJICAgICAgICAweDA3Qzk0LCAweDA4NUJDLCAweDA5QTk5LCAweDBBNEQzLCAweDBCQkY2LAoJICAgICAgICAweDBDNzYyLCAweDBEODQ3LCAweDBFNjBELCAweDBGOTI4LCAweDEwQjc4LAoJICAgICAgICAweDExNDVELCAweDEyQTE3LCAweDEzNTMyLCAweDE0OUE2LCAweDE1NjgzLAoJICAgICAgICAweDE2OEM5LCAweDE3N0VDLCAweDE4RUM0LCAweDE5MUUxLCAweDFBRkFCLAoJICAgICAgICAweDFCMDhFLCAweDFDQzFBLCAweDFEMzNGLCAweDFFRDc1LCAweDFGMjUwLAoJICAgICAgICAweDIwOUQ1LCAweDIxNkYwLCAweDIyOEJBLCAweDIzNzlGLCAweDI0QjBCLAoJICAgICAgICAweDI1NDJFLCAweDI2QTY0LCAweDI3NTQxLCAweDI4QzY5CgkgICAgXSk7CgkgICAgLyoqCgkgICAgICAgKiBTZWUgSVNPIDE4MDA0OjIwMDYgNi41LjEgVGFibGUgOQoJICAgICAgICovCgkgICAgVmVyc2lvbi5WRVJTSU9OUyA9IFsKCSAgICAgICAgbmV3IFZlcnNpb24oMSwgbmV3IEludDMyQXJyYXkoMCksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoNywgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxMCwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxMywgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxNywgbmV3IEVDQl8xLmRlZmF1bHQoMSwgOSkpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMiwgSW50MzJBcnJheS5mcm9tKFs2LCAxOF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDEwLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAzNCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE2LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAyOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIyLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAyMikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMywgSW50MzJBcnJheS5mcm9tKFs2LCAyMl0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE1LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA1NSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA0NCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE4LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxNykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIyLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxMykpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oNCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNl0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIwLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA4MCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE4LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAzMikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAyNCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE2LCBuZXcgRUNCXzEuZGVmYXVsdCg0LCA5KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbig1LCBJbnQzMkFycmF5LmZyb20oWzYsIDMwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDEsIDEwOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCA0MykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE4LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDE2KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjIsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDExKSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTIpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDYsIEludDMyQXJyYXkuZnJvbShbNiwgMzRdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxOCwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgNjgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxNiwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMjcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDcsIEludDMyQXJyYXkuZnJvbShbNiwgMjIsIDM4XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDc4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMTgsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDMxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMTgsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDE0KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNiwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTMpLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAxNCkpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oOCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNCwgNDJdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgOTcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyMiwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMzgpLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAzOSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIyLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxOCksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDE5KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDE0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDksIEludDMyQXJyYXkuZnJvbShbNiwgMjYsIDQ2XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDExNikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIyLCBuZXcgRUNCXzEuZGVmYXVsdCgzLCAzNiksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDM3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDE2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTIpLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxMykpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMTAsIEludDMyQXJyYXkuZnJvbShbNiwgMjgsIDUwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMTgsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDY4KSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgNjkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNiwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgNDMpLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA0NCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCg2LCAxOSksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDIwKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDYsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTYpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDExLCBJbnQzMkFycmF5LmZyb20oWzYsIDMwLCA1NF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIwLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCA4MSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA1MCksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDUxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoMywgMTIpLCBuZXcgRUNCXzEuZGVmYXVsdCg4LCAxMykpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMTIsIEludDMyQXJyYXkuZnJvbShbNiwgMzIsIDU4XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjQsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDkyKSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgOTMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyMiwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgMzYpLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAzNykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAyMCksIG5ldyBFQ0JfMS5kZWZhdWx0KDYsIDIxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDE0KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDEzLCBJbnQzMkFycmF5LmZyb20oWzYsIDM0LCA2Ml0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxMDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyMiwgbmV3IEVDQl8xLmRlZmF1bHQoOCwgMzcpLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAzOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCg4LCAyMCksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDIxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjIsIG5ldyBFQ0JfMS5kZWZhdWx0KDEyLCAxMSksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDEyKSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigxNCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNDYsIDY2XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDMsIDExNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEsIDExNikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCg0LCA0MCksIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDQxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjAsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAxNiksIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDE3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjQsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAxMiksIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDEzKSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigxNSwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNDgsIDcwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjIsIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDg3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgODgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoNSwgNDEpLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCA0MikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjQsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAxMiksIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDEzKSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigxNiwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNTAsIDc0XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjQsIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDk4KSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgOTkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoNywgNDUpLCBuZXcgRUNCXzEuZGVmYXVsdCgzLCA0NikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMTkpLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAyMCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgzLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEzLCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMTcsIEludDMyQXJyYXkuZnJvbShbNiwgMzAsIDU0LCA3OF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAxMDcpLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCAxMDgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTAsIDQ2KSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMjIpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTQpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNywgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDE4LCBJbnQzMkFycmF5LmZyb20oWzYsIDMwLCA1NiwgODJdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNSwgMTIwKSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTIxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDksIDQzKSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgNDQpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTcsIDIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTQpLCBuZXcgRUNCXzEuZGVmYXVsdCgxOSwgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDE5LCBJbnQzMkFycmF5LmZyb20oWzYsIDMwLCA1OCwgODZdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMywgMTEzKSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTE0KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDMsIDQ0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTEsIDQ1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDE3LCAyMSksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDIyKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDksIDEzKSwgbmV3IEVDQl8xLmRlZmF1bHQoMTYsIDE0KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyMCwgSW50MzJBcnJheS5mcm9tKFs2LCAzNCwgNjIsIDkwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDMsIDEwNyksIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDEwOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCgzLCA0MSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEzLCA0MikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCgxMCwgMTYpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDIxLCBJbnQzMkFycmF5LmZyb20oWzYsIDI4LCA1MCwgNzIsIDk0XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDExNiksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDExNykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCgxNywgNDIpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTcsIDIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTksIDE2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgMTcpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDIyLCBJbnQzMkFycmF5LmZyb20oWzYsIDI2LCA1MCwgNzQsIDk4XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDExMSksIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDExMikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxNywgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNywgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNiwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoMzQsIDEzKSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyMywgSW50MzJBcnJheS5mcm9tKFs2LCAzMCwgNTQsIDc4LCAxMDJdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTIxKSwgbmV3IEVDQl8xLmRlZmF1bHQoNSwgMTIyKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDQ3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTQsIDQ4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDE0LCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxNiwgMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgMTYpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDI0LCBJbnQzMkFycmF5LmZyb20oWzYsIDI4LCA1NCwgODAsIDEwNl0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg2LCAxMTcpLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxMTgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgNDUpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTEsIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTYsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDMwLCAxNiksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDE3KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyNSwgSW50MzJBcnJheS5mcm9tKFs2LCAzMiwgNTgsIDg0LCAxMTBdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNiwgbmV3IEVDQl8xLmRlZmF1bHQoOCwgMTA2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTA3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDgsIDQ3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTMsIDQ4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjIsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIyLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEzLCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMjYsIEludDMyQXJyYXkuZnJvbShbNiwgMzAsIDU4LCA4NiwgMTE0XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDEwLCAxMTQpLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxMTUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTksIDQ2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMjgsIDIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMzMsIDE2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTcpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDI3LCBJbnQzMkFycmF5LmZyb20oWzYsIDM0LCA2MiwgOTAsIDExOF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg4LCAxMjIpLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMjIsIDQ1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMywgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoOCwgMjMpLCBuZXcgRUNCXzEuZGVmYXVsdCgyNiwgMjQpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTIsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjgsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyOCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNTAsIDc0LCA5OCwgMTIyXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDMsIDExNyksIG5ldyBFQ0JfMS5kZWZhdWx0KDEwLCAxMTgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMywgNDUpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMywgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgzMSwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTEsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzEsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyOSwgSW50MzJBcnJheS5mcm9tKFs2LCAzMCwgNTQsIDc4LCAxMDIsIDEyNl0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg3LCAxMTYpLCBuZXcgRUNCXzEuZGVmYXVsdCg3LCAxMTcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMjEsIDQ1KSwgbmV3IEVDQl8xLmRlZmF1bHQoNywgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMjMpLCBuZXcgRUNCXzEuZGVmYXVsdCgzNywgMjQpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTksIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjYsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigzMCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNTIsIDc4LCAxMDQsIDEzMF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCAxMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCgxMCwgMTE2KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDE5LCA0NyksIG5ldyBFQ0JfMS5kZWZhdWx0KDEwLCA0OCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgyNSwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMjMsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjUsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigzMSwgSW50MzJBcnJheS5mcm9tKFs2LCAzMCwgNTYsIDgyLCAxMDgsIDEzNF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxMywgMTE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMywgMTE2KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDQ2KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjksIDQ3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQyLCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDEsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIzLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDI4LCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzIsIEludDMyQXJyYXkuZnJvbShbNiwgMzQsIDYwLCA4NiwgMTEyLCAxMzhdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTcsIDExNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxMCwgNDYpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMywgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTAsIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzUsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDE5LCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDM1LCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzMsIEludDMyQXJyYXkuZnJvbShbNiwgMzAsIDU4LCA4NiwgMTE0LCAxNDJdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTcsIDExNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEsIDExNikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgNDYpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMSwgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMjksIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTksIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDQ2LCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzQsIEludDMyQXJyYXkuZnJvbShbNiwgMzQsIDYyLCA5MCwgMTE4LCAxNDZdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTMsIDExNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDYsIDExNikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgNDYpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMywgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNDQsIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoNywgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNTksIDE2KSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTcpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDM1LCBJbnQzMkFycmF5LmZyb20oWzYsIDMwLCA1NCwgNzgsIDEwMiwgMTI2LCAxNTBdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTIsIDEyMSksIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDEyMikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxMiwgNDcpLCBuZXcgRUNCXzEuZGVmYXVsdCgyNiwgNDgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMzksIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTQsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIyLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDQxLCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzYsIEludDMyQXJyYXkuZnJvbShbNiwgMjQsIDUwLCA3NiwgMTAyLCAxMjgsIDE1NF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg2LCAxMjEpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgMTIyKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDYsIDQ3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzQsIDQ4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQ2LCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDEwLCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDY0LCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzcsIEludDMyQXJyYXkuZnJvbShbNiwgMjgsIDU0LCA4MCwgMTA2LCAxMzIsIDE1OF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxNywgMTIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTIzKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDI5LCA0NiksIG5ldyBFQ0JfMS5kZWZhdWx0KDE0LCA0NykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg0OSwgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgxMCwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMjQsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoNDYsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigzOCwgSW50MzJBcnJheS5mcm9tKFs2LCAzMiwgNTgsIDg0LCAxMTAsIDEzNiwgMTYyXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDEyMiksIG5ldyBFQ0JfMS5kZWZhdWx0KDE4LCAxMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTMsIDQ2KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzIsIDQ3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQ4LCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDE0LCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg0MiwgMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCgzMiwgMTYpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDM5LCBJbnQzMkFycmF5LmZyb20oWzYsIDI2LCA1NCwgODIsIDExMCwgMTM4LCAxNjZdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMjAsIDExNyksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDExOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCg0MCwgNDcpLCBuZXcgRUNCXzEuZGVmYXVsdCg3LCA0OCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg0MywgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMiwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTAsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoNjcsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbig0MCwgSW50MzJBcnJheS5mcm9tKFs2LCAzMCwgNTgsIDg2LCAxMTQsIDE0MiwgMTcwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDE5LCAxMTgpLCBuZXcgRUNCXzEuZGVmYXVsdCg2LCAxMTkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTgsIDQ3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzEsIDQ4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDM0LCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDM0LCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgyMCwgMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCg2MSwgMTYpKSkKCSAgICBdOwoJICAgIHJldHVybiBWZXJzaW9uOwoJfSgpKTsKCVZlcnNpb24kMS5kZWZhdWx0ID0gVmVyc2lvbjsKCgl2YXIgRGF0YU1hc2sgPSB7fTsKCgkoZnVuY3Rpb24gKGV4cG9ydHMpIHsKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJZXhwb3J0cy5EYXRhTWFza1ZhbHVlcyA9IHZvaWQgMDsKCXZhciBEYXRhTWFza1ZhbHVlczsKCShmdW5jdGlvbiAoRGF0YU1hc2tWYWx1ZXMpIHsKCSAgICBEYXRhTWFza1ZhbHVlc1tEYXRhTWFza1ZhbHVlc1siREFUQV9NQVNLXzAwMCJdID0gMF0gPSAiREFUQV9NQVNLXzAwMCI7CgkgICAgRGF0YU1hc2tWYWx1ZXNbRGF0YU1hc2tWYWx1ZXNbIkRBVEFfTUFTS18wMDEiXSA9IDFdID0gIkRBVEFfTUFTS18wMDEiOwoJICAgIERhdGFNYXNrVmFsdWVzW0RhdGFNYXNrVmFsdWVzWyJEQVRBX01BU0tfMDEwIl0gPSAyXSA9ICJEQVRBX01BU0tfMDEwIjsKCSAgICBEYXRhTWFza1ZhbHVlc1tEYXRhTWFza1ZhbHVlc1siREFUQV9NQVNLXzAxMSJdID0gM10gPSAiREFUQV9NQVNLXzAxMSI7CgkgICAgRGF0YU1hc2tWYWx1ZXNbRGF0YU1hc2tWYWx1ZXNbIkRBVEFfTUFTS18xMDAiXSA9IDRdID0gIkRBVEFfTUFTS18xMDAiOwoJICAgIERhdGFNYXNrVmFsdWVzW0RhdGFNYXNrVmFsdWVzWyJEQVRBX01BU0tfMTAxIl0gPSA1XSA9ICJEQVRBX01BU0tfMTAxIjsKCSAgICBEYXRhTWFza1ZhbHVlc1tEYXRhTWFza1ZhbHVlc1siREFUQV9NQVNLXzExMCJdID0gNl0gPSAiREFUQV9NQVNLXzExMCI7CgkgICAgRGF0YU1hc2tWYWx1ZXNbRGF0YU1hc2tWYWx1ZXNbIkRBVEFfTUFTS18xMTEiXSA9IDddID0gIkRBVEFfTUFTS18xMTEiOwoJfSkoRGF0YU1hc2tWYWx1ZXMgPSBleHBvcnRzLkRhdGFNYXNrVmFsdWVzIHx8IChleHBvcnRzLkRhdGFNYXNrVmFsdWVzID0ge30pKTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIGRhdGEgbWFza3MgZm9yIHRoZSBkYXRhIGJpdHMgaW4gYSBRUiBjb2RlLCBwZXIgSVNPIDE4MDA0OjIwMDYgNi44LiBJbXBsZW1lbnRhdGlvbnMKCSAqIG9mIHRoaXMgY2xhc3MgY2FuIHVuLW1hc2sgYSByYXcgQml0TWF0cml4LiBGb3Igc2ltcGxpY2l0eSwgdGhleSB3aWxsIHVubWFzayB0aGUgZW50aXJlIEJpdE1hdHJpeCwKCSAqIGluY2x1ZGluZyBhcmVhcyB1c2VkIGZvciBmaW5kZXIgcGF0dGVybnMsIHRpbWluZyBwYXR0ZXJucywgZXRjLiBUaGVzZSBhcmVhcyBzaG91bGQgYmUgdW51c2VkCgkgKiBhZnRlciB0aGUgcG9pbnQgdGhleSBhcmUgdW5tYXNrZWQgYW55d2F5LjwvcD4KCSAqCgkgKiA8cD5Ob3RlIHRoYXQgdGhlIGRpYWdyYW0gaW4gc2VjdGlvbiA2LjguMSBpcyBtaXNsZWFkaW5nIHNpbmNlIGl0IGluZGljYXRlcyB0aGF0IGkgaXMgY29sdW1uIHBvc2l0aW9uCgkgKiBhbmQgaiBpcyByb3cgcG9zaXRpb24uIEluIGZhY3QsIGFzIHRoZSB0ZXh0IHNheXMsIGkgaXMgcm93IHBvc2l0aW9uIGFuZCBqIGlzIGNvbHVtbiBwb3NpdGlvbi48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIERhdGFNYXNrID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIC8vIFNlZSBJU08gMTgwMDQ6MjAwNiA2LjguMQoJICAgIGZ1bmN0aW9uIERhdGFNYXNrKHZhbHVlLCBpc01hc2tlZCkgewoJICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7CgkgICAgICAgIHRoaXMuaXNNYXNrZWQgPSBpc01hc2tlZDsKCSAgICB9CgkgICAgLy8gRW5kIG9mIGVudW0gY29uc3RhbnRzLgoJICAgIC8qKgoJICAgICAqIDxwPkltcGxlbWVudGF0aW9ucyBvZiB0aGlzIG1ldGhvZCByZXZlcnNlIHRoZSBkYXRhIG1hc2tpbmcgcHJvY2VzcyBhcHBsaWVkIHRvIGEgUVIgQ29kZSBhbmQKCSAgICAgKiBtYWtlIGl0cyBiaXRzIHJlYWR5IHRvIHJlYWQuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGJpdHMgcmVwcmVzZW50YXRpb24gb2YgUVIgQ29kZSBiaXRzCgkgICAgICogQHBhcmFtIGRpbWVuc2lvbiBkaW1lbnNpb24gb2YgUVIgQ29kZSwgcmVwcmVzZW50ZWQgYnkgYml0cywgYmVpbmcgdW5tYXNrZWQKCSAgICAgKi8KCSAgICBEYXRhTWFzay5wcm90b3R5cGUudW5tYXNrQml0TWF0cml4ID0gZnVuY3Rpb24gKGJpdHMsIGRpbWVuc2lvbiAvKmludCovKSB7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGltZW5zaW9uOyBpKyspIHsKCSAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgZGltZW5zaW9uOyBqKyspIHsKCSAgICAgICAgICAgICAgICBpZiAodGhpcy5pc01hc2tlZChpLCBqKSkgewoJICAgICAgICAgICAgICAgICAgICBiaXRzLmZsaXAoaiwgaSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICBEYXRhTWFzay52YWx1ZXMgPSBuZXcgTWFwKFsKCSAgICAgICAgLyoqCgkgICAgICAgICAqIDAwMDogbWFzayBiaXRzIGZvciB3aGljaCAoeCArIHkpIG1vZCAyID09IDAKCSAgICAgICAgICovCgkgICAgICAgIFtEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMDAwLCBuZXcgRGF0YU1hc2soRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzAwMCwgZnVuY3Rpb24gKGkgLyppbnQqLywgaiAvKmludCovKSB7IHJldHVybiAoKGkgKyBqKSAmIDB4MDEpID09PSAwOyB9KV0sCgkgICAgICAgIC8qKgoJICAgICAgICAgKiAwMDE6IG1hc2sgYml0cyBmb3Igd2hpY2ggeCBtb2QgMiA9PSAwCgkgICAgICAgICAqLwoJICAgICAgICBbRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzAwMSwgbmV3IERhdGFNYXNrKERhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18wMDEsIGZ1bmN0aW9uIChpIC8qaW50Ki8sIGogLyppbnQqLykgeyByZXR1cm4gKGkgJiAweDAxKSA9PT0gMDsgfSldLAoJICAgICAgICAvKioKCSAgICAgICAgICogMDEwOiBtYXNrIGJpdHMgZm9yIHdoaWNoIHkgbW9kIDMgPT0gMAoJICAgICAgICAgKi8KCSAgICAgICAgW0RhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18wMTAsIG5ldyBEYXRhTWFzayhEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMDEwLCBmdW5jdGlvbiAoaSAvKmludCovLCBqIC8qaW50Ki8pIHsgcmV0dXJuIGogJSAzID09PSAwOyB9KV0sCgkgICAgICAgIC8qKgoJICAgICAgICAgKiAwMTE6IG1hc2sgYml0cyBmb3Igd2hpY2ggKHggKyB5KSBtb2QgMyA9PSAwCgkgICAgICAgICAqLwoJICAgICAgICBbRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzAxMSwgbmV3IERhdGFNYXNrKERhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18wMTEsIGZ1bmN0aW9uIChpIC8qaW50Ki8sIGogLyppbnQqLykgeyByZXR1cm4gKGkgKyBqKSAlIDMgPT09IDA7IH0pXSwKCSAgICAgICAgLyoqCgkgICAgICAgICAqIDEwMDogbWFzayBiaXRzIGZvciB3aGljaCAoeC8yICsgeS8zKSBtb2QgMiA9PSAwCgkgICAgICAgICAqLwoJICAgICAgICBbRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzEwMCwgbmV3IERhdGFNYXNrKERhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18xMDAsIGZ1bmN0aW9uIChpIC8qaW50Ki8sIGogLyppbnQqLykgeyByZXR1cm4gKChNYXRoLmZsb29yKGkgLyAyKSArIE1hdGguZmxvb3IoaiAvIDMpKSAmIDB4MDEpID09PSAwOyB9KV0sCgkgICAgICAgIC8qKgoJICAgICAgICAgKiAxMDE6IG1hc2sgYml0cyBmb3Igd2hpY2ggeHkgbW9kIDIgKyB4eSBtb2QgMyA9PSAwCgkgICAgICAgICAqIGVxdWl2YWxlbnRseSwgc3VjaCB0aGF0IHh5IG1vZCA2ID09IDAKCSAgICAgICAgICovCgkgICAgICAgIFtEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMTAxLCBuZXcgRGF0YU1hc2soRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzEwMSwgZnVuY3Rpb24gKGkgLyppbnQqLywgaiAvKmludCovKSB7IHJldHVybiAoaSAqIGopICUgNiA9PT0gMDsgfSldLAoJICAgICAgICAvKioKCSAgICAgICAgICogMTEwOiBtYXNrIGJpdHMgZm9yIHdoaWNoICh4eSBtb2QgMiArIHh5IG1vZCAzKSBtb2QgMiA9PSAwCgkgICAgICAgICAqIGVxdWl2YWxlbnRseSwgc3VjaCB0aGF0IHh5IG1vZCA2IDwgMwoJICAgICAgICAgKi8KCSAgICAgICAgW0RhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18xMTAsIG5ldyBEYXRhTWFzayhEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMTEwLCBmdW5jdGlvbiAoaSAvKmludCovLCBqIC8qaW50Ki8pIHsgcmV0dXJuICgoaSAqIGopICUgNikgPCAzOyB9KV0sCgkgICAgICAgIC8qKgoJICAgICAgICAgKiAxMTE6IG1hc2sgYml0cyBmb3Igd2hpY2ggKCh4K3kpbW9kIDIgKyB4eSBtb2QgMykgbW9kIDIgPT0gMAoJICAgICAgICAgKiBlcXVpdmFsZW50bHksIHN1Y2ggdGhhdCAoeCArIHkgKyB4eSBtb2QgMykgbW9kIDIgPT0gMAoJICAgICAgICAgKi8KCSAgICAgICAgW0RhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18xMTEsIG5ldyBEYXRhTWFzayhEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMTExLCBmdW5jdGlvbiAoaSAvKmludCovLCBqIC8qaW50Ki8pIHsgcmV0dXJuICgoaSArIGogKyAoKGkgKiBqKSAlIDMpKSAmIDB4MDEpID09PSAwOyB9KV0sCgkgICAgXSk7CgkgICAgcmV0dXJuIERhdGFNYXNrOwoJfSgpKTsKCWV4cG9ydHMuZGVmYXVsdCA9IERhdGFNYXNrOwoKCX0oRGF0YU1hc2spKTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEJpdE1hdHJpeFBhcnNlciQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgVmVyc2lvbl8xJDEgPSBWZXJzaW9uJDE7Cgl2YXIgRm9ybWF0SW5mb3JtYXRpb25fMSA9IEZvcm1hdEluZm9ybWF0aW9uJDE7Cgl2YXIgRGF0YU1hc2tfMSA9IERhdGFNYXNrOwoJdmFyIEZvcm1hdEV4Y2VwdGlvbl8xJDEgPSBGb3JtYXRFeGNlcHRpb24kMTsKCS8qKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEJpdE1hdHJpeFBhcnNlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gYml0TWF0cml4IHtAbGluayBCaXRNYXRyaXh9IHRvIHBhcnNlCgkgICAgICogQHRocm93cyBGb3JtYXRFeGNlcHRpb24gaWYgZGltZW5zaW9uIGlzIG5vdCA+PSAyMSBhbmQgMSBtb2QgNAoJICAgICAqLwoJICAgIGZ1bmN0aW9uIEJpdE1hdHJpeFBhcnNlcihiaXRNYXRyaXgpIHsKCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IGJpdE1hdHJpeC5nZXRIZWlnaHQoKTsKCSAgICAgICAgaWYgKGRpbWVuc2lvbiA8IDIxIHx8IChkaW1lbnNpb24gJiAweDAzKSAhPT0gMSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMuYml0TWF0cml4ID0gYml0TWF0cml4OwoJICAgIH0KCSAgICAvKioKCSAgICAgKiA8cD5SZWFkcyBmb3JtYXQgaW5mb3JtYXRpb24gZnJvbSBvbmUgb2YgaXRzIHR3byBsb2NhdGlvbnMgd2l0aGluIHRoZSBRUiBDb2RlLjwvcD4KCSAgICAgKgoJICAgICAqIEByZXR1cm4ge0BsaW5rIEZvcm1hdEluZm9ybWF0aW9ufSBlbmNhcHN1bGF0aW5nIHRoZSBRUiBDb2RlJ3MgZm9ybWF0IGluZm8KCSAgICAgKiBAdGhyb3dzIEZvcm1hdEV4Y2VwdGlvbiBpZiBib3RoIGZvcm1hdCBpbmZvcm1hdGlvbiBsb2NhdGlvbnMgY2Fubm90IGJlIHBhcnNlZCBhcwoJICAgICAqIHRoZSB2YWxpZCBlbmNvZGluZyBvZiBmb3JtYXQgaW5mb3JtYXRpb24KCSAgICAgKi8KCSAgICBCaXRNYXRyaXhQYXJzZXIucHJvdG90eXBlLnJlYWRGb3JtYXRJbmZvcm1hdGlvbiA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgaWYgKHRoaXMucGFyc2VkRm9ybWF0SW5mbyAhPT0gbnVsbCAmJiB0aGlzLnBhcnNlZEZvcm1hdEluZm8gIT09IHVuZGVmaW5lZCkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMucGFyc2VkRm9ybWF0SW5mbzsKCSAgICAgICAgfQoJICAgICAgICAvLyBSZWFkIHRvcC1sZWZ0IGZvcm1hdCBpbmZvIGJpdHMKCSAgICAgICAgdmFyIGZvcm1hdEluZm9CaXRzMSA9IDA7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgNjsgaSsrKSB7CgkgICAgICAgICAgICBmb3JtYXRJbmZvQml0czEgPSB0aGlzLmNvcHlCaXQoaSwgOCwgZm9ybWF0SW5mb0JpdHMxKTsKCSAgICAgICAgfQoJICAgICAgICAvLyAuLiBhbmQgc2tpcCBhIGJpdCBpbiB0aGUgdGltaW5nIHBhdHRlcm4gLi4uCgkgICAgICAgIGZvcm1hdEluZm9CaXRzMSA9IHRoaXMuY29weUJpdCg3LCA4LCBmb3JtYXRJbmZvQml0czEpOwoJICAgICAgICBmb3JtYXRJbmZvQml0czEgPSB0aGlzLmNvcHlCaXQoOCwgOCwgZm9ybWF0SW5mb0JpdHMxKTsKCSAgICAgICAgZm9ybWF0SW5mb0JpdHMxID0gdGhpcy5jb3B5Qml0KDgsIDcsIGZvcm1hdEluZm9CaXRzMSk7CgkgICAgICAgIC8vIC4uIGFuZCBza2lwIGEgYml0IGluIHRoZSB0aW1pbmcgcGF0dGVybiAuLi4KCSAgICAgICAgZm9yICh2YXIgaiA9IDU7IGogPj0gMDsgai0tKSB7CgkgICAgICAgICAgICBmb3JtYXRJbmZvQml0czEgPSB0aGlzLmNvcHlCaXQoOCwgaiwgZm9ybWF0SW5mb0JpdHMxKTsKCSAgICAgICAgfQoJICAgICAgICAvLyBSZWFkIHRoZSB0b3AtcmlnaHQvYm90dG9tLWxlZnQgcGF0dGVybiB0b28KCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IHRoaXMuYml0TWF0cml4LmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgZm9ybWF0SW5mb0JpdHMyID0gMDsKCSAgICAgICAgdmFyIGpNaW4gPSBkaW1lbnNpb24gLSA3OwoJICAgICAgICBmb3IgKHZhciBqID0gZGltZW5zaW9uIC0gMTsgaiA+PSBqTWluOyBqLS0pIHsKCSAgICAgICAgICAgIGZvcm1hdEluZm9CaXRzMiA9IHRoaXMuY29weUJpdCg4LCBqLCBmb3JtYXRJbmZvQml0czIpOwoJICAgICAgICB9CgkgICAgICAgIGZvciAodmFyIGkgPSBkaW1lbnNpb24gLSA4OyBpIDwgZGltZW5zaW9uOyBpKyspIHsKCSAgICAgICAgICAgIGZvcm1hdEluZm9CaXRzMiA9IHRoaXMuY29weUJpdChpLCA4LCBmb3JtYXRJbmZvQml0czIpOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMucGFyc2VkRm9ybWF0SW5mbyA9IEZvcm1hdEluZm9ybWF0aW9uXzEuZGVmYXVsdC5kZWNvZGVGb3JtYXRJbmZvcm1hdGlvbihmb3JtYXRJbmZvQml0czEsIGZvcm1hdEluZm9CaXRzMik7CgkgICAgICAgIGlmICh0aGlzLnBhcnNlZEZvcm1hdEluZm8gIT09IG51bGwpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLnBhcnNlZEZvcm1hdEluZm87CgkgICAgICAgIH0KCSAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogPHA+UmVhZHMgdmVyc2lvbiBpbmZvcm1hdGlvbiBmcm9tIG9uZSBvZiBpdHMgdHdvIGxvY2F0aW9ucyB3aXRoaW4gdGhlIFFSIENvZGUuPC9wPgoJICAgICAqCgkgICAgICogQHJldHVybiB7QGxpbmsgVmVyc2lvbn0gZW5jYXBzdWxhdGluZyB0aGUgUVIgQ29kZSdzIHZlcnNpb24KCSAgICAgKiBAdGhyb3dzIEZvcm1hdEV4Y2VwdGlvbiBpZiBib3RoIHZlcnNpb24gaW5mb3JtYXRpb24gbG9jYXRpb25zIGNhbm5vdCBiZSBwYXJzZWQgYXMKCSAgICAgKiB0aGUgdmFsaWQgZW5jb2Rpbmcgb2YgdmVyc2lvbiBpbmZvcm1hdGlvbgoJICAgICAqLwoJICAgIEJpdE1hdHJpeFBhcnNlci5wcm90b3R5cGUucmVhZFZlcnNpb24gPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIGlmICh0aGlzLnBhcnNlZFZlcnNpb24gIT09IG51bGwgJiYgdGhpcy5wYXJzZWRWZXJzaW9uICE9PSB1bmRlZmluZWQpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLnBhcnNlZFZlcnNpb247CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IHRoaXMuYml0TWF0cml4LmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgcHJvdmlzaW9uYWxWZXJzaW9uID0gTWF0aC5mbG9vcigoZGltZW5zaW9uIC0gMTcpIC8gNCk7CgkgICAgICAgIGlmIChwcm92aXNpb25hbFZlcnNpb24gPD0gNikgewoJICAgICAgICAgICAgcmV0dXJuIFZlcnNpb25fMSQxLmRlZmF1bHQuZ2V0VmVyc2lvbkZvck51bWJlcihwcm92aXNpb25hbFZlcnNpb24pOwoJICAgICAgICB9CgkgICAgICAgIC8vIFJlYWQgdG9wLXJpZ2h0IHZlcnNpb24gaW5mbzogMyB3aWRlIGJ5IDYgdGFsbAoJICAgICAgICB2YXIgdmVyc2lvbkJpdHMgPSAwOwoJICAgICAgICB2YXIgaWpNaW4gPSBkaW1lbnNpb24gLSAxMTsKCSAgICAgICAgZm9yICh2YXIgaiA9IDU7IGogPj0gMDsgai0tKSB7CgkgICAgICAgICAgICBmb3IgKHZhciBpID0gZGltZW5zaW9uIC0gOTsgaSA+PSBpak1pbjsgaS0tKSB7CgkgICAgICAgICAgICAgICAgdmVyc2lvbkJpdHMgPSB0aGlzLmNvcHlCaXQoaSwgaiwgdmVyc2lvbkJpdHMpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHZhciB0aGVQYXJzZWRWZXJzaW9uID0gVmVyc2lvbl8xJDEuZGVmYXVsdC5kZWNvZGVWZXJzaW9uSW5mb3JtYXRpb24odmVyc2lvbkJpdHMpOwoJICAgICAgICBpZiAodGhlUGFyc2VkVmVyc2lvbiAhPT0gbnVsbCAmJiB0aGVQYXJzZWRWZXJzaW9uLmdldERpbWVuc2lvbkZvclZlcnNpb24oKSA9PT0gZGltZW5zaW9uKSB7CgkgICAgICAgICAgICB0aGlzLnBhcnNlZFZlcnNpb24gPSB0aGVQYXJzZWRWZXJzaW9uOwoJICAgICAgICAgICAgcmV0dXJuIHRoZVBhcnNlZFZlcnNpb247CgkgICAgICAgIH0KCSAgICAgICAgLy8gSG1tLCBmYWlsZWQuIFRyeSBib3R0b20gbGVmdDogNiB3aWRlIGJ5IDMgdGFsbAoJICAgICAgICB2ZXJzaW9uQml0cyA9IDA7CgkgICAgICAgIGZvciAodmFyIGkgPSA1OyBpID49IDA7IGktLSkgewoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IGRpbWVuc2lvbiAtIDk7IGogPj0gaWpNaW47IGotLSkgewoJICAgICAgICAgICAgICAgIHZlcnNpb25CaXRzID0gdGhpcy5jb3B5Qml0KGksIGosIHZlcnNpb25CaXRzKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICB0aGVQYXJzZWRWZXJzaW9uID0gVmVyc2lvbl8xJDEuZGVmYXVsdC5kZWNvZGVWZXJzaW9uSW5mb3JtYXRpb24odmVyc2lvbkJpdHMpOwoJICAgICAgICBpZiAodGhlUGFyc2VkVmVyc2lvbiAhPT0gbnVsbCAmJiB0aGVQYXJzZWRWZXJzaW9uLmdldERpbWVuc2lvbkZvclZlcnNpb24oKSA9PT0gZGltZW5zaW9uKSB7CgkgICAgICAgICAgICB0aGlzLnBhcnNlZFZlcnNpb24gPSB0aGVQYXJzZWRWZXJzaW9uOwoJICAgICAgICAgICAgcmV0dXJuIHRoZVBhcnNlZFZlcnNpb247CgkgICAgICAgIH0KCSAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgpOwoJICAgIH07CgkgICAgQml0TWF0cml4UGFyc2VyLnByb3RvdHlwZS5jb3B5Qml0ID0gZnVuY3Rpb24gKGkgLyppbnQqLywgaiAvKmludCovLCB2ZXJzaW9uQml0cyAvKmludCovKSB7CgkgICAgICAgIHZhciBiaXQgPSB0aGlzLmlzTWlycm9yID8gdGhpcy5iaXRNYXRyaXguZ2V0KGosIGkpIDogdGhpcy5iaXRNYXRyaXguZ2V0KGksIGopOwoJICAgICAgICByZXR1cm4gYml0ID8gKHZlcnNpb25CaXRzIDw8IDEpIHwgMHgxIDogdmVyc2lvbkJpdHMgPDwgMTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlJlYWRzIHRoZSBiaXRzIGluIHRoZSB7QGxpbmsgQml0TWF0cml4fSByZXByZXNlbnRpbmcgdGhlIGZpbmRlciBwYXR0ZXJuIGluIHRoZQoJICAgICAqIGNvcnJlY3Qgb3JkZXIgaW4gb3JkZXIgdG8gcmVjb25zdHJ1Y3QgdGhlIGNvZGV3b3JkcyBieXRlcyBjb250YWluZWQgd2l0aGluIHRoZQoJICAgICAqIFFSIENvZGUuPC9wPgoJICAgICAqCgkgICAgICogQHJldHVybiBieXRlcyBlbmNvZGVkIHdpdGhpbiB0aGUgUVIgQ29kZQoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIHRoZSBleGFjdCBudW1iZXIgb2YgYnl0ZXMgZXhwZWN0ZWQgaXMgbm90IHJlYWQKCSAgICAgKi8KCSAgICBCaXRNYXRyaXhQYXJzZXIucHJvdG90eXBlLnJlYWRDb2Rld29yZHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHZhciBmb3JtYXRJbmZvID0gdGhpcy5yZWFkRm9ybWF0SW5mb3JtYXRpb24oKTsKCSAgICAgICAgdmFyIHZlcnNpb24gPSB0aGlzLnJlYWRWZXJzaW9uKCk7CgkgICAgICAgIC8vIEdldCB0aGUgZGF0YSBtYXNrIGZvciB0aGUgZm9ybWF0IHVzZWQgaW4gdGhpcyBRUiBDb2RlLiBUaGlzIHdpbGwgZXhjbHVkZQoJICAgICAgICAvLyBzb21lIGJpdHMgZnJvbSByZWFkaW5nIGFzIHdlIHdpbmQgdGhyb3VnaCB0aGUgYml0IG1hdHJpeC4KCSAgICAgICAgdmFyIGRhdGFNYXNrID0gRGF0YU1hc2tfMS5kZWZhdWx0LnZhbHVlcy5nZXQoZm9ybWF0SW5mby5nZXREYXRhTWFzaygpKTsKCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IHRoaXMuYml0TWF0cml4LmdldEhlaWdodCgpOwoJICAgICAgICBkYXRhTWFzay51bm1hc2tCaXRNYXRyaXgodGhpcy5iaXRNYXRyaXgsIGRpbWVuc2lvbik7CgkgICAgICAgIHZhciBmdW5jdGlvblBhdHRlcm4gPSB2ZXJzaW9uLmJ1aWxkRnVuY3Rpb25QYXR0ZXJuKCk7CgkgICAgICAgIHZhciByZWFkaW5nVXAgPSB0cnVlOwoJICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IFVpbnQ4QXJyYXkodmVyc2lvbi5nZXRUb3RhbENvZGV3b3JkcygpKTsKCSAgICAgICAgdmFyIHJlc3VsdE9mZnNldCA9IDA7CgkgICAgICAgIHZhciBjdXJyZW50Qnl0ZSA9IDA7CgkgICAgICAgIHZhciBiaXRzUmVhZCA9IDA7CgkgICAgICAgIC8vIFJlYWQgY29sdW1ucyBpbiBwYWlycywgZnJvbSByaWdodCB0byBsZWZ0CgkgICAgICAgIGZvciAodmFyIGogPSBkaW1lbnNpb24gLSAxOyBqID4gMDsgaiAtPSAyKSB7CgkgICAgICAgICAgICBpZiAoaiA9PT0gNikgewoJICAgICAgICAgICAgICAgIC8vIFNraXAgd2hvbGUgY29sdW1uIHdpdGggdmVydGljYWwgYWxpZ25tZW50IHBhdHRlcm4KCSAgICAgICAgICAgICAgICAvLyBzYXZlcyB0aW1lIGFuZCBtYWtlcyB0aGUgb3RoZXIgY29kZSBwcm9jZWVkIG1vcmUgY2xlYW5seQoJICAgICAgICAgICAgICAgIGotLTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIC8vIFJlYWQgYWx0ZXJuYXRpbmdseSBmcm9tIGJvdHRvbSB0byB0b3AgdGhlbiB0b3AgdG8gYm90dG9tCgkgICAgICAgICAgICBmb3IgKHZhciBjb3VudCA9IDA7IGNvdW50IDwgZGltZW5zaW9uOyBjb3VudCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIGkgPSByZWFkaW5nVXAgPyBkaW1lbnNpb24gLSAxIC0gY291bnQgOiBjb3VudDsKCSAgICAgICAgICAgICAgICBmb3IgKHZhciBjb2wgPSAwOyBjb2wgPCAyOyBjb2wrKykgewoJICAgICAgICAgICAgICAgICAgICAvLyBJZ25vcmUgYml0cyBjb3ZlcmVkIGJ5IHRoZSBmdW5jdGlvbiBwYXR0ZXJuCgkgICAgICAgICAgICAgICAgICAgIGlmICghZnVuY3Rpb25QYXR0ZXJuLmdldChqIC0gY29sLCBpKSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVhZCBhIGJpdAoJICAgICAgICAgICAgICAgICAgICAgICAgYml0c1JlYWQrKzsKCSAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRCeXRlIDw8PSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuYml0TWF0cml4LmdldChqIC0gY29sLCBpKSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRCeXRlIHw9IDE7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiB3ZSd2ZSBtYWRlIGEgd2hvbGUgYnl0ZSwgc2F2ZSBpdCBvZmYKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiaXRzUmVhZCA9PT0gOCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdFtyZXN1bHRPZmZzZXQrK10gPSAvKihieXRlKSAqLyBjdXJyZW50Qnl0ZTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBiaXRzUmVhZCA9IDA7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudEJ5dGUgPSAwOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmVhZGluZ1VwID0gIXJlYWRpbmdVcDsgLy8gcmVhZGluZ1VwIF49IHRydWU7IC8vIHJlYWRpbmdVcCA9ICFyZWFkaW5nVXA7IC8vIHN3aXRjaCBkaXJlY3Rpb25zCgkgICAgICAgIH0KCSAgICAgICAgaWYgKHJlc3VsdE9mZnNldCAhPT0gdmVyc2lvbi5nZXRUb3RhbENvZGV3b3JkcygpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEkMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldmVydCB0aGUgbWFzayByZW1vdmFsIGRvbmUgd2hpbGUgcmVhZGluZyB0aGUgY29kZSB3b3Jkcy4gVGhlIGJpdCBtYXRyaXggc2hvdWxkIHJldmVydCB0byBpdHMgb3JpZ2luYWwgc3RhdGUuCgkgICAgICovCgkgICAgQml0TWF0cml4UGFyc2VyLnByb3RvdHlwZS5yZW1hc2sgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIGlmICh0aGlzLnBhcnNlZEZvcm1hdEluZm8gPT09IG51bGwpIHsKCSAgICAgICAgICAgIHJldHVybjsgLy8gV2UgaGF2ZSBubyBmb3JtYXQgaW5mb3JtYXRpb24sIGFuZCBoYXZlIG5vIGRhdGEgbWFzawoJICAgICAgICB9CgkgICAgICAgIHZhciBkYXRhTWFzayA9IERhdGFNYXNrXzEuZGVmYXVsdC52YWx1ZXNbdGhpcy5wYXJzZWRGb3JtYXRJbmZvLmdldERhdGFNYXNrKCldOwoJICAgICAgICB2YXIgZGltZW5zaW9uID0gdGhpcy5iaXRNYXRyaXguZ2V0SGVpZ2h0KCk7CgkgICAgICAgIGRhdGFNYXNrLnVubWFza0JpdE1hdHJpeCh0aGlzLmJpdE1hdHJpeCwgZGltZW5zaW9uKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFByZXBhcmUgdGhlIHBhcnNlciBmb3IgYSBtaXJyb3JlZCBvcGVyYXRpb24uCgkgICAgICogVGhpcyBmbGFnIGhhcyBlZmZlY3Qgb25seSBvbiB0aGUge0BsaW5rICNyZWFkRm9ybWF0SW5mb3JtYXRpb24oKX0gYW5kIHRoZQoJICAgICAqIHtAbGluayAjcmVhZFZlcnNpb24oKX0uIEJlZm9yZSBwcm9jZWVkaW5nIHdpdGgge0BsaW5rICNyZWFkQ29kZXdvcmRzKCl9IHRoZQoJICAgICAqIHtAbGluayAjbWlycm9yKCl9IG1ldGhvZCBzaG91bGQgYmUgY2FsbGVkLgoJICAgICAqCgkgICAgICogQHBhcmFtIG1pcnJvciBXaGV0aGVyIHRvIHJlYWQgdmVyc2lvbiBhbmQgZm9ybWF0IGluZm9ybWF0aW9uIG1pcnJvcmVkLgoJICAgICAqLwoJICAgIEJpdE1hdHJpeFBhcnNlci5wcm90b3R5cGUuc2V0TWlycm9yID0gZnVuY3Rpb24gKGlzTWlycm9yKSB7CgkgICAgICAgIHRoaXMucGFyc2VkVmVyc2lvbiA9IG51bGw7CgkgICAgICAgIHRoaXMucGFyc2VkRm9ybWF0SW5mbyA9IG51bGw7CgkgICAgICAgIHRoaXMuaXNNaXJyb3IgPSBpc01pcnJvcjsKCSAgICB9OwoJICAgIC8qKiBNaXJyb3IgdGhlIGJpdCBtYXRyaXggaW4gb3JkZXIgdG8gYXR0ZW1wdCBhIHNlY29uZCByZWFkaW5nLiAqLwoJICAgIEJpdE1hdHJpeFBhcnNlci5wcm90b3R5cGUubWlycm9yID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgYml0TWF0cml4ID0gdGhpcy5iaXRNYXRyaXg7CgkgICAgICAgIGZvciAodmFyIHggPSAwLCB3aWR0aCA9IGJpdE1hdHJpeC5nZXRXaWR0aCgpOyB4IDwgd2lkdGg7IHgrKykgewoJICAgICAgICAgICAgZm9yICh2YXIgeSA9IHggKyAxLCBoZWlnaHQgPSBiaXRNYXRyaXguZ2V0SGVpZ2h0KCk7IHkgPCBoZWlnaHQ7IHkrKykgewoJICAgICAgICAgICAgICAgIGlmIChiaXRNYXRyaXguZ2V0KHgsIHkpICE9PSBiaXRNYXRyaXguZ2V0KHksIHgpKSB7CgkgICAgICAgICAgICAgICAgICAgIGJpdE1hdHJpeC5mbGlwKHksIHgpOwoJICAgICAgICAgICAgICAgICAgICBiaXRNYXRyaXguZmxpcCh4LCB5KTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICB9OwoJICAgIHJldHVybiBCaXRNYXRyaXhQYXJzZXI7Cgl9KCkpOwoJQml0TWF0cml4UGFyc2VyJDEuZGVmYXVsdCA9IEJpdE1hdHJpeFBhcnNlcjsKCgl2YXIgRGF0YUJsb2NrJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzJDMgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX192YWx1ZXMpIHx8IGZ1bmN0aW9uKG8pIHsKCSAgICB2YXIgcyA9IHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgU3ltYm9sLml0ZXJhdG9yLCBtID0gcyAmJiBvW3NdLCBpID0gMDsKCSAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTsKCSAgICBpZiAobyAmJiB0eXBlb2Ygby5sZW5ndGggPT09ICJudW1iZXIiKSByZXR1cm4gewoJICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwOwoJICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9OwoJICAgICAgICB9CgkgICAgfTsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKHMgPyAiT2JqZWN0IGlzIG5vdCBpdGVyYWJsZS4iIDogIlN5bWJvbC5pdGVyYXRvciBpcyBub3QgZGVmaW5lZC4iKTsKCX07CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRGF0YUJsb2NrJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQxID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDE7CgkvKioKCSAqIDxwPkVuY2Fwc3VsYXRlcyBhIGJsb2NrIG9mIGRhdGEgd2l0aGluIGEgUVIgQ29kZS4gUVIgQ29kZXMgbWF5IHNwbGl0IHRoZWlyIGRhdGEgaW50bwoJICogbXVsdGlwbGUgYmxvY2tzLCBlYWNoIG9mIHdoaWNoIGlzIGEgdW5pdCBvZiBkYXRhIGFuZCBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3Jkcy4gRWFjaAoJICogaXMgcmVwcmVzZW50ZWQgYnkgYW4gaW5zdGFuY2Ugb2YgdGhpcyBjbGFzcy48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIERhdGFCbG9jayA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBEYXRhQmxvY2sobnVtRGF0YUNvZGV3b3JkcyAvKmludCovLCBjb2Rld29yZHMpIHsKCSAgICAgICAgdGhpcy5udW1EYXRhQ29kZXdvcmRzID0gbnVtRGF0YUNvZGV3b3JkczsKCSAgICAgICAgdGhpcy5jb2Rld29yZHMgPSBjb2Rld29yZHM7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIDxwPldoZW4gUVIgQ29kZXMgdXNlIG11bHRpcGxlIGRhdGEgYmxvY2tzLCB0aGV5IGFyZSBhY3R1YWxseSBpbnRlcmxlYXZlZC4KCSAgICAgKiBUaGF0IGlzLCB0aGUgZmlyc3QgYnl0ZSBvZiBkYXRhIGJsb2NrIDEgdG8gbiBpcyB3cml0dGVuLCB0aGVuIHRoZSBzZWNvbmQgYnl0ZXMsIGFuZCBzbyBvbi4gVGhpcwoJICAgICAqIG1ldGhvZCB3aWxsIHNlcGFyYXRlIHRoZSBkYXRhIGludG8gb3JpZ2luYWwgYmxvY2tzLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSByYXdDb2Rld29yZHMgYnl0ZXMgYXMgcmVhZCBkaXJlY3RseSBmcm9tIHRoZSBRUiBDb2RlCgkgICAgICogQHBhcmFtIHZlcnNpb24gdmVyc2lvbiBvZiB0aGUgUVIgQ29kZQoJICAgICAqIEBwYXJhbSBlY0xldmVsIGVycm9yLWNvcnJlY3Rpb24gbGV2ZWwgb2YgdGhlIFFSIENvZGUKCSAgICAgKiBAcmV0dXJuIERhdGFCbG9ja3MgY29udGFpbmluZyBvcmlnaW5hbCBieXRlcywgImRlLWludGVybGVhdmVkIiBmcm9tIHJlcHJlc2VudGF0aW9uIGluIHRoZQoJICAgICAqICAgICAgICAgUVIgQ29kZQoJICAgICAqLwoJICAgIERhdGFCbG9jay5nZXREYXRhQmxvY2tzID0gZnVuY3Rpb24gKHJhd0NvZGV3b3JkcywgdmVyc2lvbiwgZWNMZXZlbCkgewoJICAgICAgICB2YXIgZV8xLCBfYSwgZV8yLCBfYjsKCSAgICAgICAgaWYgKHJhd0NvZGV3b3Jkcy5sZW5ndGggIT09IHZlcnNpb24uZ2V0VG90YWxDb2Rld29yZHMoKSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIC8vIEZpZ3VyZSBvdXQgdGhlIG51bWJlciBhbmQgc2l6ZSBvZiBkYXRhIGJsb2NrcyB1c2VkIGJ5IHRoaXMgdmVyc2lvbiBhbmQKCSAgICAgICAgLy8gZXJyb3IgY29ycmVjdGlvbiBsZXZlbAoJICAgICAgICB2YXIgZWNCbG9ja3MgPSB2ZXJzaW9uLmdldEVDQmxvY2tzRm9yTGV2ZWwoZWNMZXZlbCk7CgkgICAgICAgIC8vIEZpcnN0IGNvdW50IHRoZSB0b3RhbCBudW1iZXIgb2YgZGF0YSBibG9ja3MKCSAgICAgICAgdmFyIHRvdGFsQmxvY2tzID0gMDsKCSAgICAgICAgdmFyIGVjQmxvY2tBcnJheSA9IGVjQmxvY2tzLmdldEVDQmxvY2tzKCk7CgkgICAgICAgIHRyeSB7CgkgICAgICAgICAgICBmb3IgKHZhciBlY0Jsb2NrQXJyYXlfMSA9IF9fdmFsdWVzJDMoZWNCbG9ja0FycmF5KSwgZWNCbG9ja0FycmF5XzFfMSA9IGVjQmxvY2tBcnJheV8xLm5leHQoKTsgIWVjQmxvY2tBcnJheV8xXzEuZG9uZTsgZWNCbG9ja0FycmF5XzFfMSA9IGVjQmxvY2tBcnJheV8xLm5leHQoKSkgewoJICAgICAgICAgICAgICAgIHZhciBlY0Jsb2NrID0gZWNCbG9ja0FycmF5XzFfMS52YWx1ZTsKCSAgICAgICAgICAgICAgICB0b3RhbEJsb2NrcyArPSBlY0Jsb2NrLmdldENvdW50KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGVfMV8xKSB7IGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07IH0KCSAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGlmIChlY0Jsb2NrQXJyYXlfMV8xICYmICFlY0Jsb2NrQXJyYXlfMV8xLmRvbmUgJiYgKF9hID0gZWNCbG9ja0FycmF5XzEucmV0dXJuKSkgX2EuY2FsbChlY0Jsb2NrQXJyYXlfMSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gTm93IGVzdGFibGlzaCBEYXRhQmxvY2tzIG9mIHRoZSBhcHByb3ByaWF0ZSBzaXplIGFuZCBudW1iZXIgb2YgZGF0YSBjb2Rld29yZHMKCSAgICAgICAgdmFyIHJlc3VsdCA9IG5ldyBBcnJheSh0b3RhbEJsb2Nrcyk7CgkgICAgICAgIHZhciBudW1SZXN1bHRCbG9ja3MgPSAwOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgZWNCbG9ja0FycmF5XzIgPSBfX3ZhbHVlcyQzKGVjQmxvY2tBcnJheSksIGVjQmxvY2tBcnJheV8yXzEgPSBlY0Jsb2NrQXJyYXlfMi5uZXh0KCk7ICFlY0Jsb2NrQXJyYXlfMl8xLmRvbmU7IGVjQmxvY2tBcnJheV8yXzEgPSBlY0Jsb2NrQXJyYXlfMi5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgZWNCbG9jayA9IGVjQmxvY2tBcnJheV8yXzEudmFsdWU7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlY0Jsb2NrLmdldENvdW50KCk7IGkrKykgewoJICAgICAgICAgICAgICAgICAgICB2YXIgbnVtRGF0YUNvZGV3b3JkcyA9IGVjQmxvY2suZ2V0RGF0YUNvZGV3b3JkcygpOwoJICAgICAgICAgICAgICAgICAgICB2YXIgbnVtQmxvY2tDb2Rld29yZHMgPSBlY0Jsb2Nrcy5nZXRFQ0NvZGV3b3Jkc1BlckJsb2NrKCkgKyBudW1EYXRhQ29kZXdvcmRzOwoJICAgICAgICAgICAgICAgICAgICByZXN1bHRbbnVtUmVzdWx0QmxvY2tzKytdID0gbmV3IERhdGFCbG9jayhudW1EYXRhQ29kZXdvcmRzLCBuZXcgVWludDhBcnJheShudW1CbG9ja0NvZGV3b3JkcykpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZV8yXzEpIHsgZV8yID0geyBlcnJvcjogZV8yXzEgfTsgfQoJICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgaWYgKGVjQmxvY2tBcnJheV8yXzEgJiYgIWVjQmxvY2tBcnJheV8yXzEuZG9uZSAmJiAoX2IgPSBlY0Jsb2NrQXJyYXlfMi5yZXR1cm4pKSBfYi5jYWxsKGVjQmxvY2tBcnJheV8yKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8yKSB0aHJvdyBlXzIuZXJyb3I7IH0KCSAgICAgICAgfQoJICAgICAgICAvLyBBbGwgYmxvY2tzIGhhdmUgdGhlIHNhbWUgYW1vdW50IG9mIGRhdGEsIGV4Y2VwdCB0aGF0IHRoZSBsYXN0IG4KCSAgICAgICAgLy8gKHdoZXJlIG4gbWF5IGJlIDApIGhhdmUgMSBtb3JlIGJ5dGUuIEZpZ3VyZSBvdXQgd2hlcmUgdGhlc2Ugc3RhcnQuCgkgICAgICAgIHZhciBzaG9ydGVyQmxvY2tzVG90YWxDb2Rld29yZHMgPSByZXN1bHRbMF0uY29kZXdvcmRzLmxlbmd0aDsKCSAgICAgICAgdmFyIGxvbmdlckJsb2Nrc1N0YXJ0QXQgPSByZXN1bHQubGVuZ3RoIC0gMTsKCSAgICAgICAgLy8gVFlQRVNDUklQVFBPUlQ6IGNoZWNrIGxlbmd0aCBpcyBjb3JyZWN0IGhlcmUKCSAgICAgICAgd2hpbGUgKGxvbmdlckJsb2Nrc1N0YXJ0QXQgPj0gMCkgewoJICAgICAgICAgICAgdmFyIG51bUNvZGV3b3JkcyA9IHJlc3VsdFtsb25nZXJCbG9ja3NTdGFydEF0XS5jb2Rld29yZHMubGVuZ3RoOwoJICAgICAgICAgICAgaWYgKG51bUNvZGV3b3JkcyA9PT0gc2hvcnRlckJsb2Nrc1RvdGFsQ29kZXdvcmRzKSB7CgkgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBsb25nZXJCbG9ja3NTdGFydEF0LS07CgkgICAgICAgIH0KCSAgICAgICAgbG9uZ2VyQmxvY2tzU3RhcnRBdCsrOwoJICAgICAgICB2YXIgc2hvcnRlckJsb2Nrc051bURhdGFDb2Rld29yZHMgPSBzaG9ydGVyQmxvY2tzVG90YWxDb2Rld29yZHMgLSBlY0Jsb2Nrcy5nZXRFQ0NvZGV3b3Jkc1BlckJsb2NrKCk7CgkgICAgICAgIC8vIFRoZSBsYXN0IGVsZW1lbnRzIG9mIHJlc3VsdCBtYXkgYmUgMSBlbGVtZW50IGxvbmdlcgoJICAgICAgICAvLyBmaXJzdCBmaWxsIG91dCBhcyBtYW55IGVsZW1lbnRzIGFzIGFsbCBvZiB0aGVtIGhhdmUKCSAgICAgICAgdmFyIHJhd0NvZGV3b3Jkc09mZnNldCA9IDA7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2hvcnRlckJsb2Nrc051bURhdGFDb2Rld29yZHM7IGkrKykgewoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBudW1SZXN1bHRCbG9ja3M7IGorKykgewoJICAgICAgICAgICAgICAgIHJlc3VsdFtqXS5jb2Rld29yZHNbaV0gPSByYXdDb2Rld29yZHNbcmF3Q29kZXdvcmRzT2Zmc2V0KytdOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIC8vIEZpbGwgb3V0IHRoZSBsYXN0IGRhdGEgYmxvY2sgaW4gdGhlIGxvbmdlciBvbmVzCgkgICAgICAgIGZvciAodmFyIGogPSBsb25nZXJCbG9ja3NTdGFydEF0OyBqIDwgbnVtUmVzdWx0QmxvY2tzOyBqKyspIHsKCSAgICAgICAgICAgIHJlc3VsdFtqXS5jb2Rld29yZHNbc2hvcnRlckJsb2Nrc051bURhdGFDb2Rld29yZHNdID0gcmF3Q29kZXdvcmRzW3Jhd0NvZGV3b3Jkc09mZnNldCsrXTsKCSAgICAgICAgfQoJICAgICAgICAvLyBOb3cgYWRkIGluIGVycm9yIGNvcnJlY3Rpb24gYmxvY2tzCgkgICAgICAgIHZhciBtYXggPSByZXN1bHRbMF0uY29kZXdvcmRzLmxlbmd0aDsKCSAgICAgICAgZm9yICh2YXIgaSA9IHNob3J0ZXJCbG9ja3NOdW1EYXRhQ29kZXdvcmRzOyBpIDwgbWF4OyBpKyspIHsKCSAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgbnVtUmVzdWx0QmxvY2tzOyBqKyspIHsKCSAgICAgICAgICAgICAgICB2YXIgaU9mZnNldCA9IGogPCBsb25nZXJCbG9ja3NTdGFydEF0ID8gaSA6IGkgKyAxOwoJICAgICAgICAgICAgICAgIHJlc3VsdFtqXS5jb2Rld29yZHNbaU9mZnNldF0gPSByYXdDb2Rld29yZHNbcmF3Q29kZXdvcmRzT2Zmc2V0KytdOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiByZXN1bHQ7CgkgICAgfTsKCSAgICBEYXRhQmxvY2sucHJvdG90eXBlLmdldE51bURhdGFDb2Rld29yZHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm51bURhdGFDb2Rld29yZHM7CgkgICAgfTsKCSAgICBEYXRhQmxvY2sucHJvdG90eXBlLmdldENvZGV3b3JkcyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuY29kZXdvcmRzOwoJICAgIH07CgkgICAgcmV0dXJuIERhdGFCbG9jazsKCX0oKSk7CglEYXRhQmxvY2skMS5kZWZhdWx0ID0gRGF0YUJsb2NrOwoKCXZhciBEZWNvZGVkQml0U3RyZWFtUGFyc2VyJDEgPSB7fTsKCgl2YXIgQml0U291cmNlJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEJpdFNvdXJjZSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLmNvbW1vbiB7Ki8KCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5UaGlzIHByb3ZpZGVzIGFuIGVhc3kgYWJzdHJhY3Rpb24gdG8gcmVhZCBiaXRzIGF0IGEgdGltZSBmcm9tIGEgc2VxdWVuY2Ugb2YgYnl0ZXMsIHdoZXJlIHRoZQoJICogbnVtYmVyIG9mIGJpdHMgcmVhZCBpcyBub3Qgb2Z0ZW4gYSBtdWx0aXBsZSBvZiA4LjwvcD4KCSAqCgkgKiA8cD5UaGlzIGNsYXNzIGlzIHRocmVhZC1zYWZlIGJ1dCBub3QgcmVlbnRyYW50IC0tIHVubGVzcyB0aGUgY2FsbGVyIG1vZGlmaWVzIHRoZSBieXRlcyBhcnJheQoJICogaXQgcGFzc2VkIGluLCBpbiB3aGljaCBjYXNlIGFsbCBiZXRzIGFyZSBvZmYuPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBCaXRTb3VyY2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgLyoqCgkgICAgICogQHBhcmFtIGJ5dGVzIGJ5dGVzIGZyb20gd2hpY2ggdGhpcyB3aWxsIHJlYWQgYml0cy4gQml0cyB3aWxsIGJlIHJlYWQgZnJvbSB0aGUgZmlyc3QgYnl0ZSBmaXJzdC4KCSAgICAgKiBCaXRzIGFyZSByZWFkIHdpdGhpbiBhIGJ5dGUgZnJvbSBtb3N0LXNpZ25pZmljYW50IHRvIGxlYXN0LXNpZ25pZmljYW50IGJpdC4KCSAgICAgKi8KCSAgICBmdW5jdGlvbiBCaXRTb3VyY2UoYnl0ZXMpIHsKCSAgICAgICAgdGhpcy5ieXRlcyA9IGJ5dGVzOwoJICAgICAgICB0aGlzLmJ5dGVPZmZzZXQgPSAwOwoJICAgICAgICB0aGlzLmJpdE9mZnNldCA9IDA7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gaW5kZXggb2YgbmV4dCBiaXQgaW4gY3VycmVudCBieXRlIHdoaWNoIHdvdWxkIGJlIHJlYWQgYnkgdGhlIG5leHQgY2FsbCB0byB7QGxpbmsgI3JlYWRCaXRzKGludCl9LgoJICAgICAqLwoJICAgIEJpdFNvdXJjZS5wcm90b3R5cGUuZ2V0Qml0T2Zmc2V0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5iaXRPZmZzZXQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIGluZGV4IG9mIG5leHQgYnl0ZSBpbiBpbnB1dCBieXRlIGFycmF5IHdoaWNoIHdvdWxkIGJlIHJlYWQgYnkgdGhlIG5leHQgY2FsbCB0byB7QGxpbmsgI3JlYWRCaXRzKGludCl9LgoJICAgICAqLwoJICAgIEJpdFNvdXJjZS5wcm90b3R5cGUuZ2V0Qnl0ZU9mZnNldCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYnl0ZU9mZnNldDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBudW1CaXRzIG51bWJlciBvZiBiaXRzIHRvIHJlYWQKCSAgICAgKiBAcmV0dXJuIGludCByZXByZXNlbnRpbmcgdGhlIGJpdHMgcmVhZC4gVGhlIGJpdHMgd2lsbCBhcHBlYXIgYXMgdGhlIGxlYXN0LXNpZ25pZmljYW50CgkgICAgICogICAgICAgICBiaXRzIG9mIHRoZSBpbnQKCSAgICAgKiBAdGhyb3dzIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiBpZiBudW1CaXRzIGlzbid0IGluIFsxLDMyXSBvciBtb3JlIHRoYW4gaXMgYXZhaWxhYmxlCgkgICAgICovCgkgICAgQml0U291cmNlLnByb3RvdHlwZS5yZWFkQml0cyA9IGZ1bmN0aW9uIChudW1CaXRzIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKG51bUJpdHMgPCAxIHx8IG51bUJpdHMgPiAzMiB8fCBudW1CaXRzID4gdGhpcy5hdmFpbGFibGUoKSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xLmRlZmF1bHQoJycgKyBudW1CaXRzKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgcmVzdWx0ID0gMDsKCSAgICAgICAgdmFyIGJpdE9mZnNldCA9IHRoaXMuYml0T2Zmc2V0OwoJICAgICAgICB2YXIgYnl0ZU9mZnNldCA9IHRoaXMuYnl0ZU9mZnNldDsKCSAgICAgICAgdmFyIGJ5dGVzID0gdGhpcy5ieXRlczsKCSAgICAgICAgLy8gRmlyc3QsIHJlYWQgcmVtYWluZGVyIGZyb20gY3VycmVudCBieXRlCgkgICAgICAgIGlmIChiaXRPZmZzZXQgPiAwKSB7CgkgICAgICAgICAgICB2YXIgYml0c0xlZnQgPSA4IC0gYml0T2Zmc2V0OwoJICAgICAgICAgICAgdmFyIHRvUmVhZCA9IG51bUJpdHMgPCBiaXRzTGVmdCA/IG51bUJpdHMgOiBiaXRzTGVmdDsKCSAgICAgICAgICAgIHZhciBiaXRzVG9Ob3RSZWFkID0gYml0c0xlZnQgLSB0b1JlYWQ7CgkgICAgICAgICAgICB2YXIgbWFzayA9ICgweEZGID4+ICg4IC0gdG9SZWFkKSkgPDwgYml0c1RvTm90UmVhZDsKCSAgICAgICAgICAgIHJlc3VsdCA9IChieXRlc1tieXRlT2Zmc2V0XSAmIG1hc2spID4+IGJpdHNUb05vdFJlYWQ7CgkgICAgICAgICAgICBudW1CaXRzIC09IHRvUmVhZDsKCSAgICAgICAgICAgIGJpdE9mZnNldCArPSB0b1JlYWQ7CgkgICAgICAgICAgICBpZiAoYml0T2Zmc2V0ID09PSA4KSB7CgkgICAgICAgICAgICAgICAgYml0T2Zmc2V0ID0gMDsKCSAgICAgICAgICAgICAgICBieXRlT2Zmc2V0Kys7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gTmV4dCByZWFkIHdob2xlIGJ5dGVzCgkgICAgICAgIGlmIChudW1CaXRzID4gMCkgewoJICAgICAgICAgICAgd2hpbGUgKG51bUJpdHMgPj0gOCkgewoJICAgICAgICAgICAgICAgIHJlc3VsdCA9IChyZXN1bHQgPDwgOCkgfCAoYnl0ZXNbYnl0ZU9mZnNldF0gJiAweEZGKTsKCSAgICAgICAgICAgICAgICBieXRlT2Zmc2V0Kys7CgkgICAgICAgICAgICAgICAgbnVtQml0cyAtPSA4OwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgLy8gRmluYWxseSByZWFkIGEgcGFydGlhbCBieXRlCgkgICAgICAgICAgICBpZiAobnVtQml0cyA+IDApIHsKCSAgICAgICAgICAgICAgICB2YXIgYml0c1RvTm90UmVhZCA9IDggLSBudW1CaXRzOwoJICAgICAgICAgICAgICAgIHZhciBtYXNrID0gKDB4RkYgPj4gYml0c1RvTm90UmVhZCkgPDwgYml0c1RvTm90UmVhZDsKCSAgICAgICAgICAgICAgICByZXN1bHQgPSAocmVzdWx0IDw8IG51bUJpdHMpIHwgKChieXRlc1tieXRlT2Zmc2V0XSAmIG1hc2spID4+IGJpdHNUb05vdFJlYWQpOwoJICAgICAgICAgICAgICAgIGJpdE9mZnNldCArPSBudW1CaXRzOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHRoaXMuYml0T2Zmc2V0ID0gYml0T2Zmc2V0OwoJICAgICAgICB0aGlzLmJ5dGVPZmZzZXQgPSBieXRlT2Zmc2V0OwoJICAgICAgICByZXR1cm4gcmVzdWx0OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBudW1iZXIgb2YgYml0cyB0aGF0IGNhbiBiZSByZWFkIHN1Y2Nlc3NmdWxseQoJICAgICAqLwoJICAgIEJpdFNvdXJjZS5wcm90b3R5cGUuYXZhaWxhYmxlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gOCAqICh0aGlzLmJ5dGVzLmxlbmd0aCAtIHRoaXMuYnl0ZU9mZnNldCkgLSB0aGlzLmJpdE9mZnNldDsKCSAgICB9OwoJICAgIHJldHVybiBCaXRTb3VyY2U7Cgl9KCkpOwoJQml0U291cmNlJDEuZGVmYXVsdCA9IEJpdFNvdXJjZTsKCgl2YXIgRGVjb2RlclJlc3VsdCQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShEZWNvZGVyUmVzdWx0JDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyppbXBvcnQgamF2YS51dGlsLkxpc3Q7Ki8KCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIHRoZSByZXN1bHQgb2YgZGVjb2RpbmcgYSBtYXRyaXggb2YgYml0cy4gVGhpcyB0eXBpY2FsbHkKCSAqIGFwcGxpZXMgdG8gMkQgYmFyY29kZSBmb3JtYXRzLiBGb3Igbm93IGl0IGNvbnRhaW5zIHRoZSByYXcgYnl0ZXMgb2J0YWluZWQsCgkgKiBhcyB3ZWxsIGFzIGEgU3RyaW5nIGludGVycHJldGF0aW9uIG9mIHRob3NlIGJ5dGVzLCBpZiBhcHBsaWNhYmxlLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgRGVjb2RlclJlc3VsdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IocmF3Qnl0ZXM6IFVpbnQ4QXJyYXksCgkgICAgLy8gICAgICAgICAgICAgICAgICAgICAgdGV4dDogc3RyaW5nLAoJICAgIC8vICAgICAgICAgICAgICAgICAgICAgIExpc3Q8VWludDhBcnJheT4gYnl0ZVNlZ21lbnRzLAoJICAgIC8vICAgICAgICAgICAgICAgICAgICAgIFN0cmluZyBlY0xldmVsKSB7CgkgICAgLy8gICB0aGlzKHJhd0J5dGVzLCB0ZXh0LCBieXRlU2VnbWVudHMsIGVjTGV2ZWwsIC0xLCAtMSkKCSAgICAvLyB9CgkgICAgZnVuY3Rpb24gRGVjb2RlclJlc3VsdChyYXdCeXRlcywgdGV4dCwgYnl0ZVNlZ21lbnRzLCBlY0xldmVsLCBzdHJ1Y3R1cmVkQXBwZW5kU2VxdWVuY2VOdW1iZXIsIHN0cnVjdHVyZWRBcHBlbmRQYXJpdHkpIHsKCSAgICAgICAgaWYgKHN0cnVjdHVyZWRBcHBlbmRTZXF1ZW5jZU51bWJlciA9PT0gdm9pZCAwKSB7IHN0cnVjdHVyZWRBcHBlbmRTZXF1ZW5jZU51bWJlciA9IC0xOyB9CgkgICAgICAgIGlmIChzdHJ1Y3R1cmVkQXBwZW5kUGFyaXR5ID09PSB2b2lkIDApIHsgc3RydWN0dXJlZEFwcGVuZFBhcml0eSA9IC0xOyB9CgkgICAgICAgIHRoaXMucmF3Qnl0ZXMgPSByYXdCeXRlczsKCSAgICAgICAgdGhpcy50ZXh0ID0gdGV4dDsKCSAgICAgICAgdGhpcy5ieXRlU2VnbWVudHMgPSBieXRlU2VnbWVudHM7CgkgICAgICAgIHRoaXMuZWNMZXZlbCA9IGVjTGV2ZWw7CgkgICAgICAgIHRoaXMuc3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyID0gc3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyOwoJICAgICAgICB0aGlzLnN0cnVjdHVyZWRBcHBlbmRQYXJpdHkgPSBzdHJ1Y3R1cmVkQXBwZW5kUGFyaXR5OwoJICAgICAgICB0aGlzLm51bUJpdHMgPSAocmF3Qnl0ZXMgPT09IHVuZGVmaW5lZCB8fCByYXdCeXRlcyA9PT0gbnVsbCkgPyAwIDogOCAqIHJhd0J5dGVzLmxlbmd0aDsKCSAgICB9CgkgICAgLyoqCgkgICAgICogQHJldHVybiByYXcgYnl0ZXMgcmVwcmVzZW50aW5nIHRoZSByZXN1bHQsIG9yIHtAY29kZSBudWxsfSBpZiBub3QgYXBwbGljYWJsZQoJICAgICAqLwoJICAgIERlY29kZXJSZXN1bHQucHJvdG90eXBlLmdldFJhd0J5dGVzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yYXdCeXRlczsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gaG93IG1hbnkgYml0cyBvZiB7QGxpbmsgI2dldFJhd0J5dGVzKCl9IGFyZSB2YWxpZDsgdHlwaWNhbGx5IDggdGltZXMgaXRzIGxlbmd0aAoJICAgICAqIEBzaW5jZSAzLjMuMAoJICAgICAqLwoJICAgIERlY29kZXJSZXN1bHQucHJvdG90eXBlLmdldE51bUJpdHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm51bUJpdHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gbnVtQml0cyBvdmVycmlkZXMgdGhlIG51bWJlciBvZiBiaXRzIHRoYXQgYXJlIHZhbGlkIGluIHtAbGluayAjZ2V0UmF3Qnl0ZXMoKX0KCSAgICAgKiBAc2luY2UgMy4zLjAKCSAgICAgKi8KCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5zZXROdW1CaXRzID0gZnVuY3Rpb24gKG51bUJpdHMgLyppbnQqLykgewoJICAgICAgICB0aGlzLm51bUJpdHMgPSBudW1CaXRzOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiB0ZXh0IHJlcHJlc2VudGF0aW9uIG9mIHRoZSByZXN1bHQKCSAgICAgKi8KCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5nZXRUZXh0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy50ZXh0OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBsaXN0IG9mIGJ5dGUgc2VnbWVudHMgaW4gdGhlIHJlc3VsdCwgb3Ige0Bjb2RlIG51bGx9IGlmIG5vdCBhcHBsaWNhYmxlCgkgICAgICovCgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuZ2V0Qnl0ZVNlZ21lbnRzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5ieXRlU2VnbWVudHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIG5hbWUgb2YgZXJyb3IgY29ycmVjdGlvbiBsZXZlbCB1c2VkLCBvciB7QGNvZGUgbnVsbH0gaWYgbm90IGFwcGxpY2FibGUKCSAgICAgKi8KCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5nZXRFQ0xldmVsID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5lY0xldmVsOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBudW1iZXIgb2YgZXJyb3JzIGNvcnJlY3RlZCwgb3Ige0Bjb2RlIG51bGx9IGlmIG5vdCBhcHBsaWNhYmxlCgkgICAgICovCgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuZ2V0RXJyb3JzQ29ycmVjdGVkID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5lcnJvcnNDb3JyZWN0ZWQ7CgkgICAgfTsKCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5zZXRFcnJvcnNDb3JyZWN0ZWQgPSBmdW5jdGlvbiAoZXJyb3JzQ29ycmVjdGVkIC8qSW50ZWdlciovKSB7CgkgICAgICAgIHRoaXMuZXJyb3JzQ29ycmVjdGVkID0gZXJyb3JzQ29ycmVjdGVkOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBudW1iZXIgb2YgZXJhc3VyZXMgY29ycmVjdGVkLCBvciB7QGNvZGUgbnVsbH0gaWYgbm90IGFwcGxpY2FibGUKCSAgICAgKi8KCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5nZXRFcmFzdXJlcyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuZXJhc3VyZXM7CgkgICAgfTsKCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5zZXRFcmFzdXJlcyA9IGZ1bmN0aW9uIChlcmFzdXJlcyAvKkludGVnZXIqLykgewoJICAgICAgICB0aGlzLmVyYXN1cmVzID0gZXJhc3VyZXM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIGFyYml0cmFyeSBhZGRpdGlvbmFsIG1ldGFkYXRhCgkgICAgICovCgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuZ2V0T3RoZXIgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm90aGVyOwoJICAgIH07CgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuc2V0T3RoZXIgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgdGhpcy5vdGhlciA9IG90aGVyOwoJICAgIH07CgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuaGFzU3RydWN0dXJlZEFwcGVuZCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc3RydWN0dXJlZEFwcGVuZFBhcml0eSA+PSAwICYmIHRoaXMuc3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyID49IDA7CgkgICAgfTsKCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5nZXRTdHJ1Y3R1cmVkQXBwZW5kUGFyaXR5ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5zdHJ1Y3R1cmVkQXBwZW5kUGFyaXR5OwoJICAgIH07CgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuZ2V0U3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5zdHJ1Y3R1cmVkQXBwZW5kU2VxdWVuY2VOdW1iZXI7CgkgICAgfTsKCSAgICByZXR1cm4gRGVjb2RlclJlc3VsdDsKCX0oKSk7CglEZWNvZGVyUmVzdWx0JDEuZGVmYXVsdCA9IERlY29kZXJSZXN1bHQ7CgoJdmFyIE1vZGUgPSB7fTsKCgkoZnVuY3Rpb24gKGV4cG9ydHMpIHsKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJZXhwb3J0cy5Nb2RlVmFsdWVzID0gdm9pZCAwOwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDE7Cgl2YXIgTW9kZVZhbHVlczsKCShmdW5jdGlvbiAoTW9kZVZhbHVlcykgewoJICAgIE1vZGVWYWx1ZXNbTW9kZVZhbHVlc1siVEVSTUlOQVRPUiJdID0gMF0gPSAiVEVSTUlOQVRPUiI7CgkgICAgTW9kZVZhbHVlc1tNb2RlVmFsdWVzWyJOVU1FUklDIl0gPSAxXSA9ICJOVU1FUklDIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIkFMUEhBTlVNRVJJQyJdID0gMl0gPSAiQUxQSEFOVU1FUklDIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIlNUUlVDVFVSRURfQVBQRU5EIl0gPSAzXSA9ICJTVFJVQ1RVUkVEX0FQUEVORCI7CgkgICAgTW9kZVZhbHVlc1tNb2RlVmFsdWVzWyJCWVRFIl0gPSA0XSA9ICJCWVRFIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIkVDSSJdID0gNV0gPSAiRUNJIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIktBTkpJIl0gPSA2XSA9ICJLQU5KSSI7CgkgICAgTW9kZVZhbHVlc1tNb2RlVmFsdWVzWyJGTkMxX0ZJUlNUX1BPU0lUSU9OIl0gPSA3XSA9ICJGTkMxX0ZJUlNUX1BPU0lUSU9OIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIkZOQzFfU0VDT05EX1BPU0lUSU9OIl0gPSA4XSA9ICJGTkMxX1NFQ09ORF9QT1NJVElPTiI7CgkgICAgLyoqIFNlZSBHQlQgMTgyODQtMjAwMDsgIkhhbnppIiBpcyBhIHRyYW5zbGl0ZXJhdGlvbiBvZiB0aGlzIG1vZGUgbmFtZS4gKi8KCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIkhBTlpJIl0gPSA5XSA9ICJIQU5aSSI7Cgl9KShNb2RlVmFsdWVzID0gZXhwb3J0cy5Nb2RlVmFsdWVzIHx8IChleHBvcnRzLk1vZGVWYWx1ZXMgPSB7fSkpOwoJLyoqCgkgKiA8cD5TZWUgSVNPIDE4MDA0OjIwMDYsIDYuNC4xLCBUYWJsZXMgMiBhbmQgMy4gVGhpcyBlbnVtIGVuY2Fwc3VsYXRlcyB0aGUgdmFyaW91cyBtb2RlcyBpbiB3aGljaAoJICogZGF0YSBjYW4gYmUgZW5jb2RlZCB0byBiaXRzIGluIHRoZSBRUiBjb2RlIHN0YW5kYXJkLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgTW9kZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBNb2RlKHZhbHVlLCBzdHJpbmdWYWx1ZSwgY2hhcmFjdGVyQ291bnRCaXRzRm9yVmVyc2lvbnMsIGJpdHMgLyppbnQqLykgewoJICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7CgkgICAgICAgIHRoaXMuc3RyaW5nVmFsdWUgPSBzdHJpbmdWYWx1ZTsKCSAgICAgICAgdGhpcy5jaGFyYWN0ZXJDb3VudEJpdHNGb3JWZXJzaW9ucyA9IGNoYXJhY3RlckNvdW50Qml0c0ZvclZlcnNpb25zOwoJICAgICAgICB0aGlzLmJpdHMgPSBiaXRzOwoJICAgICAgICBNb2RlLkZPUl9CSVRTLnNldChiaXRzLCB0aGlzKTsKCSAgICAgICAgTW9kZS5GT1JfVkFMVUUuc2V0KHZhbHVlLCB0aGlzKTsKCSAgICB9CgkgICAgLyoqCgkgICAgICogQHBhcmFtIGJpdHMgZm91ciBiaXRzIGVuY29kaW5nIGEgUVIgQ29kZSBkYXRhIG1vZGUKCSAgICAgKiBAcmV0dXJuIE1vZGUgZW5jb2RlZCBieSB0aGVzZSBiaXRzCgkgICAgICogQHRocm93cyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gaWYgYml0cyBkbyBub3QgY29ycmVzcG9uZCB0byBhIGtub3duIG1vZGUKCSAgICAgKi8KCSAgICBNb2RlLmZvckJpdHMgPSBmdW5jdGlvbiAoYml0cyAvKmludCovKSB7CgkgICAgICAgIHZhciBtb2RlID0gTW9kZS5GT1JfQklUUy5nZXQoYml0cyk7CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IG1vZGUpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG1vZGU7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gdmVyc2lvbiB2ZXJzaW9uIGluIHF1ZXN0aW9uCgkgICAgICogQHJldHVybiBudW1iZXIgb2YgYml0cyB1c2VkLCBpbiB0aGlzIFFSIENvZGUgc3ltYm9sIHtAbGluayBWZXJzaW9ufSwgdG8gZW5jb2RlIHRoZQoJICAgICAqICAgICAgICAgY291bnQgb2YgY2hhcmFjdGVycyB0aGF0IHdpbGwgZm9sbG93IGVuY29kZWQgaW4gdGhpcyBNb2RlCgkgICAgICovCgkgICAgTW9kZS5wcm90b3R5cGUuZ2V0Q2hhcmFjdGVyQ291bnRCaXRzID0gZnVuY3Rpb24gKHZlcnNpb24pIHsKCSAgICAgICAgdmFyIHZlcnNpb25OdW1iZXIgPSB2ZXJzaW9uLmdldFZlcnNpb25OdW1iZXIoKTsKCSAgICAgICAgdmFyIG9mZnNldDsKCSAgICAgICAgaWYgKHZlcnNpb25OdW1iZXIgPD0gOSkgewoJICAgICAgICAgICAgb2Zmc2V0ID0gMDsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmICh2ZXJzaW9uTnVtYmVyIDw9IDI2KSB7CgkgICAgICAgICAgICBvZmZzZXQgPSAxOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgb2Zmc2V0ID0gMjsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdGhpcy5jaGFyYWN0ZXJDb3VudEJpdHNGb3JWZXJzaW9uc1tvZmZzZXRdOwoJICAgIH07CgkgICAgTW9kZS5wcm90b3R5cGUuZ2V0VmFsdWUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnZhbHVlOwoJICAgIH07CgkgICAgTW9kZS5wcm90b3R5cGUuZ2V0Qml0cyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYml0czsKCSAgICB9OwoJICAgIE1vZGUucHJvdG90eXBlLmVxdWFscyA9IGZ1bmN0aW9uIChvKSB7CgkgICAgICAgIGlmICghKG8gaW5zdGFuY2VvZiBNb2RlKSkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHZhciBvdGhlciA9IG87CgkgICAgICAgIHJldHVybiB0aGlzLnZhbHVlID09PSBvdGhlci52YWx1ZTsKCSAgICB9OwoJICAgIE1vZGUucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5zdHJpbmdWYWx1ZTsKCSAgICB9OwoJICAgIE1vZGUuRk9SX0JJVFMgPSBuZXcgTWFwKCk7CgkgICAgTW9kZS5GT1JfVkFMVUUgPSBuZXcgTWFwKCk7CgkgICAgTW9kZS5URVJNSU5BVE9SID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5URVJNSU5BVE9SLCAnVEVSTUlOQVRPUicsIEludDMyQXJyYXkuZnJvbShbMCwgMCwgMF0pLCAweDAwKTsgLy8gTm90IHJlYWxseSBhIG1vZGUuLi4KCSAgICBNb2RlLk5VTUVSSUMgPSBuZXcgTW9kZShNb2RlVmFsdWVzLk5VTUVSSUMsICdOVU1FUklDJywgSW50MzJBcnJheS5mcm9tKFsxMCwgMTIsIDE0XSksIDB4MDEpOwoJICAgIE1vZGUuQUxQSEFOVU1FUklDID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5BTFBIQU5VTUVSSUMsICdBTFBIQU5VTUVSSUMnLCBJbnQzMkFycmF5LmZyb20oWzksIDExLCAxM10pLCAweDAyKTsKCSAgICBNb2RlLlNUUlVDVFVSRURfQVBQRU5EID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5TVFJVQ1RVUkVEX0FQUEVORCwgJ1NUUlVDVFVSRURfQVBQRU5EJywgSW50MzJBcnJheS5mcm9tKFswLCAwLCAwXSksIDB4MDMpOyAvLyBOb3Qgc3VwcG9ydGVkCgkgICAgTW9kZS5CWVRFID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5CWVRFLCAnQllURScsIEludDMyQXJyYXkuZnJvbShbOCwgMTYsIDE2XSksIDB4MDQpOwoJICAgIE1vZGUuRUNJID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5FQ0ksICdFQ0knLCBJbnQzMkFycmF5LmZyb20oWzAsIDAsIDBdKSwgMHgwNyk7IC8vIGNoYXJhY3RlciBjb3VudHMgZG9uJ3QgYXBwbHkKCSAgICBNb2RlLktBTkpJID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5LQU5KSSwgJ0tBTkpJJywgSW50MzJBcnJheS5mcm9tKFs4LCAxMCwgMTJdKSwgMHgwOCk7CgkgICAgTW9kZS5GTkMxX0ZJUlNUX1BPU0lUSU9OID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5GTkMxX0ZJUlNUX1BPU0lUSU9OLCAnRk5DMV9GSVJTVF9QT1NJVElPTicsIEludDMyQXJyYXkuZnJvbShbMCwgMCwgMF0pLCAweDA1KTsKCSAgICBNb2RlLkZOQzFfU0VDT05EX1BPU0lUSU9OID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5GTkMxX1NFQ09ORF9QT1NJVElPTiwgJ0ZOQzFfU0VDT05EX1BPU0lUSU9OJywgSW50MzJBcnJheS5mcm9tKFswLCAwLCAwXSksIDB4MDkpOwoJICAgIC8qKiBTZWUgR0JUIDE4Mjg0LTIwMDA7ICJIYW56aSIgaXMgYSB0cmFuc2xpdGVyYXRpb24gb2YgdGhpcyBtb2RlIG5hbWUuICovCgkgICAgTW9kZS5IQU5aSSA9IG5ldyBNb2RlKE1vZGVWYWx1ZXMuSEFOWkksICdIQU5aSScsIEludDMyQXJyYXkuZnJvbShbOCwgMTAsIDEyXSksIDB4MEQpOwoJICAgIHJldHVybiBNb2RlOwoJfSgpKTsKCWV4cG9ydHMuZGVmYXVsdCA9IE1vZGU7CgoJfShNb2RlKSk7CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShEZWNvZGVkQml0U3RyZWFtUGFyc2VyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcucXJjb2RlLmRlY29kZXIgeyovCgl2YXIgQml0U291cmNlXzEgPSBCaXRTb3VyY2UkMTsKCXZhciBDaGFyYWN0ZXJTZXRFQ0lfMSA9IENoYXJhY3RlclNldEVDSTsKCXZhciBEZWNvZGVyUmVzdWx0XzEgPSBEZWNvZGVyUmVzdWx0JDE7Cgl2YXIgU3RyaW5nVXRpbHNfMSA9IFN0cmluZ1V0aWxzJDE7Cgl2YXIgRm9ybWF0RXhjZXB0aW9uXzEgPSBGb3JtYXRFeGNlcHRpb24kMTsKCXZhciBTdHJpbmdCdWlsZGVyXzEgPSBTdHJpbmdCdWlsZGVyJDE7Cgl2YXIgU3RyaW5nRW5jb2RpbmdfMSA9IFN0cmluZ0VuY29kaW5nJDE7Cgl2YXIgTW9kZV8xID0gTW9kZTsKCS8qaW1wb3J0IGphdmEuaW8uVW5zdXBwb3J0ZWRFbmNvZGluZ0V4Y2VwdGlvbjsqLwoJLyppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsqLwoJLyppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5MaXN0OyovCgkvKmltcG9ydCBqYXZhLnV0aWwuTWFwOyovCgkvKioKCSAqIDxwPlFSIENvZGVzIGNhbiBlbmNvZGUgdGV4dCBhcyBiaXRzIGluIG9uZSBvZiBzZXZlcmFsIG1vZGVzLCBhbmQgY2FuIHVzZSBtdWx0aXBsZSBtb2RlcwoJICogaW4gb25lIFFSIENvZGUuIFRoaXMgY2xhc3MgZGVjb2RlcyB0aGUgYml0cyBiYWNrIGludG8gdGV4dC48L3A+CgkgKgoJICogPHA+U2VlIElTTyAxODAwNDoyMDA2LCA2LjQuMyAtIDYuNC43PC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBEZWNvZGVkQml0U3RyZWFtUGFyc2VyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIERlY29kZWRCaXRTdHJlYW1QYXJzZXIoKSB7CgkgICAgfQoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlID0gZnVuY3Rpb24gKGJ5dGVzLCB2ZXJzaW9uLCBlY0xldmVsLCBoaW50cykgewoJICAgICAgICB2YXIgYml0cyA9IG5ldyBCaXRTb3VyY2VfMS5kZWZhdWx0KGJ5dGVzKTsKCSAgICAgICAgdmFyIHJlc3VsdCA9IG5ldyBTdHJpbmdCdWlsZGVyXzEuZGVmYXVsdCgpOwoJICAgICAgICB2YXIgYnl0ZVNlZ21lbnRzID0gbmV3IEFycmF5KCk7IC8vIDEKCSAgICAgICAgLy8gVFlQRVNDUklQVFBPUlQ6IEkgZG8gbm90IHVzZSBjb25zdHJ1Y3RvciB3aXRoIHNpemUgMSBhcyBpbiBvcmlnaW5hbCBKYXZhIG1lYW5zIGNhcGFjaXR5IGFuZCB0aGUgYXJyYXkgbGVuZ3RoIGlzIGNoZWNrZWQgYmVsb3cKCSAgICAgICAgdmFyIHN5bWJvbFNlcXVlbmNlID0gLTE7CgkgICAgICAgIHZhciBwYXJpdHlEYXRhID0gLTE7CgkgICAgICAgIHRyeSB7CgkgICAgICAgICAgICB2YXIgY3VycmVudENoYXJhY3RlclNldEVDSSA9IG51bGw7CgkgICAgICAgICAgICB2YXIgZmMxSW5FZmZlY3QgPSBmYWxzZTsKCSAgICAgICAgICAgIHZhciBtb2RlID0gdm9pZCAwOwoJICAgICAgICAgICAgZG8gewoJICAgICAgICAgICAgICAgIC8vIFdoaWxlIHN0aWxsIGFub3RoZXIgc2VnbWVudCB0byByZWFkLi4uCgkgICAgICAgICAgICAgICAgaWYgKGJpdHMuYXZhaWxhYmxlKCkgPCA0KSB7CgkgICAgICAgICAgICAgICAgICAgIC8vIE9LLCBhc3N1bWUgd2UncmUgZG9uZS4gUmVhbGx5LCBhIFRFUk1JTkFUT1IgbW9kZSBzaG91bGQgaGF2ZSBiZWVuIHJlY29yZGVkIGhlcmUKCSAgICAgICAgICAgICAgICAgICAgbW9kZSA9IE1vZGVfMS5kZWZhdWx0LlRFUk1JTkFUT1I7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgICAgICAgICB2YXIgbW9kZUJpdHMgPSBiaXRzLnJlYWRCaXRzKDQpOwoJICAgICAgICAgICAgICAgICAgICBtb2RlID0gTW9kZV8xLmRlZmF1bHQuZm9yQml0cyhtb2RlQml0cyk7IC8vIG1vZGUgaXMgZW5jb2RlZCBieSA0IGJpdHMKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgc3dpdGNoIChtb2RlKSB7CgkgICAgICAgICAgICAgICAgICAgIGNhc2UgTW9kZV8xLmRlZmF1bHQuVEVSTUlOQVRPUjoKCSAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICBjYXNlIE1vZGVfMS5kZWZhdWx0LkZOQzFfRklSU1RfUE9TSVRJT046CgkgICAgICAgICAgICAgICAgICAgIGNhc2UgTW9kZV8xLmRlZmF1bHQuRk5DMV9TRUNPTkRfUE9TSVRJT046CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBXZSBkbyBsaXR0bGUgd2l0aCBGTkMxIGV4Y2VwdCBhbHRlciB0aGUgcGFyc2VkIHJlc3VsdCBhIGJpdCBhY2NvcmRpbmcgdG8gdGhlIHNwZWMKCSAgICAgICAgICAgICAgICAgICAgICAgIGZjMUluRWZmZWN0ID0gdHJ1ZTsKCSAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICBjYXNlIE1vZGVfMS5kZWZhdWx0LlNUUlVDVFVSRURfQVBQRU5EOgoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJpdHMuYXZhaWxhYmxlKCkgPCAxNikgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBzZXF1ZW5jZSBudW1iZXIgYW5kIHBhcml0eSBpcyBhZGRlZCBsYXRlciB0byB0aGUgcmVzdWx0IG1ldGFkYXRhCgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBSZWFkIG5leHQgOCBiaXRzIChzeW1ib2wgc2VxdWVuY2UgIykgYW5kIDggYml0cyAoZGF0YTogcGFyaXR5KSwgdGhlbiBjb250aW51ZQoJICAgICAgICAgICAgICAgICAgICAgICAgc3ltYm9sU2VxdWVuY2UgPSBiaXRzLnJlYWRCaXRzKDgpOwoJICAgICAgICAgICAgICAgICAgICAgICAgcGFyaXR5RGF0YSA9IGJpdHMucmVhZEJpdHMoOCk7CgkgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgY2FzZSBNb2RlXzEuZGVmYXVsdC5FQ0k6CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBDb3VudCBkb2Vzbid0IGFwcGx5IHRvIEVDSQoJICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5wYXJzZUVDSVZhbHVlKGJpdHMpOwoJICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudENoYXJhY3RlclNldEVDSSA9IENoYXJhY3RlclNldEVDSV8xLmRlZmF1bHQuZ2V0Q2hhcmFjdGVyU2V0RUNJQnlWYWx1ZSh2YWx1ZSk7CgkgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudENoYXJhY3RlclNldEVDSSA9PT0gbnVsbCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgY2FzZSBNb2RlXzEuZGVmYXVsdC5IQU5aSToKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZpcnN0IGhhbmRsZSBIYW56aSBtb2RlIHdoaWNoIGRvZXMgbm90IHN0YXJ0IHdpdGggY2hhcmFjdGVyIGNvdW50CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBDaGluZXNlIG1vZGUgY29udGFpbnMgYSBzdWIgc2V0IGluZGljYXRvciByaWdodCBhZnRlciBtb2RlIGluZGljYXRvcgoJICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YnNldCA9IGJpdHMucmVhZEJpdHMoNCk7CgkgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY291bnRIYW56aSA9IGJpdHMucmVhZEJpdHMobW9kZS5nZXRDaGFyYWN0ZXJDb3VudEJpdHModmVyc2lvbikpOwoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN1YnNldCA9PT0gRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5HQjIzMTJfU1VCU0VUKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5kZWNvZGVIYW56aVNlZ21lbnQoYml0cywgcmVzdWx0LCBjb3VudEhhbnppKTsKCSAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OgoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gIk5vcm1hbCIgUVIgY29kZSBtb2RlczoKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIEhvdyBtYW55IGNoYXJhY3RlcnMgd2lsbCBmb2xsb3csIGVuY29kZWQgaW4gdGhpcyBtb2RlPwoJICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvdW50ID0gYml0cy5yZWFkQml0cyhtb2RlLmdldENoYXJhY3RlckNvdW50Qml0cyh2ZXJzaW9uKSk7CgkgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKG1vZGUpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIE1vZGVfMS5kZWZhdWx0Lk5VTUVSSUM6CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlTnVtZXJpY1NlZ21lbnQoYml0cywgcmVzdWx0LCBjb3VudCk7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgTW9kZV8xLmRlZmF1bHQuQUxQSEFOVU1FUklDOgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBEZWNvZGVkQml0U3RyZWFtUGFyc2VyLmRlY29kZUFscGhhbnVtZXJpY1NlZ21lbnQoYml0cywgcmVzdWx0LCBjb3VudCwgZmMxSW5FZmZlY3QpOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIE1vZGVfMS5kZWZhdWx0LkJZVEU6CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlQnl0ZVNlZ21lbnQoYml0cywgcmVzdWx0LCBjb3VudCwgY3VycmVudENoYXJhY3RlclNldEVDSSwgYnl0ZVNlZ21lbnRzLCBoaW50cyk7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgTW9kZV8xLmRlZmF1bHQuS0FOSkk6CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlS2FuamlTZWdtZW50KGJpdHMsIHJlc3VsdCwgY291bnQpOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfSB3aGlsZSAobW9kZSAhPT0gTW9kZV8xLmRlZmF1bHQuVEVSTUlOQVRPUik7CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGlhZSAvKjogSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKi8pIHsKCSAgICAgICAgICAgIC8vIGZyb20gcmVhZEJpdHMoKSBjYWxscwoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gbmV3IERlY29kZXJSZXN1bHRfMS5kZWZhdWx0KGJ5dGVzLCByZXN1bHQudG9TdHJpbmcoKSwgYnl0ZVNlZ21lbnRzLmxlbmd0aCA9PT0gMCA/IG51bGwgOiBieXRlU2VnbWVudHMsIGVjTGV2ZWwgPT09IG51bGwgPyBudWxsIDogZWNMZXZlbC50b1N0cmluZygpLCBzeW1ib2xTZXF1ZW5jZSwgcGFyaXR5RGF0YSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBTZWUgc3BlY2lmaWNhdGlvbiBHQlQgMTgyODQtMjAwMAoJICAgICAqLwoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlSGFuemlTZWdtZW50ID0gZnVuY3Rpb24gKGJpdHMsIHJlc3VsdCwgY291bnQgLyppbnQqLykgewoJICAgICAgICAvLyBEb24ndCBjcmFzaCB0cnlpbmcgdG8gcmVhZCBtb3JlIGJpdHMgdGhhbiB3ZSBoYXZlIGF2YWlsYWJsZS4KCSAgICAgICAgaWYgKGNvdW50ICogMTMgPiBiaXRzLmF2YWlsYWJsZSgpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIC8vIEVhY2ggY2hhcmFjdGVyIHdpbGwgcmVxdWlyZSAyIGJ5dGVzLiBSZWFkIHRoZSBjaGFyYWN0ZXJzIGFzIDItYnl0ZSBwYWlycwoJICAgICAgICAvLyBhbmQgZGVjb2RlIGFzIEdCMjMxMiBhZnRlcndhcmRzCgkgICAgICAgIHZhciBidWZmZXIgPSBuZXcgVWludDhBcnJheSgyICogY291bnQpOwoJICAgICAgICB2YXIgb2Zmc2V0ID0gMDsKCSAgICAgICAgd2hpbGUgKGNvdW50ID4gMCkgewoJICAgICAgICAgICAgLy8gRWFjaCAxMyBiaXRzIGVuY29kZXMgYSAyLWJ5dGUgY2hhcmFjdGVyCgkgICAgICAgICAgICB2YXIgdHdvQnl0ZXMgPSBiaXRzLnJlYWRCaXRzKDEzKTsKCSAgICAgICAgICAgIHZhciBhc3NlbWJsZWRUd29CeXRlcyA9ICgoKHR3b0J5dGVzIC8gMHgwNjApIDw8IDgpICYgMHhGRkZGRkZGRikgfCAodHdvQnl0ZXMgJSAweDA2MCk7CgkgICAgICAgICAgICBpZiAoYXNzZW1ibGVkVHdvQnl0ZXMgPCAweDAwM0JGKSB7CgkgICAgICAgICAgICAgICAgLy8gSW4gdGhlIDB4QTFBMSB0byAweEFBRkUgcmFuZ2UKCSAgICAgICAgICAgICAgICBhc3NlbWJsZWRUd29CeXRlcyArPSAweDBBMUExOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgLy8gSW4gdGhlIDB4QjBBMSB0byAweEZBRkUgcmFuZ2UKCSAgICAgICAgICAgICAgICBhc3NlbWJsZWRUd29CeXRlcyArPSAweDBBNkExOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgYnVmZmVyW29mZnNldF0gPSAvKihieXRlKSAqLyAoKGFzc2VtYmxlZFR3b0J5dGVzID4+IDgpICYgMHhGRik7CgkgICAgICAgICAgICBidWZmZXJbb2Zmc2V0ICsgMV0gPSAvKihieXRlKSAqLyAoYXNzZW1ibGVkVHdvQnl0ZXMgJiAweEZGKTsKCSAgICAgICAgICAgIG9mZnNldCArPSAyOwoJICAgICAgICAgICAgY291bnQtLTsKCSAgICAgICAgfQoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChTdHJpbmdFbmNvZGluZ18xLmRlZmF1bHQuZGVjb2RlKGJ1ZmZlciwgU3RyaW5nVXRpbHNfMS5kZWZhdWx0LkdCMjMxMikpOwoJICAgICAgICAgICAgLy8gVFlQRVNDUklQVFBPUlQ6IFRPRE86IGltcGxlbWVudCBHQjIzMTIgZGVjb2RlLiBTdHJpbmdWaWV3IGZyb20gTUROIGNvdWxkIGJlIGEgc3RhcnRpbmcgcG9pbnQKCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoaWdub3JlZCAvKjogVW5zdXBwb3J0ZWRFbmNvZGluZ0V4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdChpZ25vcmVkKTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5kZWNvZGVLYW5qaVNlZ21lbnQgPSBmdW5jdGlvbiAoYml0cywgcmVzdWx0LCBjb3VudCAvKmludCovKSB7CgkgICAgICAgIC8vIERvbid0IGNyYXNoIHRyeWluZyB0byByZWFkIG1vcmUgYml0cyB0aGFuIHdlIGhhdmUgYXZhaWxhYmxlLgoJICAgICAgICBpZiAoY291bnQgKiAxMyA+IGJpdHMuYXZhaWxhYmxlKCkpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gRWFjaCBjaGFyYWN0ZXIgd2lsbCByZXF1aXJlIDIgYnl0ZXMuIFJlYWQgdGhlIGNoYXJhY3RlcnMgYXMgMi1ieXRlIHBhaXJzCgkgICAgICAgIC8vIGFuZCBkZWNvZGUgYXMgU2hpZnRfSklTIGFmdGVyd2FyZHMKCSAgICAgICAgdmFyIGJ1ZmZlciA9IG5ldyBVaW50OEFycmF5KDIgKiBjb3VudCk7CgkgICAgICAgIHZhciBvZmZzZXQgPSAwOwoJICAgICAgICB3aGlsZSAoY291bnQgPiAwKSB7CgkgICAgICAgICAgICAvLyBFYWNoIDEzIGJpdHMgZW5jb2RlcyBhIDItYnl0ZSBjaGFyYWN0ZXIKCSAgICAgICAgICAgIHZhciB0d29CeXRlcyA9IGJpdHMucmVhZEJpdHMoMTMpOwoJICAgICAgICAgICAgdmFyIGFzc2VtYmxlZFR3b0J5dGVzID0gKCgodHdvQnl0ZXMgLyAweDBDMCkgPDwgOCkgJiAweEZGRkZGRkZGKSB8ICh0d29CeXRlcyAlIDB4MEMwKTsKCSAgICAgICAgICAgIGlmIChhc3NlbWJsZWRUd29CeXRlcyA8IDB4MDFGMDApIHsKCSAgICAgICAgICAgICAgICAvLyBJbiB0aGUgMHg4MTQwIHRvIDB4OUZGQyByYW5nZQoJICAgICAgICAgICAgICAgIGFzc2VtYmxlZFR3b0J5dGVzICs9IDB4MDgxNDA7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAvLyBJbiB0aGUgMHhFMDQwIHRvIDB4RUJCRiByYW5nZQoJICAgICAgICAgICAgICAgIGFzc2VtYmxlZFR3b0J5dGVzICs9IDB4MEMxNDA7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBidWZmZXJbb2Zmc2V0XSA9IC8qKGJ5dGUpICovIChhc3NlbWJsZWRUd29CeXRlcyA+PiA4KTsKCSAgICAgICAgICAgIGJ1ZmZlcltvZmZzZXQgKyAxXSA9IC8qKGJ5dGUpICovIGFzc2VtYmxlZFR3b0J5dGVzOwoJICAgICAgICAgICAgb2Zmc2V0ICs9IDI7CgkgICAgICAgICAgICBjb3VudC0tOwoJICAgICAgICB9CgkgICAgICAgIC8vIFNoaWZ0X0pJUyBtYXkgbm90IGJlIHN1cHBvcnRlZCBpbiBzb21lIGVudmlyb25tZW50czoKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoU3RyaW5nRW5jb2RpbmdfMS5kZWZhdWx0LmRlY29kZShidWZmZXIsIFN0cmluZ1V0aWxzXzEuZGVmYXVsdC5TSElGVF9KSVMpKTsKCSAgICAgICAgICAgIC8vIFRZUEVTQ1JJUFRQT1JUOiBUT0RPOiBpbXBsZW1lbnQgU0hJRlRfSklTIGRlY29kZS4gU3RyaW5nVmlldyBmcm9tIE1ETiBjb3VsZCBiZSBhIHN0YXJ0aW5nIHBvaW50CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGlnbm9yZWQgLyo6IFVuc3VwcG9ydGVkRW5jb2RpbmdFeGNlcHRpb24qLykgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoaWdub3JlZCk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlQnl0ZVNlZ21lbnQgPSBmdW5jdGlvbiAoYml0cywgcmVzdWx0LCBjb3VudCAvKmludCovLCBjdXJyZW50Q2hhcmFjdGVyU2V0RUNJLCBieXRlU2VnbWVudHMsIGhpbnRzKSB7CgkgICAgICAgIC8vIERvbid0IGNyYXNoIHRyeWluZyB0byByZWFkIG1vcmUgYml0cyB0aGFuIHdlIGhhdmUgYXZhaWxhYmxlLgoJICAgICAgICBpZiAoOCAqIGNvdW50ID4gYml0cy5hdmFpbGFibGUoKSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgcmVhZEJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoY291bnQpOwoJICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKCSAgICAgICAgICAgIHJlYWRCeXRlc1tpXSA9IC8qKGJ5dGUpICovIGJpdHMucmVhZEJpdHMoOCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGVuY29kaW5nOwoJICAgICAgICBpZiAoY3VycmVudENoYXJhY3RlclNldEVDSSA9PT0gbnVsbCkgewoJICAgICAgICAgICAgLy8gVGhlIHNwZWMgaXNuJ3QgY2xlYXIgb24gdGhpcyBtb2RlOyBzZWUKCSAgICAgICAgICAgIC8vIHNlY3Rpb24gNi40LjU6IHQgZG9lcyBub3Qgc2F5IHdoaWNoIGVuY29kaW5nIHRvIGFzc3VtaW5nCgkgICAgICAgICAgICAvLyB1cG9uIGRlY29kaW5nLiBJIGhhdmUgc2VlbiBJU08tODg1OS0xIHVzZWQgYXMgd2VsbCBhcwoJICAgICAgICAgICAgLy8gU2hpZnRfSklTIC0tIHdpdGhvdXQgYW55dGhpbmcgbGlrZSBhbiBFQ0kgZGVzaWduYXRvciB0bwoJICAgICAgICAgICAgLy8gZ2l2ZSBhIGhpbnQuCgkgICAgICAgICAgICBlbmNvZGluZyA9IFN0cmluZ1V0aWxzXzEuZGVmYXVsdC5ndWVzc0VuY29kaW5nKHJlYWRCeXRlcywgaGludHMpOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgZW5jb2RpbmcgPSBjdXJyZW50Q2hhcmFjdGVyU2V0RUNJLmdldE5hbWUoKTsKCSAgICAgICAgfQoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChTdHJpbmdFbmNvZGluZ18xLmRlZmF1bHQuZGVjb2RlKHJlYWRCeXRlcywgZW5jb2RpbmcpKTsKCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoaWdub3JlZCAvKjogVW5zdXBwb3J0ZWRFbmNvZGluZ0V4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdChpZ25vcmVkKTsKCSAgICAgICAgfQoJICAgICAgICBieXRlU2VnbWVudHMucHVzaChyZWFkQnl0ZXMpOwoJICAgIH07CgkgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIgPSBmdW5jdGlvbiAodmFsdWUgLyppbnQqLykgewoJICAgICAgICBpZiAodmFsdWUgPj0gRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5BTFBIQU5VTUVSSUNfQ0hBUlMubGVuZ3RoKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBEZWNvZGVkQml0U3RyZWFtUGFyc2VyLkFMUEhBTlVNRVJJQ19DSEFSU1t2YWx1ZV07CgkgICAgfTsKCSAgICBEZWNvZGVkQml0U3RyZWFtUGFyc2VyLmRlY29kZUFscGhhbnVtZXJpY1NlZ21lbnQgPSBmdW5jdGlvbiAoYml0cywgcmVzdWx0LCBjb3VudCAvKmludCovLCBmYzFJbkVmZmVjdCkgewoJICAgICAgICAvLyBSZWFkIHR3byBjaGFyYWN0ZXJzIGF0IGEgdGltZQoJICAgICAgICB2YXIgc3RhcnQgPSByZXN1bHQubGVuZ3RoKCk7CgkgICAgICAgIHdoaWxlIChjb3VudCA+IDEpIHsKCSAgICAgICAgICAgIGlmIChiaXRzLmF2YWlsYWJsZSgpIDwgMTEpIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgdmFyIG5leHRUd29DaGFyc0JpdHMgPSBiaXRzLnJlYWRCaXRzKDExKTsKCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIoTWF0aC5mbG9vcihuZXh0VHdvQ2hhcnNCaXRzIC8gNDUpKSk7CgkgICAgICAgICAgICByZXN1bHQuYXBwZW5kKERlY29kZWRCaXRTdHJlYW1QYXJzZXIudG9BbHBoYU51bWVyaWNDaGFyKG5leHRUd29DaGFyc0JpdHMgJSA0NSkpOwoJICAgICAgICAgICAgY291bnQgLT0gMjsKCSAgICAgICAgfQoJICAgICAgICBpZiAoY291bnQgPT09IDEpIHsKCSAgICAgICAgICAgIC8vIHNwZWNpYWwgY2FzZTogb25lIGNoYXJhY3RlciBsZWZ0CgkgICAgICAgICAgICBpZiAoYml0cy5hdmFpbGFibGUoKSA8IDYpIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChEZWNvZGVkQml0U3RyZWFtUGFyc2VyLnRvQWxwaGFOdW1lcmljQ2hhcihiaXRzLnJlYWRCaXRzKDYpKSk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gU2VlIHNlY3Rpb24gNi40LjguMSwgNi40LjguMgoJICAgICAgICBpZiAoZmMxSW5FZmZlY3QpIHsKCSAgICAgICAgICAgIC8vIFdlIG5lZWQgdG8gbWFzc2FnZSB0aGUgcmVzdWx0IGEgYml0IGlmIGluIGFuIEZOQzEgbW9kZToKCSAgICAgICAgICAgIGZvciAodmFyIGkgPSBzdGFydDsgaSA8IHJlc3VsdC5sZW5ndGgoKTsgaSsrKSB7CgkgICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5jaGFyQXQoaSkgPT09ICclJykgewoJICAgICAgICAgICAgICAgICAgICBpZiAoaSA8IHJlc3VsdC5sZW5ndGgoKSAtIDEgJiYgcmVzdWx0LmNoYXJBdChpICsgMSkgPT09ICclJykgewoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gJSUgaXMgcmVuZGVyZWQgYXMgJQoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmRlbGV0ZUNoYXJBdChpICsgMSk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBJbiBhbHBoYSBtb2RlLCAlIHNob3VsZCBiZSBjb252ZXJ0ZWQgdG8gRk5DMSBzZXBhcmF0b3IgMHgxRAoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnNldENoYXJBdChpLCBTdHJpbmcuZnJvbUNoYXJDb2RlKDB4MUQpKTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgIH07CgkgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5kZWNvZGVOdW1lcmljU2VnbWVudCA9IGZ1bmN0aW9uIChiaXRzLCByZXN1bHQsIGNvdW50IC8qaW50Ki8pIHsKCSAgICAgICAgLy8gUmVhZCB0aHJlZSBkaWdpdHMgYXQgYSB0aW1lCgkgICAgICAgIHdoaWxlIChjb3VudCA+PSAzKSB7CgkgICAgICAgICAgICAvLyBFYWNoIDEwIGJpdHMgZW5jb2RlcyB0aHJlZSBkaWdpdHMKCSAgICAgICAgICAgIGlmIChiaXRzLmF2YWlsYWJsZSgpIDwgMTApIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgdmFyIHRocmVlRGlnaXRzQml0cyA9IGJpdHMucmVhZEJpdHMoMTApOwoJICAgICAgICAgICAgaWYgKHRocmVlRGlnaXRzQml0cyA+PSAxMDAwKSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIoTWF0aC5mbG9vcih0aHJlZURpZ2l0c0JpdHMgLyAxMDApKSk7CgkgICAgICAgICAgICByZXN1bHQuYXBwZW5kKERlY29kZWRCaXRTdHJlYW1QYXJzZXIudG9BbHBoYU51bWVyaWNDaGFyKE1hdGguZmxvb3IodGhyZWVEaWdpdHNCaXRzIC8gMTApICUgMTApKTsKCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIodGhyZWVEaWdpdHNCaXRzICUgMTApKTsKCSAgICAgICAgICAgIGNvdW50IC09IDM7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNvdW50ID09PSAyKSB7CgkgICAgICAgICAgICAvLyBUd28gZGlnaXRzIGxlZnQgb3ZlciB0byByZWFkLCBlbmNvZGVkIGluIDcgYml0cwoJICAgICAgICAgICAgaWYgKGJpdHMuYXZhaWxhYmxlKCkgPCA3KSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHZhciB0d29EaWdpdHNCaXRzID0gYml0cy5yZWFkQml0cyg3KTsKCSAgICAgICAgICAgIGlmICh0d29EaWdpdHNCaXRzID49IDEwMCkgewoJICAgICAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICByZXN1bHQuYXBwZW5kKERlY29kZWRCaXRTdHJlYW1QYXJzZXIudG9BbHBoYU51bWVyaWNDaGFyKE1hdGguZmxvb3IodHdvRGlnaXRzQml0cyAvIDEwKSkpOwoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChEZWNvZGVkQml0U3RyZWFtUGFyc2VyLnRvQWxwaGFOdW1lcmljQ2hhcih0d29EaWdpdHNCaXRzICUgMTApKTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmIChjb3VudCA9PT0gMSkgewoJICAgICAgICAgICAgLy8gT25lIGRpZ2l0IGxlZnQgb3ZlciB0byByZWFkCgkgICAgICAgICAgICBpZiAoYml0cy5hdmFpbGFibGUoKSA8IDQpIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgdmFyIGRpZ2l0Qml0cyA9IGJpdHMucmVhZEJpdHMoNCk7CgkgICAgICAgICAgICBpZiAoZGlnaXRCaXRzID49IDEwKSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIoZGlnaXRCaXRzKSk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIucGFyc2VFQ0lWYWx1ZSA9IGZ1bmN0aW9uIChiaXRzKSB7CgkgICAgICAgIHZhciBmaXJzdEJ5dGUgPSBiaXRzLnJlYWRCaXRzKDgpOwoJICAgICAgICBpZiAoKGZpcnN0Qnl0ZSAmIDB4ODApID09PSAwKSB7CgkgICAgICAgICAgICAvLyBqdXN0IG9uZSBieXRlCgkgICAgICAgICAgICByZXR1cm4gZmlyc3RCeXRlICYgMHg3RjsKCSAgICAgICAgfQoJICAgICAgICBpZiAoKGZpcnN0Qnl0ZSAmIDB4QzApID09PSAweDgwKSB7CgkgICAgICAgICAgICAvLyB0d28gYnl0ZXMKCSAgICAgICAgICAgIHZhciBzZWNvbmRCeXRlID0gYml0cy5yZWFkQml0cyg4KTsKCSAgICAgICAgICAgIHJldHVybiAoKChmaXJzdEJ5dGUgJiAweDNGKSA8PCA4KSAmIDB4RkZGRkZGRkYpIHwgc2Vjb25kQnl0ZTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoKGZpcnN0Qnl0ZSAmIDB4RTApID09PSAweEMwKSB7CgkgICAgICAgICAgICAvLyB0aHJlZSBieXRlcwoJICAgICAgICAgICAgdmFyIHNlY29uZFRoaXJkQnl0ZXMgPSBiaXRzLnJlYWRCaXRzKDE2KTsKCSAgICAgICAgICAgIHJldHVybiAoKChmaXJzdEJ5dGUgJiAweDFGKSA8PCAxNikgJiAweEZGRkZGRkZGKSB8IHNlY29uZFRoaXJkQnl0ZXM7CgkgICAgICAgIH0KCSAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFNlZSBJU08gMTgwMDQ6MjAwNiwgNi40LjQgVGFibGUgNQoJICAgICAqLwoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuQUxQSEFOVU1FUklDX0NIQVJTID0gJzAxMjM0NTY3ODlBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWiAkJSorLS4vOic7CgkgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5HQjIzMTJfU1VCU0VUID0gMTsKCSAgICByZXR1cm4gRGVjb2RlZEJpdFN0cmVhbVBhcnNlcjsKCX0oKSk7CglEZWNvZGVkQml0U3RyZWFtUGFyc2VyJDEuZGVmYXVsdCA9IERlY29kZWRCaXRTdHJlYW1QYXJzZXI7CgoJdmFyIFFSQ29kZURlY29kZXJNZXRhRGF0YSQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDEzIFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShRUkNvZGVEZWNvZGVyTWV0YURhdGEkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLyoqCgkgKiBNZXRhLWRhdGEgY29udGFpbmVyIGZvciBRUiBDb2RlIGRlY29kaW5nLiBJbnN0YW5jZXMgb2YgdGhpcyBjbGFzcyBtYXkgYmUgdXNlZCB0byBjb252ZXkgaW5mb3JtYXRpb24gYmFjayB0byB0aGUKCSAqIGRlY29kaW5nIGNhbGxlci4gQ2FsbGVycyBhcmUgZXhwZWN0ZWQgdG8gcHJvY2VzcyB0aGlzLgoJICoKCSAqIEBzZWUgY29tLmdvb2dsZS56eGluZy5jb21tb24uRGVjb2RlclJlc3VsdCNnZXRPdGhlcigpCgkgKi8KCXZhciBRUkNvZGVEZWNvZGVyTWV0YURhdGEgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gUVJDb2RlRGVjb2Rlck1ldGFEYXRhKG1pcnJvcmVkKSB7CgkgICAgICAgIHRoaXMubWlycm9yZWQgPSBtaXJyb3JlZDsKCSAgICB9CgkgICAgLyoqCgkgICAgICogQHJldHVybiB0cnVlIGlmIHRoZSBRUiBDb2RlIHdhcyBtaXJyb3JlZC4KCSAgICAgKi8KCSAgICBRUkNvZGVEZWNvZGVyTWV0YURhdGEucHJvdG90eXBlLmlzTWlycm9yZWQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm1pcnJvcmVkOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQXBwbHkgdGhlIHJlc3VsdCBwb2ludHMnIG9yZGVyIGNvcnJlY3Rpb24gZHVlIHRvIG1pcnJvcmluZy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBwb2ludHMgQXJyYXkgb2YgcG9pbnRzIHRvIGFwcGx5IG1pcnJvciBjb3JyZWN0aW9uIHRvLgoJICAgICAqLwoJICAgIFFSQ29kZURlY29kZXJNZXRhRGF0YS5wcm90b3R5cGUuYXBwbHlNaXJyb3JlZENvcnJlY3Rpb24gPSBmdW5jdGlvbiAocG9pbnRzKSB7CgkgICAgICAgIGlmICghdGhpcy5taXJyb3JlZCB8fCBwb2ludHMgPT09IG51bGwgfHwgcG9pbnRzLmxlbmd0aCA8IDMpIHsKCSAgICAgICAgICAgIHJldHVybjsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYm90dG9tTGVmdCA9IHBvaW50c1swXTsKCSAgICAgICAgcG9pbnRzWzBdID0gcG9pbnRzWzJdOwoJICAgICAgICBwb2ludHNbMl0gPSBib3R0b21MZWZ0OwoJICAgICAgICAvLyBObyBuZWVkIHRvICdmaXgnIHRvcC1sZWZ0IGFuZCBhbGlnbm1lbnQgcGF0dGVybi4KCSAgICB9OwoJICAgIHJldHVybiBRUkNvZGVEZWNvZGVyTWV0YURhdGE7Cgl9KCkpOwoJUVJDb2RlRGVjb2Rlck1ldGFEYXRhJDEuZGVmYXVsdCA9IFFSQ29kZURlY29kZXJNZXRhRGF0YTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzJDIgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX192YWx1ZXMpIHx8IGZ1bmN0aW9uKG8pIHsKCSAgICB2YXIgcyA9IHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgU3ltYm9sLml0ZXJhdG9yLCBtID0gcyAmJiBvW3NdLCBpID0gMDsKCSAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTsKCSAgICBpZiAobyAmJiB0eXBlb2Ygby5sZW5ndGggPT09ICJudW1iZXIiKSByZXR1cm4gewoJICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwOwoJICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9OwoJICAgICAgICB9CgkgICAgfTsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKHMgPyAiT2JqZWN0IGlzIG5vdCBpdGVyYWJsZS4iIDogIlN5bWJvbC5pdGVyYXRvciBpcyBub3QgZGVmaW5lZC4iKTsKCX07CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRGVjb2RlciQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLnFyY29kZS5kZWNvZGVyIHsqLwoJdmFyIENoZWNrc3VtRXhjZXB0aW9uXzEgPSBDaGVja3N1bUV4Y2VwdGlvbiQxOwoJdmFyIEJpdE1hdHJpeF8xJDIgPSBCaXRNYXRyaXgkMTsKCXZhciBHZW5lcmljR0ZfMSA9IEdlbmVyaWNHRiQxOwoJdmFyIFJlZWRTb2xvbW9uRGVjb2Rlcl8xID0gUmVlZFNvbG9tb25EZWNvZGVyJDE7Cgl2YXIgQml0TWF0cml4UGFyc2VyXzEgPSBCaXRNYXRyaXhQYXJzZXIkMTsKCXZhciBEYXRhQmxvY2tfMSA9IERhdGFCbG9jayQxOwoJdmFyIERlY29kZWRCaXRTdHJlYW1QYXJzZXJfMSA9IERlY29kZWRCaXRTdHJlYW1QYXJzZXIkMTsKCXZhciBRUkNvZGVEZWNvZGVyTWV0YURhdGFfMSQxID0gUVJDb2RlRGVjb2Rlck1ldGFEYXRhJDE7CgkvKmltcG9ydCBqYXZhLnV0aWwuTWFwOyovCgkvKioKCSAqIDxwPlRoZSBtYWluIGNsYXNzIHdoaWNoIGltcGxlbWVudHMgUVIgQ29kZSBkZWNvZGluZyAtLSBhcyBvcHBvc2VkIHRvIGxvY2F0aW5nIGFuZCBleHRyYWN0aW5nCgkgKiB0aGUgUVIgQ29kZSBmcm9tIGFuIGltYWdlLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgRGVjb2RlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBEZWNvZGVyKCkgewoJICAgICAgICB0aGlzLnJzRGVjb2RlciA9IG5ldyBSZWVkU29sb21vbkRlY29kZXJfMS5kZWZhdWx0KEdlbmVyaWNHRl8xLmRlZmF1bHQuUVJfQ09ERV9GSUVMRF8yNTYpOwoJICAgIH0KCSAgICAvLyBwdWJsaWMgZGVjb2RlKGltYWdlOiBib29sZWFuW11bXSk6IERlY29kZXJSZXN1bHQgLyp0aHJvd3MgQ2hlY2tzdW1FeGNlcHRpb24sIEZvcm1hdEV4Y2VwdGlvbiovIHsKCSAgICAvLyAgIHJldHVybiBkZWNvZGUoaW1hZ2UsIG51bGwpCgkgICAgLy8gfQoJICAgIC8qKgoJICAgICAqIDxwPkNvbnZlbmllbmNlIG1ldGhvZCB0aGF0IGNhbiBkZWNvZGUgYSBRUiBDb2RlIHJlcHJlc2VudGVkIGFzIGEgMkQgYXJyYXkgb2YgYm9vbGVhbnMuCgkgICAgICogInRydWUiIGlzIHRha2VuIHRvIG1lYW4gYSBibGFjayBtb2R1bGUuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGltYWdlIGJvb2xlYW5zIHJlcHJlc2VudGluZyB3aGl0ZS9ibGFjayBRUiBDb2RlIG1vZHVsZXMKCSAgICAgKiBAcGFyYW0gaGludHMgZGVjb2RpbmcgaGludHMgdGhhdCBzaG91bGQgYmUgdXNlZCB0byBpbmZsdWVuY2UgZGVjb2RpbmcKCSAgICAgKiBAcmV0dXJuIHRleHQgYW5kIGJ5dGVzIGVuY29kZWQgd2l0aGluIHRoZSBRUiBDb2RlCgkgICAgICogQHRocm93cyBGb3JtYXRFeGNlcHRpb24gaWYgdGhlIFFSIENvZGUgY2Fubm90IGJlIGRlY29kZWQKCSAgICAgKiBAdGhyb3dzIENoZWNrc3VtRXhjZXB0aW9uIGlmIGVycm9yIGNvcnJlY3Rpb24gZmFpbHMKCSAgICAgKi8KCSAgICBEZWNvZGVyLnByb3RvdHlwZS5kZWNvZGVCb29sZWFuQXJyYXkgPSBmdW5jdGlvbiAoaW1hZ2UsIGhpbnRzKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRlY29kZUJpdE1hdHJpeChCaXRNYXRyaXhfMSQyLmRlZmF1bHQucGFyc2VGcm9tQm9vbGVhbkFycmF5KGltYWdlKSwgaGludHMpOwoJICAgIH07CgkgICAgLy8gcHVibGljIGRlY29kZUJpdE1hdHJpeChiaXRzOiBCaXRNYXRyaXgpOiBEZWNvZGVyUmVzdWx0IC8qdGhyb3dzIENoZWNrc3VtRXhjZXB0aW9uLCBGb3JtYXRFeGNlcHRpb24qLyB7CgkgICAgLy8gICByZXR1cm4gZGVjb2RlKGJpdHMsIG51bGwpCgkgICAgLy8gfQoJICAgIC8qKgoJICAgICAqIDxwPkRlY29kZXMgYSBRUiBDb2RlIHJlcHJlc2VudGVkIGFzIGEge0BsaW5rIEJpdE1hdHJpeH0uIEEgMSBvciAidHJ1ZSIgaXMgdGFrZW4gdG8gbWVhbiBhIGJsYWNrIG1vZHVsZS48L3A+CgkgICAgICoKCSAgICAgKiBAcGFyYW0gYml0cyBib29sZWFucyByZXByZXNlbnRpbmcgd2hpdGUvYmxhY2sgUVIgQ29kZSBtb2R1bGVzCgkgICAgICogQHBhcmFtIGhpbnRzIGRlY29kaW5nIGhpbnRzIHRoYXQgc2hvdWxkIGJlIHVzZWQgdG8gaW5mbHVlbmNlIGRlY29kaW5nCgkgICAgICogQHJldHVybiB0ZXh0IGFuZCBieXRlcyBlbmNvZGVkIHdpdGhpbiB0aGUgUVIgQ29kZQoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIHRoZSBRUiBDb2RlIGNhbm5vdCBiZSBkZWNvZGVkCgkgICAgICogQHRocm93cyBDaGVja3N1bUV4Y2VwdGlvbiBpZiBlcnJvciBjb3JyZWN0aW9uIGZhaWxzCgkgICAgICovCgkgICAgRGVjb2Rlci5wcm90b3R5cGUuZGVjb2RlQml0TWF0cml4ID0gZnVuY3Rpb24gKGJpdHMsIGhpbnRzKSB7CgkgICAgICAgIC8vIENvbnN0cnVjdCBhIHBhcnNlciBhbmQgcmVhZCB2ZXJzaW9uLCBlcnJvci1jb3JyZWN0aW9uIGxldmVsCgkgICAgICAgIHZhciBwYXJzZXIgPSBuZXcgQml0TWF0cml4UGFyc2VyXzEuZGVmYXVsdChiaXRzKTsKCSAgICAgICAgdmFyIGV4ID0gbnVsbDsKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLmRlY29kZUJpdE1hdHJpeFBhcnNlcihwYXJzZXIsIGhpbnRzKTsKCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZSAvKjogRm9ybWF0RXhjZXB0aW9uLCBDaGVja3N1bUV4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICBleCA9IGU7CgkgICAgICAgIH0KCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIC8vIFJldmVydCB0aGUgYml0IG1hdHJpeAoJICAgICAgICAgICAgcGFyc2VyLnJlbWFzaygpOwoJICAgICAgICAgICAgLy8gV2lsbCBiZSBhdHRlbXB0aW5nIGEgbWlycm9yZWQgcmVhZGluZyBvZiB0aGUgdmVyc2lvbiBhbmQgZm9ybWF0IGluZm8uCgkgICAgICAgICAgICBwYXJzZXIuc2V0TWlycm9yKHRydWUpOwoJICAgICAgICAgICAgLy8gUHJlZW1wdGl2ZWx5IHJlYWQgdGhlIHZlcnNpb24uCgkgICAgICAgICAgICBwYXJzZXIucmVhZFZlcnNpb24oKTsKCSAgICAgICAgICAgIC8vIFByZWVtcHRpdmVseSByZWFkIHRoZSBmb3JtYXQgaW5mb3JtYXRpb24uCgkgICAgICAgICAgICBwYXJzZXIucmVhZEZvcm1hdEluZm9ybWF0aW9uKCk7CgkgICAgICAgICAgICAvKgoJICAgICAgICAgICAgICogU2luY2Ugd2UncmUgaGVyZSwgdGhpcyBtZWFucyB3ZSBoYXZlIHN1Y2Nlc3NmdWxseSBkZXRlY3RlZCBzb21lIGtpbmQKCSAgICAgICAgICAgICAqIG9mIHZlcnNpb24gYW5kIGZvcm1hdCBpbmZvcm1hdGlvbiB3aGVuIG1pcnJvcmVkLiBUaGlzIGlzIGEgZ29vZCBzaWduLAoJICAgICAgICAgICAgICogdGhhdCB0aGUgUVIgY29kZSBtYXkgYmUgbWlycm9yZWQsIGFuZCB3ZSBzaG91bGQgdHJ5IG9uY2UgbW9yZSB3aXRoIGEKCSAgICAgICAgICAgICAqIG1pcnJvcmVkIGNvbnRlbnQuCgkgICAgICAgICAgICAgKi8KCSAgICAgICAgICAgIC8vIFByZXBhcmUgZm9yIGEgbWlycm9yZWQgcmVhZGluZy4KCSAgICAgICAgICAgIHBhcnNlci5taXJyb3IoKTsKCSAgICAgICAgICAgIHZhciByZXN1bHQgPSB0aGlzLmRlY29kZUJpdE1hdHJpeFBhcnNlcihwYXJzZXIsIGhpbnRzKTsKCSAgICAgICAgICAgIC8vIFN1Y2Nlc3MhIE5vdGlmeSB0aGUgY2FsbGVyIHRoYXQgdGhlIGNvZGUgd2FzIG1pcnJvcmVkLgoJICAgICAgICAgICAgcmVzdWx0LnNldE90aGVyKG5ldyBRUkNvZGVEZWNvZGVyTWV0YURhdGFfMSQxLmRlZmF1bHQodHJ1ZSkpOwoJICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZSAvKkZvcm1hdEV4Y2VwdGlvbiB8IENoZWNrc3VtRXhjZXB0aW9uKi8pIHsKCSAgICAgICAgICAgIC8vIFRocm93IHRoZSBleGNlcHRpb24gZnJvbSB0aGUgb3JpZ2luYWwgcmVhZGluZwoJICAgICAgICAgICAgaWYgKGV4ICE9PSBudWxsKSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgZXg7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB0aHJvdyBlOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBEZWNvZGVyLnByb3RvdHlwZS5kZWNvZGVCaXRNYXRyaXhQYXJzZXIgPSBmdW5jdGlvbiAocGFyc2VyLCBoaW50cykgewoJICAgICAgICB2YXIgZV8xLCBfYSwgZV8yLCBfYjsKCSAgICAgICAgdmFyIHZlcnNpb24gPSBwYXJzZXIucmVhZFZlcnNpb24oKTsKCSAgICAgICAgdmFyIGVjTGV2ZWwgPSBwYXJzZXIucmVhZEZvcm1hdEluZm9ybWF0aW9uKCkuZ2V0RXJyb3JDb3JyZWN0aW9uTGV2ZWwoKTsKCSAgICAgICAgLy8gUmVhZCBjb2Rld29yZHMKCSAgICAgICAgdmFyIGNvZGV3b3JkcyA9IHBhcnNlci5yZWFkQ29kZXdvcmRzKCk7CgkgICAgICAgIC8vIFNlcGFyYXRlIGludG8gZGF0YSBibG9ja3MKCSAgICAgICAgdmFyIGRhdGFCbG9ja3MgPSBEYXRhQmxvY2tfMS5kZWZhdWx0LmdldERhdGFCbG9ja3MoY29kZXdvcmRzLCB2ZXJzaW9uLCBlY0xldmVsKTsKCSAgICAgICAgLy8gQ291bnQgdG90YWwgbnVtYmVyIG9mIGRhdGEgYnl0ZXMKCSAgICAgICAgdmFyIHRvdGFsQnl0ZXMgPSAwOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgZGF0YUJsb2Nrc18xID0gX192YWx1ZXMkMihkYXRhQmxvY2tzKSwgZGF0YUJsb2Nrc18xXzEgPSBkYXRhQmxvY2tzXzEubmV4dCgpOyAhZGF0YUJsb2Nrc18xXzEuZG9uZTsgZGF0YUJsb2Nrc18xXzEgPSBkYXRhQmxvY2tzXzEubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGRhdGFCbG9jayA9IGRhdGFCbG9ja3NfMV8xLnZhbHVlOwoJICAgICAgICAgICAgICAgIHRvdGFsQnl0ZXMgKz0gZGF0YUJsb2NrLmdldE51bURhdGFDb2Rld29yZHMoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZV8xXzEpIHsgZV8xID0geyBlcnJvcjogZV8xXzEgfTsgfQoJICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgaWYgKGRhdGFCbG9ja3NfMV8xICYmICFkYXRhQmxvY2tzXzFfMS5kb25lICYmIChfYSA9IGRhdGFCbG9ja3NfMS5yZXR1cm4pKSBfYS5jYWxsKGRhdGFCbG9ja3NfMSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHJlc3VsdEJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkodG90YWxCeXRlcyk7CgkgICAgICAgIHZhciByZXN1bHRPZmZzZXQgPSAwOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgLy8gRXJyb3ItY29ycmVjdCBhbmQgY29weSBkYXRhIGJsb2NrcyB0b2dldGhlciBpbnRvIGEgc3RyZWFtIG9mIGJ5dGVzCgkgICAgICAgICAgICBmb3IgKHZhciBkYXRhQmxvY2tzXzIgPSBfX3ZhbHVlcyQyKGRhdGFCbG9ja3MpLCBkYXRhQmxvY2tzXzJfMSA9IGRhdGFCbG9ja3NfMi5uZXh0KCk7ICFkYXRhQmxvY2tzXzJfMS5kb25lOyBkYXRhQmxvY2tzXzJfMSA9IGRhdGFCbG9ja3NfMi5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgZGF0YUJsb2NrID0gZGF0YUJsb2Nrc18yXzEudmFsdWU7CgkgICAgICAgICAgICAgICAgdmFyIGNvZGV3b3JkQnl0ZXMgPSBkYXRhQmxvY2suZ2V0Q29kZXdvcmRzKCk7CgkgICAgICAgICAgICAgICAgdmFyIG51bURhdGFDb2Rld29yZHMgPSBkYXRhQmxvY2suZ2V0TnVtRGF0YUNvZGV3b3JkcygpOwoJICAgICAgICAgICAgICAgIHRoaXMuY29ycmVjdEVycm9ycyhjb2Rld29yZEJ5dGVzLCBudW1EYXRhQ29kZXdvcmRzKTsKCSAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG51bURhdGFDb2Rld29yZHM7IGkrKykgewoJICAgICAgICAgICAgICAgICAgICByZXN1bHRCeXRlc1tyZXN1bHRPZmZzZXQrK10gPSBjb2Rld29yZEJ5dGVzW2ldOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZV8yXzEpIHsgZV8yID0geyBlcnJvcjogZV8yXzEgfTsgfQoJICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgaWYgKGRhdGFCbG9ja3NfMl8xICYmICFkYXRhQmxvY2tzXzJfMS5kb25lICYmIChfYiA9IGRhdGFCbG9ja3NfMi5yZXR1cm4pKSBfYi5jYWxsKGRhdGFCbG9ja3NfMik7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMikgdGhyb3cgZV8yLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gRGVjb2RlIHRoZSBjb250ZW50cyBvZiB0aGF0IHN0cmVhbSBvZiBieXRlcwoJICAgICAgICByZXR1cm4gRGVjb2RlZEJpdFN0cmVhbVBhcnNlcl8xLmRlZmF1bHQuZGVjb2RlKHJlc3VsdEJ5dGVzLCB2ZXJzaW9uLCBlY0xldmVsLCBoaW50cyk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiA8cD5HaXZlbiBkYXRhIGFuZCBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3JkcyByZWNlaXZlZCwgcG9zc2libHkgY29ycnVwdGVkIGJ5IGVycm9ycywgYXR0ZW1wdHMgdG8KCSAgICAgKiBjb3JyZWN0IHRoZSBlcnJvcnMgaW4tcGxhY2UgdXNpbmcgUmVlZC1Tb2xvbW9uIGVycm9yIGNvcnJlY3Rpb24uPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGNvZGV3b3JkQnl0ZXMgZGF0YSBhbmQgZXJyb3IgY29ycmVjdGlvbiBjb2Rld29yZHMKCSAgICAgKiBAcGFyYW0gbnVtRGF0YUNvZGV3b3JkcyBudW1iZXIgb2YgY29kZXdvcmRzIHRoYXQgYXJlIGRhdGEgYnl0ZXMKCSAgICAgKiBAdGhyb3dzIENoZWNrc3VtRXhjZXB0aW9uIGlmIGVycm9yIGNvcnJlY3Rpb24gZmFpbHMKCSAgICAgKi8KCSAgICBEZWNvZGVyLnByb3RvdHlwZS5jb3JyZWN0RXJyb3JzID0gZnVuY3Rpb24gKGNvZGV3b3JkQnl0ZXMsIG51bURhdGFDb2Rld29yZHMgLyppbnQqLykgewoJICAgICAgICAvLyBjb25zdCBudW1Db2Rld29yZHMgPSBjb2Rld29yZEJ5dGVzLmxlbmd0aDsKCSAgICAgICAgLy8gRmlyc3QgcmVhZCBpbnRvIGFuIGFycmF5IG9mIGludHMKCSAgICAgICAgdmFyIGNvZGV3b3Jkc0ludHMgPSBuZXcgSW50MzJBcnJheShjb2Rld29yZEJ5dGVzKTsKCSAgICAgICAgLy8gVFlQRVNDUklQVFBPUlQ6IG5vdCByZWFseSBuZWNlc3NhcnkgdG8gdHJhbnNmb3JtIHRvIGludHM/IGNvdWxkIHJlZGVzaWduIGV2ZXJ5dGhpbmcgdG8gd29yayB3aXRoIHVuc2lnbmVkIGJ5dGVzPwoJICAgICAgICAvLyBjb25zdCBjb2Rld29yZHNJbnRzID0gbmV3IEludDMyQXJyYXkobnVtQ29kZXdvcmRzKQoJICAgICAgICAvLyBmb3IgKGxldCBpID0gMDsgaSA8IG51bUNvZGV3b3JkczsgaSsrKSB7CgkgICAgICAgIC8vICAgY29kZXdvcmRzSW50c1tpXSA9IGNvZGV3b3JkQnl0ZXNbaV0gJiAweEZGCgkgICAgICAgIC8vIH0KCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIHRoaXMucnNEZWNvZGVyLmRlY29kZShjb2Rld29yZHNJbnRzLCBjb2Rld29yZEJ5dGVzLmxlbmd0aCAtIG51bURhdGFDb2Rld29yZHMpOwoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChpZ25vcmVkIC8qOiBSZWVkU29sb21vbkV4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgQ2hlY2tzdW1FeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gQ29weSBiYWNrIGludG8gYXJyYXkgb2YgYnl0ZXMgLS0gb25seSBuZWVkIHRvIHdvcnJ5IGFib3V0IHRoZSBieXRlcyB0aGF0IHdlcmUgZGF0YQoJICAgICAgICAvLyBXZSBkb24ndCBjYXJlIGFib3V0IGVycm9ycyBpbiB0aGUgZXJyb3ItY29ycmVjdGlvbiBjb2Rld29yZHMKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBudW1EYXRhQ29kZXdvcmRzOyBpKyspIHsKCSAgICAgICAgICAgIGNvZGV3b3JkQnl0ZXNbaV0gPSAvKihieXRlKSAqLyBjb2Rld29yZHNJbnRzW2ldOwoJICAgICAgICB9CgkgICAgfTsKCSAgICByZXR1cm4gRGVjb2RlcjsKCX0oKSk7CglEZWNvZGVyJDEuZGVmYXVsdCA9IERlY29kZXI7CgoJdmFyIERldGVjdG9yJDEgPSB7fTsKCgl2YXIgTWF0aFV0aWxzJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMTIgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KE1hdGhVdGlscyQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLmNvbW1vbi5kZXRlY3RvciB7Ki8KCS8qKgoJICogR2VuZXJhbCBtYXRoLXJlbGF0ZWQgYW5kIG51bWVyaWMgdXRpbGl0eSBmdW5jdGlvbnMuCgkgKi8KCXZhciBNYXRoVXRpbHMgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gTWF0aFV0aWxzKCkgewoJICAgIH0KCSAgICAvKioKCSAgICAgKiBFbmRzIHVwIGJlaW5nIGEgYml0IGZhc3RlciB0aGFuIHtAbGluayBNYXRoI3JvdW5kKGZsb2F0KX0uIFRoaXMgbWVyZWx5IHJvdW5kcyBpdHMKCSAgICAgKiBhcmd1bWVudCB0byB0aGUgbmVhcmVzdCBpbnQsIHdoZXJlIHguNSByb3VuZHMgdXAgdG8geCsxLiBTZW1hbnRpY3Mgb2YgdGhpcyBzaG9ydGN1dAoJICAgICAqIGRpZmZlciBzbGlnaHRseSBmcm9tIHtAbGluayBNYXRoI3JvdW5kKGZsb2F0KX0gaW4gdGhhdCBoYWxmIHJvdW5kcyBkb3duIGZvciBuZWdhdGl2ZQoJICAgICAqIHZhbHVlcy4gLTIuNSByb3VuZHMgdG8gLTMsIG5vdCAtMi4gRm9yIHB1cnBvc2VzIGhlcmUgaXQgbWFrZXMgbm8gZGlmZmVyZW5jZS4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBkIHJlYWwgdmFsdWUgdG8gcm91bmQKCSAgICAgKiBAcmV0dXJuIG5lYXJlc3Qge0Bjb2RlIGludH0KCSAgICAgKi8KCSAgICBNYXRoVXRpbHMucm91bmQgPSBmdW5jdGlvbiAoZCAvKmZsb2F0Ki8pIHsKCSAgICAgICAgaWYgKE5hTiA9PT0gZCkKCSAgICAgICAgICAgIHJldHVybiAwOwoJICAgICAgICBpZiAoZCA8PSBOdW1iZXIuTUlOX1NBRkVfSU5URUdFUikKCSAgICAgICAgICAgIHJldHVybiBOdW1iZXIuTUlOX1NBRkVfSU5URUdFUjsKCSAgICAgICAgaWYgKGQgPj0gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVIpCgkgICAgICAgICAgICByZXR1cm4gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVI7CgkgICAgICAgIHJldHVybiAvKihpbnQpICovIChkICsgKGQgPCAwLjAgPyAtMC41IDogMC41KSkgfCAwOwoJICAgIH07CgkgICAgLy8gVFlQRVNDUklQVFBPUlQ6IG1heWJlIHJlbW92ZSByb3VuZCBtZXRob2QgYW5kIGNhbGwgZGlyZWN0bHkgTWF0aC5yb3VuZCwgaXQgbG9va3MgbGlrZSBpdCBkb2Vzbid0IG1ha2Ugc2Vuc2UgZm9yIGpzCgkgICAgLyoqCgkgICAgICogQHBhcmFtIGFYIHBvaW50IEEgeCBjb29yZGluYXRlCgkgICAgICogQHBhcmFtIGFZIHBvaW50IEEgeSBjb29yZGluYXRlCgkgICAgICogQHBhcmFtIGJYIHBvaW50IEIgeCBjb29yZGluYXRlCgkgICAgICogQHBhcmFtIGJZIHBvaW50IEIgeSBjb29yZGluYXRlCgkgICAgICogQHJldHVybiBFdWNsaWRlYW4gZGlzdGFuY2UgYmV0d2VlbiBwb2ludHMgQSBhbmQgQgoJICAgICAqLwoJICAgIE1hdGhVdGlscy5kaXN0YW5jZSA9IGZ1bmN0aW9uIChhWCAvKmZsb2F0fGludCovLCBhWSAvKmZsb2F0fGludCovLCBiWCAvKmZsb2F0fGludCovLCBiWSAvKmZsb2F0fGludCovKSB7CgkgICAgICAgIHZhciB4RGlmZiA9IGFYIC0gYlg7CgkgICAgICAgIHZhciB5RGlmZiA9IGFZIC0gYlk7CgkgICAgICAgIHJldHVybiAvKihmbG9hdCkgKi8gTWF0aC5zcXJ0KHhEaWZmICogeERpZmYgKyB5RGlmZiAqIHlEaWZmKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBhWCBwb2ludCBBIHggY29vcmRpbmF0ZQoJICAgICAqIEBwYXJhbSBhWSBwb2ludCBBIHkgY29vcmRpbmF0ZQoJICAgICAqIEBwYXJhbSBiWCBwb2ludCBCIHggY29vcmRpbmF0ZQoJICAgICAqIEBwYXJhbSBiWSBwb2ludCBCIHkgY29vcmRpbmF0ZQoJICAgICAqIEByZXR1cm4gRXVjbGlkZWFuIGRpc3RhbmNlIGJldHdlZW4gcG9pbnRzIEEgYW5kIEIKCSAgICAgKi8KCSAgICAvLyBwdWJsaWMgc3RhdGljIGRpc3RhbmNlKGFYOiBudW1iZXIgLyppbnQqLywgYVk6IG51bWJlciAvKmludCovLCBiWDogbnVtYmVyIC8qaW50Ki8sIGJZOiBudW1iZXIgLyppbnQqLyk6IGZsb2F0IHsKCSAgICAvLyAgIGNvbnN0IHhEaWZmID0gYVggLSBiWAoJICAgIC8vICAgY29uc3QgeURpZmYgPSBhWSAtIGJZCgkgICAgLy8gICByZXR1cm4gKGZsb2F0KSBNYXRoLnNxcnQoeERpZmYgKiB4RGlmZiArIHlEaWZmICogeURpZmYpOwoJICAgIC8vIH0KCSAgICAvKioKCSAgICAgKiBAcGFyYW0gYXJyYXkgdmFsdWVzIHRvIHN1bQoJICAgICAqIEByZXR1cm4gc3VtIG9mIHZhbHVlcyBpbiBhcnJheQoJICAgICAqLwoJICAgIE1hdGhVdGlscy5zdW0gPSBmdW5jdGlvbiAoYXJyYXkpIHsKCSAgICAgICAgdmFyIGNvdW50ID0gMDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aF8xID0gYXJyYXkubGVuZ3RoOyBpICE9PSBsZW5ndGhfMTsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgYSA9IGFycmF5W2ldOwoJICAgICAgICAgICAgY291bnQgKz0gYTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gY291bnQ7CgkgICAgfTsKCSAgICByZXR1cm4gTWF0aFV0aWxzOwoJfSgpKTsKCU1hdGhVdGlscyQxLmRlZmF1bHQgPSBNYXRoVXRpbHM7CgoJdmFyIERldGVjdG9yUmVzdWx0JDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KERldGVjdG9yUmVzdWx0JDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIHRoZSByZXN1bHQgb2YgZGV0ZWN0aW5nIGEgYmFyY29kZSBpbiBhbiBpbWFnZS4gVGhpcyBpbmNsdWRlcyB0aGUgcmF3CgkgKiBtYXRyaXggb2YgYmxhY2svd2hpdGUgcGl4ZWxzIGNvcnJlc3BvbmRpbmcgdG8gdGhlIGJhcmNvZGUsIGFuZCBwb3NzaWJseSBwb2ludHMgb2YgaW50ZXJlc3QKCSAqIGluIHRoZSBpbWFnZSwgbGlrZSB0aGUgbG9jYXRpb24gb2YgZmluZGVyIHBhdHRlcm5zIG9yIGNvcm5lcnMgb2YgdGhlIGJhcmNvZGUgaW4gdGhlIGltYWdlLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgRGV0ZWN0b3JSZXN1bHQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gRGV0ZWN0b3JSZXN1bHQoYml0cywgcG9pbnRzKSB7CgkgICAgICAgIHRoaXMuYml0cyA9IGJpdHM7CgkgICAgICAgIHRoaXMucG9pbnRzID0gcG9pbnRzOwoJICAgIH0KCSAgICBEZXRlY3RvclJlc3VsdC5wcm90b3R5cGUuZ2V0Qml0cyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYml0czsKCSAgICB9OwoJICAgIERldGVjdG9yUmVzdWx0LnByb3RvdHlwZS5nZXRQb2ludHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnBvaW50czsKCSAgICB9OwoJICAgIHJldHVybiBEZXRlY3RvclJlc3VsdDsKCX0oKSk7CglEZXRlY3RvclJlc3VsdCQxLmRlZmF1bHQgPSBEZXRlY3RvclJlc3VsdDsKCgl2YXIgR3JpZFNhbXBsZXJJbnN0YW5jZSQxID0ge307CgoJdmFyIERlZmF1bHRHcmlkU2FtcGxlciQxID0ge307CgoJdmFyIEdyaWRTYW1wbGVyJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEdyaWRTYW1wbGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBOb3RGb3VuZEV4Y2VwdGlvbl8xJDUgPSBOb3RGb3VuZEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBJbXBsZW1lbnRhdGlvbnMgb2YgdGhpcyBjbGFzcyBjYW4sIGdpdmVuIGxvY2F0aW9ucyBvZiBmaW5kZXIgcGF0dGVybnMgZm9yIGEgUVIgY29kZSBpbiBhbgoJICogaW1hZ2UsIHNhbXBsZSB0aGUgcmlnaHQgcG9pbnRzIGluIHRoZSBpbWFnZSB0byByZWNvbnN0cnVjdCB0aGUgUVIgY29kZSwgYWNjb3VudGluZyBmb3IKCSAqIHBlcnNwZWN0aXZlIGRpc3RvcnRpb24uIEl0IGlzIGFic3RyYWN0ZWQgc2luY2UgaXQgaXMgcmVsYXRpdmVseSBleHBlbnNpdmUgYW5kIHNob3VsZCBiZSBhbGxvd2VkCgkgKiB0byB0YWtlIGFkdmFudGFnZSBvZiBwbGF0Zm9ybS1zcGVjaWZpYyBvcHRpbWl6ZWQgaW1wbGVtZW50YXRpb25zLCBsaWtlIFN1bidzIEphdmEgQWR2YW5jZWQKCSAqIEltYWdpbmcgbGlicmFyeSwgYnV0IHdoaWNoIG1heSBub3QgYmUgYXZhaWxhYmxlIGluIG90aGVyIGVudmlyb25tZW50cyBzdWNoIGFzIEoyTUUsIGFuZCB2aWNlCgkgKiB2ZXJzYS4KCSAqCgkgKiBUaGUgaW1wbGVtZW50YXRpb24gdXNlZCBjYW4gYmUgY29udHJvbGxlZCBieSBjYWxsaW5nIHtAbGluayAjc2V0R3JpZFNhbXBsZXIoR3JpZFNhbXBsZXIpfQoJICogd2l0aCBhbiBpbnN0YW5jZSBvZiBhIGNsYXNzIHdoaWNoIGltcGxlbWVudHMgdGhpcyBpbnRlcmZhY2UuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEdyaWRTYW1wbGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEdyaWRTYW1wbGVyKCkgewoJICAgIH0KCSAgICAvKioKCSAgICAgKiA8cD5DaGVja3MgYSBzZXQgb2YgcG9pbnRzIHRoYXQgaGF2ZSBiZWVuIHRyYW5zZm9ybWVkIHRvIHNhbXBsZSBwb2ludHMgb24gYW4gaW1hZ2UgYWdhaW5zdAoJICAgICAqIHRoZSBpbWFnZSdzIGRpbWVuc2lvbnMgdG8gc2VlIGlmIHRoZSBwb2ludCBhcmUgZXZlbiB3aXRoaW4gdGhlIGltYWdlLjwvcD4KCSAgICAgKgoJICAgICAqIDxwPlRoaXMgbWV0aG9kIHdpbGwgYWN0dWFsbHkgIm51ZGdlIiB0aGUgZW5kcG9pbnRzIGJhY2sgb250byB0aGUgaW1hZ2UgaWYgdGhleSBhcmUgZm91bmQgdG8gYmUKCSAgICAgKiBiYXJlbHkgKGxlc3MgdGhhbiAxIHBpeGVsKSBvZmYgdGhlIGltYWdlLiBUaGlzIGFjY291bnRzIGZvciBpbXBlcmZlY3QgZGV0ZWN0aW9uIG9mIGZpbmRlcgoJICAgICAqIHBhdHRlcm5zIGluIGFuIGltYWdlIHdoZXJlIHRoZSBRUiBDb2RlIHJ1bnMgYWxsIHRoZSB3YXkgdG8gdGhlIGltYWdlIGJvcmRlci48L3A+CgkgICAgICoKCSAgICAgKiA8cD5Gb3IgZWZmaWNpZW5jeSwgdGhlIG1ldGhvZCB3aWxsIGNoZWNrIHBvaW50cyBmcm9tIGVpdGhlciBlbmQgb2YgdGhlIGxpbmUgdW50aWwgb25lIGlzIGZvdW5kCgkgICAgICogdG8gYmUgd2l0aGluIHRoZSBpbWFnZS4gQmVjYXVzZSB0aGUgc2V0IG9mIHBvaW50cyBhcmUgYXNzdW1lZCB0byBiZSBsaW5lYXIsIHRoaXMgaXMgdmFsaWQuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGltYWdlIGltYWdlIGludG8gd2hpY2ggdGhlIHBvaW50cyBzaG91bGQgbWFwCgkgICAgICogQHBhcmFtIHBvaW50cyBhY3R1YWwgcG9pbnRzIGluIHgxLHkxLC4uLix4bix5biBmb3JtCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBhbiBlbmRwb2ludCBpcyBsaWVzIG91dHNpZGUgdGhlIGltYWdlIGJvdW5kYXJpZXMKCSAgICAgKi8KCSAgICBHcmlkU2FtcGxlci5jaGVja0FuZE51ZGdlUG9pbnRzID0gZnVuY3Rpb24gKGltYWdlLCBwb2ludHMpIHsKCSAgICAgICAgdmFyIHdpZHRoID0gaW1hZ2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIGhlaWdodCA9IGltYWdlLmdldEhlaWdodCgpOwoJICAgICAgICAvLyBDaGVjayBhbmQgbnVkZ2UgcG9pbnRzIGZyb20gc3RhcnQgdW50aWwgd2Ugc2VlIHNvbWUgdGhhdCBhcmUgT0s6CgkgICAgICAgIHZhciBudWRnZWQgPSB0cnVlOwoJICAgICAgICBmb3IgKHZhciBvZmZzZXQgPSAwOyBvZmZzZXQgPCBwb2ludHMubGVuZ3RoICYmIG51ZGdlZDsgb2Zmc2V0ICs9IDIpIHsKCSAgICAgICAgICAgIHZhciB4ID0gTWF0aC5mbG9vcihwb2ludHNbb2Zmc2V0XSk7CgkgICAgICAgICAgICB2YXIgeSA9IE1hdGguZmxvb3IocG9pbnRzW29mZnNldCArIDFdKTsKCSAgICAgICAgICAgIGlmICh4IDwgLTEgfHwgeCA+IHdpZHRoIHx8IHkgPCAtMSB8fCB5ID4gaGVpZ2h0KSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkNS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBudWRnZWQgPSBmYWxzZTsKCSAgICAgICAgICAgIGlmICh4ID09PSAtMSkgewoJICAgICAgICAgICAgICAgIHBvaW50c1tvZmZzZXRdID0gMC4wOwoJICAgICAgICAgICAgICAgIG51ZGdlZCA9IHRydWU7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIGlmICh4ID09PSB3aWR0aCkgewoJICAgICAgICAgICAgICAgIHBvaW50c1tvZmZzZXRdID0gd2lkdGggLSAxOwoJICAgICAgICAgICAgICAgIG51ZGdlZCA9IHRydWU7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBpZiAoeSA9PT0gLTEpIHsKCSAgICAgICAgICAgICAgICBwb2ludHNbb2Zmc2V0ICsgMV0gPSAwLjA7CgkgICAgICAgICAgICAgICAgbnVkZ2VkID0gdHJ1ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGVsc2UgaWYgKHkgPT09IGhlaWdodCkgewoJICAgICAgICAgICAgICAgIHBvaW50c1tvZmZzZXQgKyAxXSA9IGhlaWdodCAtIDE7CgkgICAgICAgICAgICAgICAgbnVkZ2VkID0gdHJ1ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICAvLyBDaGVjayBhbmQgbnVkZ2UgcG9pbnRzIGZyb20gZW5kOgoJICAgICAgICBudWRnZWQgPSB0cnVlOwoJICAgICAgICBmb3IgKHZhciBvZmZzZXQgPSBwb2ludHMubGVuZ3RoIC0gMjsgb2Zmc2V0ID49IDAgJiYgbnVkZ2VkOyBvZmZzZXQgLT0gMikgewoJICAgICAgICAgICAgdmFyIHggPSBNYXRoLmZsb29yKHBvaW50c1tvZmZzZXRdKTsKCSAgICAgICAgICAgIHZhciB5ID0gTWF0aC5mbG9vcihwb2ludHNbb2Zmc2V0ICsgMV0pOwoJICAgICAgICAgICAgaWYgKHggPCAtMSB8fCB4ID4gd2lkdGggfHwgeSA8IC0xIHx8IHkgPiBoZWlnaHQpIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMSQ1LmRlZmF1bHQoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIG51ZGdlZCA9IGZhbHNlOwoJICAgICAgICAgICAgaWYgKHggPT09IC0xKSB7CgkgICAgICAgICAgICAgICAgcG9pbnRzW29mZnNldF0gPSAwLjA7CgkgICAgICAgICAgICAgICAgbnVkZ2VkID0gdHJ1ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGVsc2UgaWYgKHggPT09IHdpZHRoKSB7CgkgICAgICAgICAgICAgICAgcG9pbnRzW29mZnNldF0gPSB3aWR0aCAtIDE7CgkgICAgICAgICAgICAgICAgbnVkZ2VkID0gdHJ1ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGlmICh5ID09PSAtMSkgewoJICAgICAgICAgICAgICAgIHBvaW50c1tvZmZzZXQgKyAxXSA9IDAuMDsKCSAgICAgICAgICAgICAgICBudWRnZWQgPSB0cnVlOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSBpZiAoeSA9PT0gaGVpZ2h0KSB7CgkgICAgICAgICAgICAgICAgcG9pbnRzW29mZnNldCArIDFdID0gaGVpZ2h0IC0gMTsKCSAgICAgICAgICAgICAgICBudWRnZWQgPSB0cnVlOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICByZXR1cm4gR3JpZFNhbXBsZXI7Cgl9KCkpOwoJR3JpZFNhbXBsZXIkMS5kZWZhdWx0ID0gR3JpZFNhbXBsZXI7CgoJdmFyIFBlcnNwZWN0aXZlVHJhbnNmb3JtJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFBlcnNwZWN0aXZlVHJhbnNmb3JtJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyoqCgkgKiA8cD5UaGlzIGNsYXNzIGltcGxlbWVudHMgYSBwZXJzcGVjdGl2ZSB0cmFuc2Zvcm0gaW4gdHdvIGRpbWVuc2lvbnMuIEdpdmVuIGZvdXIgc291cmNlIGFuZCBmb3VyCgkgKiBkZXN0aW5hdGlvbiBwb2ludHMsIGl0IHdpbGwgY29tcHV0ZSB0aGUgdHJhbnNmb3JtYXRpb24gaW1wbGllZCBiZXR3ZWVuIHRoZW0uIFRoZSBjb2RlIGlzIGJhc2VkCgkgKiBkaXJlY3RseSB1cG9uIHNlY3Rpb24gMy40LjIgb2YgR2VvcmdlIFdvbGJlcmcncyAiRGlnaXRhbCBJbWFnZSBXYXJwaW5nIjsgc2VlIHBhZ2VzIDU0LTU2LjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgUGVyc3BlY3RpdmVUcmFuc2Zvcm0gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gUGVyc3BlY3RpdmVUcmFuc2Zvcm0oYTExIC8qZmxvYXQqLywgYTIxIC8qZmxvYXQqLywgYTMxIC8qZmxvYXQqLywgYTEyIC8qZmxvYXQqLywgYTIyIC8qZmxvYXQqLywgYTMyIC8qZmxvYXQqLywgYTEzIC8qZmxvYXQqLywgYTIzIC8qZmxvYXQqLywgYTMzIC8qZmxvYXQqLykgewoJICAgICAgICB0aGlzLmExMSA9IGExMTsKCSAgICAgICAgdGhpcy5hMjEgPSBhMjE7CgkgICAgICAgIHRoaXMuYTMxID0gYTMxOwoJICAgICAgICB0aGlzLmExMiA9IGExMjsKCSAgICAgICAgdGhpcy5hMjIgPSBhMjI7CgkgICAgICAgIHRoaXMuYTMyID0gYTMyOwoJICAgICAgICB0aGlzLmExMyA9IGExMzsKCSAgICAgICAgdGhpcy5hMjMgPSBhMjM7CgkgICAgICAgIHRoaXMuYTMzID0gYTMzOwoJICAgIH0KCSAgICBQZXJzcGVjdGl2ZVRyYW5zZm9ybS5xdWFkcmlsYXRlcmFsVG9RdWFkcmlsYXRlcmFsID0gZnVuY3Rpb24gKHgwIC8qZmxvYXQqLywgeTAgLypmbG9hdCovLCB4MSAvKmZsb2F0Ki8sIHkxIC8qZmxvYXQqLywgeDIgLypmbG9hdCovLCB5MiAvKmZsb2F0Ki8sIHgzIC8qZmxvYXQqLywgeTMgLypmbG9hdCovLCB4MHAgLypmbG9hdCovLCB5MHAgLypmbG9hdCovLCB4MXAgLypmbG9hdCovLCB5MXAgLypmbG9hdCovLCB4MnAgLypmbG9hdCovLCB5MnAgLypmbG9hdCovLCB4M3AgLypmbG9hdCovLCB5M3AgLypmbG9hdCovKSB7CgkgICAgICAgIHZhciBxVG9TID0gUGVyc3BlY3RpdmVUcmFuc2Zvcm0ucXVhZHJpbGF0ZXJhbFRvU3F1YXJlKHgwLCB5MCwgeDEsIHkxLCB4MiwgeTIsIHgzLCB5Myk7CgkgICAgICAgIHZhciBzVG9RID0gUGVyc3BlY3RpdmVUcmFuc2Zvcm0uc3F1YXJlVG9RdWFkcmlsYXRlcmFsKHgwcCwgeTBwLCB4MXAsIHkxcCwgeDJwLCB5MnAsIHgzcCwgeTNwKTsKCSAgICAgICAgcmV0dXJuIHNUb1EudGltZXMocVRvUyk7CgkgICAgfTsKCSAgICBQZXJzcGVjdGl2ZVRyYW5zZm9ybS5wcm90b3R5cGUudHJhbnNmb3JtUG9pbnRzID0gZnVuY3Rpb24gKHBvaW50cykgewoJICAgICAgICB2YXIgbWF4ID0gcG9pbnRzLmxlbmd0aDsKCSAgICAgICAgdmFyIGExMSA9IHRoaXMuYTExOwoJICAgICAgICB2YXIgYTEyID0gdGhpcy5hMTI7CgkgICAgICAgIHZhciBhMTMgPSB0aGlzLmExMzsKCSAgICAgICAgdmFyIGEyMSA9IHRoaXMuYTIxOwoJICAgICAgICB2YXIgYTIyID0gdGhpcy5hMjI7CgkgICAgICAgIHZhciBhMjMgPSB0aGlzLmEyMzsKCSAgICAgICAgdmFyIGEzMSA9IHRoaXMuYTMxOwoJICAgICAgICB2YXIgYTMyID0gdGhpcy5hMzI7CgkgICAgICAgIHZhciBhMzMgPSB0aGlzLmEzMzsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtYXg7IGkgKz0gMikgewoJICAgICAgICAgICAgdmFyIHggPSBwb2ludHNbaV07CgkgICAgICAgICAgICB2YXIgeSA9IHBvaW50c1tpICsgMV07CgkgICAgICAgICAgICB2YXIgZGVub21pbmF0b3IgPSBhMTMgKiB4ICsgYTIzICogeSArIGEzMzsKCSAgICAgICAgICAgIHBvaW50c1tpXSA9IChhMTEgKiB4ICsgYTIxICogeSArIGEzMSkgLyBkZW5vbWluYXRvcjsKCSAgICAgICAgICAgIHBvaW50c1tpICsgMV0gPSAoYTEyICogeCArIGEyMiAqIHkgKyBhMzIpIC8gZGVub21pbmF0b3I7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIFBlcnNwZWN0aXZlVHJhbnNmb3JtLnByb3RvdHlwZS50cmFuc2Zvcm1Qb2ludHNXaXRoVmFsdWVzID0gZnVuY3Rpb24gKHhWYWx1ZXMsIHlWYWx1ZXMpIHsKCSAgICAgICAgdmFyIGExMSA9IHRoaXMuYTExOwoJICAgICAgICB2YXIgYTEyID0gdGhpcy5hMTI7CgkgICAgICAgIHZhciBhMTMgPSB0aGlzLmExMzsKCSAgICAgICAgdmFyIGEyMSA9IHRoaXMuYTIxOwoJICAgICAgICB2YXIgYTIyID0gdGhpcy5hMjI7CgkgICAgICAgIHZhciBhMjMgPSB0aGlzLmEyMzsKCSAgICAgICAgdmFyIGEzMSA9IHRoaXMuYTMxOwoJICAgICAgICB2YXIgYTMyID0gdGhpcy5hMzI7CgkgICAgICAgIHZhciBhMzMgPSB0aGlzLmEzMzsKCSAgICAgICAgdmFyIG4gPSB4VmFsdWVzLmxlbmd0aDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBuOyBpKyspIHsKCSAgICAgICAgICAgIHZhciB4ID0geFZhbHVlc1tpXTsKCSAgICAgICAgICAgIHZhciB5ID0geVZhbHVlc1tpXTsKCSAgICAgICAgICAgIHZhciBkZW5vbWluYXRvciA9IGExMyAqIHggKyBhMjMgKiB5ICsgYTMzOwoJICAgICAgICAgICAgeFZhbHVlc1tpXSA9IChhMTEgKiB4ICsgYTIxICogeSArIGEzMSkgLyBkZW5vbWluYXRvcjsKCSAgICAgICAgICAgIHlWYWx1ZXNbaV0gPSAoYTEyICogeCArIGEyMiAqIHkgKyBhMzIpIC8gZGVub21pbmF0b3I7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIFBlcnNwZWN0aXZlVHJhbnNmb3JtLnNxdWFyZVRvUXVhZHJpbGF0ZXJhbCA9IGZ1bmN0aW9uICh4MCAvKmZsb2F0Ki8sIHkwIC8qZmxvYXQqLywgeDEgLypmbG9hdCovLCB5MSAvKmZsb2F0Ki8sIHgyIC8qZmxvYXQqLywgeTIgLypmbG9hdCovLCB4MyAvKmZsb2F0Ki8sIHkzIC8qZmxvYXQqLykgewoJICAgICAgICB2YXIgZHgzID0geDAgLSB4MSArIHgyIC0geDM7CgkgICAgICAgIHZhciBkeTMgPSB5MCAtIHkxICsgeTIgLSB5MzsKCSAgICAgICAgaWYgKGR4MyA9PT0gMC4wICYmIGR5MyA9PT0gMC4wKSB7CgkgICAgICAgICAgICAvLyBBZmZpbmUKCSAgICAgICAgICAgIHJldHVybiBuZXcgUGVyc3BlY3RpdmVUcmFuc2Zvcm0oeDEgLSB4MCwgeDIgLSB4MSwgeDAsIHkxIC0geTAsIHkyIC0geTEsIHkwLCAwLjAsIDAuMCwgMS4wKTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHZhciBkeDEgPSB4MSAtIHgyOwoJICAgICAgICAgICAgdmFyIGR4MiA9IHgzIC0geDI7CgkgICAgICAgICAgICB2YXIgZHkxID0geTEgLSB5MjsKCSAgICAgICAgICAgIHZhciBkeTIgPSB5MyAtIHkyOwoJICAgICAgICAgICAgdmFyIGRlbm9taW5hdG9yID0gZHgxICogZHkyIC0gZHgyICogZHkxOwoJICAgICAgICAgICAgdmFyIGExMyA9IChkeDMgKiBkeTIgLSBkeDIgKiBkeTMpIC8gZGVub21pbmF0b3I7CgkgICAgICAgICAgICB2YXIgYTIzID0gKGR4MSAqIGR5MyAtIGR4MyAqIGR5MSkgLyBkZW5vbWluYXRvcjsKCSAgICAgICAgICAgIHJldHVybiBuZXcgUGVyc3BlY3RpdmVUcmFuc2Zvcm0oeDEgLSB4MCArIGExMyAqIHgxLCB4MyAtIHgwICsgYTIzICogeDMsIHgwLCB5MSAtIHkwICsgYTEzICogeTEsIHkzIC0geTAgKyBhMjMgKiB5MywgeTAsIGExMywgYTIzLCAxLjApOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBQZXJzcGVjdGl2ZVRyYW5zZm9ybS5xdWFkcmlsYXRlcmFsVG9TcXVhcmUgPSBmdW5jdGlvbiAoeDAgLypmbG9hdCovLCB5MCAvKmZsb2F0Ki8sIHgxIC8qZmxvYXQqLywgeTEgLypmbG9hdCovLCB4MiAvKmZsb2F0Ki8sIHkyIC8qZmxvYXQqLywgeDMgLypmbG9hdCovLCB5MyAvKmZsb2F0Ki8pIHsKCSAgICAgICAgLy8gSGVyZSwgdGhlIGFkam9pbnQgc2VydmVzIGFzIHRoZSBpbnZlcnNlOgoJICAgICAgICByZXR1cm4gUGVyc3BlY3RpdmVUcmFuc2Zvcm0uc3F1YXJlVG9RdWFkcmlsYXRlcmFsKHgwLCB5MCwgeDEsIHkxLCB4MiwgeTIsIHgzLCB5MykuYnVpbGRBZGpvaW50KCk7CgkgICAgfTsKCSAgICBQZXJzcGVjdGl2ZVRyYW5zZm9ybS5wcm90b3R5cGUuYnVpbGRBZGpvaW50ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICAvLyBBZGpvaW50IGlzIHRoZSB0cmFuc3Bvc2Ugb2YgdGhlIGNvZmFjdG9yIG1hdHJpeDoKCSAgICAgICAgcmV0dXJuIG5ldyBQZXJzcGVjdGl2ZVRyYW5zZm9ybSh0aGlzLmEyMiAqIHRoaXMuYTMzIC0gdGhpcy5hMjMgKiB0aGlzLmEzMiwgdGhpcy5hMjMgKiB0aGlzLmEzMSAtIHRoaXMuYTIxICogdGhpcy5hMzMsIHRoaXMuYTIxICogdGhpcy5hMzIgLSB0aGlzLmEyMiAqIHRoaXMuYTMxLCB0aGlzLmExMyAqIHRoaXMuYTMyIC0gdGhpcy5hMTIgKiB0aGlzLmEzMywgdGhpcy5hMTEgKiB0aGlzLmEzMyAtIHRoaXMuYTEzICogdGhpcy5hMzEsIHRoaXMuYTEyICogdGhpcy5hMzEgLSB0aGlzLmExMSAqIHRoaXMuYTMyLCB0aGlzLmExMiAqIHRoaXMuYTIzIC0gdGhpcy5hMTMgKiB0aGlzLmEyMiwgdGhpcy5hMTMgKiB0aGlzLmEyMSAtIHRoaXMuYTExICogdGhpcy5hMjMsIHRoaXMuYTExICogdGhpcy5hMjIgLSB0aGlzLmExMiAqIHRoaXMuYTIxKTsKCSAgICB9OwoJICAgIFBlcnNwZWN0aXZlVHJhbnNmb3JtLnByb3RvdHlwZS50aW1lcyA9IGZ1bmN0aW9uIChvdGhlcikgewoJICAgICAgICByZXR1cm4gbmV3IFBlcnNwZWN0aXZlVHJhbnNmb3JtKHRoaXMuYTExICogb3RoZXIuYTExICsgdGhpcy5hMjEgKiBvdGhlci5hMTIgKyB0aGlzLmEzMSAqIG90aGVyLmExMywgdGhpcy5hMTEgKiBvdGhlci5hMjEgKyB0aGlzLmEyMSAqIG90aGVyLmEyMiArIHRoaXMuYTMxICogb3RoZXIuYTIzLCB0aGlzLmExMSAqIG90aGVyLmEzMSArIHRoaXMuYTIxICogb3RoZXIuYTMyICsgdGhpcy5hMzEgKiBvdGhlci5hMzMsIHRoaXMuYTEyICogb3RoZXIuYTExICsgdGhpcy5hMjIgKiBvdGhlci5hMTIgKyB0aGlzLmEzMiAqIG90aGVyLmExMywgdGhpcy5hMTIgKiBvdGhlci5hMjEgKyB0aGlzLmEyMiAqIG90aGVyLmEyMiArIHRoaXMuYTMyICogb3RoZXIuYTIzLCB0aGlzLmExMiAqIG90aGVyLmEzMSArIHRoaXMuYTIyICogb3RoZXIuYTMyICsgdGhpcy5hMzIgKiBvdGhlci5hMzMsIHRoaXMuYTEzICogb3RoZXIuYTExICsgdGhpcy5hMjMgKiBvdGhlci5hMTIgKyB0aGlzLmEzMyAqIG90aGVyLmExMywgdGhpcy5hMTMgKiBvdGhlci5hMjEgKyB0aGlzLmEyMyAqIG90aGVyLmEyMiArIHRoaXMuYTMzICogb3RoZXIuYTIzLCB0aGlzLmExMyAqIG90aGVyLmEzMSArIHRoaXMuYTIzICogb3RoZXIuYTMyICsgdGhpcy5hMzMgKiBvdGhlci5hMzMpOwoJICAgIH07CgkgICAgcmV0dXJuIFBlcnNwZWN0aXZlVHJhbnNmb3JtOwoJfSgpKTsKCVBlcnNwZWN0aXZlVHJhbnNmb3JtJDEuZGVmYXVsdCA9IFBlcnNwZWN0aXZlVHJhbnNmb3JtOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCgl2YXIgX19leHRlbmRzJDIgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRGVmYXVsdEdyaWRTYW1wbGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJdmFyIEdyaWRTYW1wbGVyXzEgPSBHcmlkU2FtcGxlciQxOwoJdmFyIEJpdE1hdHJpeF8xJDEgPSBCaXRNYXRyaXgkMTsKCXZhciBQZXJzcGVjdGl2ZVRyYW5zZm9ybV8xJDEgPSBQZXJzcGVjdGl2ZVRyYW5zZm9ybSQxOwoJdmFyIE5vdEZvdW5kRXhjZXB0aW9uXzEkNCA9IE5vdEZvdW5kRXhjZXB0aW9uJDE7CgkvKioKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBEZWZhdWx0R3JpZFNhbXBsZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJDIoRGVmYXVsdEdyaWRTYW1wbGVyLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIERlZmF1bHRHcmlkU2FtcGxlcigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICAvKkBPdmVycmlkZSovCgkgICAgRGVmYXVsdEdyaWRTYW1wbGVyLnByb3RvdHlwZS5zYW1wbGVHcmlkID0gZnVuY3Rpb24gKGltYWdlLCBkaW1lbnNpb25YIC8qaW50Ki8sIGRpbWVuc2lvblkgLyppbnQqLywgcDFUb1ggLypmbG9hdCovLCBwMVRvWSAvKmZsb2F0Ki8sIHAyVG9YIC8qZmxvYXQqLywgcDJUb1kgLypmbG9hdCovLCBwM1RvWCAvKmZsb2F0Ki8sIHAzVG9ZIC8qZmxvYXQqLywgcDRUb1ggLypmbG9hdCovLCBwNFRvWSAvKmZsb2F0Ki8sIHAxRnJvbVggLypmbG9hdCovLCBwMUZyb21ZIC8qZmxvYXQqLywgcDJGcm9tWCAvKmZsb2F0Ki8sIHAyRnJvbVkgLypmbG9hdCovLCBwM0Zyb21YIC8qZmxvYXQqLywgcDNGcm9tWSAvKmZsb2F0Ki8sIHA0RnJvbVggLypmbG9hdCovLCBwNEZyb21ZIC8qZmxvYXQqLykgewoJICAgICAgICB2YXIgdHJhbnNmb3JtID0gUGVyc3BlY3RpdmVUcmFuc2Zvcm1fMSQxLmRlZmF1bHQucXVhZHJpbGF0ZXJhbFRvUXVhZHJpbGF0ZXJhbChwMVRvWCwgcDFUb1ksIHAyVG9YLCBwMlRvWSwgcDNUb1gsIHAzVG9ZLCBwNFRvWCwgcDRUb1ksIHAxRnJvbVgsIHAxRnJvbVksIHAyRnJvbVgsIHAyRnJvbVksIHAzRnJvbVgsIHAzRnJvbVksIHA0RnJvbVgsIHA0RnJvbVkpOwoJICAgICAgICByZXR1cm4gdGhpcy5zYW1wbGVHcmlkV2l0aFRyYW5zZm9ybShpbWFnZSwgZGltZW5zaW9uWCwgZGltZW5zaW9uWSwgdHJhbnNmb3JtKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBEZWZhdWx0R3JpZFNhbXBsZXIucHJvdG90eXBlLnNhbXBsZUdyaWRXaXRoVHJhbnNmb3JtID0gZnVuY3Rpb24gKGltYWdlLCBkaW1lbnNpb25YIC8qaW50Ki8sIGRpbWVuc2lvblkgLyppbnQqLywgdHJhbnNmb3JtKSB7CgkgICAgICAgIGlmIChkaW1lbnNpb25YIDw9IDAgfHwgZGltZW5zaW9uWSA8PSAwKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMSQ0LmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYml0cyA9IG5ldyBCaXRNYXRyaXhfMSQxLmRlZmF1bHQoZGltZW5zaW9uWCwgZGltZW5zaW9uWSk7CgkgICAgICAgIHZhciBwb2ludHMgPSBuZXcgRmxvYXQzMkFycmF5KDIgKiBkaW1lbnNpb25YKTsKCSAgICAgICAgZm9yICh2YXIgeSA9IDA7IHkgPCBkaW1lbnNpb25ZOyB5KyspIHsKCSAgICAgICAgICAgIHZhciBtYXggPSBwb2ludHMubGVuZ3RoOwoJICAgICAgICAgICAgdmFyIGlWYWx1ZSA9IHkgKyAwLjU7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IG1heDsgeCArPSAyKSB7CgkgICAgICAgICAgICAgICAgcG9pbnRzW3hdID0gKHggLyAyKSArIDAuNTsKCSAgICAgICAgICAgICAgICBwb2ludHNbeCArIDFdID0gaVZhbHVlOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgdHJhbnNmb3JtLnRyYW5zZm9ybVBvaW50cyhwb2ludHMpOwoJICAgICAgICAgICAgLy8gUXVpY2sgY2hlY2sgdG8gc2VlIGlmIHBvaW50cyB0cmFuc2Zvcm1lZCB0byBzb21ldGhpbmcgaW5zaWRlIHRoZSBpbWFnZQoJICAgICAgICAgICAgLy8gc3VmZmljaWVudCB0byBjaGVjayB0aGUgZW5kcG9pbnRzCgkgICAgICAgICAgICBHcmlkU2FtcGxlcl8xLmRlZmF1bHQuY2hlY2tBbmROdWRnZVBvaW50cyhpbWFnZSwgcG9pbnRzKTsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCBtYXg7IHggKz0gMikgewoJICAgICAgICAgICAgICAgICAgICBpZiAoaW1hZ2UuZ2V0KE1hdGguZmxvb3IocG9pbnRzW3hdKSwgTWF0aC5mbG9vcihwb2ludHNbeCArIDFdKSkpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIEJsYWNrKC1pc2gpIHBpeGVsCgkgICAgICAgICAgICAgICAgICAgICAgICBiaXRzLnNldCh4IC8gMiwgeSk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBjYXRjaCAoYWlvb2JlIC8qOiBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24qLykgewoJICAgICAgICAgICAgICAgIC8vIFRoaXMgZmVlbHMgd3JvbmcsIGJ1dCwgc29tZXRpbWVzIGlmIHRoZSBmaW5kZXIgcGF0dGVybnMgYXJlIG1pc2lkZW50aWZpZWQsIHRoZSByZXN1bHRpbmcKCSAgICAgICAgICAgICAgICAvLyB0cmFuc2Zvcm0gZ2V0cyAidHdpc3RlZCIgc3VjaCB0aGF0IGl0IG1hcHMgYSBzdHJhaWdodCBsaW5lIG9mIHBvaW50cyB0byBhIHNldCBvZiBwb2ludHMKCSAgICAgICAgICAgICAgICAvLyB3aG9zZSBlbmRwb2ludHMgYXJlIGluIGJvdW5kcywgYnV0IG90aGVycyBhcmUgbm90LiBUaGVyZSBpcyBwcm9iYWJseSBzb21lIG1hdGhlbWF0aWNhbAoJICAgICAgICAgICAgICAgIC8vIHdheSB0byBkZXRlY3QgdGhpcyBhYm91dCB0aGUgdHJhbnNmb3JtYXRpb24gdGhhdCBJIGRvbid0IGtub3cgeWV0LgoJICAgICAgICAgICAgICAgIC8vIFRoaXMgcmVzdWx0cyBpbiBhbiB1Z2x5IHJ1bnRpbWUgZXhjZXB0aW9uIGRlc3BpdGUgb3VyIGNsZXZlciBjaGVja3MgYWJvdmUgLS0gY2FuJ3QgaGF2ZQoJICAgICAgICAgICAgICAgIC8vIHRoYXQuIFdlIGNvdWxkIGNoZWNrIGVhY2ggcG9pbnQncyBjb29yZGluYXRlcyBidXQgdGhhdCBmZWVscyBkdXBsaWNhdGl2ZS4gV2Ugc2V0dGxlIGZvcgoJICAgICAgICAgICAgICAgIC8vIGNhdGNoaW5nIGFuZCB3cmFwcGluZyBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24uCgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkNC5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGJpdHM7CgkgICAgfTsKCSAgICByZXR1cm4gRGVmYXVsdEdyaWRTYW1wbGVyOwoJfShHcmlkU2FtcGxlcl8xLmRlZmF1bHQpKTsKCURlZmF1bHRHcmlkU2FtcGxlciQxLmRlZmF1bHQgPSBEZWZhdWx0R3JpZFNhbXBsZXI7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEdyaWRTYW1wbGVySW5zdGFuY2UkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIERlZmF1bHRHcmlkU2FtcGxlcl8xID0gRGVmYXVsdEdyaWRTYW1wbGVyJDE7Cgl2YXIgR3JpZFNhbXBsZXJJbnN0YW5jZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBHcmlkU2FtcGxlckluc3RhbmNlKCkgewoJICAgIH0KCSAgICAvKioKCSAgICAgKiBTZXRzIHRoZSBpbXBsZW1lbnRhdGlvbiBvZiBHcmlkU2FtcGxlciB1c2VkIGJ5IHRoZSBsaWJyYXJ5LiBPbmUgZ2xvYmFsCgkgICAgICogaW5zdGFuY2UgaXMgc3RvcmVkLCB3aGljaCBtYXkgc291bmQgcHJvYmxlbWF0aWMuIEJ1dCwgdGhlIGltcGxlbWVudGF0aW9uIHByb3ZpZGVkCgkgICAgICogb3VnaHQgdG8gYmUgYXBwcm9wcmlhdGUgZm9yIHRoZSBlbnRpcmUgcGxhdGZvcm0sIGFuZCBhbGwgdXNlcyBvZiB0aGlzIGxpYnJhcnkKCSAgICAgKiBpbiB0aGUgd2hvbGUgbGlmZXRpbWUgb2YgdGhlIEpWTS4gRm9yIGluc3RhbmNlLCBhbiBBbmRyb2lkIGFjdGl2aXR5IGNhbiBzd2FwIGluCgkgICAgICogYW4gaW1wbGVtZW50YXRpb24gdGhhdCB0YWtlcyBhZHZhbnRhZ2Ugb2YgbmF0aXZlIHBsYXRmb3JtIGxpYnJhcmllcy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBuZXdHcmlkU2FtcGxlciBUaGUgcGxhdGZvcm0tc3BlY2lmaWMgb2JqZWN0IHRvIGluc3RhbGwuCgkgICAgICovCgkgICAgR3JpZFNhbXBsZXJJbnN0YW5jZS5zZXRHcmlkU2FtcGxlciA9IGZ1bmN0aW9uIChuZXdHcmlkU2FtcGxlcikgewoJICAgICAgICBHcmlkU2FtcGxlckluc3RhbmNlLmdyaWRTYW1wbGVyID0gbmV3R3JpZFNhbXBsZXI7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHRoZSBjdXJyZW50IGltcGxlbWVudGF0aW9uIG9mIEdyaWRTYW1wbGVyCgkgICAgICovCgkgICAgR3JpZFNhbXBsZXJJbnN0YW5jZS5nZXRJbnN0YW5jZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIEdyaWRTYW1wbGVySW5zdGFuY2UuZ3JpZFNhbXBsZXI7CgkgICAgfTsKCSAgICBHcmlkU2FtcGxlckluc3RhbmNlLmdyaWRTYW1wbGVyID0gbmV3IERlZmF1bHRHcmlkU2FtcGxlcl8xLmRlZmF1bHQoKTsKCSAgICByZXR1cm4gR3JpZFNhbXBsZXJJbnN0YW5jZTsKCX0oKSk7CglHcmlkU2FtcGxlckluc3RhbmNlJDEuZGVmYXVsdCA9IEdyaWRTYW1wbGVySW5zdGFuY2U7CgoJdmFyIFJlc3VsdFBvaW50JDEgPSB7fTsKCgl2YXIgRmxvYXQkMSA9IHt9OwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShGbG9hdCQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKioKCSAqIFBvbnlmaWxsIGZvciBKYXZhJ3MgRmxvYXQgY2xhc3MuCgkgKi8KCXZhciBGbG9hdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBGbG9hdCgpIHsKCSAgICB9CgkgICAgLyoqCgkgICAgICogU2luY1RTIGhhcyBubyBkaWZmZXJlbmNlIGJldHdlZW4gaW50IGFuZCBmbG9hdCwgdGhlcmUncyBhbGwgbnVtYmVycywKCSAgICAgKiB0aGlzIGlzIHVzZWQgb25seSB0byBwb2x5ZmlsbCBKYXZhIGNvZGUuCgkgICAgICovCgkgICAgRmxvYXQuZmxvYXRUb0ludEJpdHMgPSBmdW5jdGlvbiAoZikgewoJICAgICAgICByZXR1cm4gZjsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFRoZSBmbG9hdCBtYXggdmFsdWUgaW4gSlMgaXMgdGhlIG51bWJlciBtYXggdmFsdWUuCgkgICAgICovCgkgICAgRmxvYXQuTUFYX1ZBTFVFID0gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVI7CgkgICAgcmV0dXJuIEZsb2F0OwoJfSgpKTsKCUZsb2F0JDEuZGVmYXVsdCA9IEZsb2F0OwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoUmVzdWx0UG9pbnQkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZyB7Ki8KCXZhciBNYXRoVXRpbHNfMSQxID0gTWF0aFV0aWxzJDE7Cgl2YXIgRmxvYXRfMSA9IEZsb2F0JDE7CgkvKioKCSAqIDxwPkVuY2Fwc3VsYXRlcyBhIHBvaW50IG9mIGludGVyZXN0IGluIGFuIGltYWdlIGNvbnRhaW5pbmcgYSBiYXJjb2RlLiBUeXBpY2FsbHksIHRoaXMKCSAqIHdvdWxkIGJlIHRoZSBsb2NhdGlvbiBvZiBhIGZpbmRlciBwYXR0ZXJuIG9yIHRoZSBjb3JuZXIgb2YgdGhlIGJhcmNvZGUsIGZvciBleGFtcGxlLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgUmVzdWx0UG9pbnQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gUmVzdWx0UG9pbnQoeCwgeSkgewoJICAgICAgICB0aGlzLnggPSB4OwoJICAgICAgICB0aGlzLnkgPSB5OwoJICAgIH0KCSAgICBSZXN1bHRQb2ludC5wcm90b3R5cGUuZ2V0WCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMueDsKCSAgICB9OwoJICAgIFJlc3VsdFBvaW50LnByb3RvdHlwZS5nZXRZID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy55OwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIFJlc3VsdFBvaW50LnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgaWYgKG90aGVyIGluc3RhbmNlb2YgUmVzdWx0UG9pbnQpIHsKCSAgICAgICAgICAgIHZhciBvdGhlclBvaW50ID0gb3RoZXI7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy54ID09PSBvdGhlclBvaW50LnggJiYgdGhpcy55ID09PSBvdGhlclBvaW50Lnk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIFJlc3VsdFBvaW50LnByb3RvdHlwZS5oYXNoQ29kZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIDMxICogRmxvYXRfMS5kZWZhdWx0LmZsb2F0VG9JbnRCaXRzKHRoaXMueCkgKyBGbG9hdF8xLmRlZmF1bHQuZmxvYXRUb0ludEJpdHModGhpcy55KTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBSZXN1bHRQb2ludC5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiAnKCcgKyB0aGlzLnggKyAnLCcgKyB0aGlzLnkgKyAnKSc7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBPcmRlcnMgYW4gYXJyYXkgb2YgdGhyZWUgUmVzdWx0UG9pbnRzIGluIGFuIG9yZGVyIFtBLEIsQ10gc3VjaCB0aGF0IEFCIGlzIGxlc3MgdGhhbiBBQwoJICAgICAqIGFuZCBCQyBpcyBsZXNzIHRoYW4gQUMsIGFuZCB0aGUgYW5nbGUgYmV0d2VlbiBCQyBhbmQgQkEgaXMgbGVzcyB0aGFuIDE4MCBkZWdyZWVzLgoJICAgICAqCgkgICAgICogQHBhcmFtIHBhdHRlcm5zIGFycmF5IG9mIHRocmVlIHtAY29kZSBSZXN1bHRQb2ludH0gdG8gb3JkZXIKCSAgICAgKi8KCSAgICBSZXN1bHRQb2ludC5vcmRlckJlc3RQYXR0ZXJucyA9IGZ1bmN0aW9uIChwYXR0ZXJucykgewoJICAgICAgICAvLyBGaW5kIGRpc3RhbmNlcyBiZXR3ZWVuIHBhdHRlcm4gY2VudGVycwoJICAgICAgICB2YXIgemVyb09uZURpc3RhbmNlID0gdGhpcy5kaXN0YW5jZShwYXR0ZXJuc1swXSwgcGF0dGVybnNbMV0pOwoJICAgICAgICB2YXIgb25lVHdvRGlzdGFuY2UgPSB0aGlzLmRpc3RhbmNlKHBhdHRlcm5zWzFdLCBwYXR0ZXJuc1syXSk7CgkgICAgICAgIHZhciB6ZXJvVHdvRGlzdGFuY2UgPSB0aGlzLmRpc3RhbmNlKHBhdHRlcm5zWzBdLCBwYXR0ZXJuc1syXSk7CgkgICAgICAgIHZhciBwb2ludEE7CgkgICAgICAgIHZhciBwb2ludEI7CgkgICAgICAgIHZhciBwb2ludEM7CgkgICAgICAgIC8vIEFzc3VtZSBvbmUgY2xvc2VzdCB0byBvdGhlciB0d28gaXMgQjsgQSBhbmQgQyB3aWxsIGp1c3QgYmUgZ3Vlc3NlcyBhdCBmaXJzdAoJICAgICAgICBpZiAob25lVHdvRGlzdGFuY2UgPj0gemVyb09uZURpc3RhbmNlICYmIG9uZVR3b0Rpc3RhbmNlID49IHplcm9Ud29EaXN0YW5jZSkgewoJICAgICAgICAgICAgcG9pbnRCID0gcGF0dGVybnNbMF07CgkgICAgICAgICAgICBwb2ludEEgPSBwYXR0ZXJuc1sxXTsKCSAgICAgICAgICAgIHBvaW50QyA9IHBhdHRlcm5zWzJdOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgaWYgKHplcm9Ud29EaXN0YW5jZSA+PSBvbmVUd29EaXN0YW5jZSAmJiB6ZXJvVHdvRGlzdGFuY2UgPj0gemVyb09uZURpc3RhbmNlKSB7CgkgICAgICAgICAgICBwb2ludEIgPSBwYXR0ZXJuc1sxXTsKCSAgICAgICAgICAgIHBvaW50QSA9IHBhdHRlcm5zWzBdOwoJICAgICAgICAgICAgcG9pbnRDID0gcGF0dGVybnNbMl07CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICBwb2ludEIgPSBwYXR0ZXJuc1syXTsKCSAgICAgICAgICAgIHBvaW50QSA9IHBhdHRlcm5zWzBdOwoJICAgICAgICAgICAgcG9pbnRDID0gcGF0dGVybnNbMV07CgkgICAgICAgIH0KCSAgICAgICAgLy8gVXNlIGNyb3NzIHByb2R1Y3QgdG8gZmlndXJlIG91dCB3aGV0aGVyIEEgYW5kIEMgYXJlIGNvcnJlY3Qgb3IgZmxpcHBlZC4KCSAgICAgICAgLy8gVGhpcyBhc2tzIHdoZXRoZXIgQkMgeCBCQSBoYXMgYSBwb3NpdGl2ZSB6IGNvbXBvbmVudCwgd2hpY2ggaXMgdGhlIGFycmFuZ2VtZW50CgkgICAgICAgIC8vIHdlIHdhbnQgZm9yIEEsIEIsIEMuIElmIGl0J3MgbmVnYXRpdmUsIHRoZW4gd2UndmUgZ290IGl0IGZsaXBwZWQgYXJvdW5kIGFuZAoJICAgICAgICAvLyBzaG91bGQgc3dhcCBBIGFuZCBDLgoJICAgICAgICBpZiAodGhpcy5jcm9zc1Byb2R1Y3RaKHBvaW50QSwgcG9pbnRCLCBwb2ludEMpIDwgMC4wKSB7CgkgICAgICAgICAgICB2YXIgdGVtcCA9IHBvaW50QTsKCSAgICAgICAgICAgIHBvaW50QSA9IHBvaW50QzsKCSAgICAgICAgICAgIHBvaW50QyA9IHRlbXA7CgkgICAgICAgIH0KCSAgICAgICAgcGF0dGVybnNbMF0gPSBwb2ludEE7CgkgICAgICAgIHBhdHRlcm5zWzFdID0gcG9pbnRCOwoJICAgICAgICBwYXR0ZXJuc1syXSA9IHBvaW50QzsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBwYXR0ZXJuMSBmaXJzdCBwYXR0ZXJuCgkgICAgICogQHBhcmFtIHBhdHRlcm4yIHNlY29uZCBwYXR0ZXJuCgkgICAgICogQHJldHVybiBkaXN0YW5jZSBiZXR3ZWVuIHR3byBwb2ludHMKCSAgICAgKi8KCSAgICBSZXN1bHRQb2ludC5kaXN0YW5jZSA9IGZ1bmN0aW9uIChwYXR0ZXJuMSwgcGF0dGVybjIpIHsKCSAgICAgICAgcmV0dXJuIE1hdGhVdGlsc18xJDEuZGVmYXVsdC5kaXN0YW5jZShwYXR0ZXJuMS54LCBwYXR0ZXJuMS55LCBwYXR0ZXJuMi54LCBwYXR0ZXJuMi55KTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgdGhlIHogY29tcG9uZW50IG9mIHRoZSBjcm9zcyBwcm9kdWN0IGJldHdlZW4gdmVjdG9ycyBCQyBhbmQgQkEuCgkgICAgICovCgkgICAgUmVzdWx0UG9pbnQuY3Jvc3NQcm9kdWN0WiA9IGZ1bmN0aW9uIChwb2ludEEsIHBvaW50QiwgcG9pbnRDKSB7CgkgICAgICAgIHZhciBiWCA9IHBvaW50Qi54OwoJICAgICAgICB2YXIgYlkgPSBwb2ludEIueTsKCSAgICAgICAgcmV0dXJuICgocG9pbnRDLnggLSBiWCkgKiAocG9pbnRBLnkgLSBiWSkpIC0gKChwb2ludEMueSAtIGJZKSAqIChwb2ludEEueCAtIGJYKSk7CgkgICAgfTsKCSAgICByZXR1cm4gUmVzdWx0UG9pbnQ7Cgl9KCkpOwoJUmVzdWx0UG9pbnQkMS5kZWZhdWx0ID0gUmVzdWx0UG9pbnQ7CgoJdmFyIEFsaWdubWVudFBhdHRlcm5GaW5kZXIkMSA9IHt9OwoKCXZhciBBbGlnbm1lbnRQYXR0ZXJuJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fZXh0ZW5kcyQxID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHsKCSAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKCSAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHwKCSAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9OwoJICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICB9OwoJICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KCSAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwoJICAgIH07Cgl9KSgpOwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEFsaWdubWVudFBhdHRlcm4kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGV0ZWN0b3IgeyovCgl2YXIgUmVzdWx0UG9pbnRfMSQzID0gUmVzdWx0UG9pbnQkMTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIGFuIGFsaWdubWVudCBwYXR0ZXJuLCB3aGljaCBhcmUgdGhlIHNtYWxsZXIgc3F1YXJlIHBhdHRlcm5zIGZvdW5kIGluCgkgKiBhbGwgYnV0IHRoZSBzaW1wbGVzdCBRUiBDb2Rlcy48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEFsaWdubWVudFBhdHRlcm4gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJDEoQWxpZ25tZW50UGF0dGVybiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBBbGlnbm1lbnRQYXR0ZXJuKHBvc1ggLypmbG9hdCovLCBwb3NZIC8qZmxvYXQqLywgZXN0aW1hdGVkTW9kdWxlU2l6ZSAvKmZsb2F0Ki8pIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgcG9zWCwgcG9zWSkgfHwgdGhpczsKCSAgICAgICAgX3RoaXMuZXN0aW1hdGVkTW9kdWxlU2l6ZSA9IGVzdGltYXRlZE1vZHVsZVNpemU7CgkgICAgICAgIHJldHVybiBfdGhpczsKCSAgICB9CgkgICAgLyoqCgkgICAgICogPHA+RGV0ZXJtaW5lcyBpZiB0aGlzIGFsaWdubWVudCBwYXR0ZXJuICJhYm91dCBlcXVhbHMiIGFuIGFsaWdubWVudCBwYXR0ZXJuIGF0IHRoZSBzdGF0ZWQKCSAgICAgKiBwb3NpdGlvbiBhbmQgc2l6ZSAtLSBtZWFuaW5nLCBpdCBpcyBhdCBuZWFybHkgdGhlIHNhbWUgY2VudGVyIHdpdGggbmVhcmx5IHRoZSBzYW1lIHNpemUuPC9wPgoJICAgICAqLwoJICAgIEFsaWdubWVudFBhdHRlcm4ucHJvdG90eXBlLmFib3V0RXF1YWxzID0gZnVuY3Rpb24gKG1vZHVsZVNpemUgLypmbG9hdCovLCBpIC8qZmxvYXQqLywgaiAvKmZsb2F0Ki8pIHsKCSAgICAgICAgaWYgKE1hdGguYWJzKGkgLSB0aGlzLmdldFkoKSkgPD0gbW9kdWxlU2l6ZSAmJiBNYXRoLmFicyhqIC0gdGhpcy5nZXRYKCkpIDw9IG1vZHVsZVNpemUpIHsKCSAgICAgICAgICAgIHZhciBtb2R1bGVTaXplRGlmZiA9IE1hdGguYWJzKG1vZHVsZVNpemUgLSB0aGlzLmVzdGltYXRlZE1vZHVsZVNpemUpOwoJICAgICAgICAgICAgcmV0dXJuIG1vZHVsZVNpemVEaWZmIDw9IDEuMCB8fCBtb2R1bGVTaXplRGlmZiA8PSB0aGlzLmVzdGltYXRlZE1vZHVsZVNpemU7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQ29tYmluZXMgdGhpcyBvYmplY3QncyBjdXJyZW50IGVzdGltYXRlIG9mIGEgZmluZGVyIHBhdHRlcm4gcG9zaXRpb24gYW5kIG1vZHVsZSBzaXplCgkgICAgICogd2l0aCBhIG5ldyBlc3RpbWF0ZS4gSXQgcmV0dXJucyBhIG5ldyB7QGNvZGUgRmluZGVyUGF0dGVybn0gY29udGFpbmluZyBhbiBhdmVyYWdlIG9mIHRoZSB0d28uCgkgICAgICovCgkgICAgQWxpZ25tZW50UGF0dGVybi5wcm90b3R5cGUuY29tYmluZUVzdGltYXRlID0gZnVuY3Rpb24gKGkgLypmbG9hdCovLCBqIC8qZmxvYXQqLywgbmV3TW9kdWxlU2l6ZSAvKmZsb2F0Ki8pIHsKCSAgICAgICAgdmFyIGNvbWJpbmVkWCA9ICh0aGlzLmdldFgoKSArIGopIC8gMi4wOwoJICAgICAgICB2YXIgY29tYmluZWRZID0gKHRoaXMuZ2V0WSgpICsgaSkgLyAyLjA7CgkgICAgICAgIHZhciBjb21iaW5lZE1vZHVsZVNpemUgPSAodGhpcy5lc3RpbWF0ZWRNb2R1bGVTaXplICsgbmV3TW9kdWxlU2l6ZSkgLyAyLjA7CgkgICAgICAgIHJldHVybiBuZXcgQWxpZ25tZW50UGF0dGVybihjb21iaW5lZFgsIGNvbWJpbmVkWSwgY29tYmluZWRNb2R1bGVTaXplKTsKCSAgICB9OwoJICAgIHJldHVybiBBbGlnbm1lbnRQYXR0ZXJuOwoJfShSZXN1bHRQb2ludF8xJDMuZGVmYXVsdCkpOwoJQWxpZ25tZW50UGF0dGVybiQxLmRlZmF1bHQgPSBBbGlnbm1lbnRQYXR0ZXJuOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCgl2YXIgX192YWx1ZXMkMSA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX3ZhbHVlcykgfHwgZnVuY3Rpb24obykgewoJICAgIHZhciBzID0gdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBTeW1ib2wuaXRlcmF0b3IsIG0gPSBzICYmIG9bc10sIGkgPSAwOwoJICAgIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pOwoJICAgIGlmIChvICYmIHR5cGVvZiBvLmxlbmd0aCA9PT0gIm51bWJlciIpIHJldHVybiB7CgkgICAgICAgIG5leHQ6IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgICAgIGlmIChvICYmIGkgPj0gby5sZW5ndGgpIG8gPSB2b2lkIDA7CgkgICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogbyAmJiBvW2krK10sIGRvbmU6ICFvIH07CgkgICAgICAgIH0KCSAgICB9OwoJICAgIHRocm93IG5ldyBUeXBlRXJyb3IocyA/ICJPYmplY3QgaXMgbm90IGl0ZXJhYmxlLiIgOiAiU3ltYm9sLml0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLiIpOwoJfTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShBbGlnbm1lbnRQYXR0ZXJuRmluZGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBBbGlnbm1lbnRQYXR0ZXJuXzEgPSBBbGlnbm1lbnRQYXR0ZXJuJDE7Cgl2YXIgTm90Rm91bmRFeGNlcHRpb25fMSQzID0gTm90Rm91bmRFeGNlcHRpb24kMTsKCS8qaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5MaXN0OyovCgkvKioKCSAqIDxwPlRoaXMgY2xhc3MgYXR0ZW1wdHMgdG8gZmluZCBhbGlnbm1lbnQgcGF0dGVybnMgaW4gYSBRUiBDb2RlLiBBbGlnbm1lbnQgcGF0dGVybnMgbG9vayBsaWtlIGZpbmRlcgoJICogcGF0dGVybnMgYnV0IGFyZSBzbWFsbGVyIGFuZCBhcHBlYXIgYXQgcmVndWxhciBpbnRlcnZhbHMgdGhyb3VnaG91dCB0aGUgaW1hZ2UuPC9wPgoJICoKCSAqIDxwPkF0IHRoZSBtb21lbnQgdGhpcyBvbmx5IGxvb2tzIGZvciB0aGUgYm90dG9tLXJpZ2h0IGFsaWdubWVudCBwYXR0ZXJuLjwvcD4KCSAqCgkgKiA8cD5UaGlzIGlzIG1vc3RseSBhIHNpbXBsaWZpZWQgY29weSBvZiB7QGxpbmsgRmluZGVyUGF0dGVybkZpbmRlcn0uIEl0IGlzIGNvcGllZCwKCSAqIHBhc3RlZCBhbmQgc3RyaXBwZWQgZG93biBoZXJlIGZvciBtYXhpbXVtIHBlcmZvcm1hbmNlIGJ1dCBkb2VzIHVuZm9ydHVuYXRlbHkgZHVwbGljYXRlCgkgKiBzb21lIGNvZGUuPC9wPgoJICoKCSAqIDxwPlRoaXMgY2xhc3MgaXMgdGhyZWFkLXNhZmUgYnV0IG5vdCByZWVudHJhbnQuIEVhY2ggdGhyZWFkIG11c3QgYWxsb2NhdGUgaXRzIG93biBvYmplY3QuPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIC8qKgoJICAgICAqIDxwPkNyZWF0ZXMgYSBmaW5kZXIgdGhhdCB3aWxsIGxvb2sgaW4gYSBwb3J0aW9uIG9mIHRoZSB3aG9sZSBpbWFnZS48L3A+CgkgICAgICoKCSAgICAgKiBAcGFyYW0gaW1hZ2UgaW1hZ2UgdG8gc2VhcmNoCgkgICAgICogQHBhcmFtIHN0YXJ0WCBsZWZ0IGNvbHVtbiBmcm9tIHdoaWNoIHRvIHN0YXJ0IHNlYXJjaGluZwoJICAgICAqIEBwYXJhbSBzdGFydFkgdG9wIHJvdyBmcm9tIHdoaWNoIHRvIHN0YXJ0IHNlYXJjaGluZwoJICAgICAqIEBwYXJhbSB3aWR0aCB3aWR0aCBvZiByZWdpb24gdG8gc2VhcmNoCgkgICAgICogQHBhcmFtIGhlaWdodCBoZWlnaHQgb2YgcmVnaW9uIHRvIHNlYXJjaAoJICAgICAqIEBwYXJhbSBtb2R1bGVTaXplIGVzdGltYXRlZCBtb2R1bGUgc2l6ZSBzbyBmYXIKCSAgICAgKi8KCSAgICBmdW5jdGlvbiBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyKGltYWdlLCBzdGFydFggLyppbnQqLywgc3RhcnRZIC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovLCBtb2R1bGVTaXplIC8qZmxvYXQqLywgcmVzdWx0UG9pbnRDYWxsYmFjaykgewoJICAgICAgICB0aGlzLmltYWdlID0gaW1hZ2U7CgkgICAgICAgIHRoaXMuc3RhcnRYID0gc3RhcnRYOwoJICAgICAgICB0aGlzLnN0YXJ0WSA9IHN0YXJ0WTsKCSAgICAgICAgdGhpcy53aWR0aCA9IHdpZHRoOwoJICAgICAgICB0aGlzLmhlaWdodCA9IGhlaWdodDsKCSAgICAgICAgdGhpcy5tb2R1bGVTaXplID0gbW9kdWxlU2l6ZTsKCSAgICAgICAgdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrID0gcmVzdWx0UG9pbnRDYWxsYmFjazsKCSAgICAgICAgdGhpcy5wb3NzaWJsZUNlbnRlcnMgPSBbXTsgLy8gbmV3IEFycmF5PGFueT4oNSkpCgkgICAgICAgIC8vIFRZUEVTQ1JJUFRQT1JUOiBhcnJheSBpbml0aWFsaXphdGlvbiB3aXRob3V0IHNpemUgYXMgdGhlIGxlbmd0aCBpcyBjaGVja2VkIGJlbG93CgkgICAgICAgIHRoaXMuY3Jvc3NDaGVja1N0YXRlQ291bnQgPSBuZXcgSW50MzJBcnJheSgzKTsKCSAgICB9CgkgICAgLyoqCgkgICAgICogPHA+VGhpcyBtZXRob2QgYXR0ZW1wdHMgdG8gZmluZCB0aGUgYm90dG9tLXJpZ2h0IGFsaWdubWVudCBwYXR0ZXJuIGluIHRoZSBpbWFnZS4gSXQgaXMgYSBiaXQgbWVzc3kgc2luY2UKCSAgICAgKiBpdCdzIHByZXR0eSBwZXJmb3JtYW5jZS1jcml0aWNhbCBhbmQgc28gaXMgd3JpdHRlbiB0byBiZSBmYXN0IGZvcmVtb3N0LjwvcD4KCSAgICAgKgoJICAgICAqIEByZXR1cm4ge0BsaW5rIEFsaWdubWVudFBhdHRlcm59IGlmIGZvdW5kCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBub3QgZm91bmQKCSAgICAgKi8KCSAgICBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5maW5kID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgc3RhcnRYID0gdGhpcy5zdGFydFg7CgkgICAgICAgIHZhciBoZWlnaHQgPSB0aGlzLmhlaWdodDsKCSAgICAgICAgdmFyIHdpZHRoID0gdGhpcy53aWR0aDsKCSAgICAgICAgdmFyIG1heEogPSBzdGFydFggKyB3aWR0aDsKCSAgICAgICAgdmFyIG1pZGRsZUkgPSB0aGlzLnN0YXJ0WSArIChoZWlnaHQgLyAyKTsKCSAgICAgICAgLy8gV2UgYXJlIGxvb2tpbmcgZm9yIGJsYWNrL3doaXRlL2JsYWNrIG1vZHVsZXMgaW4gMToxOjEgcmF0aW8KCSAgICAgICAgLy8gdGhpcyB0cmFja3MgdGhlIG51bWJlciBvZiBibGFjay93aGl0ZS9ibGFjayBtb2R1bGVzIHNlZW4gc28gZmFyCgkgICAgICAgIHZhciBzdGF0ZUNvdW50ID0gbmV3IEludDMyQXJyYXkoMyk7CgkgICAgICAgIHZhciBpbWFnZSA9IHRoaXMuaW1hZ2U7CgkgICAgICAgIGZvciAodmFyIGlHZW4gPSAwOyBpR2VuIDwgaGVpZ2h0OyBpR2VuKyspIHsKCSAgICAgICAgICAgIC8vIFNlYXJjaCBmcm9tIG1pZGRsZSBvdXR3YXJkcwoJICAgICAgICAgICAgdmFyIGkgPSBtaWRkbGVJICsgKChpR2VuICYgMHgwMSkgPT09IDAgPyBNYXRoLmZsb29yKChpR2VuICsgMSkgLyAyKSA6IC1NYXRoLmZsb29yKChpR2VuICsgMSkgLyAyKSk7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzBdID0gMDsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbMV0gPSAwOwoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSA9IDA7CgkgICAgICAgICAgICB2YXIgaiA9IHN0YXJ0WDsKCSAgICAgICAgICAgIC8vIEJ1cm4gb2ZmIGxlYWRpbmcgd2hpdGUgcGl4ZWxzIGJlZm9yZSBhbnl0aGluZyBlbHNlOyBpZiB3ZSBzdGFydCBpbiB0aGUgbWlkZGxlIG9mCgkgICAgICAgICAgICAvLyBhIHdoaXRlIHJ1biwgaXQgZG9lc24ndCBtYWtlIHNlbnNlIHRvIGNvdW50IGl0cyBsZW5ndGgsIHNpbmNlIHdlIGRvbid0IGtub3cgaWYgdGhlCgkgICAgICAgICAgICAvLyB3aGl0ZSBydW4gY29udGludWVkIHRvIHRoZSBsZWZ0IG9mIHRoZSBzdGFydCBwb2ludAoJICAgICAgICAgICAgd2hpbGUgKGogPCBtYXhKICYmICFpbWFnZS5nZXQoaiwgaSkpIHsKCSAgICAgICAgICAgICAgICBqKys7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB2YXIgY3VycmVudFN0YXRlID0gMDsKCSAgICAgICAgICAgIHdoaWxlIChqIDwgbWF4SikgewoJICAgICAgICAgICAgICAgIGlmIChpbWFnZS5nZXQoaiwgaSkpIHsKCSAgICAgICAgICAgICAgICAgICAgLy8gQmxhY2sgcGl4ZWwKCSAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRTdGF0ZSA9PT0gMSkgeyAvLyBDb3VudGluZyBibGFjayBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbMV0rKzsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBlbHNlIHsgLy8gQ291bnRpbmcgd2hpdGUgcGl4ZWxzCgkgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudFN0YXRlID09PSAyKSB7IC8vIEEgd2lubmVyPwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmZvdW5kUGF0dGVybkNyb3NzKHN0YXRlQ291bnQpKSB7IC8vIFllcwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29uZmlybWVkID0gdGhpcy5oYW5kbGVQb3NzaWJsZUNlbnRlcihzdGF0ZUNvdW50LCBpLCBqKTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbmZpcm1lZCAhPT0gbnVsbCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbmZpcm1lZDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzBdID0gc3RhdGVDb3VudFsyXTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzFdID0gMTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzJdID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50U3RhdGUgPSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFsrK2N1cnJlbnRTdGF0ZV0rKzsKCSAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIHsgLy8gV2hpdGUgcGl4ZWwKCSAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRTdGF0ZSA9PT0gMSkgeyAvLyBDb3VudGluZyBibGFjayBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRTdGF0ZSsrOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbY3VycmVudFN0YXRlXSsrOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBqKys7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBpZiAodGhpcy5mb3VuZFBhdHRlcm5Dcm9zcyhzdGF0ZUNvdW50KSkgewoJICAgICAgICAgICAgICAgIHZhciBjb25maXJtZWQgPSB0aGlzLmhhbmRsZVBvc3NpYmxlQ2VudGVyKHN0YXRlQ291bnQsIGksIG1heEopOwoJICAgICAgICAgICAgICAgIGlmIChjb25maXJtZWQgIT09IG51bGwpIHsKCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbmZpcm1lZDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gSG1tLCBub3RoaW5nIHdlIHNhdyB3YXMgb2JzZXJ2ZWQgYW5kIGNvbmZpcm1lZCB0d2ljZS4gSWYgd2UgaGFkCgkgICAgICAgIC8vIGFueSBndWVzcyBhdCBhbGwsIHJldHVybiBpdC4KCSAgICAgICAgaWYgKHRoaXMucG9zc2libGVDZW50ZXJzLmxlbmd0aCAhPT0gMCkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMucG9zc2libGVDZW50ZXJzWzBdOwoJICAgICAgICB9CgkgICAgICAgIHRocm93IG5ldyBOb3RGb3VuZEV4Y2VwdGlvbl8xJDMuZGVmYXVsdCgpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogR2l2ZW4gYSBjb3VudCBvZiBibGFjay93aGl0ZS9ibGFjayBwaXhlbHMganVzdCBzZWVuIGFuZCBhbiBlbmQgcG9zaXRpb24sCgkgICAgICogZmlndXJlcyB0aGUgbG9jYXRpb24gb2YgdGhlIGNlbnRlciBvZiB0aGlzIGJsYWNrL3doaXRlL2JsYWNrIHJ1bi4KCSAgICAgKi8KCSAgICBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyLmNlbnRlckZyb21FbmQgPSBmdW5jdGlvbiAoc3RhdGVDb3VudCwgZW5kIC8qaW50Ki8pIHsKCSAgICAgICAgcmV0dXJuIChlbmQgLSBzdGF0ZUNvdW50WzJdKSAtIHN0YXRlQ291bnRbMV0gLyAyLjA7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gc3RhdGVDb3VudCBjb3VudCBvZiBibGFjay93aGl0ZS9ibGFjayBwaXhlbHMganVzdCByZWFkCgkgICAgICogQHJldHVybiB0cnVlIGlmZiB0aGUgcHJvcG9ydGlvbnMgb2YgdGhlIGNvdW50cyBpcyBjbG9zZSBlbm91Z2ggdG8gdGhlIDEvMS8xIHJhdGlvcwoJICAgICAqICAgICAgICAgdXNlZCBieSBhbGlnbm1lbnQgcGF0dGVybnMgdG8gYmUgY29uc2lkZXJlZCBhIG1hdGNoCgkgICAgICovCgkgICAgQWxpZ25tZW50UGF0dGVybkZpbmRlci5wcm90b3R5cGUuZm91bmRQYXR0ZXJuQ3Jvc3MgPSBmdW5jdGlvbiAoc3RhdGVDb3VudCkgewoJICAgICAgICB2YXIgbW9kdWxlU2l6ZSA9IHRoaXMubW9kdWxlU2l6ZTsKCSAgICAgICAgdmFyIG1heFZhcmlhbmNlID0gbW9kdWxlU2l6ZSAvIDIuMDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAzOyBpKyspIHsKCSAgICAgICAgICAgIGlmIChNYXRoLmFicyhtb2R1bGVTaXplIC0gc3RhdGVDb3VudFtpXSkgPj0gbWF4VmFyaWFuY2UpIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRydWU7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiA8cD5BZnRlciBhIGhvcml6b250YWwgc2NhbiBmaW5kcyBhIHBvdGVudGlhbCBhbGlnbm1lbnQgcGF0dGVybiwgdGhpcyBtZXRob2QKCSAgICAgKiAiY3Jvc3MtY2hlY2tzIiBieSBzY2FubmluZyBkb3duIHZlcnRpY2FsbHkgdGhyb3VnaCB0aGUgY2VudGVyIG9mIHRoZSBwb3NzaWJsZQoJICAgICAqIGFsaWdubWVudCBwYXR0ZXJuIHRvIHNlZSBpZiB0aGUgc2FtZSBwcm9wb3J0aW9uIGlzIGRldGVjdGVkLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBzdGFydEkgcm93IHdoZXJlIGFuIGFsaWdubWVudCBwYXR0ZXJuIHdhcyBkZXRlY3RlZAoJICAgICAqIEBwYXJhbSBjZW50ZXJKIGNlbnRlciBvZiB0aGUgc2VjdGlvbiB0aGF0IGFwcGVhcnMgdG8gY3Jvc3MgYW4gYWxpZ25tZW50IHBhdHRlcm4KCSAgICAgKiBAcGFyYW0gbWF4Q291bnQgbWF4aW11bSByZWFzb25hYmxlIG51bWJlciBvZiBtb2R1bGVzIHRoYXQgc2hvdWxkIGJlCgkgICAgICogb2JzZXJ2ZWQgaW4gYW55IHJlYWRpbmcgc3RhdGUsIGJhc2VkIG9uIHRoZSByZXN1bHRzIG9mIHRoZSBob3Jpem9udGFsIHNjYW4KCSAgICAgKiBAcmV0dXJuIHZlcnRpY2FsIGNlbnRlciBvZiBhbGlnbm1lbnQgcGF0dGVybiwgb3Ige0BsaW5rIEZsb2F0I05hTn0gaWYgbm90IGZvdW5kCgkgICAgICovCgkgICAgQWxpZ25tZW50UGF0dGVybkZpbmRlci5wcm90b3R5cGUuY3Jvc3NDaGVja1ZlcnRpY2FsID0gZnVuY3Rpb24gKHN0YXJ0SSAvKmludCovLCBjZW50ZXJKIC8qaW50Ki8sIG1heENvdW50IC8qaW50Ki8sIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGltYWdlID0gdGhpcy5pbWFnZTsKCSAgICAgICAgdmFyIG1heEkgPSBpbWFnZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgdmFyIHN0YXRlQ291bnQgPSB0aGlzLmNyb3NzQ2hlY2tTdGF0ZUNvdW50OwoJICAgICAgICBzdGF0ZUNvdW50WzBdID0gMDsKCSAgICAgICAgc3RhdGVDb3VudFsxXSA9IDA7CgkgICAgICAgIHN0YXRlQ291bnRbMl0gPSAwOwoJICAgICAgICAvLyBTdGFydCBjb3VudGluZyB1cCBmcm9tIGNlbnRlcgoJICAgICAgICB2YXIgaSA9IHN0YXJ0STsKCSAgICAgICAgd2hpbGUgKGkgPj0gMCAmJiBpbWFnZS5nZXQoY2VudGVySiwgaSkgJiYgc3RhdGVDb3VudFsxXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsxXSsrOwoJICAgICAgICAgICAgaS0tOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIGFscmVhZHkgdG9vIG1hbnkgbW9kdWxlcyBpbiB0aGlzIHN0YXRlIG9yIHJhbiBvZmYgdGhlIGVkZ2U6CgkgICAgICAgIGlmIChpIDwgMCB8fCBzdGF0ZUNvdW50WzFdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKGkgPj0gMCAmJiAhaW1hZ2UuZ2V0KGNlbnRlckosIGkpICYmIHN0YXRlQ291bnRbMF0gPD0gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbMF0rKzsKCSAgICAgICAgICAgIGktLTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoc3RhdGVDb3VudFswXSA+IG1heENvdW50KSB7CgkgICAgICAgICAgICByZXR1cm4gTmFOOwoJICAgICAgICB9CgkgICAgICAgIC8vIE5vdyBhbHNvIGNvdW50IGRvd24gZnJvbSBjZW50ZXIKCSAgICAgICAgaSA9IHN0YXJ0SSArIDE7CgkgICAgICAgIHdoaWxlIChpIDwgbWF4SSAmJiBpbWFnZS5nZXQoY2VudGVySiwgaSkgJiYgc3RhdGVDb3VudFsxXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsxXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChpID09PSBtYXhJIHx8IHN0YXRlQ291bnRbMV0gPiBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB3aGlsZSAoaSA8IG1heEkgJiYgIWltYWdlLmdldChjZW50ZXJKLCBpKSAmJiBzdGF0ZUNvdW50WzJdIDw9IG1heENvdW50KSB7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzJdKys7CgkgICAgICAgICAgICBpKys7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHN0YXRlQ291bnRbMl0gPiBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB2YXIgc3RhdGVDb3VudFRvdGFsID0gc3RhdGVDb3VudFswXSArIHN0YXRlQ291bnRbMV0gKyBzdGF0ZUNvdW50WzJdOwoJICAgICAgICBpZiAoNSAqIE1hdGguYWJzKHN0YXRlQ291bnRUb3RhbCAtIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsKSA+PSAyICogb3JpZ2luYWxTdGF0ZUNvdW50VG90YWwpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRoaXMuZm91bmRQYXR0ZXJuQ3Jvc3Moc3RhdGVDb3VudCkgPyBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyLmNlbnRlckZyb21FbmQoc3RhdGVDb3VudCwgaSkgOiBOYU47CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiA8cD5UaGlzIGlzIGNhbGxlZCB3aGVuIGEgaG9yaXpvbnRhbCBzY2FuIGZpbmRzIGEgcG9zc2libGUgYWxpZ25tZW50IHBhdHRlcm4uIEl0IHdpbGwKCSAgICAgKiBjcm9zcyBjaGVjayB3aXRoIGEgdmVydGljYWwgc2NhbiwgYW5kIGlmIHN1Y2Nlc3NmdWwsIHdpbGwgc2VlIGlmIHRoaXMgcGF0dGVybiBoYWQgYmVlbgoJICAgICAqIGZvdW5kIG9uIGEgcHJldmlvdXMgaG9yaXpvbnRhbCBzY2FuLiBJZiBzbywgd2UgY29uc2lkZXIgaXQgY29uZmlybWVkIGFuZCBjb25jbHVkZSB3ZSBoYXZlCgkgICAgICogZm91bmQgdGhlIGFsaWdubWVudCBwYXR0ZXJuLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBzdGF0ZUNvdW50IHJlYWRpbmcgc3RhdGUgbW9kdWxlIGNvdW50cyBmcm9tIGhvcml6b250YWwgc2NhbgoJICAgICAqIEBwYXJhbSBpIHJvdyB3aGVyZSBhbGlnbm1lbnQgcGF0dGVybiBtYXkgYmUgZm91bmQKCSAgICAgKiBAcGFyYW0gaiBlbmQgb2YgcG9zc2libGUgYWxpZ25tZW50IHBhdHRlcm4gaW4gcm93CgkgICAgICogQHJldHVybiB7QGxpbmsgQWxpZ25tZW50UGF0dGVybn0gaWYgd2UgaGF2ZSBmb3VuZCB0aGUgc2FtZSBwYXR0ZXJuIHR3aWNlLCBvciBudWxsIGlmIG5vdAoJICAgICAqLwoJICAgIEFsaWdubWVudFBhdHRlcm5GaW5kZXIucHJvdG90eXBlLmhhbmRsZVBvc3NpYmxlQ2VudGVyID0gZnVuY3Rpb24gKHN0YXRlQ291bnQsIGkgLyppbnQqLywgaiAvKmludCovKSB7CgkgICAgICAgIHZhciBlXzEsIF9hOwoJICAgICAgICB2YXIgc3RhdGVDb3VudFRvdGFsID0gc3RhdGVDb3VudFswXSArIHN0YXRlQ291bnRbMV0gKyBzdGF0ZUNvdW50WzJdOwoJICAgICAgICB2YXIgY2VudGVySiA9IEFsaWdubWVudFBhdHRlcm5GaW5kZXIuY2VudGVyRnJvbUVuZChzdGF0ZUNvdW50LCBqKTsKCSAgICAgICAgdmFyIGNlbnRlckkgPSB0aGlzLmNyb3NzQ2hlY2tWZXJ0aWNhbChpLCAvKihpbnQpICovIGNlbnRlckosIDIgKiBzdGF0ZUNvdW50WzFdLCBzdGF0ZUNvdW50VG90YWwpOwoJICAgICAgICBpZiAoIWlzTmFOKGNlbnRlckkpKSB7CgkgICAgICAgICAgICB2YXIgZXN0aW1hdGVkTW9kdWxlU2l6ZSA9IChzdGF0ZUNvdW50WzBdICsgc3RhdGVDb3VudFsxXSArIHN0YXRlQ291bnRbMl0pIC8gMy4wOwoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBmb3IgKHZhciBfYiA9IF9fdmFsdWVzJDEodGhpcy5wb3NzaWJsZUNlbnRlcnMpLCBfYyA9IF9iLm5leHQoKTsgIV9jLmRvbmU7IF9jID0gX2IubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgICAgIHZhciBjZW50ZXIgPSBfYy52YWx1ZTsKCSAgICAgICAgICAgICAgICAgICAgLy8gTG9vayBmb3IgYWJvdXQgdGhlIHNhbWUgY2VudGVyIGFuZCBtb2R1bGUgc2l6ZToKCSAgICAgICAgICAgICAgICAgICAgaWYgKGNlbnRlci5hYm91dEVxdWFscyhlc3RpbWF0ZWRNb2R1bGVTaXplLCBjZW50ZXJJLCBjZW50ZXJKKSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNlbnRlci5jb21iaW5lRXN0aW1hdGUoY2VudGVySSwgY2VudGVySiwgZXN0aW1hdGVkTW9kdWxlU2l6ZSk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBjYXRjaCAoZV8xXzEpIHsgZV8xID0geyBlcnJvcjogZV8xXzEgfTsgfQoJICAgICAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKF9jICYmICFfYy5kb25lICYmIChfYSA9IF9iLnJldHVybikpIF9hLmNhbGwoX2IpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICAvLyBIYWRuJ3QgZm91bmQgdGhpcyBiZWZvcmU7IHNhdmUgaXQKCSAgICAgICAgICAgIHZhciBwb2ludCA9IG5ldyBBbGlnbm1lbnRQYXR0ZXJuXzEuZGVmYXVsdChjZW50ZXJKLCBjZW50ZXJJLCBlc3RpbWF0ZWRNb2R1bGVTaXplKTsKCSAgICAgICAgICAgIHRoaXMucG9zc2libGVDZW50ZXJzLnB1c2gocG9pbnQpOwoJICAgICAgICAgICAgaWYgKHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayAhPT0gbnVsbCAmJiB0aGlzLnJlc3VsdFBvaW50Q2FsbGJhY2sgIT09IHVuZGVmaW5lZCkgewoJICAgICAgICAgICAgICAgIHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjay5mb3VuZFBvc3NpYmxlUmVzdWx0UG9pbnQocG9pbnQpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBudWxsOwoJICAgIH07CgkgICAgcmV0dXJuIEFsaWdubWVudFBhdHRlcm5GaW5kZXI7Cgl9KCkpOwoJQWxpZ25tZW50UGF0dGVybkZpbmRlciQxLmRlZmF1bHQgPSBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyOwoKCXZhciBGaW5kZXJQYXR0ZXJuRmluZGVyJDEgPSB7fTsKCgl2YXIgRmluZGVyUGF0dGVybiQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCXZhciBfX2V4dGVuZHMgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRmluZGVyUGF0dGVybiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLnFyY29kZS5kZXRlY3RvciB7Ki8KCXZhciBSZXN1bHRQb2ludF8xJDIgPSBSZXN1bHRQb2ludCQxOwoJLyoqCgkgKiA8cD5FbmNhcHN1bGF0ZXMgYSBmaW5kZXIgcGF0dGVybiwgd2hpY2ggYXJlIHRoZSB0aHJlZSBzcXVhcmUgcGF0dGVybnMgZm91bmQgaW4KCSAqIHRoZSBjb3JuZXJzIG9mIFFSIENvZGVzLiBJdCBhbHNvIGVuY2Fwc3VsYXRlcyBhIGNvdW50IG9mIHNpbWlsYXIgZmluZGVyIHBhdHRlcm5zLAoJICogYXMgYSBjb252ZW5pZW5jZSB0byB0aGUgZmluZGVyJ3MgYm9va2tlZXBpbmcuPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBGaW5kZXJQYXR0ZXJuID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyhGaW5kZXJQYXR0ZXJuLCBfc3VwZXIpOwoJICAgIC8vIEZpbmRlclBhdHRlcm4ocG9zWDogbnVtYmVyLypmbG9hdCovLCBwb3NZOiBudW1iZXIvKmZsb2F0Ki8sIGVzdGltYXRlZE1vZHVsZVNpemU6IG51bWJlci8qZmxvYXQqLykgewoJICAgIC8vICAgdGhpcyhwb3NYLCBwb3NZLCBlc3RpbWF0ZWRNb2R1bGVTaXplLCAxKQoJICAgIC8vIH0KCSAgICBmdW5jdGlvbiBGaW5kZXJQYXR0ZXJuKHBvc1ggLypmbG9hdCovLCBwb3NZIC8qZmxvYXQqLywgZXN0aW1hdGVkTW9kdWxlU2l6ZSAvKmZsb2F0Ki8sIGNvdW50IC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgcG9zWCwgcG9zWSkgfHwgdGhpczsKCSAgICAgICAgX3RoaXMuZXN0aW1hdGVkTW9kdWxlU2l6ZSA9IGVzdGltYXRlZE1vZHVsZVNpemU7CgkgICAgICAgIF90aGlzLmNvdW50ID0gY291bnQ7CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IGNvdW50KSB7CgkgICAgICAgICAgICBfdGhpcy5jb3VudCA9IDE7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICBGaW5kZXJQYXR0ZXJuLnByb3RvdHlwZS5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5lc3RpbWF0ZWRNb2R1bGVTaXplOwoJICAgIH07CgkgICAgRmluZGVyUGF0dGVybi5wcm90b3R5cGUuZ2V0Q291bnQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmNvdW50OwoJICAgIH07CgkgICAgLyoKCSAgICB2b2lkIGluY3JlbWVudENvdW50KCkgewoJICAgICAgdGhpcy5jb3VudCsrCgkgICAgfQoJICAgICAqLwoJICAgIC8qKgoJICAgICAqIDxwPkRldGVybWluZXMgaWYgdGhpcyBmaW5kZXIgcGF0dGVybiAiYWJvdXQgZXF1YWxzIiBhIGZpbmRlciBwYXR0ZXJuIGF0IHRoZSBzdGF0ZWQKCSAgICAgKiBwb3NpdGlvbiBhbmQgc2l6ZSAtLSBtZWFuaW5nLCBpdCBpcyBhdCBuZWFybHkgdGhlIHNhbWUgY2VudGVyIHdpdGggbmVhcmx5IHRoZSBzYW1lIHNpemUuPC9wPgoJICAgICAqLwoJICAgIEZpbmRlclBhdHRlcm4ucHJvdG90eXBlLmFib3V0RXF1YWxzID0gZnVuY3Rpb24gKG1vZHVsZVNpemUgLypmbG9hdCovLCBpIC8qZmxvYXQqLywgaiAvKmZsb2F0Ki8pIHsKCSAgICAgICAgaWYgKE1hdGguYWJzKGkgLSB0aGlzLmdldFkoKSkgPD0gbW9kdWxlU2l6ZSAmJiBNYXRoLmFicyhqIC0gdGhpcy5nZXRYKCkpIDw9IG1vZHVsZVNpemUpIHsKCSAgICAgICAgICAgIHZhciBtb2R1bGVTaXplRGlmZiA9IE1hdGguYWJzKG1vZHVsZVNpemUgLSB0aGlzLmVzdGltYXRlZE1vZHVsZVNpemUpOwoJICAgICAgICAgICAgcmV0dXJuIG1vZHVsZVNpemVEaWZmIDw9IDEuMCB8fCBtb2R1bGVTaXplRGlmZiA8PSB0aGlzLmVzdGltYXRlZE1vZHVsZVNpemU7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQ29tYmluZXMgdGhpcyBvYmplY3QncyBjdXJyZW50IGVzdGltYXRlIG9mIGEgZmluZGVyIHBhdHRlcm4gcG9zaXRpb24gYW5kIG1vZHVsZSBzaXplCgkgICAgICogd2l0aCBhIG5ldyBlc3RpbWF0ZS4gSXQgcmV0dXJucyBhIG5ldyB7QGNvZGUgRmluZGVyUGF0dGVybn0gY29udGFpbmluZyBhIHdlaWdodGVkIGF2ZXJhZ2UKCSAgICAgKiBiYXNlZCBvbiBjb3VudC4KCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuLnByb3RvdHlwZS5jb21iaW5lRXN0aW1hdGUgPSBmdW5jdGlvbiAoaSAvKmZsb2F0Ki8sIGogLypmbG9hdCovLCBuZXdNb2R1bGVTaXplIC8qZmxvYXQqLykgewoJICAgICAgICB2YXIgY29tYmluZWRDb3VudCA9IHRoaXMuY291bnQgKyAxOwoJICAgICAgICB2YXIgY29tYmluZWRYID0gKHRoaXMuY291bnQgKiB0aGlzLmdldFgoKSArIGopIC8gY29tYmluZWRDb3VudDsKCSAgICAgICAgdmFyIGNvbWJpbmVkWSA9ICh0aGlzLmNvdW50ICogdGhpcy5nZXRZKCkgKyBpKSAvIGNvbWJpbmVkQ291bnQ7CgkgICAgICAgIHZhciBjb21iaW5lZE1vZHVsZVNpemUgPSAodGhpcy5jb3VudCAqIHRoaXMuZXN0aW1hdGVkTW9kdWxlU2l6ZSArIG5ld01vZHVsZVNpemUpIC8gY29tYmluZWRDb3VudDsKCSAgICAgICAgcmV0dXJuIG5ldyBGaW5kZXJQYXR0ZXJuKGNvbWJpbmVkWCwgY29tYmluZWRZLCBjb21iaW5lZE1vZHVsZVNpemUsIGNvbWJpbmVkQ291bnQpOwoJICAgIH07CgkgICAgcmV0dXJuIEZpbmRlclBhdHRlcm47Cgl9KFJlc3VsdFBvaW50XzEkMi5kZWZhdWx0KSk7CglGaW5kZXJQYXR0ZXJuJDEuZGVmYXVsdCA9IEZpbmRlclBhdHRlcm47CgoJdmFyIEZpbmRlclBhdHRlcm5JbmZvJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEZpbmRlclBhdHRlcm5JbmZvJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIGluZm9ybWF0aW9uIGFib3V0IGZpbmRlciBwYXR0ZXJucyBpbiBhbiBpbWFnZSwgaW5jbHVkaW5nIHRoZSBsb2NhdGlvbiBvZgoJICogdGhlIHRocmVlIGZpbmRlciBwYXR0ZXJucywgYW5kIHRoZWlyIGVzdGltYXRlZCBtb2R1bGUgc2l6ZS48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEZpbmRlclBhdHRlcm5JbmZvID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEZpbmRlclBhdHRlcm5JbmZvKHBhdHRlcm5DZW50ZXJzKSB7CgkgICAgICAgIHRoaXMuYm90dG9tTGVmdCA9IHBhdHRlcm5DZW50ZXJzWzBdOwoJICAgICAgICB0aGlzLnRvcExlZnQgPSBwYXR0ZXJuQ2VudGVyc1sxXTsKCSAgICAgICAgdGhpcy50b3BSaWdodCA9IHBhdHRlcm5DZW50ZXJzWzJdOwoJICAgIH0KCSAgICBGaW5kZXJQYXR0ZXJuSW5mby5wcm90b3R5cGUuZ2V0Qm90dG9tTGVmdCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYm90dG9tTGVmdDsKCSAgICB9OwoJICAgIEZpbmRlclBhdHRlcm5JbmZvLnByb3RvdHlwZS5nZXRUb3BMZWZ0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy50b3BMZWZ0OwoJICAgIH07CgkgICAgRmluZGVyUGF0dGVybkluZm8ucHJvdG90eXBlLmdldFRvcFJpZ2h0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy50b3BSaWdodDsKCSAgICB9OwoJICAgIHJldHVybiBGaW5kZXJQYXR0ZXJuSW5mbzsKCX0oKSk7CglGaW5kZXJQYXR0ZXJuSW5mbyQxLmRlZmF1bHQgPSBGaW5kZXJQYXR0ZXJuSW5mbzsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fdmFsdWVzKSB8fCBmdW5jdGlvbihvKSB7CgkgICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7CgkgICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7CgkgICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSAibnVtYmVyIikgcmV0dXJuIHsKCSAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDsKCSAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gIk9iamVjdCBpcyBub3QgaXRlcmFibGUuIiA6ICJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuIik7Cgl9OwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEZpbmRlclBhdHRlcm5GaW5kZXIkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGV0ZWN0b3IgeyovCgl2YXIgRGVjb2RlSGludFR5cGVfMSQyID0gRGVjb2RlSGludFR5cGUkMTsKCXZhciBSZXN1bHRQb2ludF8xJDEgPSBSZXN1bHRQb2ludCQxOwoJdmFyIEZpbmRlclBhdHRlcm5fMSA9IEZpbmRlclBhdHRlcm4kMTsKCXZhciBGaW5kZXJQYXR0ZXJuSW5mb18xID0gRmluZGVyUGF0dGVybkluZm8kMTsKCXZhciBOb3RGb3VuZEV4Y2VwdGlvbl8xJDIgPSBOb3RGb3VuZEV4Y2VwdGlvbiQxOwoJLyppbXBvcnQgamF2YS5pby5TZXJpYWxpemFibGU7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uczsqLwoJLyppbXBvcnQgamF2YS51dGlsLkNvbXBhcmF0b3I7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5MaXN0OyovCgkvKmltcG9ydCBqYXZhLnV0aWwuTWFwOyovCgkvKioKCSAqIDxwPlRoaXMgY2xhc3MgYXR0ZW1wdHMgdG8gZmluZCBmaW5kZXIgcGF0dGVybnMgaW4gYSBRUiBDb2RlLiBGaW5kZXIgcGF0dGVybnMgYXJlIHRoZSBzcXVhcmUKCSAqIG1hcmtlcnMgYXQgdGhyZWUgY29ybmVycyBvZiBhIFFSIENvZGUuPC9wPgoJICoKCSAqIDxwPlRoaXMgY2xhc3MgaXMgdGhyZWFkLXNhZmUgYnV0IG5vdCByZWVudHJhbnQuIEVhY2ggdGhyZWFkIG11c3QgYWxsb2NhdGUgaXRzIG93biBvYmplY3QuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEZpbmRlclBhdHRlcm5GaW5kZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgLyoqCgkgICAgICogPHA+Q3JlYXRlcyBhIGZpbmRlciB0aGF0IHdpbGwgc2VhcmNoIHRoZSBpbWFnZSBmb3IgdGhyZWUgZmluZGVyIHBhdHRlcm5zLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBpbWFnZSBpbWFnZSB0byBzZWFyY2gKCSAgICAgKi8KCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IoaW1hZ2U6IEJpdE1hdHJpeCkgewoJICAgIC8vICAgdGhpcyhpbWFnZSwgbnVsbCkKCSAgICAvLyB9CgkgICAgZnVuY3Rpb24gRmluZGVyUGF0dGVybkZpbmRlcihpbWFnZSwgcmVzdWx0UG9pbnRDYWxsYmFjaykgewoJICAgICAgICB0aGlzLmltYWdlID0gaW1hZ2U7CgkgICAgICAgIHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayA9IHJlc3VsdFBvaW50Q2FsbGJhY2s7CgkgICAgICAgIHRoaXMucG9zc2libGVDZW50ZXJzID0gW107CgkgICAgICAgIHRoaXMuY3Jvc3NDaGVja1N0YXRlQ291bnQgPSBuZXcgSW50MzJBcnJheSg1KTsKCSAgICAgICAgdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrID0gcmVzdWx0UG9pbnRDYWxsYmFjazsKCSAgICB9CgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5wcm90b3R5cGUuZ2V0SW1hZ2UgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmltYWdlOwoJICAgIH07CgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5wcm90b3R5cGUuZ2V0UG9zc2libGVDZW50ZXJzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5wb3NzaWJsZUNlbnRlcnM7CgkgICAgfTsKCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5maW5kID0gZnVuY3Rpb24gKGhpbnRzKSB7CgkgICAgICAgIHZhciB0cnlIYXJkZXIgPSAoaGludHMgIT09IG51bGwgJiYgaGludHMgIT09IHVuZGVmaW5lZCkgJiYgdW5kZWZpbmVkICE9PSBoaW50cy5nZXQoRGVjb2RlSGludFR5cGVfMSQyLmRlZmF1bHQuVFJZX0hBUkRFUik7CgkgICAgICAgIHZhciBwdXJlQmFyY29kZSA9IChoaW50cyAhPT0gbnVsbCAmJiBoaW50cyAhPT0gdW5kZWZpbmVkKSAmJiB1bmRlZmluZWQgIT09IGhpbnRzLmdldChEZWNvZGVIaW50VHlwZV8xJDIuZGVmYXVsdC5QVVJFX0JBUkNPREUpOwoJICAgICAgICB2YXIgaW1hZ2UgPSB0aGlzLmltYWdlOwoJICAgICAgICB2YXIgbWF4SSA9IGltYWdlLmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgbWF4SiA9IGltYWdlLmdldFdpZHRoKCk7CgkgICAgICAgIC8vIFdlIGFyZSBsb29raW5nIGZvciBibGFjay93aGl0ZS9ibGFjay93aGl0ZS9ibGFjayBtb2R1bGVzIGluCgkgICAgICAgIC8vIDE6MTozOjE6MSByYXRpbzsgdGhpcyB0cmFja3MgdGhlIG51bWJlciBvZiBzdWNoIG1vZHVsZXMgc2VlbiBzbyBmYXIKCSAgICAgICAgLy8gTGV0J3MgYXNzdW1lIHRoYXQgdGhlIG1heGltdW0gdmVyc2lvbiBRUiBDb2RlIHdlIHN1cHBvcnQgdGFrZXMgdXAgMS80IHRoZSBoZWlnaHQgb2YgdGhlCgkgICAgICAgIC8vIGltYWdlLCBhbmQgdGhlbiBhY2NvdW50IGZvciB0aGUgY2VudGVyIGJlaW5nIDMgbW9kdWxlcyBpbiBzaXplLiBUaGlzIGdpdmVzIHRoZSBzbWFsbGVzdAoJICAgICAgICAvLyBudW1iZXIgb2YgcGl4ZWxzIHRoZSBjZW50ZXIgY291bGQgYmUsIHNvIHNraXAgdGhpcyBvZnRlbi4gV2hlbiB0cnlpbmcgaGFyZGVyLCBsb29rIGZvciBhbGwKCSAgICAgICAgLy8gUVIgdmVyc2lvbnMgcmVnYXJkbGVzcyBvZiBob3cgZGVuc2UgdGhleSBhcmUuCgkgICAgICAgIHZhciBpU2tpcCA9IE1hdGguZmxvb3IoKDMgKiBtYXhJKSAvICg0ICogRmluZGVyUGF0dGVybkZpbmRlci5NQVhfTU9EVUxFUykpOwoJICAgICAgICBpZiAoaVNraXAgPCBGaW5kZXJQYXR0ZXJuRmluZGVyLk1JTl9TS0lQIHx8IHRyeUhhcmRlcikgewoJICAgICAgICAgICAgaVNraXAgPSBGaW5kZXJQYXR0ZXJuRmluZGVyLk1JTl9TS0lQOwoJICAgICAgICB9CgkgICAgICAgIHZhciBkb25lID0gZmFsc2U7CgkgICAgICAgIHZhciBzdGF0ZUNvdW50ID0gbmV3IEludDMyQXJyYXkoNSk7CgkgICAgICAgIGZvciAodmFyIGkgPSBpU2tpcCAtIDE7IGkgPCBtYXhJICYmICFkb25lOyBpICs9IGlTa2lwKSB7CgkgICAgICAgICAgICAvLyBHZXQgYSByb3cgb2YgYmxhY2svd2hpdGUgdmFsdWVzCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzBdID0gMDsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbMV0gPSAwOwoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSA9IDA7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzNdID0gMDsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbNF0gPSAwOwoJICAgICAgICAgICAgdmFyIGN1cnJlbnRTdGF0ZSA9IDA7CgkgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IG1heEo7IGorKykgewoJICAgICAgICAgICAgICAgIGlmIChpbWFnZS5nZXQoaiwgaSkpIHsKCSAgICAgICAgICAgICAgICAgICAgLy8gQmxhY2sgcGl4ZWwKCSAgICAgICAgICAgICAgICAgICAgaWYgKChjdXJyZW50U3RhdGUgJiAxKSA9PT0gMSkgeyAvLyBDb3VudGluZyB3aGl0ZSBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRTdGF0ZSsrOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbY3VycmVudFN0YXRlXSsrOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIHsgLy8gV2hpdGUgcGl4ZWwKCSAgICAgICAgICAgICAgICAgICAgaWYgKChjdXJyZW50U3RhdGUgJiAxKSA9PT0gMCkgeyAvLyBDb3VudGluZyBibGFjayBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50U3RhdGUgPT09IDQpIHsgLy8gQSB3aW5uZXI/CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEZpbmRlclBhdHRlcm5GaW5kZXIuZm91bmRQYXR0ZXJuQ3Jvc3Moc3RhdGVDb3VudCkpIHsgLy8gWWVzCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb25maXJtZWQgPSB0aGlzLmhhbmRsZVBvc3NpYmxlQ2VudGVyKHN0YXRlQ291bnQsIGksIGosIHB1cmVCYXJjb2RlKTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbmZpcm1lZCA9PT0gdHJ1ZSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU3RhcnQgZXhhbWluaW5nIGV2ZXJ5IG90aGVyIGxpbmUuIENoZWNraW5nIGVhY2ggbGluZSB0dXJuZWQgb3V0IHRvIGJlIHRvbwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZXhwZW5zaXZlIGFuZCBkaWRuJ3QgaW1wcm92ZSBwZXJmb3JtYW5jZS4KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlTa2lwID0gMjsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmhhc1NraXBwZWQgPT09IHRydWUpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb25lID0gdGhpcy5oYXZlTXVsdGlwbHlDb25maXJtZWRDZW50ZXJzKCk7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcm93U2tpcCA9IHRoaXMuZmluZFJvd1NraXAoKTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocm93U2tpcCA+IHN0YXRlQ291bnRbMl0pIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU2tpcCByb3dzIGJldHdlZW4gcm93IG9mIGxvd2VyIGNvbmZpcm1lZCBjZW50ZXIKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYW5kIHRvcCBvZiBwcmVzdW1lZCB0aGlyZCBjb25maXJtZWQgY2VudGVyCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJ1dCBiYWNrIHVwIGEgYml0IHRvIGdldCBhIGZ1bGwgY2hhbmNlIG9mIGRldGVjdGluZwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpdCwgZW50aXJlIHdpZHRoIG9mIGNlbnRlciBvZiBmaW5kZXIgcGF0dGVybgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBTa2lwIGJ5IHJvd1NraXAsIGJ1dCBiYWNrIG9mZiBieSBzdGF0ZUNvdW50WzJdIChzaXplIG9mIGxhc3QgY2VudGVyCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG9mIHBhdHRlcm4gd2Ugc2F3KSB0byBiZSBjb25zZXJ2YXRpdmUsIGFuZCBhbHNvIGJhY2sgb2ZmIGJ5IGlTa2lwIHdoaWNoCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGlzIGFib3V0IHRvIGJlIHJlLWFkZGVkCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkgKz0gcm93U2tpcCAtIHN0YXRlQ291bnRbMl0gLSBpU2tpcDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaiA9IG1heEogLSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbMF0gPSBzdGF0ZUNvdW50WzJdOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFsxXSA9IHN0YXRlQ291bnRbM107CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzJdID0gc3RhdGVDb3VudFs0XTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbM10gPSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFs0XSA9IDA7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50U3RhdGUgPSAzOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ2xlYXIgc3RhdGUgdG8gc3RhcnQgbG9va2luZyBhZ2FpbgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50U3RhdGUgPSAwOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzBdID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFsxXSA9IDA7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbMl0gPSAwOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzNdID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFs0XSA9IDA7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgeyAvLyBObywgc2hpZnQgY291bnRzIGJhY2sgYnkgdHdvCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbMF0gPSBzdGF0ZUNvdW50WzJdOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzFdID0gc3RhdGVDb3VudFszXTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFsyXSA9IHN0YXRlQ291bnRbNF07CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbM10gPSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzRdID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFN0YXRlID0gMzsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WysrY3VycmVudFN0YXRlXSsrOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGVsc2UgeyAvLyBDb3VudGluZyB3aGl0ZSBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbY3VycmVudFN0YXRlXSsrOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgaWYgKEZpbmRlclBhdHRlcm5GaW5kZXIuZm91bmRQYXR0ZXJuQ3Jvc3Moc3RhdGVDb3VudCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgY29uZmlybWVkID0gdGhpcy5oYW5kbGVQb3NzaWJsZUNlbnRlcihzdGF0ZUNvdW50LCBpLCBtYXhKLCBwdXJlQmFyY29kZSk7CgkgICAgICAgICAgICAgICAgaWYgKGNvbmZpcm1lZCA9PT0gdHJ1ZSkgewoJICAgICAgICAgICAgICAgICAgICBpU2tpcCA9IHN0YXRlQ291bnRbMF07CgkgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmhhc1NraXBwZWQpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZvdW5kIGEgdGhpcmQgb25lCgkgICAgICAgICAgICAgICAgICAgICAgICBkb25lID0gdGhpcy5oYXZlTXVsdGlwbHlDb25maXJtZWRDZW50ZXJzKCk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHBhdHRlcm5JbmZvID0gdGhpcy5zZWxlY3RCZXN0UGF0dGVybnMoKTsKCSAgICAgICAgUmVzdWx0UG9pbnRfMSQxLmRlZmF1bHQub3JkZXJCZXN0UGF0dGVybnMocGF0dGVybkluZm8pOwoJICAgICAgICByZXR1cm4gbmV3IEZpbmRlclBhdHRlcm5JbmZvXzEuZGVmYXVsdChwYXR0ZXJuSW5mbyk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBHaXZlbiBhIGNvdW50IG9mIGJsYWNrL3doaXRlL2JsYWNrL3doaXRlL2JsYWNrIHBpeGVscyBqdXN0IHNlZW4gYW5kIGFuIGVuZCBwb3NpdGlvbiwKCSAgICAgKiBmaWd1cmVzIHRoZSBsb2NhdGlvbiBvZiB0aGUgY2VudGVyIG9mIHRoaXMgcnVuLgoJICAgICAqLwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIuY2VudGVyRnJvbUVuZCA9IGZ1bmN0aW9uIChzdGF0ZUNvdW50LCBlbmQgLyppbnQqLykgewoJICAgICAgICByZXR1cm4gKGVuZCAtIHN0YXRlQ291bnRbNF0gLSBzdGF0ZUNvdW50WzNdKSAtIHN0YXRlQ291bnRbMl0gLyAyLjA7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gc3RhdGVDb3VudCBjb3VudCBvZiBibGFjay93aGl0ZS9ibGFjay93aGl0ZS9ibGFjayBwaXhlbHMganVzdCByZWFkCgkgICAgICogQHJldHVybiB0cnVlIGlmZiB0aGUgcHJvcG9ydGlvbnMgb2YgdGhlIGNvdW50cyBpcyBjbG9zZSBlbm91Z2ggdG8gdGhlIDEvMS8zLzEvMSByYXRpb3MKCSAgICAgKiAgICAgICAgIHVzZWQgYnkgZmluZGVyIHBhdHRlcm5zIHRvIGJlIGNvbnNpZGVyZWQgYSBtYXRjaAoJICAgICAqLwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIuZm91bmRQYXR0ZXJuQ3Jvc3MgPSBmdW5jdGlvbiAoc3RhdGVDb3VudCkgewoJICAgICAgICB2YXIgdG90YWxNb2R1bGVTaXplID0gMDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCA1OyBpKyspIHsKCSAgICAgICAgICAgIHZhciBjb3VudCA9IHN0YXRlQ291bnRbaV07CgkgICAgICAgICAgICBpZiAoY291bnQgPT09IDApIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB0b3RhbE1vZHVsZVNpemUgKz0gY291bnQ7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHRvdGFsTW9kdWxlU2l6ZSA8IDcpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgbW9kdWxlU2l6ZSA9IHRvdGFsTW9kdWxlU2l6ZSAvIDcuMDsKCSAgICAgICAgdmFyIG1heFZhcmlhbmNlID0gbW9kdWxlU2l6ZSAvIDIuMDsKCSAgICAgICAgLy8gQWxsb3cgbGVzcyB0aGFuIDUwJSB2YXJpYW5jZSBmcm9tIDEtMS0zLTEtMSBwcm9wb3J0aW9ucwoJICAgICAgICByZXR1cm4gTWF0aC5hYnMobW9kdWxlU2l6ZSAtIHN0YXRlQ291bnRbMF0pIDwgbWF4VmFyaWFuY2UgJiYKCSAgICAgICAgICAgIE1hdGguYWJzKG1vZHVsZVNpemUgLSBzdGF0ZUNvdW50WzFdKSA8IG1heFZhcmlhbmNlICYmCgkgICAgICAgICAgICBNYXRoLmFicygzLjAgKiBtb2R1bGVTaXplIC0gc3RhdGVDb3VudFsyXSkgPCAzICogbWF4VmFyaWFuY2UgJiYKCSAgICAgICAgICAgIE1hdGguYWJzKG1vZHVsZVNpemUgLSBzdGF0ZUNvdW50WzNdKSA8IG1heFZhcmlhbmNlICYmCgkgICAgICAgICAgICBNYXRoLmFicyhtb2R1bGVTaXplIC0gc3RhdGVDb3VudFs0XSkgPCBtYXhWYXJpYW5jZTsKCSAgICB9OwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIucHJvdG90eXBlLmdldENyb3NzQ2hlY2tTdGF0ZUNvdW50ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgY3Jvc3NDaGVja1N0YXRlQ291bnQgPSB0aGlzLmNyb3NzQ2hlY2tTdGF0ZUNvdW50OwoJICAgICAgICBjcm9zc0NoZWNrU3RhdGVDb3VudFswXSA9IDA7CgkgICAgICAgIGNyb3NzQ2hlY2tTdGF0ZUNvdW50WzFdID0gMDsKCSAgICAgICAgY3Jvc3NDaGVja1N0YXRlQ291bnRbMl0gPSAwOwoJICAgICAgICBjcm9zc0NoZWNrU3RhdGVDb3VudFszXSA9IDA7CgkgICAgICAgIGNyb3NzQ2hlY2tTdGF0ZUNvdW50WzRdID0gMDsKCSAgICAgICAgcmV0dXJuIGNyb3NzQ2hlY2tTdGF0ZUNvdW50OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQWZ0ZXIgYSB2ZXJ0aWNhbCBhbmQgaG9yaXpvbnRhbCBzY2FuIGZpbmRzIGEgcG90ZW50aWFsIGZpbmRlciBwYXR0ZXJuLCB0aGlzIG1ldGhvZAoJICAgICAqICJjcm9zcy1jcm9zcy1jcm9zcy1jaGVja3MiIGJ5IHNjYW5uaW5nIGRvd24gZGlhZ29uYWxseSB0aHJvdWdoIHRoZSBjZW50ZXIgb2YgdGhlIHBvc3NpYmxlCgkgICAgICogZmluZGVyIHBhdHRlcm4gdG8gc2VlIGlmIHRoZSBzYW1lIHByb3BvcnRpb24gaXMgZGV0ZWN0ZWQuCgkgICAgICoKCSAgICAgKiBAcGFyYW0gc3RhcnRJIHJvdyB3aGVyZSBhIGZpbmRlciBwYXR0ZXJuIHdhcyBkZXRlY3RlZAoJICAgICAqIEBwYXJhbSBjZW50ZXJKIGNlbnRlciBvZiB0aGUgc2VjdGlvbiB0aGF0IGFwcGVhcnMgdG8gY3Jvc3MgYSBmaW5kZXIgcGF0dGVybgoJICAgICAqIEBwYXJhbSBtYXhDb3VudCBtYXhpbXVtIHJlYXNvbmFibGUgbnVtYmVyIG9mIG1vZHVsZXMgdGhhdCBzaG91bGQgYmUKCSAgICAgKiAgb2JzZXJ2ZWQgaW4gYW55IHJlYWRpbmcgc3RhdGUsIGJhc2VkIG9uIHRoZSByZXN1bHRzIG9mIHRoZSBob3Jpem9udGFsIHNjYW4KCSAgICAgKiBAcGFyYW0gb3JpZ2luYWxTdGF0ZUNvdW50VG90YWwgVGhlIG9yaWdpbmFsIHN0YXRlIGNvdW50IHRvdGFsLgoJICAgICAqIEByZXR1cm4gdHJ1ZSBpZiBwcm9wb3J0aW9ucyBhcmUgd2l0aGluZyBleHBlY3RlZCBsaW1pdHMKCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5jcm9zc0NoZWNrRGlhZ29uYWwgPSBmdW5jdGlvbiAoc3RhcnRJIC8qaW50Ki8sIGNlbnRlckogLyppbnQqLywgbWF4Q291bnQgLyppbnQqLywgb3JpZ2luYWxTdGF0ZUNvdW50VG90YWwgLyppbnQqLykgewoJICAgICAgICB2YXIgc3RhdGVDb3VudCA9IHRoaXMuZ2V0Q3Jvc3NDaGVja1N0YXRlQ291bnQoKTsKCSAgICAgICAgLy8gU3RhcnQgY291bnRpbmcgdXAsIGxlZnQgZnJvbSBjZW50ZXIgZmluZGluZyBibGFjayBjZW50ZXIgbWFzcwoJICAgICAgICB2YXIgaSA9IDA7CgkgICAgICAgIHZhciBpbWFnZSA9IHRoaXMuaW1hZ2U7CgkgICAgICAgIHdoaWxlIChzdGFydEkgPj0gaSAmJiBjZW50ZXJKID49IGkgJiYgaW1hZ2UuZ2V0KGNlbnRlckogLSBpLCBzdGFydEkgLSBpKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChzdGFydEkgPCBpIHx8IGNlbnRlckogPCBpKSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgLy8gQ29udGludWUgdXAsIGxlZnQgZmluZGluZyB3aGl0ZSBzcGFjZQoJICAgICAgICB3aGlsZSAoc3RhcnRJID49IGkgJiYgY2VudGVySiA+PSBpICYmICFpbWFnZS5nZXQoY2VudGVySiAtIGksIHN0YXJ0SSAtIGkpICYmCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzFdIDw9IG1heENvdW50KSB7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzFdKys7CgkgICAgICAgICAgICBpKys7CgkgICAgICAgIH0KCSAgICAgICAgLy8gSWYgYWxyZWFkeSB0b28gbWFueSBtb2R1bGVzIGluIHRoaXMgc3RhdGUgb3IgcmFuIG9mZiB0aGUgZWRnZToKCSAgICAgICAgaWYgKHN0YXJ0SSA8IGkgfHwgY2VudGVySiA8IGkgfHwgc3RhdGVDb3VudFsxXSA+IG1heENvdW50KSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgLy8gQ29udGludWUgdXAsIGxlZnQgZmluZGluZyBibGFjayBib3JkZXIKCSAgICAgICAgd2hpbGUgKHN0YXJ0SSA+PSBpICYmIGNlbnRlckogPj0gaSAmJiBpbWFnZS5nZXQoY2VudGVySiAtIGksIHN0YXJ0SSAtIGkpICYmCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzBdIDw9IG1heENvdW50KSB7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzBdKys7CgkgICAgICAgICAgICBpKys7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHN0YXRlQ291bnRbMF0gPiBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHZhciBtYXhJID0gaW1hZ2UuZ2V0SGVpZ2h0KCk7CgkgICAgICAgIHZhciBtYXhKID0gaW1hZ2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgLy8gTm93IGFsc28gY291bnQgZG93biwgcmlnaHQgZnJvbSBjZW50ZXIKCSAgICAgICAgaSA9IDE7CgkgICAgICAgIHdoaWxlIChzdGFydEkgKyBpIDwgbWF4SSAmJiBjZW50ZXJKICsgaSA8IG1heEogJiYgaW1hZ2UuZ2V0KGNlbnRlckogKyBpLCBzdGFydEkgKyBpKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIC8vIFJhbiBvZmYgdGhlIGVkZ2U/CgkgICAgICAgIGlmIChzdGFydEkgKyBpID49IG1heEkgfHwgY2VudGVySiArIGkgPj0gbWF4SikgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHdoaWxlIChzdGFydEkgKyBpIDwgbWF4SSAmJiBjZW50ZXJKICsgaSA8IG1heEogJiYgIWltYWdlLmdldChjZW50ZXJKICsgaSwgc3RhcnRJICsgaSkgJiYKCSAgICAgICAgICAgIHN0YXRlQ291bnRbM10gPCBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFszXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChzdGFydEkgKyBpID49IG1heEkgfHwgY2VudGVySiArIGkgPj0gbWF4SiB8fCBzdGF0ZUNvdW50WzNdID49IG1heENvdW50KSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKHN0YXJ0SSArIGkgPCBtYXhJICYmIGNlbnRlckogKyBpIDwgbWF4SiAmJiBpbWFnZS5nZXQoY2VudGVySiArIGksIHN0YXJ0SSArIGkpICYmCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzRdIDwgbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbNF0rKzsKCSAgICAgICAgICAgIGkrKzsKCSAgICAgICAgfQoJICAgICAgICBpZiAoc3RhdGVDb3VudFs0XSA+PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIHdlIGZvdW5kIGEgZmluZGVyLXBhdHRlcm4tbGlrZSBzZWN0aW9uLCBidXQgaXRzIHNpemUgaXMgbW9yZSB0aGFuIDEwMCUgZGlmZmVyZW50IHRoYW4KCSAgICAgICAgLy8gdGhlIG9yaWdpbmFsLCBhc3N1bWUgaXQncyBhIGZhbHNlIHBvc2l0aXZlCgkgICAgICAgIHZhciBzdGF0ZUNvdW50VG90YWwgPSBzdGF0ZUNvdW50WzBdICsgc3RhdGVDb3VudFsxXSArIHN0YXRlQ291bnRbMl0gKyBzdGF0ZUNvdW50WzNdICsgc3RhdGVDb3VudFs0XTsKCSAgICAgICAgcmV0dXJuIE1hdGguYWJzKHN0YXRlQ291bnRUb3RhbCAtIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsKSA8IDIgKiBvcmlnaW5hbFN0YXRlQ291bnRUb3RhbCAmJgoJICAgICAgICAgICAgRmluZGVyUGF0dGVybkZpbmRlci5mb3VuZFBhdHRlcm5Dcm9zcyhzdGF0ZUNvdW50KTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkFmdGVyIGEgaG9yaXpvbnRhbCBzY2FuIGZpbmRzIGEgcG90ZW50aWFsIGZpbmRlciBwYXR0ZXJuLCB0aGlzIG1ldGhvZAoJICAgICAqICJjcm9zcy1jaGVja3MiIGJ5IHNjYW5uaW5nIGRvd24gdmVydGljYWxseSB0aHJvdWdoIHRoZSBjZW50ZXIgb2YgdGhlIHBvc3NpYmxlCgkgICAgICogZmluZGVyIHBhdHRlcm4gdG8gc2VlIGlmIHRoZSBzYW1lIHByb3BvcnRpb24gaXMgZGV0ZWN0ZWQuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIHN0YXJ0SSByb3cgd2hlcmUgYSBmaW5kZXIgcGF0dGVybiB3YXMgZGV0ZWN0ZWQKCSAgICAgKiBAcGFyYW0gY2VudGVySiBjZW50ZXIgb2YgdGhlIHNlY3Rpb24gdGhhdCBhcHBlYXJzIHRvIGNyb3NzIGEgZmluZGVyIHBhdHRlcm4KCSAgICAgKiBAcGFyYW0gbWF4Q291bnQgbWF4aW11bSByZWFzb25hYmxlIG51bWJlciBvZiBtb2R1bGVzIHRoYXQgc2hvdWxkIGJlCgkgICAgICogb2JzZXJ2ZWQgaW4gYW55IHJlYWRpbmcgc3RhdGUsIGJhc2VkIG9uIHRoZSByZXN1bHRzIG9mIHRoZSBob3Jpem9udGFsIHNjYW4KCSAgICAgKiBAcmV0dXJuIHZlcnRpY2FsIGNlbnRlciBvZiBmaW5kZXIgcGF0dGVybiwgb3Ige0BsaW5rIEZsb2F0I05hTn0gaWYgbm90IGZvdW5kCgkgICAgICovCgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5wcm90b3R5cGUuY3Jvc3NDaGVja1ZlcnRpY2FsID0gZnVuY3Rpb24gKHN0YXJ0SSAvKmludCovLCBjZW50ZXJKIC8qaW50Ki8sIG1heENvdW50IC8qaW50Ki8sIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGltYWdlID0gdGhpcy5pbWFnZTsKCSAgICAgICAgdmFyIG1heEkgPSBpbWFnZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgdmFyIHN0YXRlQ291bnQgPSB0aGlzLmdldENyb3NzQ2hlY2tTdGF0ZUNvdW50KCk7CgkgICAgICAgIC8vIFN0YXJ0IGNvdW50aW5nIHVwIGZyb20gY2VudGVyCgkgICAgICAgIHZhciBpID0gc3RhcnRJOwoJICAgICAgICB3aGlsZSAoaSA+PSAwICYmIGltYWdlLmdldChjZW50ZXJKLCBpKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgaS0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChpIDwgMCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB3aGlsZSAoaSA+PSAwICYmICFpbWFnZS5nZXQoY2VudGVySiwgaSkgJiYgc3RhdGVDb3VudFsxXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsxXSsrOwoJICAgICAgICAgICAgaS0tOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIGFscmVhZHkgdG9vIG1hbnkgbW9kdWxlcyBpbiB0aGlzIHN0YXRlIG9yIHJhbiBvZmYgdGhlIGVkZ2U6CgkgICAgICAgIGlmIChpIDwgMCB8fCBzdGF0ZUNvdW50WzFdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKGkgPj0gMCAmJiBpbWFnZS5nZXQoY2VudGVySiwgaSkgJiYgc3RhdGVDb3VudFswXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFswXSsrOwoJICAgICAgICAgICAgaS0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChzdGF0ZUNvdW50WzBdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgLy8gTm93IGFsc28gY291bnQgZG93biBmcm9tIGNlbnRlcgoJICAgICAgICBpID0gc3RhcnRJICsgMTsKCSAgICAgICAgd2hpbGUgKGkgPCBtYXhJICYmIGltYWdlLmdldChjZW50ZXJKLCBpKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChpID09PSBtYXhJKSB7CgkgICAgICAgICAgICByZXR1cm4gTmFOOwoJICAgICAgICB9CgkgICAgICAgIHdoaWxlIChpIDwgbWF4SSAmJiAhaW1hZ2UuZ2V0KGNlbnRlckosIGkpICYmIHN0YXRlQ291bnRbM10gPCBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFszXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChpID09PSBtYXhJIHx8IHN0YXRlQ291bnRbM10gPj0gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKGkgPCBtYXhJICYmIGltYWdlLmdldChjZW50ZXJKLCBpKSAmJiBzdGF0ZUNvdW50WzRdIDwgbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbNF0rKzsKCSAgICAgICAgICAgIGkrKzsKCSAgICAgICAgfQoJICAgICAgICBpZiAoc3RhdGVDb3VudFs0XSA+PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICAvLyBJZiB3ZSBmb3VuZCBhIGZpbmRlci1wYXR0ZXJuLWxpa2Ugc2VjdGlvbiwgYnV0IGl0cyBzaXplIGlzIG1vcmUgdGhhbiA0MCUgZGlmZmVyZW50IHRoYW4KCSAgICAgICAgLy8gdGhlIG9yaWdpbmFsLCBhc3N1bWUgaXQncyBhIGZhbHNlIHBvc2l0aXZlCgkgICAgICAgIHZhciBzdGF0ZUNvdW50VG90YWwgPSBzdGF0ZUNvdW50WzBdICsgc3RhdGVDb3VudFsxXSArIHN0YXRlQ291bnRbMl0gKyBzdGF0ZUNvdW50WzNdICsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbNF07CgkgICAgICAgIGlmICg1ICogTWF0aC5hYnMoc3RhdGVDb3VudFRvdGFsIC0gb3JpZ2luYWxTdGF0ZUNvdW50VG90YWwpID49IDIgKiBvcmlnaW5hbFN0YXRlQ291bnRUb3RhbCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gRmluZGVyUGF0dGVybkZpbmRlci5mb3VuZFBhdHRlcm5Dcm9zcyhzdGF0ZUNvdW50KSA/IEZpbmRlclBhdHRlcm5GaW5kZXIuY2VudGVyRnJvbUVuZChzdGF0ZUNvdW50LCBpKSA6IE5hTjsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkxpa2Uge0BsaW5rICNjcm9zc0NoZWNrVmVydGljYWwoaW50LCBpbnQsIGludCwgaW50KX0sIGFuZCBpbiBmYWN0IGlzIGJhc2ljYWxseSBpZGVudGljYWwsCgkgICAgICogZXhjZXB0IGl0IHJlYWRzIGhvcml6b250YWxseSBpbnN0ZWFkIG9mIHZlcnRpY2FsbHkuIFRoaXMgaXMgdXNlZCB0byBjcm9zcy1jcm9zcwoJICAgICAqIGNoZWNrIGEgdmVydGljYWwgY3Jvc3MgY2hlY2sgYW5kIGxvY2F0ZSB0aGUgcmVhbCBjZW50ZXIgb2YgdGhlIGFsaWdubWVudCBwYXR0ZXJuLjwvcD4KCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5jcm9zc0NoZWNrSG9yaXpvbnRhbCA9IGZ1bmN0aW9uIChzdGFydEogLyppbnQqLywgY2VudGVySSAvKmludCovLCBtYXhDb3VudCAvKmludCovLCBvcmlnaW5hbFN0YXRlQ291bnRUb3RhbCAvKmludCovKSB7CgkgICAgICAgIHZhciBpbWFnZSA9IHRoaXMuaW1hZ2U7CgkgICAgICAgIHZhciBtYXhKID0gaW1hZ2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIHN0YXRlQ291bnQgPSB0aGlzLmdldENyb3NzQ2hlY2tTdGF0ZUNvdW50KCk7CgkgICAgICAgIHZhciBqID0gc3RhcnRKOwoJICAgICAgICB3aGlsZSAoaiA+PSAwICYmIGltYWdlLmdldChqLCBjZW50ZXJJKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgai0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChqIDwgMCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB3aGlsZSAoaiA+PSAwICYmICFpbWFnZS5nZXQoaiwgY2VudGVySSkgJiYgc3RhdGVDb3VudFsxXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsxXSsrOwoJICAgICAgICAgICAgai0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChqIDwgMCB8fCBzdGF0ZUNvdW50WzFdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKGogPj0gMCAmJiBpbWFnZS5nZXQoaiwgY2VudGVySSkgJiYgc3RhdGVDb3VudFswXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFswXSsrOwoJICAgICAgICAgICAgai0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChzdGF0ZUNvdW50WzBdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgaiA9IHN0YXJ0SiArIDE7CgkgICAgICAgIHdoaWxlIChqIDwgbWF4SiAmJiBpbWFnZS5nZXQoaiwgY2VudGVySSkpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbMl0rKzsKCSAgICAgICAgICAgIGorKzsKCSAgICAgICAgfQoJICAgICAgICBpZiAoaiA9PT0gbWF4SikgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB3aGlsZSAoaiA8IG1heEogJiYgIWltYWdlLmdldChqLCBjZW50ZXJJKSAmJiBzdGF0ZUNvdW50WzNdIDwgbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbM10rKzsKCSAgICAgICAgICAgIGorKzsKCSAgICAgICAgfQoJICAgICAgICBpZiAoaiA9PT0gbWF4SiB8fCBzdGF0ZUNvdW50WzNdID49IG1heENvdW50KSB7CgkgICAgICAgICAgICByZXR1cm4gTmFOOwoJICAgICAgICB9CgkgICAgICAgIHdoaWxlIChqIDwgbWF4SiAmJiBpbWFnZS5nZXQoaiwgY2VudGVySSkgJiYgc3RhdGVDb3VudFs0XSA8IG1heENvdW50KSB7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzRdKys7CgkgICAgICAgICAgICBqKys7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHN0YXRlQ291bnRbNF0gPj0gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgLy8gSWYgd2UgZm91bmQgYSBmaW5kZXItcGF0dGVybi1saWtlIHNlY3Rpb24sIGJ1dCBpdHMgc2l6ZSBpcyBzaWduaWZpY2FudGx5IGRpZmZlcmVudCB0aGFuCgkgICAgICAgIC8vIHRoZSBvcmlnaW5hbCwgYXNzdW1lIGl0J3MgYSBmYWxzZSBwb3NpdGl2ZQoJICAgICAgICB2YXIgc3RhdGVDb3VudFRvdGFsID0gc3RhdGVDb3VudFswXSArIHN0YXRlQ291bnRbMV0gKyBzdGF0ZUNvdW50WzJdICsgc3RhdGVDb3VudFszXSArCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzRdOwoJICAgICAgICBpZiAoNSAqIE1hdGguYWJzKHN0YXRlQ291bnRUb3RhbCAtIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsKSA+PSBvcmlnaW5hbFN0YXRlQ291bnRUb3RhbCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gRmluZGVyUGF0dGVybkZpbmRlci5mb3VuZFBhdHRlcm5Dcm9zcyhzdGF0ZUNvdW50KSA/IEZpbmRlclBhdHRlcm5GaW5kZXIuY2VudGVyRnJvbUVuZChzdGF0ZUNvdW50LCBqKSA6IE5hTjsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlRoaXMgaXMgY2FsbGVkIHdoZW4gYSBob3Jpem9udGFsIHNjYW4gZmluZHMgYSBwb3NzaWJsZSBhbGlnbm1lbnQgcGF0dGVybi4gSXQgd2lsbAoJICAgICAqIGNyb3NzIGNoZWNrIHdpdGggYSB2ZXJ0aWNhbCBzY2FuLCBhbmQgaWYgc3VjY2Vzc2Z1bCwgd2lsbCwgYWgsIGNyb3NzLWNyb3NzLWNoZWNrCgkgICAgICogd2l0aCBhbm90aGVyIGhvcml6b250YWwgc2Nhbi4gVGhpcyBpcyBuZWVkZWQgcHJpbWFyaWx5IHRvIGxvY2F0ZSB0aGUgcmVhbCBob3Jpem9udGFsCgkgICAgICogY2VudGVyIG9mIHRoZSBwYXR0ZXJuIGluIGNhc2VzIG9mIGV4dHJlbWUgc2tldy4KCSAgICAgKiBBbmQgdGhlbiB3ZSBjcm9zcy1jcm9zcy1jcm9zcyBjaGVjayB3aXRoIGFub3RoZXIgZGlhZ29uYWwgc2Nhbi48L3A+CgkgICAgICoKCSAgICAgKiA8cD5JZiB0aGF0IHN1Y2NlZWRzIHRoZSBmaW5kZXIgcGF0dGVybiBsb2NhdGlvbiBpcyBhZGRlZCB0byBhIGxpc3QgdGhhdCB0cmFja3MKCSAgICAgKiB0aGUgbnVtYmVyIG9mIHRpbWVzIGVhY2ggbG9jYXRpb24gaGFzIGJlZW4gbmVhcmx5LW1hdGNoZWQgYXMgYSBmaW5kZXIgcGF0dGVybi4KCSAgICAgKiBFYWNoIGFkZGl0aW9uYWwgZmluZCBpcyBtb3JlIGV2aWRlbmNlIHRoYXQgdGhlIGxvY2F0aW9uIGlzIGluIGZhY3QgYSBmaW5kZXIKCSAgICAgKiBwYXR0ZXJuIGNlbnRlcgoJICAgICAqCgkgICAgICogQHBhcmFtIHN0YXRlQ291bnQgcmVhZGluZyBzdGF0ZSBtb2R1bGUgY291bnRzIGZyb20gaG9yaXpvbnRhbCBzY2FuCgkgICAgICogQHBhcmFtIGkgcm93IHdoZXJlIGZpbmRlciBwYXR0ZXJuIG1heSBiZSBmb3VuZAoJICAgICAqIEBwYXJhbSBqIGVuZCBvZiBwb3NzaWJsZSBmaW5kZXIgcGF0dGVybiBpbiByb3cKCSAgICAgKiBAcGFyYW0gcHVyZUJhcmNvZGUgdHJ1ZSBpZiBpbiAicHVyZSBiYXJjb2RlIiBtb2RlCgkgICAgICogQHJldHVybiB0cnVlIGlmIGEgZmluZGVyIHBhdHRlcm4gY2FuZGlkYXRlIHdhcyBmb3VuZCB0aGlzIHRpbWUKCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5oYW5kbGVQb3NzaWJsZUNlbnRlciA9IGZ1bmN0aW9uIChzdGF0ZUNvdW50LCBpIC8qaW50Ki8sIGogLyppbnQqLywgcHVyZUJhcmNvZGUpIHsKCSAgICAgICAgdmFyIHN0YXRlQ291bnRUb3RhbCA9IHN0YXRlQ291bnRbMF0gKyBzdGF0ZUNvdW50WzFdICsgc3RhdGVDb3VudFsyXSArIHN0YXRlQ291bnRbM10gKwoJICAgICAgICAgICAgc3RhdGVDb3VudFs0XTsKCSAgICAgICAgdmFyIGNlbnRlckogPSBGaW5kZXJQYXR0ZXJuRmluZGVyLmNlbnRlckZyb21FbmQoc3RhdGVDb3VudCwgaik7CgkgICAgICAgIHZhciBjZW50ZXJJID0gdGhpcy5jcm9zc0NoZWNrVmVydGljYWwoaSwgLyooaW50KSAqLyBNYXRoLmZsb29yKGNlbnRlckopLCBzdGF0ZUNvdW50WzJdLCBzdGF0ZUNvdW50VG90YWwpOwoJICAgICAgICBpZiAoIWlzTmFOKGNlbnRlckkpKSB7CgkgICAgICAgICAgICAvLyBSZS1jcm9zcyBjaGVjawoJICAgICAgICAgICAgY2VudGVySiA9IHRoaXMuY3Jvc3NDaGVja0hvcml6b250YWwoLyooaW50KSAqLyBNYXRoLmZsb29yKGNlbnRlckopLCAvKihpbnQpICovIE1hdGguZmxvb3IoY2VudGVySSksIHN0YXRlQ291bnRbMl0sIHN0YXRlQ291bnRUb3RhbCk7CgkgICAgICAgICAgICBpZiAoIWlzTmFOKGNlbnRlckopICYmCgkgICAgICAgICAgICAgICAgKCFwdXJlQmFyY29kZSB8fCB0aGlzLmNyb3NzQ2hlY2tEaWFnb25hbCgvKihpbnQpICovIE1hdGguZmxvb3IoY2VudGVySSksIC8qKGludCkgKi8gTWF0aC5mbG9vcihjZW50ZXJKKSwgc3RhdGVDb3VudFsyXSwgc3RhdGVDb3VudFRvdGFsKSkpIHsKCSAgICAgICAgICAgICAgICB2YXIgZXN0aW1hdGVkTW9kdWxlU2l6ZSA9IHN0YXRlQ291bnRUb3RhbCAvIDcuMDsKCSAgICAgICAgICAgICAgICB2YXIgZm91bmQgPSBmYWxzZTsKCSAgICAgICAgICAgICAgICB2YXIgcG9zc2libGVDZW50ZXJzID0gdGhpcy5wb3NzaWJsZUNlbnRlcnM7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgaW5kZXggPSAwLCBsZW5ndGhfMSA9IHBvc3NpYmxlQ2VudGVycy5sZW5ndGg7IGluZGV4IDwgbGVuZ3RoXzE7IGluZGV4KyspIHsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGNlbnRlciA9IHBvc3NpYmxlQ2VudGVyc1tpbmRleF07CgkgICAgICAgICAgICAgICAgICAgIC8vIExvb2sgZm9yIGFib3V0IHRoZSBzYW1lIGNlbnRlciBhbmQgbW9kdWxlIHNpemU6CgkgICAgICAgICAgICAgICAgICAgIGlmIChjZW50ZXIuYWJvdXRFcXVhbHMoZXN0aW1hdGVkTW9kdWxlU2l6ZSwgY2VudGVySSwgY2VudGVySikpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHBvc3NpYmxlQ2VudGVyc1tpbmRleF0gPSBjZW50ZXIuY29tYmluZUVzdGltYXRlKGNlbnRlckksIGNlbnRlckosIGVzdGltYXRlZE1vZHVsZVNpemUpOwoJICAgICAgICAgICAgICAgICAgICAgICAgZm91bmQgPSB0cnVlOwoJICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgaWYgKCFmb3VuZCkgewoJICAgICAgICAgICAgICAgICAgICB2YXIgcG9pbnQgPSBuZXcgRmluZGVyUGF0dGVybl8xLmRlZmF1bHQoY2VudGVySiwgY2VudGVySSwgZXN0aW1hdGVkTW9kdWxlU2l6ZSk7CgkgICAgICAgICAgICAgICAgICAgIHBvc3NpYmxlQ2VudGVycy5wdXNoKHBvaW50KTsKCSAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayAhPT0gbnVsbCAmJiB0aGlzLnJlc3VsdFBvaW50Q2FsbGJhY2sgIT09IHVuZGVmaW5lZCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrLmZvdW5kUG9zc2libGVSZXN1bHRQb2ludChwb2ludCk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBudW1iZXIgb2Ygcm93cyB3ZSBjb3VsZCBzYWZlbHkgc2tpcCBkdXJpbmcgc2Nhbm5pbmcsIGJhc2VkIG9uIHRoZSBmaXJzdAoJICAgICAqICAgICAgICAgdHdvIGZpbmRlciBwYXR0ZXJucyB0aGF0IGhhdmUgYmVlbiBsb2NhdGVkLiBJbiBzb21lIGNhc2VzIHRoZWlyIHBvc2l0aW9uIHdpbGwKCSAgICAgKiAgICAgICAgIGFsbG93IHVzIHRvIGluZmVyIHRoYXQgdGhlIHRoaXJkIHBhdHRlcm4gbXVzdCBsaWUgYmVsb3cgYSBjZXJ0YWluIHBvaW50IGZhcnRoZXIKCSAgICAgKiAgICAgICAgIGRvd24gaW4gdGhlIGltYWdlLgoJICAgICAqLwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIucHJvdG90eXBlLmZpbmRSb3dTa2lwID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgZV8xLCBfYTsKCSAgICAgICAgdmFyIG1heCA9IHRoaXMucG9zc2libGVDZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgaWYgKG1heCA8PSAxKSB7CgkgICAgICAgICAgICByZXR1cm4gMDsKCSAgICAgICAgfQoJICAgICAgICB2YXIgZmlyc3RDb25maXJtZWRDZW50ZXIgPSBudWxsOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgX2IgPSBfX3ZhbHVlcyh0aGlzLnBvc3NpYmxlQ2VudGVycyksIF9jID0gX2IubmV4dCgpOyAhX2MuZG9uZTsgX2MgPSBfYi5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgY2VudGVyID0gX2MudmFsdWU7CgkgICAgICAgICAgICAgICAgaWYgKGNlbnRlci5nZXRDb3VudCgpID49IEZpbmRlclBhdHRlcm5GaW5kZXIuQ0VOVEVSX1FVT1JVTSkgewoJICAgICAgICAgICAgICAgICAgICBpZiAoZmlyc3RDb25maXJtZWRDZW50ZXIgPT0gbnVsbCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3RDb25maXJtZWRDZW50ZXIgPSBjZW50ZXI7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBXZSBoYXZlIHR3byBjb25maXJtZWQgY2VudGVycwoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gSG93IGZhciBkb3duIGNhbiB3ZSBza2lwIGJlZm9yZSByZXN1bWluZyBsb29raW5nIGZvciB0aGUgbmV4dAoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gcGF0dGVybj8gSW4gdGhlIHdvcnN0IGNhc2UsIG9ubHkgdGhlIGRpZmZlcmVuY2UgYmV0d2VlbiB0aGUKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIGRpZmZlcmVuY2UgaW4gdGhlIHggLyB5IGNvb3JkaW5hdGVzIG9mIHRoZSB0d28gY2VudGVycy4KCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgaXMgdGhlIGNhc2Ugd2hlcmUgeW91IGZpbmQgdG9wIGxlZnQgbGFzdC4KCSAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGFzU2tpcHBlZCA9IHRydWU7CgkgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gLyooaW50KSAqLyBNYXRoLmZsb29yKChNYXRoLmFicyhmaXJzdENvbmZpcm1lZENlbnRlci5nZXRYKCkgLSBjZW50ZXIuZ2V0WCgpKSAtCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5hYnMoZmlyc3RDb25maXJtZWRDZW50ZXIuZ2V0WSgpIC0gY2VudGVyLmdldFkoKSkpIC8gMik7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGVfMV8xKSB7IGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07IH0KCSAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGlmIChfYyAmJiAhX2MuZG9uZSAmJiAoX2EgPSBfYi5yZXR1cm4pKSBfYS5jYWxsKF9iKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8xKSB0aHJvdyBlXzEuZXJyb3I7IH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gMDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gdHJ1ZSBpZmYgd2UgaGF2ZSBmb3VuZCBhdCBsZWFzdCAzIGZpbmRlciBwYXR0ZXJucyB0aGF0IGhhdmUgYmVlbiBkZXRlY3RlZAoJICAgICAqICAgICAgICAgYXQgbGVhc3Qge0BsaW5rICNDRU5URVJfUVVPUlVNfSB0aW1lcyBlYWNoLCBhbmQsIHRoZSBlc3RpbWF0ZWQgbW9kdWxlIHNpemUgb2YgdGhlCgkgICAgICogICAgICAgICBjYW5kaWRhdGVzIGlzICJwcmV0dHkgc2ltaWxhciIKCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5oYXZlTXVsdGlwbHlDb25maXJtZWRDZW50ZXJzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgZV8yLCBfYSwgZV8zLCBfYjsKCSAgICAgICAgdmFyIGNvbmZpcm1lZENvdW50ID0gMDsKCSAgICAgICAgdmFyIHRvdGFsTW9kdWxlU2l6ZSA9IDAuMDsKCSAgICAgICAgdmFyIG1heCA9IHRoaXMucG9zc2libGVDZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIGZvciAodmFyIF9jID0gX192YWx1ZXModGhpcy5wb3NzaWJsZUNlbnRlcnMpLCBfZCA9IF9jLm5leHQoKTsgIV9kLmRvbmU7IF9kID0gX2MubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBhdHRlcm4gPSBfZC52YWx1ZTsKCSAgICAgICAgICAgICAgICBpZiAocGF0dGVybi5nZXRDb3VudCgpID49IEZpbmRlclBhdHRlcm5GaW5kZXIuQ0VOVEVSX1FVT1JVTSkgewoJICAgICAgICAgICAgICAgICAgICBjb25maXJtZWRDb3VudCsrOwoJICAgICAgICAgICAgICAgICAgICB0b3RhbE1vZHVsZVNpemUgKz0gcGF0dGVybi5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplKCk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlXzJfMSkgeyBlXzIgPSB7IGVycm9yOiBlXzJfMSB9OyB9CgkgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBpZiAoX2QgJiYgIV9kLmRvbmUgJiYgKF9hID0gX2MucmV0dXJuKSkgX2EuY2FsbChfYyk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMikgdGhyb3cgZV8yLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNvbmZpcm1lZENvdW50IDwgMykgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIC8vIE9LLCB3ZSBoYXZlIGF0IGxlYXN0IDMgY29uZmlybWVkIGNlbnRlcnMsIGJ1dCwgaXQncyBwb3NzaWJsZSB0aGF0IG9uZSBpcyBhICJmYWxzZSBwb3NpdGl2ZSIKCSAgICAgICAgLy8gYW5kIHRoYXQgd2UgbmVlZCB0byBrZWVwIGxvb2tpbmcuIFdlIGRldGVjdCB0aGlzIGJ5IGFza2luZyBpZiB0aGUgZXN0aW1hdGVkIG1vZHVsZSBzaXplcwoJICAgICAgICAvLyB2YXJ5IHRvbyBtdWNoLiBXZSBhcmJpdHJhcmlseSBzYXkgdGhhdCB3aGVuIHRoZSB0b3RhbCBkZXZpYXRpb24gZnJvbSBhdmVyYWdlIGV4Y2VlZHMKCSAgICAgICAgLy8gNSUgb2YgdGhlIHRvdGFsIG1vZHVsZSBzaXplIGVzdGltYXRlcywgaXQncyB0b28gbXVjaC4KCSAgICAgICAgdmFyIGF2ZXJhZ2UgPSB0b3RhbE1vZHVsZVNpemUgLyBtYXg7CgkgICAgICAgIHZhciB0b3RhbERldmlhdGlvbiA9IDAuMDsKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIGZvciAodmFyIF9lID0gX192YWx1ZXModGhpcy5wb3NzaWJsZUNlbnRlcnMpLCBfZiA9IF9lLm5leHQoKTsgIV9mLmRvbmU7IF9mID0gX2UubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBhdHRlcm4gPSBfZi52YWx1ZTsKCSAgICAgICAgICAgICAgICB0b3RhbERldmlhdGlvbiArPSBNYXRoLmFicyhwYXR0ZXJuLmdldEVzdGltYXRlZE1vZHVsZVNpemUoKSAtIGF2ZXJhZ2UpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlXzNfMSkgeyBlXzMgPSB7IGVycm9yOiBlXzNfMSB9OyB9CgkgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBpZiAoX2YgJiYgIV9mLmRvbmUgJiYgKF9iID0gX2UucmV0dXJuKSkgX2IuY2FsbChfZSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMykgdGhyb3cgZV8zLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRvdGFsRGV2aWF0aW9uIDw9IDAuMDUgKiB0b3RhbE1vZHVsZVNpemU7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHRoZSAzIGJlc3Qge0BsaW5rIEZpbmRlclBhdHRlcm59cyBmcm9tIG91ciBsaXN0IG9mIGNhbmRpZGF0ZXMuIFRoZSAiYmVzdCIgYXJlCgkgICAgICogICAgICAgICB0aG9zZSB0aGF0IGhhdmUgYmVlbiBkZXRlY3RlZCBhdCBsZWFzdCB7QGxpbmsgI0NFTlRFUl9RVU9SVU19IHRpbWVzLCBhbmQgd2hvc2UgbW9kdWxlCgkgICAgICogICAgICAgICBzaXplIGRpZmZlcnMgZnJvbSB0aGUgYXZlcmFnZSBhbW9uZyB0aG9zZSBwYXR0ZXJucyB0aGUgbGVhc3QKCSAgICAgKiBAdGhyb3dzIE5vdEZvdW5kRXhjZXB0aW9uIGlmIDMgc3VjaCBmaW5kZXIgcGF0dGVybnMgZG8gbm90IGV4aXN0CgkgICAgICovCgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5wcm90b3R5cGUuc2VsZWN0QmVzdFBhdHRlcm5zID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgZV80LCBfYSwgZV81LCBfYjsKCSAgICAgICAgdmFyIHN0YXJ0U2l6ZSA9IHRoaXMucG9zc2libGVDZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgaWYgKHN0YXJ0U2l6ZSA8IDMpIHsKCSAgICAgICAgICAgIC8vIENvdWxkbid0IGZpbmQgZW5vdWdoIGZpbmRlciBwYXR0ZXJucwoJICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkMi5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHBvc3NpYmxlQ2VudGVycyA9IHRoaXMucG9zc2libGVDZW50ZXJzOwoJICAgICAgICB2YXIgYXZlcmFnZTsKCSAgICAgICAgLy8gRmlsdGVyIG91dGxpZXIgcG9zc2liaWxpdGllcyB3aG9zZSBtb2R1bGUgc2l6ZSBpcyB0b28gZGlmZmVyZW50CgkgICAgICAgIGlmIChzdGFydFNpemUgPiAzKSB7CgkgICAgICAgICAgICAvLyBCdXQgd2UgY2FuIG9ubHkgYWZmb3JkIHRvIGRvIHNvIGlmIHdlIGhhdmUgYXQgbGVhc3QgNCBwb3NzaWJpbGl0aWVzIHRvIGNob29zZSBmcm9tCgkgICAgICAgICAgICB2YXIgdG90YWxNb2R1bGVTaXplID0gMC4wOwoJICAgICAgICAgICAgdmFyIHNxdWFyZSA9IDAuMDsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgX2MgPSBfX3ZhbHVlcyh0aGlzLnBvc3NpYmxlQ2VudGVycyksIF9kID0gX2MubmV4dCgpOyAhX2QuZG9uZTsgX2QgPSBfYy5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGNlbnRlciA9IF9kLnZhbHVlOwoJICAgICAgICAgICAgICAgICAgICB2YXIgc2l6ZSA9IGNlbnRlci5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplKCk7CgkgICAgICAgICAgICAgICAgICAgIHRvdGFsTW9kdWxlU2l6ZSArPSBzaXplOwoJICAgICAgICAgICAgICAgICAgICBzcXVhcmUgKz0gc2l6ZSAqIHNpemU7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgY2F0Y2ggKGVfNF8xKSB7IGVfNCA9IHsgZXJyb3I6IGVfNF8xIH07IH0KCSAgICAgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgICAgIGlmIChfZCAmJiAhX2QuZG9uZSAmJiAoX2EgPSBfYy5yZXR1cm4pKSBfYS5jYWxsKF9jKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZmluYWxseSB7IGlmIChlXzQpIHRocm93IGVfNC5lcnJvcjsgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgYXZlcmFnZSA9IHRvdGFsTW9kdWxlU2l6ZSAvIHN0YXJ0U2l6ZTsKCSAgICAgICAgICAgIHZhciBzdGREZXYgPSBNYXRoLnNxcnQoc3F1YXJlIC8gc3RhcnRTaXplIC0gYXZlcmFnZSAqIGF2ZXJhZ2UpOwoJICAgICAgICAgICAgcG9zc2libGVDZW50ZXJzLnNvcnQoCgkgICAgICAgICAgICAvKioKCSAgICAgICAgICAgICAqIDxwPk9yZGVycyBieSBmdXJ0aGVzdCBmcm9tIGF2ZXJhZ2U8L3A+CgkgICAgICAgICAgICAgKi8KCSAgICAgICAgICAgIC8vIEZ1cnRoZXN0RnJvbUF2ZXJhZ2VDb21wYXJhdG9yIGltcGxlbWVudHMgQ29tcGFyYXRvcjxGaW5kZXJQYXR0ZXJuPgoJICAgICAgICAgICAgZnVuY3Rpb24gKGNlbnRlcjEsIGNlbnRlcjIpIHsKCSAgICAgICAgICAgICAgICB2YXIgZEEgPSBNYXRoLmFicyhjZW50ZXIyLmdldEVzdGltYXRlZE1vZHVsZVNpemUoKSAtIGF2ZXJhZ2UpOwoJICAgICAgICAgICAgICAgIHZhciBkQiA9IE1hdGguYWJzKGNlbnRlcjEuZ2V0RXN0aW1hdGVkTW9kdWxlU2l6ZSgpIC0gYXZlcmFnZSk7CgkgICAgICAgICAgICAgICAgcmV0dXJuIGRBIDwgZEIgPyAtMSA6IGRBID4gZEIgPyAxIDogMDsKCSAgICAgICAgICAgIH0pOwoJICAgICAgICAgICAgdmFyIGxpbWl0ID0gTWF0aC5tYXgoMC4yICogYXZlcmFnZSwgc3RkRGV2KTsKCSAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcG9zc2libGVDZW50ZXJzLmxlbmd0aCAmJiBwb3NzaWJsZUNlbnRlcnMubGVuZ3RoID4gMzsgaSsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBhdHRlcm4gPSBwb3NzaWJsZUNlbnRlcnNbaV07CgkgICAgICAgICAgICAgICAgaWYgKE1hdGguYWJzKHBhdHRlcm4uZ2V0RXN0aW1hdGVkTW9kdWxlU2l6ZSgpIC0gYXZlcmFnZSkgPiBsaW1pdCkgewoJICAgICAgICAgICAgICAgICAgICBwb3NzaWJsZUNlbnRlcnMuc3BsaWNlKGksIDEpOwoJICAgICAgICAgICAgICAgICAgICBpLS07CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGlmIChwb3NzaWJsZUNlbnRlcnMubGVuZ3RoID4gMykgewoJICAgICAgICAgICAgLy8gVGhyb3cgYXdheSBhbGwgYnV0IHRob3NlIGZpcnN0IHNpemUgY2FuZGlkYXRlIHBvaW50cyB3ZSBmb3VuZC4KCSAgICAgICAgICAgIHZhciB0b3RhbE1vZHVsZVNpemUgPSAwLjA7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGZvciAodmFyIHBvc3NpYmxlQ2VudGVyc18xID0gX192YWx1ZXMocG9zc2libGVDZW50ZXJzKSwgcG9zc2libGVDZW50ZXJzXzFfMSA9IHBvc3NpYmxlQ2VudGVyc18xLm5leHQoKTsgIXBvc3NpYmxlQ2VudGVyc18xXzEuZG9uZTsgcG9zc2libGVDZW50ZXJzXzFfMSA9IHBvc3NpYmxlQ2VudGVyc18xLm5leHQoKSkgewoJICAgICAgICAgICAgICAgICAgICB2YXIgcG9zc2libGVDZW50ZXIgPSBwb3NzaWJsZUNlbnRlcnNfMV8xLnZhbHVlOwoJICAgICAgICAgICAgICAgICAgICB0b3RhbE1vZHVsZVNpemUgKz0gcG9zc2libGVDZW50ZXIuZ2V0RXN0aW1hdGVkTW9kdWxlU2l6ZSgpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGNhdGNoIChlXzVfMSkgeyBlXzUgPSB7IGVycm9yOiBlXzVfMSB9OyB9CgkgICAgICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgICAgICBpZiAocG9zc2libGVDZW50ZXJzXzFfMSAmJiAhcG9zc2libGVDZW50ZXJzXzFfMS5kb25lICYmIChfYiA9IHBvc3NpYmxlQ2VudGVyc18xLnJldHVybikpIF9iLmNhbGwocG9zc2libGVDZW50ZXJzXzEpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfNSkgdGhyb3cgZV81LmVycm9yOyB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBhdmVyYWdlID0gdG90YWxNb2R1bGVTaXplIC8gcG9zc2libGVDZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgICAgIHBvc3NpYmxlQ2VudGVycy5zb3J0KAoJICAgICAgICAgICAgLyoqCgkgICAgICAgICAgICAgKiA8cD5PcmRlcnMgYnkge0BsaW5rIEZpbmRlclBhdHRlcm4jZ2V0Q291bnQoKX0sIGRlc2NlbmRpbmcuPC9wPgoJICAgICAgICAgICAgICovCgkgICAgICAgICAgICAvLyBDZW50ZXJDb21wYXJhdG9yIGltcGxlbWVudHMgQ29tcGFyYXRvcjxGaW5kZXJQYXR0ZXJuPgoJICAgICAgICAgICAgZnVuY3Rpb24gKGNlbnRlcjEsIGNlbnRlcjIpIHsKCSAgICAgICAgICAgICAgICBpZiAoY2VudGVyMi5nZXRDb3VudCgpID09PSBjZW50ZXIxLmdldENvdW50KCkpIHsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGRBID0gTWF0aC5hYnMoY2VudGVyMi5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplKCkgLSBhdmVyYWdlKTsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGRCID0gTWF0aC5hYnMoY2VudGVyMS5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplKCkgLSBhdmVyYWdlKTsKCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRBIDwgZEIgPyAxIDogZEEgPiBkQiA/IC0xIDogMDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgIHJldHVybiBjZW50ZXIyLmdldENvdW50KCkgLSBjZW50ZXIxLmdldENvdW50KCk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfSk7CgkgICAgICAgICAgICBwb3NzaWJsZUNlbnRlcnMuc3BsaWNlKDMpOyAvLyB0aGlzIGlzIG5vdCByZWFseSBuZWNlc3NhcnkgYXMgd2Ugb25seSByZXR1cm4gZmlyc3QgMyBhbnl3YXkKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gWwoJICAgICAgICAgICAgcG9zc2libGVDZW50ZXJzWzBdLAoJICAgICAgICAgICAgcG9zc2libGVDZW50ZXJzWzFdLAoJICAgICAgICAgICAgcG9zc2libGVDZW50ZXJzWzJdCgkgICAgICAgIF07CgkgICAgfTsKCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLkNFTlRFUl9RVU9SVU0gPSAyOwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIuTUlOX1NLSVAgPSAzOyAvLyAxIHBpeGVsL21vZHVsZSB0aW1lcyAzIG1vZHVsZXMvY2VudGVyCgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5NQVhfTU9EVUxFUyA9IDU3OyAvLyBzdXBwb3J0IHVwIHRvIHZlcnNpb24gMTAgZm9yIG1vYmlsZSBjbGllbnRzCgkgICAgcmV0dXJuIEZpbmRlclBhdHRlcm5GaW5kZXI7Cgl9KCkpOwoJRmluZGVyUGF0dGVybkZpbmRlciQxLmRlZmF1bHQgPSBGaW5kZXJQYXR0ZXJuRmluZGVyOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoRGV0ZWN0b3IkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIE1hdGhVdGlsc18xID0gTWF0aFV0aWxzJDE7Cgl2YXIgRGV0ZWN0b3JSZXN1bHRfMSA9IERldGVjdG9yUmVzdWx0JDE7CgkvLyBpbXBvcnQgR3JpZFNhbXBsZXIgZnJvbSAnLi4vLi4vY29tbW9uL0dyaWRTYW1wbGVyJzsKCXZhciBHcmlkU2FtcGxlckluc3RhbmNlXzEgPSBHcmlkU2FtcGxlckluc3RhbmNlJDE7Cgl2YXIgUGVyc3BlY3RpdmVUcmFuc2Zvcm1fMSA9IFBlcnNwZWN0aXZlVHJhbnNmb3JtJDE7Cgl2YXIgRGVjb2RlSGludFR5cGVfMSQxID0gRGVjb2RlSGludFR5cGUkMTsKCXZhciBOb3RGb3VuZEV4Y2VwdGlvbl8xJDEgPSBOb3RGb3VuZEV4Y2VwdGlvbiQxOwoJdmFyIFJlc3VsdFBvaW50XzEgPSBSZXN1bHRQb2ludCQxOwoJdmFyIFZlcnNpb25fMSA9IFZlcnNpb24kMTsKCXZhciBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyXzEgPSBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyJDE7Cgl2YXIgRmluZGVyUGF0dGVybkZpbmRlcl8xID0gRmluZGVyUGF0dGVybkZpbmRlciQxOwoJLyppbXBvcnQgamF2YS51dGlsLk1hcDsqLwoJLyoqCgkgKiA8cD5FbmNhcHN1bGF0ZXMgbG9naWMgdGhhdCBjYW4gZGV0ZWN0IGEgUVIgQ29kZSBpbiBhbiBpbWFnZSwgZXZlbiBpZiB0aGUgUVIgQ29kZQoJICogaXMgcm90YXRlZCBvciBza2V3ZWQsIG9yIHBhcnRpYWxseSBvYnNjdXJlZC48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIERldGVjdG9yID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIERldGVjdG9yKGltYWdlKSB7CgkgICAgICAgIHRoaXMuaW1hZ2UgPSBpbWFnZTsKCSAgICB9CgkgICAgRGV0ZWN0b3IucHJvdG90eXBlLmdldEltYWdlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5pbWFnZTsKCSAgICB9OwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5nZXRSZXN1bHRQb2ludENhbGxiYWNrID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogPHA+RGV0ZWN0cyBhIFFSIENvZGUgaW4gYW4gaW1hZ2UuPC9wPgoJICAgICAqCgkgICAgICogQHJldHVybiB7QGxpbmsgRGV0ZWN0b3JSZXN1bHR9IGVuY2Fwc3VsYXRpbmcgcmVzdWx0cyBvZiBkZXRlY3RpbmcgYSBRUiBDb2RlCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBRUiBDb2RlIGNhbm5vdCBiZSBmb3VuZAoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIGEgUVIgQ29kZSBjYW5ub3QgYmUgZGVjb2RlZAoJICAgICAqLwoJICAgIC8vIHB1YmxpYyBkZXRlY3QoKTogRGV0ZWN0b3JSZXN1bHQgLyp0aHJvd3MgTm90Rm91bmRFeGNlcHRpb24sIEZvcm1hdEV4Y2VwdGlvbiovIHsKCSAgICAvLyAgIHJldHVybiBkZXRlY3QobnVsbCkKCSAgICAvLyB9CgkgICAgLyoqCgkgICAgICogPHA+RGV0ZWN0cyBhIFFSIENvZGUgaW4gYW4gaW1hZ2UuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGhpbnRzIG9wdGlvbmFsIGhpbnRzIHRvIGRldGVjdG9yCgkgICAgICogQHJldHVybiB7QGxpbmsgRGV0ZWN0b3JSZXN1bHR9IGVuY2Fwc3VsYXRpbmcgcmVzdWx0cyBvZiBkZXRlY3RpbmcgYSBRUiBDb2RlCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBRUiBDb2RlIGNhbm5vdCBiZSBmb3VuZAoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIGEgUVIgQ29kZSBjYW5ub3QgYmUgZGVjb2RlZAoJICAgICAqLwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5kZXRlY3QgPSBmdW5jdGlvbiAoaGludHMpIHsKCSAgICAgICAgdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrID0gKGhpbnRzID09PSBudWxsIHx8IGhpbnRzID09PSB1bmRlZmluZWQpID8gbnVsbCA6CgkgICAgICAgICAgICAvKihSZXN1bHRQb2ludENhbGxiYWNrKSAqLyBoaW50cy5nZXQoRGVjb2RlSGludFR5cGVfMSQxLmRlZmF1bHQuTkVFRF9SRVNVTFRfUE9JTlRfQ0FMTEJBQ0spOwoJICAgICAgICB2YXIgZmluZGVyID0gbmV3IEZpbmRlclBhdHRlcm5GaW5kZXJfMS5kZWZhdWx0KHRoaXMuaW1hZ2UsIHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayk7CgkgICAgICAgIHZhciBpbmZvID0gZmluZGVyLmZpbmQoaGludHMpOwoJICAgICAgICByZXR1cm4gdGhpcy5wcm9jZXNzRmluZGVyUGF0dGVybkluZm8oaW5mbyk7CgkgICAgfTsKCSAgICBEZXRlY3Rvci5wcm90b3R5cGUucHJvY2Vzc0ZpbmRlclBhdHRlcm5JbmZvID0gZnVuY3Rpb24gKGluZm8pIHsKCSAgICAgICAgdmFyIHRvcExlZnQgPSBpbmZvLmdldFRvcExlZnQoKTsKCSAgICAgICAgdmFyIHRvcFJpZ2h0ID0gaW5mby5nZXRUb3BSaWdodCgpOwoJICAgICAgICB2YXIgYm90dG9tTGVmdCA9IGluZm8uZ2V0Qm90dG9tTGVmdCgpOwoJICAgICAgICB2YXIgbW9kdWxlU2l6ZSA9IHRoaXMuY2FsY3VsYXRlTW9kdWxlU2l6ZSh0b3BMZWZ0LCB0b3BSaWdodCwgYm90dG9tTGVmdCk7CgkgICAgICAgIGlmIChtb2R1bGVTaXplIDwgMS4wKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMSQxLmRlZmF1bHQoJ05vIHBhdHRlcm4gZm91bmQgaW4gcHJvY2Nlc3MgZmluZGVyLicpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBkaW1lbnNpb24gPSBEZXRlY3Rvci5jb21wdXRlRGltZW5zaW9uKHRvcExlZnQsIHRvcFJpZ2h0LCBib3R0b21MZWZ0LCBtb2R1bGVTaXplKTsKCSAgICAgICAgdmFyIHByb3Zpc2lvbmFsVmVyc2lvbiA9IFZlcnNpb25fMS5kZWZhdWx0LmdldFByb3Zpc2lvbmFsVmVyc2lvbkZvckRpbWVuc2lvbihkaW1lbnNpb24pOwoJICAgICAgICB2YXIgbW9kdWxlc0JldHdlZW5GUENlbnRlcnMgPSBwcm92aXNpb25hbFZlcnNpb24uZ2V0RGltZW5zaW9uRm9yVmVyc2lvbigpIC0gNzsKCSAgICAgICAgdmFyIGFsaWdubWVudFBhdHRlcm4gPSBudWxsOwoJICAgICAgICAvLyBBbnl0aGluZyBhYm92ZSB2ZXJzaW9uIDEgaGFzIGFuIGFsaWdubWVudCBwYXR0ZXJuCgkgICAgICAgIGlmIChwcm92aXNpb25hbFZlcnNpb24uZ2V0QWxpZ25tZW50UGF0dGVybkNlbnRlcnMoKS5sZW5ndGggPiAwKSB7CgkgICAgICAgICAgICAvLyBHdWVzcyB3aGVyZSBhICJib3R0b20gcmlnaHQiIGZpbmRlciBwYXR0ZXJuIHdvdWxkIGhhdmUgYmVlbgoJICAgICAgICAgICAgdmFyIGJvdHRvbVJpZ2h0WCA9IHRvcFJpZ2h0LmdldFgoKSAtIHRvcExlZnQuZ2V0WCgpICsgYm90dG9tTGVmdC5nZXRYKCk7CgkgICAgICAgICAgICB2YXIgYm90dG9tUmlnaHRZID0gdG9wUmlnaHQuZ2V0WSgpIC0gdG9wTGVmdC5nZXRZKCkgKyBib3R0b21MZWZ0LmdldFkoKTsKCSAgICAgICAgICAgIC8vIEVzdGltYXRlIHRoYXQgYWxpZ25tZW50IHBhdHRlcm4gaXMgY2xvc2VyIGJ5IDMgbW9kdWxlcwoJICAgICAgICAgICAgLy8gZnJvbSAiYm90dG9tIHJpZ2h0IiB0byBrbm93biB0b3AgbGVmdCBsb2NhdGlvbgoJICAgICAgICAgICAgdmFyIGNvcnJlY3Rpb25Ub1RvcExlZnQgPSAxLjAgLSAzLjAgLyBtb2R1bGVzQmV0d2VlbkZQQ2VudGVyczsKCSAgICAgICAgICAgIHZhciBlc3RBbGlnbm1lbnRYID0gLyooaW50KSAqLyBNYXRoLmZsb29yKHRvcExlZnQuZ2V0WCgpICsgY29ycmVjdGlvblRvVG9wTGVmdCAqIChib3R0b21SaWdodFggLSB0b3BMZWZ0LmdldFgoKSkpOwoJICAgICAgICAgICAgdmFyIGVzdEFsaWdubWVudFkgPSAvKihpbnQpICovIE1hdGguZmxvb3IodG9wTGVmdC5nZXRZKCkgKyBjb3JyZWN0aW9uVG9Ub3BMZWZ0ICogKGJvdHRvbVJpZ2h0WSAtIHRvcExlZnQuZ2V0WSgpKSk7CgkgICAgICAgICAgICAvLyBLaW5kIG9mIGFyYml0cmFyeSAtLSBleHBhbmQgc2VhcmNoIHJhZGl1cyBiZWZvcmUgZ2l2aW5nIHVwCgkgICAgICAgICAgICBmb3IgKHZhciBpID0gNDsgaSA8PSAxNjsgaSA8PD0gMSkgewoJICAgICAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgICAgIGFsaWdubWVudFBhdHRlcm4gPSB0aGlzLmZpbmRBbGlnbm1lbnRJblJlZ2lvbihtb2R1bGVTaXplLCBlc3RBbGlnbm1lbnRYLCBlc3RBbGlnbm1lbnRZLCBpKTsKCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGNhdGNoIChyZSAvKk5vdEZvdW5kRXhjZXB0aW9uKi8pIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKCEocmUgaW5zdGFuY2VvZiBOb3RGb3VuZEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCkpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IHJlOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIC8vIHRyeSBuZXh0IHJvdW5kCgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgLy8gSWYgd2UgZGlkbid0IGZpbmQgYWxpZ25tZW50IHBhdHRlcm4uLi4gd2VsbCB0cnkgYW55d2F5IHdpdGhvdXQgaXQKCSAgICAgICAgfQoJICAgICAgICB2YXIgdHJhbnNmb3JtID0gRGV0ZWN0b3IuY3JlYXRlVHJhbnNmb3JtKHRvcExlZnQsIHRvcFJpZ2h0LCBib3R0b21MZWZ0LCBhbGlnbm1lbnRQYXR0ZXJuLCBkaW1lbnNpb24pOwoJICAgICAgICB2YXIgYml0cyA9IERldGVjdG9yLnNhbXBsZUdyaWQodGhpcy5pbWFnZSwgdHJhbnNmb3JtLCBkaW1lbnNpb24pOwoJICAgICAgICB2YXIgcG9pbnRzOwoJICAgICAgICBpZiAoYWxpZ25tZW50UGF0dGVybiA9PT0gbnVsbCkgewoJICAgICAgICAgICAgcG9pbnRzID0gW2JvdHRvbUxlZnQsIHRvcExlZnQsIHRvcFJpZ2h0XTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHBvaW50cyA9IFtib3R0b21MZWZ0LCB0b3BMZWZ0LCB0b3BSaWdodCwgYWxpZ25tZW50UGF0dGVybl07CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG5ldyBEZXRlY3RvclJlc3VsdF8xLmRlZmF1bHQoYml0cywgcG9pbnRzKTsKCSAgICB9OwoJICAgIERldGVjdG9yLmNyZWF0ZVRyYW5zZm9ybSA9IGZ1bmN0aW9uICh0b3BMZWZ0LCB0b3BSaWdodCwgYm90dG9tTGVmdCwgYWxpZ25tZW50UGF0dGVybiwgZGltZW5zaW9uIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGRpbU1pbnVzVGhyZWUgPSBkaW1lbnNpb24gLSAzLjU7CgkgICAgICAgIHZhciBib3R0b21SaWdodFg7IC8qZmxvYXQqLwoJICAgICAgICB2YXIgYm90dG9tUmlnaHRZOyAvKmZsb2F0Ki8KCSAgICAgICAgdmFyIHNvdXJjZUJvdHRvbVJpZ2h0WDsgLypmbG9hdCovCgkgICAgICAgIHZhciBzb3VyY2VCb3R0b21SaWdodFk7IC8qZmxvYXQqLwoJICAgICAgICBpZiAoYWxpZ25tZW50UGF0dGVybiAhPT0gbnVsbCkgewoJICAgICAgICAgICAgYm90dG9tUmlnaHRYID0gYWxpZ25tZW50UGF0dGVybi5nZXRYKCk7CgkgICAgICAgICAgICBib3R0b21SaWdodFkgPSBhbGlnbm1lbnRQYXR0ZXJuLmdldFkoKTsKCSAgICAgICAgICAgIHNvdXJjZUJvdHRvbVJpZ2h0WCA9IGRpbU1pbnVzVGhyZWUgLSAzLjA7CgkgICAgICAgICAgICBzb3VyY2VCb3R0b21SaWdodFkgPSBzb3VyY2VCb3R0b21SaWdodFg7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAvLyBEb24ndCBoYXZlIGFuIGFsaWdubWVudCBwYXR0ZXJuLCBqdXN0IG1ha2UgdXAgdGhlIGJvdHRvbS1yaWdodCBwb2ludAoJICAgICAgICAgICAgYm90dG9tUmlnaHRYID0gKHRvcFJpZ2h0LmdldFgoKSAtIHRvcExlZnQuZ2V0WCgpKSArIGJvdHRvbUxlZnQuZ2V0WCgpOwoJICAgICAgICAgICAgYm90dG9tUmlnaHRZID0gKHRvcFJpZ2h0LmdldFkoKSAtIHRvcExlZnQuZ2V0WSgpKSArIGJvdHRvbUxlZnQuZ2V0WSgpOwoJICAgICAgICAgICAgc291cmNlQm90dG9tUmlnaHRYID0gZGltTWludXNUaHJlZTsKCSAgICAgICAgICAgIHNvdXJjZUJvdHRvbVJpZ2h0WSA9IGRpbU1pbnVzVGhyZWU7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIFBlcnNwZWN0aXZlVHJhbnNmb3JtXzEuZGVmYXVsdC5xdWFkcmlsYXRlcmFsVG9RdWFkcmlsYXRlcmFsKDMuNSwgMy41LCBkaW1NaW51c1RocmVlLCAzLjUsIHNvdXJjZUJvdHRvbVJpZ2h0WCwgc291cmNlQm90dG9tUmlnaHRZLCAzLjUsIGRpbU1pbnVzVGhyZWUsIHRvcExlZnQuZ2V0WCgpLCB0b3BMZWZ0LmdldFkoKSwgdG9wUmlnaHQuZ2V0WCgpLCB0b3BSaWdodC5nZXRZKCksIGJvdHRvbVJpZ2h0WCwgYm90dG9tUmlnaHRZLCBib3R0b21MZWZ0LmdldFgoKSwgYm90dG9tTGVmdC5nZXRZKCkpOwoJICAgIH07CgkgICAgRGV0ZWN0b3Iuc2FtcGxlR3JpZCA9IGZ1bmN0aW9uIChpbWFnZSwgdHJhbnNmb3JtLCBkaW1lbnNpb24gLyppbnQqLykgewoJICAgICAgICB2YXIgc2FtcGxlciA9IEdyaWRTYW1wbGVySW5zdGFuY2VfMS5kZWZhdWx0LmdldEluc3RhbmNlKCk7CgkgICAgICAgIHJldHVybiBzYW1wbGVyLnNhbXBsZUdyaWRXaXRoVHJhbnNmb3JtKGltYWdlLCBkaW1lbnNpb24sIGRpbWVuc2lvbiwgdHJhbnNmb3JtKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkNvbXB1dGVzIHRoZSBkaW1lbnNpb24gKG51bWJlciBvZiBtb2R1bGVzIG9uIGEgc2l6ZSkgb2YgdGhlIFFSIENvZGUgYmFzZWQgb24gdGhlIHBvc2l0aW9uCgkgICAgICogb2YgdGhlIGZpbmRlciBwYXR0ZXJucyBhbmQgZXN0aW1hdGVkIG1vZHVsZSBzaXplLjwvcD4KCSAgICAgKi8KCSAgICBEZXRlY3Rvci5jb21wdXRlRGltZW5zaW9uID0gZnVuY3Rpb24gKHRvcExlZnQsIHRvcFJpZ2h0LCBib3R0b21MZWZ0LCBtb2R1bGVTaXplIC8qZmxvYXQqLykgewoJICAgICAgICB2YXIgdGx0ckNlbnRlcnNEaW1lbnNpb24gPSBNYXRoVXRpbHNfMS5kZWZhdWx0LnJvdW5kKFJlc3VsdFBvaW50XzEuZGVmYXVsdC5kaXN0YW5jZSh0b3BMZWZ0LCB0b3BSaWdodCkgLyBtb2R1bGVTaXplKTsKCSAgICAgICAgdmFyIHRsYmxDZW50ZXJzRGltZW5zaW9uID0gTWF0aFV0aWxzXzEuZGVmYXVsdC5yb3VuZChSZXN1bHRQb2ludF8xLmRlZmF1bHQuZGlzdGFuY2UodG9wTGVmdCwgYm90dG9tTGVmdCkgLyBtb2R1bGVTaXplKTsKCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IE1hdGguZmxvb3IoKHRsdHJDZW50ZXJzRGltZW5zaW9uICsgdGxibENlbnRlcnNEaW1lbnNpb24pIC8gMikgKyA3OwoJICAgICAgICBzd2l0Y2ggKGRpbWVuc2lvbiAmIDB4MDMpIHsgLy8gbW9kIDQKCSAgICAgICAgICAgIGNhc2UgMDoKCSAgICAgICAgICAgICAgICBkaW1lbnNpb24rKzsKCSAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgIC8vIDE/IGRvIG5vdGhpbmcKCSAgICAgICAgICAgIGNhc2UgMjoKCSAgICAgICAgICAgICAgICBkaW1lbnNpb24tLTsKCSAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgIGNhc2UgMzoKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMSQxLmRlZmF1bHQoJ0RpbWVuc2lvbnMgY291bGQgYmUgbm90IGZvdW5kLicpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBkaW1lbnNpb247CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiA8cD5Db21wdXRlcyBhbiBhdmVyYWdlIGVzdGltYXRlZCBtb2R1bGUgc2l6ZSBiYXNlZCBvbiBlc3RpbWF0ZWQgZGVyaXZlZCBmcm9tIHRoZSBwb3NpdGlvbnMKCSAgICAgKiBvZiB0aGUgdGhyZWUgZmluZGVyIHBhdHRlcm5zLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB0b3BMZWZ0IGRldGVjdGVkIHRvcC1sZWZ0IGZpbmRlciBwYXR0ZXJuIGNlbnRlcgoJICAgICAqIEBwYXJhbSB0b3BSaWdodCBkZXRlY3RlZCB0b3AtcmlnaHQgZmluZGVyIHBhdHRlcm4gY2VudGVyCgkgICAgICogQHBhcmFtIGJvdHRvbUxlZnQgZGV0ZWN0ZWQgYm90dG9tLWxlZnQgZmluZGVyIHBhdHRlcm4gY2VudGVyCgkgICAgICogQHJldHVybiBlc3RpbWF0ZWQgbW9kdWxlIHNpemUKCSAgICAgKi8KCSAgICBEZXRlY3Rvci5wcm90b3R5cGUuY2FsY3VsYXRlTW9kdWxlU2l6ZSA9IGZ1bmN0aW9uICh0b3BMZWZ0LCB0b3BSaWdodCwgYm90dG9tTGVmdCkgewoJICAgICAgICAvLyBUYWtlIHRoZSBhdmVyYWdlCgkgICAgICAgIHJldHVybiAodGhpcy5jYWxjdWxhdGVNb2R1bGVTaXplT25lV2F5KHRvcExlZnQsIHRvcFJpZ2h0KSArCgkgICAgICAgICAgICB0aGlzLmNhbGN1bGF0ZU1vZHVsZVNpemVPbmVXYXkodG9wTGVmdCwgYm90dG9tTGVmdCkpIC8gMi4wOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogPHA+RXN0aW1hdGVzIG1vZHVsZSBzaXplIGJhc2VkIG9uIHR3byBmaW5kZXIgcGF0dGVybnMgLS0gaXQgdXNlcwoJICAgICAqIHtAbGluayAjc2l6ZU9mQmxhY2tXaGl0ZUJsYWNrUnVuQm90aFdheXMoaW50LCBpbnQsIGludCwgaW50KX0gdG8gZmlndXJlIHRoZQoJICAgICAqIHdpZHRoIG9mIGVhY2gsIG1lYXN1cmluZyBhbG9uZyB0aGUgYXhpcyBiZXR3ZWVuIHRoZWlyIGNlbnRlcnMuPC9wPgoJICAgICAqLwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5jYWxjdWxhdGVNb2R1bGVTaXplT25lV2F5ID0gZnVuY3Rpb24gKHBhdHRlcm4sIG90aGVyUGF0dGVybikgewoJICAgICAgICB2YXIgbW9kdWxlU2l6ZUVzdDEgPSB0aGlzLnNpemVPZkJsYWNrV2hpdGVCbGFja1J1bkJvdGhXYXlzKC8qKGludCkgKi8gTWF0aC5mbG9vcihwYXR0ZXJuLmdldFgoKSksIAoJICAgICAgICAvKihpbnQpICovIE1hdGguZmxvb3IocGF0dGVybi5nZXRZKCkpLCAKCSAgICAgICAgLyooaW50KSAqLyBNYXRoLmZsb29yKG90aGVyUGF0dGVybi5nZXRYKCkpLCAKCSAgICAgICAgLyooaW50KSAqLyBNYXRoLmZsb29yKG90aGVyUGF0dGVybi5nZXRZKCkpKTsKCSAgICAgICAgdmFyIG1vZHVsZVNpemVFc3QyID0gdGhpcy5zaXplT2ZCbGFja1doaXRlQmxhY2tSdW5Cb3RoV2F5cygvKihpbnQpICovIE1hdGguZmxvb3Iob3RoZXJQYXR0ZXJuLmdldFgoKSksIAoJICAgICAgICAvKihpbnQpICovIE1hdGguZmxvb3Iob3RoZXJQYXR0ZXJuLmdldFkoKSksIAoJICAgICAgICAvKihpbnQpICovIE1hdGguZmxvb3IocGF0dGVybi5nZXRYKCkpLCAKCSAgICAgICAgLyooaW50KSAqLyBNYXRoLmZsb29yKHBhdHRlcm4uZ2V0WSgpKSk7CgkgICAgICAgIGlmIChpc05hTihtb2R1bGVTaXplRXN0MSkpIHsKCSAgICAgICAgICAgIHJldHVybiBtb2R1bGVTaXplRXN0MiAvIDcuMDsKCSAgICAgICAgfQoJICAgICAgICBpZiAoaXNOYU4obW9kdWxlU2l6ZUVzdDIpKSB7CgkgICAgICAgICAgICByZXR1cm4gbW9kdWxlU2l6ZUVzdDEgLyA3LjA7CgkgICAgICAgIH0KCSAgICAgICAgLy8gQXZlcmFnZSB0aGVtLCBhbmQgZGl2aWRlIGJ5IDcgc2luY2Ugd2UndmUgY291bnRlZCB0aGUgd2lkdGggb2YgMyBibGFjayBtb2R1bGVzLAoJICAgICAgICAvLyBhbmQgMSB3aGl0ZSBhbmQgMSBibGFjayBtb2R1bGUgb24gZWl0aGVyIHNpZGUuIEVyZ28sIGRpdmlkZSBzdW0gYnkgMTQuCgkgICAgICAgIHJldHVybiAobW9kdWxlU2l6ZUVzdDEgKyBtb2R1bGVTaXplRXN0MikgLyAxNC4wOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogU2VlIHtAbGluayAjc2l6ZU9mQmxhY2tXaGl0ZUJsYWNrUnVuKGludCwgaW50LCBpbnQsIGludCl9OyBjb21wdXRlcyB0aGUgdG90YWwgd2lkdGggb2YKCSAgICAgKiBhIGZpbmRlciBwYXR0ZXJuIGJ5IGxvb2tpbmcgZm9yIGEgYmxhY2std2hpdGUtYmxhY2sgcnVuIGZyb20gdGhlIGNlbnRlciBpbiB0aGUgZGlyZWN0aW9uCgkgICAgICogb2YgYW5vdGhlciBwb2ludCAoYW5vdGhlciBmaW5kZXIgcGF0dGVybiBjZW50ZXIpLCBhbmQgaW4gdGhlIG9wcG9zaXRlIGRpcmVjdGlvbiB0b28uCgkgICAgICovCgkgICAgRGV0ZWN0b3IucHJvdG90eXBlLnNpemVPZkJsYWNrV2hpdGVCbGFja1J1bkJvdGhXYXlzID0gZnVuY3Rpb24gKGZyb21YIC8qaW50Ki8sIGZyb21ZIC8qaW50Ki8sIHRvWCAvKmludCovLCB0b1kgLyppbnQqLykgewoJICAgICAgICB2YXIgcmVzdWx0ID0gdGhpcy5zaXplT2ZCbGFja1doaXRlQmxhY2tSdW4oZnJvbVgsIGZyb21ZLCB0b1gsIHRvWSk7CgkgICAgICAgIC8vIE5vdyBjb3VudCBvdGhlciB3YXkgLS0gZG9uJ3QgcnVuIG9mZiBpbWFnZSB0aG91Z2ggb2YgY291cnNlCgkgICAgICAgIHZhciBzY2FsZSA9IDEuMDsKCSAgICAgICAgdmFyIG90aGVyVG9YID0gZnJvbVggLSAodG9YIC0gZnJvbVgpOwoJICAgICAgICBpZiAob3RoZXJUb1ggPCAwKSB7CgkgICAgICAgICAgICBzY2FsZSA9IGZyb21YIC8gLyooZmxvYXQpICovIChmcm9tWCAtIG90aGVyVG9YKTsKCSAgICAgICAgICAgIG90aGVyVG9YID0gMDsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmIChvdGhlclRvWCA+PSB0aGlzLmltYWdlLmdldFdpZHRoKCkpIHsKCSAgICAgICAgICAgIHNjYWxlID0gKHRoaXMuaW1hZ2UuZ2V0V2lkdGgoKSAtIDEgLSBmcm9tWCkgLyAvKihmbG9hdCkgKi8gKG90aGVyVG9YIC0gZnJvbVgpOwoJICAgICAgICAgICAgb3RoZXJUb1ggPSB0aGlzLmltYWdlLmdldFdpZHRoKCkgLSAxOwoJICAgICAgICB9CgkgICAgICAgIHZhciBvdGhlclRvWSA9IC8qKGludCkgKi8gTWF0aC5mbG9vcihmcm9tWSAtICh0b1kgLSBmcm9tWSkgKiBzY2FsZSk7CgkgICAgICAgIHNjYWxlID0gMS4wOwoJICAgICAgICBpZiAob3RoZXJUb1kgPCAwKSB7CgkgICAgICAgICAgICBzY2FsZSA9IGZyb21ZIC8gLyooZmxvYXQpICovIChmcm9tWSAtIG90aGVyVG9ZKTsKCSAgICAgICAgICAgIG90aGVyVG9ZID0gMDsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmIChvdGhlclRvWSA+PSB0aGlzLmltYWdlLmdldEhlaWdodCgpKSB7CgkgICAgICAgICAgICBzY2FsZSA9ICh0aGlzLmltYWdlLmdldEhlaWdodCgpIC0gMSAtIGZyb21ZKSAvIC8qKGZsb2F0KSAqLyAob3RoZXJUb1kgLSBmcm9tWSk7CgkgICAgICAgICAgICBvdGhlclRvWSA9IHRoaXMuaW1hZ2UuZ2V0SGVpZ2h0KCkgLSAxOwoJICAgICAgICB9CgkgICAgICAgIG90aGVyVG9YID0gLyooaW50KSAqLyBNYXRoLmZsb29yKGZyb21YICsgKG90aGVyVG9YIC0gZnJvbVgpICogc2NhbGUpOwoJICAgICAgICByZXN1bHQgKz0gdGhpcy5zaXplT2ZCbGFja1doaXRlQmxhY2tSdW4oZnJvbVgsIGZyb21ZLCBvdGhlclRvWCwgb3RoZXJUb1kpOwoJICAgICAgICAvLyBNaWRkbGUgcGl4ZWwgaXMgZG91YmxlLWNvdW50ZWQgdGhpcyB3YXk7IHN1YnRyYWN0IDEKCSAgICAgICAgcmV0dXJuIHJlc3VsdCAtIDEuMDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlRoaXMgbWV0aG9kIHRyYWNlcyBhIGxpbmUgZnJvbSBhIHBvaW50IGluIHRoZSBpbWFnZSwgaW4gdGhlIGRpcmVjdGlvbiB0b3dhcmRzIGFub3RoZXIgcG9pbnQuCgkgICAgICogSXQgYmVnaW5zIGluIGEgYmxhY2sgcmVnaW9uLCBhbmQga2VlcHMgZ29pbmcgdW50aWwgaXQgZmluZHMgd2hpdGUsIHRoZW4gYmxhY2ssIHRoZW4gd2hpdGUgYWdhaW4uCgkgICAgICogSXQgcmVwb3J0cyB0aGUgZGlzdGFuY2UgZnJvbSB0aGUgc3RhcnQgdG8gdGhpcyBwb2ludC48L3A+CgkgICAgICoKCSAgICAgKiA8cD5UaGlzIGlzIHVzZWQgd2hlbiBmaWd1cmluZyBvdXQgaG93IHdpZGUgYSBmaW5kZXIgcGF0dGVybiBpcywgd2hlbiB0aGUgZmluZGVyIHBhdHRlcm4KCSAgICAgKiBtYXkgYmUgc2tld2VkIG9yIHJvdGF0ZWQuPC9wPgoJICAgICAqLwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5zaXplT2ZCbGFja1doaXRlQmxhY2tSdW4gPSBmdW5jdGlvbiAoZnJvbVggLyppbnQqLywgZnJvbVkgLyppbnQqLywgdG9YIC8qaW50Ki8sIHRvWSAvKmludCovKSB7CgkgICAgICAgIC8vIE1pbGQgdmFyaWFudCBvZiBCcmVzZW5oYW0ncyBhbGdvcml0aG0KCSAgICAgICAgLy8gc2VlIGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvQnJlc2VuaGFtJ3NfbGluZV9hbGdvcml0aG0KCSAgICAgICAgdmFyIHN0ZWVwID0gTWF0aC5hYnModG9ZIC0gZnJvbVkpID4gTWF0aC5hYnModG9YIC0gZnJvbVgpOwoJICAgICAgICBpZiAoc3RlZXApIHsKCSAgICAgICAgICAgIHZhciB0ZW1wID0gZnJvbVg7CgkgICAgICAgICAgICBmcm9tWCA9IGZyb21ZOwoJICAgICAgICAgICAgZnJvbVkgPSB0ZW1wOwoJICAgICAgICAgICAgdGVtcCA9IHRvWDsKCSAgICAgICAgICAgIHRvWCA9IHRvWTsKCSAgICAgICAgICAgIHRvWSA9IHRlbXA7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGR4ID0gTWF0aC5hYnModG9YIC0gZnJvbVgpOwoJICAgICAgICB2YXIgZHkgPSBNYXRoLmFicyh0b1kgLSBmcm9tWSk7CgkgICAgICAgIHZhciBlcnJvciA9IC1keCAvIDI7CgkgICAgICAgIHZhciB4c3RlcCA9IGZyb21YIDwgdG9YID8gMSA6IC0xOwoJICAgICAgICB2YXIgeXN0ZXAgPSBmcm9tWSA8IHRvWSA/IDEgOiAtMTsKCSAgICAgICAgLy8gSW4gYmxhY2sgcGl4ZWxzLCBsb29raW5nIGZvciB3aGl0ZSwgZmlyc3Qgb3Igc2Vjb25kIHRpbWUuCgkgICAgICAgIHZhciBzdGF0ZSA9IDA7CgkgICAgICAgIC8vIExvb3AgdXAgdW50aWwgeCA9PSB0b1gsIGJ1dCBub3QgYmV5b25kCgkgICAgICAgIHZhciB4TGltaXQgPSB0b1ggKyB4c3RlcDsKCSAgICAgICAgZm9yICh2YXIgeCA9IGZyb21YLCB5ID0gZnJvbVk7IHggIT09IHhMaW1pdDsgeCArPSB4c3RlcCkgewoJICAgICAgICAgICAgdmFyIHJlYWxYID0gc3RlZXAgPyB5IDogeDsKCSAgICAgICAgICAgIHZhciByZWFsWSA9IHN0ZWVwID8geCA6IHk7CgkgICAgICAgICAgICAvLyBEb2VzIGN1cnJlbnQgcGl4ZWwgbWVhbiB3ZSBoYXZlIG1vdmVkIHdoaXRlIHRvIGJsYWNrIG9yIHZpY2UgdmVyc2E/CgkgICAgICAgICAgICAvLyBTY2FubmluZyBibGFjayBpbiBzdGF0ZSAwLDIgYW5kIHdoaXRlIGluIHN0YXRlIDEsIHNvIGlmIHdlIGZpbmQgdGhlIHdyb25nCgkgICAgICAgICAgICAvLyBjb2xvciwgYWR2YW5jZSB0byBuZXh0IHN0YXRlIG9yIGVuZCBpZiB3ZSBhcmUgaW4gc3RhdGUgMiBhbHJlYWR5CgkgICAgICAgICAgICBpZiAoKHN0YXRlID09PSAxKSA9PT0gdGhpcy5pbWFnZS5nZXQocmVhbFgsIHJlYWxZKSkgewoJICAgICAgICAgICAgICAgIGlmIChzdGF0ZSA9PT0gMikgewoJICAgICAgICAgICAgICAgICAgICByZXR1cm4gTWF0aFV0aWxzXzEuZGVmYXVsdC5kaXN0YW5jZSh4LCB5LCBmcm9tWCwgZnJvbVkpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBzdGF0ZSsrOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZXJyb3IgKz0gZHk7CgkgICAgICAgICAgICBpZiAoZXJyb3IgPiAwKSB7CgkgICAgICAgICAgICAgICAgaWYgKHkgPT09IHRvWSkgewoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgeSArPSB5c3RlcDsKCSAgICAgICAgICAgICAgICBlcnJvciAtPSBkeDsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICAvLyBGb3VuZCBibGFjay13aGl0ZS1ibGFjazsgZ2l2ZSB0aGUgYmVuZWZpdCBvZiB0aGUgZG91YnQgdGhhdCB0aGUgbmV4dCBwaXhlbCBvdXRzaWRlIHRoZSBpbWFnZQoJICAgICAgICAvLyBpcyAid2hpdGUiIHNvIHRoaXMgbGFzdCBwb2ludCBhdCAodG9YK3hTdGVwLHRvWSkgaXMgdGhlIHJpZ2h0IGVuZGluZy4gVGhpcyBpcyByZWFsbHkgYQoJICAgICAgICAvLyBzbWFsbCBhcHByb3hpbWF0aW9uOyAodG9YK3hTdGVwLHRvWSt5U3RlcCkgbWlnaHQgYmUgcmVhbGx5IGNvcnJlY3QuIElnbm9yZSB0aGlzLgoJICAgICAgICBpZiAoc3RhdGUgPT09IDIpIHsKCSAgICAgICAgICAgIHJldHVybiBNYXRoVXRpbHNfMS5kZWZhdWx0LmRpc3RhbmNlKHRvWCArIHhzdGVwLCB0b1ksIGZyb21YLCBmcm9tWSk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gZWxzZSB3ZSBkaWRuJ3QgZmluZCBldmVuIGJsYWNrLXdoaXRlLWJsYWNrOyBubyBlc3RpbWF0ZSBpcyByZWFsbHkgcG9zc2libGUKCSAgICAgICAgcmV0dXJuIE5hTjsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkF0dGVtcHRzIHRvIGxvY2F0ZSBhbiBhbGlnbm1lbnQgcGF0dGVybiBpbiBhIGxpbWl0ZWQgcmVnaW9uIG9mIHRoZSBpbWFnZSwgd2hpY2ggaXMKCSAgICAgKiBndWVzc2VkIHRvIGNvbnRhaW4gaXQuIFRoaXMgbWV0aG9kIHVzZXMge0BsaW5rIEFsaWdubWVudFBhdHRlcm59LjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBvdmVyYWxsRXN0TW9kdWxlU2l6ZSBlc3RpbWF0ZWQgbW9kdWxlIHNpemUgc28gZmFyCgkgICAgICogQHBhcmFtIGVzdEFsaWdubWVudFggeCBjb29yZGluYXRlIG9mIGNlbnRlciBvZiBhcmVhIHByb2JhYmx5IGNvbnRhaW5pbmcgYWxpZ25tZW50IHBhdHRlcm4KCSAgICAgKiBAcGFyYW0gZXN0QWxpZ25tZW50WSB5IGNvb3JkaW5hdGUgb2YgYWJvdmUKCSAgICAgKiBAcGFyYW0gYWxsb3dhbmNlRmFjdG9yIG51bWJlciBvZiBwaXhlbHMgaW4gYWxsIGRpcmVjdGlvbnMgdG8gc2VhcmNoIGZyb20gdGhlIGNlbnRlcgoJICAgICAqIEByZXR1cm4ge0BsaW5rIEFsaWdubWVudFBhdHRlcm59IGlmIGZvdW5kLCBvciBudWxsIG90aGVyd2lzZQoJICAgICAqIEB0aHJvd3MgTm90Rm91bmRFeGNlcHRpb24gaWYgYW4gdW5leHBlY3RlZCBlcnJvciBvY2N1cnMgZHVyaW5nIGRldGVjdGlvbgoJICAgICAqLwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5maW5kQWxpZ25tZW50SW5SZWdpb24gPSBmdW5jdGlvbiAob3ZlcmFsbEVzdE1vZHVsZVNpemUgLypmbG9hdCovLCBlc3RBbGlnbm1lbnRYIC8qaW50Ki8sIGVzdEFsaWdubWVudFkgLyppbnQqLywgYWxsb3dhbmNlRmFjdG9yIC8qZmxvYXQqLykgewoJICAgICAgICAvLyBMb29rIGZvciBhbiBhbGlnbm1lbnQgcGF0dGVybiAoMyBtb2R1bGVzIGluIHNpemUpIGFyb3VuZCB3aGVyZSBpdAoJICAgICAgICAvLyBzaG91bGQgYmUKCSAgICAgICAgdmFyIGFsbG93YW5jZSA9IC8qKGludCkgKi8gTWF0aC5mbG9vcihhbGxvd2FuY2VGYWN0b3IgKiBvdmVyYWxsRXN0TW9kdWxlU2l6ZSk7CgkgICAgICAgIHZhciBhbGlnbm1lbnRBcmVhTGVmdFggPSBNYXRoLm1heCgwLCBlc3RBbGlnbm1lbnRYIC0gYWxsb3dhbmNlKTsKCSAgICAgICAgdmFyIGFsaWdubWVudEFyZWFSaWdodFggPSBNYXRoLm1pbih0aGlzLmltYWdlLmdldFdpZHRoKCkgLSAxLCBlc3RBbGlnbm1lbnRYICsgYWxsb3dhbmNlKTsKCSAgICAgICAgaWYgKGFsaWdubWVudEFyZWFSaWdodFggLSBhbGlnbm1lbnRBcmVhTGVmdFggPCBvdmVyYWxsRXN0TW9kdWxlU2l6ZSAqIDMpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBOb3RGb3VuZEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgnQWxpZ25tZW50IHRvcCBleGNlZWRzIGVzdGltYXRlZCBtb2R1bGUgc2l6ZS4nKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYWxpZ25tZW50QXJlYVRvcFkgPSBNYXRoLm1heCgwLCBlc3RBbGlnbm1lbnRZIC0gYWxsb3dhbmNlKTsKCSAgICAgICAgdmFyIGFsaWdubWVudEFyZWFCb3R0b21ZID0gTWF0aC5taW4odGhpcy5pbWFnZS5nZXRIZWlnaHQoKSAtIDEsIGVzdEFsaWdubWVudFkgKyBhbGxvd2FuY2UpOwoJICAgICAgICBpZiAoYWxpZ25tZW50QXJlYUJvdHRvbVkgLSBhbGlnbm1lbnRBcmVhVG9wWSA8IG92ZXJhbGxFc3RNb2R1bGVTaXplICogMykgewoJICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkMS5kZWZhdWx0KCdBbGlnbm1lbnQgYm90dG9tIGV4Y2VlZHMgZXN0aW1hdGVkIG1vZHVsZSBzaXplLicpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBhbGlnbm1lbnRGaW5kZXIgPSBuZXcgQWxpZ25tZW50UGF0dGVybkZpbmRlcl8xLmRlZmF1bHQodGhpcy5pbWFnZSwgYWxpZ25tZW50QXJlYUxlZnRYLCBhbGlnbm1lbnRBcmVhVG9wWSwgYWxpZ25tZW50QXJlYVJpZ2h0WCAtIGFsaWdubWVudEFyZWFMZWZ0WCwgYWxpZ25tZW50QXJlYUJvdHRvbVkgLSBhbGlnbm1lbnRBcmVhVG9wWSwgb3ZlcmFsbEVzdE1vZHVsZVNpemUsIHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayk7CgkgICAgICAgIHJldHVybiBhbGlnbm1lbnRGaW5kZXIuZmluZCgpOwoJICAgIH07CgkgICAgcmV0dXJuIERldGVjdG9yOwoJfSgpKTsKCURldGVjdG9yJDEuZGVmYXVsdCA9IERldGVjdG9yOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoUVJDb2RlUmVhZGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcucXJjb2RlIHsqLwoJdmFyIEJhcmNvZGVGb3JtYXRfMSA9IEJhcmNvZGVGb3JtYXQkMTsKCXZhciBCaXRNYXRyaXhfMSA9IEJpdE1hdHJpeCQxOwoJdmFyIERlY29kZUhpbnRUeXBlXzEgPSBEZWNvZGVIaW50VHlwZSQxOwoJdmFyIE5vdEZvdW5kRXhjZXB0aW9uXzEgPSBOb3RGb3VuZEV4Y2VwdGlvbiQxOwoJdmFyIFJlc3VsdF8xID0gUmVzdWx0JDE7Cgl2YXIgUmVzdWx0TWV0YWRhdGFUeXBlXzEgPSBSZXN1bHRNZXRhZGF0YVR5cGUkMTsKCS8vIGltcG9ydCBEZXRlY3RvclJlc3VsdCBmcm9tICcuLi9jb21tb24vRGV0ZWN0b3JSZXN1bHQnOwoJdmFyIERlY29kZXJfMSA9IERlY29kZXIkMTsKCXZhciBRUkNvZGVEZWNvZGVyTWV0YURhdGFfMSA9IFFSQ29kZURlY29kZXJNZXRhRGF0YSQxOwoJdmFyIERldGVjdG9yXzEgPSBEZXRlY3RvciQxOwoJLyppbXBvcnQgamF2YS51dGlsLkxpc3Q7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5NYXA7Ki8KCS8qKgoJICogVGhpcyBpbXBsZW1lbnRhdGlvbiBjYW4gZGV0ZWN0IGFuZCBkZWNvZGUgUVIgQ29kZXMgaW4gYW4gaW1hZ2UuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIFFSQ29kZVJlYWRlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBRUkNvZGVSZWFkZXIoKSB7CgkgICAgICAgIHRoaXMuZGVjb2RlciA9IG5ldyBEZWNvZGVyXzEuZGVmYXVsdCgpOwoJICAgIH0KCSAgICBRUkNvZGVSZWFkZXIucHJvdG90eXBlLmdldERlY29kZXIgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRlY29kZXI7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBMb2NhdGVzIGFuZCBkZWNvZGVzIGEgUVIgY29kZSBpbiBhbiBpbWFnZS4KCSAgICAgKgoJICAgICAqIEByZXR1cm4gYSByZXByZXNlbnRpbmc6IHN0cmluZyB0aGUgY29udGVudCBlbmNvZGVkIGJ5IHRoZSBRUiBjb2RlCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBhIFFSIGNvZGUgY2Fubm90IGJlIGZvdW5kCgkgICAgICogQHRocm93cyBGb3JtYXRFeGNlcHRpb24gaWYgYSBRUiBjb2RlIGNhbm5vdCBiZSBkZWNvZGVkCgkgICAgICogQHRocm93cyBDaGVja3N1bUV4Y2VwdGlvbiBpZiBlcnJvciBjb3JyZWN0aW9uIGZhaWxzCgkgICAgICovCgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIC8vIHB1YmxpYyBkZWNvZGUoaW1hZ2U6IEJpbmFyeUJpdG1hcCk6IFJlc3VsdCAvKnRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiwgQ2hlY2tzdW1FeGNlcHRpb24sIEZvcm1hdEV4Y2VwdGlvbiAqLyB7CgkgICAgLy8gICByZXR1cm4gdGhpcy5kZWNvZGUoaW1hZ2UsIG51bGwpCgkgICAgLy8gfQoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBRUkNvZGVSZWFkZXIucHJvdG90eXBlLmRlY29kZSA9IGZ1bmN0aW9uIChpbWFnZSwgaGludHMpIHsKCSAgICAgICAgdmFyIGRlY29kZXJSZXN1bHQ7CgkgICAgICAgIHZhciBwb2ludHM7CgkgICAgICAgIGlmIChoaW50cyAhPT0gdW5kZWZpbmVkICYmIGhpbnRzICE9PSBudWxsICYmIHVuZGVmaW5lZCAhPT0gaGludHMuZ2V0KERlY29kZUhpbnRUeXBlXzEuZGVmYXVsdC5QVVJFX0JBUkNPREUpKSB7CgkgICAgICAgICAgICB2YXIgYml0cyA9IFFSQ29kZVJlYWRlci5leHRyYWN0UHVyZUJpdHMoaW1hZ2UuZ2V0QmxhY2tNYXRyaXgoKSk7CgkgICAgICAgICAgICBkZWNvZGVyUmVzdWx0ID0gdGhpcy5kZWNvZGVyLmRlY29kZUJpdE1hdHJpeChiaXRzLCBoaW50cyk7CgkgICAgICAgICAgICBwb2ludHMgPSBRUkNvZGVSZWFkZXIuTk9fUE9JTlRTOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgdmFyIGRldGVjdG9yUmVzdWx0ID0gbmV3IERldGVjdG9yXzEuZGVmYXVsdChpbWFnZS5nZXRCbGFja01hdHJpeCgpKS5kZXRlY3QoaGludHMpOwoJICAgICAgICAgICAgZGVjb2RlclJlc3VsdCA9IHRoaXMuZGVjb2Rlci5kZWNvZGVCaXRNYXRyaXgoZGV0ZWN0b3JSZXN1bHQuZ2V0Qml0cygpLCBoaW50cyk7CgkgICAgICAgICAgICBwb2ludHMgPSBkZXRlY3RvclJlc3VsdC5nZXRQb2ludHMoKTsKCSAgICAgICAgfQoJICAgICAgICAvLyBJZiB0aGUgY29kZSB3YXMgbWlycm9yZWQ6IHN3YXAgdGhlIGJvdHRvbS1sZWZ0IGFuZCB0aGUgdG9wLXJpZ2h0IHBvaW50cy4KCSAgICAgICAgaWYgKGRlY29kZXJSZXN1bHQuZ2V0T3RoZXIoKSBpbnN0YW5jZW9mIFFSQ29kZURlY29kZXJNZXRhRGF0YV8xLmRlZmF1bHQpIHsKCSAgICAgICAgICAgIGRlY29kZXJSZXN1bHQuZ2V0T3RoZXIoKS5hcHBseU1pcnJvcmVkQ29ycmVjdGlvbihwb2ludHMpOwoJICAgICAgICB9CgkgICAgICAgIHZhciByZXN1bHQgPSBuZXcgUmVzdWx0XzEuZGVmYXVsdChkZWNvZGVyUmVzdWx0LmdldFRleHQoKSwgZGVjb2RlclJlc3VsdC5nZXRSYXdCeXRlcygpLCB1bmRlZmluZWQsIHBvaW50cywgQmFyY29kZUZvcm1hdF8xLmRlZmF1bHQuUVJfQ09ERSwgdW5kZWZpbmVkKTsKCSAgICAgICAgdmFyIGJ5dGVTZWdtZW50cyA9IGRlY29kZXJSZXN1bHQuZ2V0Qnl0ZVNlZ21lbnRzKCk7CgkgICAgICAgIGlmIChieXRlU2VnbWVudHMgIT09IG51bGwpIHsKCSAgICAgICAgICAgIHJlc3VsdC5wdXRNZXRhZGF0YShSZXN1bHRNZXRhZGF0YVR5cGVfMS5kZWZhdWx0LkJZVEVfU0VHTUVOVFMsIGJ5dGVTZWdtZW50cyk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGVjTGV2ZWwgPSBkZWNvZGVyUmVzdWx0LmdldEVDTGV2ZWwoKTsKCSAgICAgICAgaWYgKGVjTGV2ZWwgIT09IG51bGwpIHsKCSAgICAgICAgICAgIHJlc3VsdC5wdXRNZXRhZGF0YShSZXN1bHRNZXRhZGF0YVR5cGVfMS5kZWZhdWx0LkVSUk9SX0NPUlJFQ1RJT05fTEVWRUwsIGVjTGV2ZWwpOwoJICAgICAgICB9CgkgICAgICAgIGlmIChkZWNvZGVyUmVzdWx0Lmhhc1N0cnVjdHVyZWRBcHBlbmQoKSkgewoJICAgICAgICAgICAgcmVzdWx0LnB1dE1ldGFkYXRhKFJlc3VsdE1ldGFkYXRhVHlwZV8xLmRlZmF1bHQuU1RSVUNUVVJFRF9BUFBFTkRfU0VRVUVOQ0UsIGRlY29kZXJSZXN1bHQuZ2V0U3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyKCkpOwoJICAgICAgICAgICAgcmVzdWx0LnB1dE1ldGFkYXRhKFJlc3VsdE1ldGFkYXRhVHlwZV8xLmRlZmF1bHQuU1RSVUNUVVJFRF9BUFBFTkRfUEFSSVRZLCBkZWNvZGVyUmVzdWx0LmdldFN0cnVjdHVyZWRBcHBlbmRQYXJpdHkoKSk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBRUkNvZGVSZWFkZXIucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICAvLyBkbyBub3RoaW5nCgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBUaGlzIG1ldGhvZCBkZXRlY3RzIGEgY29kZSBpbiBhICJwdXJlIiBpbWFnZSAtLSB0aGF0IGlzLCBwdXJlIG1vbm9jaHJvbWUgaW1hZ2UKCSAgICAgKiB3aGljaCBjb250YWlucyBvbmx5IGFuIHVucm90YXRlZCwgdW5za2V3ZWQsIGltYWdlIG9mIGEgY29kZSwgd2l0aCBzb21lIHdoaXRlIGJvcmRlcgoJICAgICAqIGFyb3VuZCBpdC4gVGhpcyBpcyBhIHNwZWNpYWxpemVkIG1ldGhvZCB0aGF0IHdvcmtzIGV4Y2VwdGlvbmFsbHkgZmFzdCBpbiB0aGlzIHNwZWNpYWwKCSAgICAgKiBjYXNlLgoJICAgICAqCgkgICAgICogQHNlZSBjb20uZ29vZ2xlLnp4aW5nLmRhdGFtYXRyaXguRGF0YU1hdHJpeFJlYWRlciNleHRyYWN0UHVyZUJpdHMoQml0TWF0cml4KQoJICAgICAqLwoJICAgIFFSQ29kZVJlYWRlci5leHRyYWN0UHVyZUJpdHMgPSBmdW5jdGlvbiAoaW1hZ2UpIHsKCSAgICAgICAgdmFyIGxlZnRUb3BCbGFjayA9IGltYWdlLmdldFRvcExlZnRPbkJpdCgpOwoJICAgICAgICB2YXIgcmlnaHRCb3R0b21CbGFjayA9IGltYWdlLmdldEJvdHRvbVJpZ2h0T25CaXQoKTsKCSAgICAgICAgaWYgKGxlZnRUb3BCbGFjayA9PT0gbnVsbCB8fCByaWdodEJvdHRvbUJsYWNrID09PSBudWxsKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIG1vZHVsZVNpemUgPSB0aGlzLm1vZHVsZVNpemUobGVmdFRvcEJsYWNrLCBpbWFnZSk7CgkgICAgICAgIHZhciB0b3AgPSBsZWZ0VG9wQmxhY2tbMV07CgkgICAgICAgIHZhciBib3R0b20gPSByaWdodEJvdHRvbUJsYWNrWzFdOwoJICAgICAgICB2YXIgbGVmdCA9IGxlZnRUb3BCbGFja1swXTsKCSAgICAgICAgdmFyIHJpZ2h0ID0gcmlnaHRCb3R0b21CbGFja1swXTsKCSAgICAgICAgLy8gU2FuaXR5IGNoZWNrIQoJICAgICAgICBpZiAobGVmdCA+PSByaWdodCB8fCB0b3AgPj0gYm90dG9tKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGJvdHRvbSAtIHRvcCAhPT0gcmlnaHQgLSBsZWZ0KSB7CgkgICAgICAgICAgICAvLyBTcGVjaWFsIGNhc2UsIHdoZXJlIGJvdHRvbS1yaWdodCBtb2R1bGUgd2Fzbid0IGJsYWNrIHNvIHdlIGZvdW5kIHNvbWV0aGluZyBlbHNlIGluIHRoZSBsYXN0IHJvdwoJICAgICAgICAgICAgLy8gQXNzdW1lIGl0J3MgYSBzcXVhcmUsIHNvIHVzZSBoZWlnaHQgYXMgdGhlIHdpZHRoCgkgICAgICAgICAgICByaWdodCA9IGxlZnQgKyAoYm90dG9tIC0gdG9wKTsKCSAgICAgICAgICAgIGlmIChyaWdodCA+PSBpbWFnZS5nZXRXaWR0aCgpKSB7CgkgICAgICAgICAgICAgICAgLy8gQWJvcnQgaWYgdGhhdCB3b3VsZCBub3QgbWFrZSBzZW5zZSAtLSBvZmYgaW1hZ2UKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgdmFyIG1hdHJpeFdpZHRoID0gTWF0aC5yb3VuZCgocmlnaHQgLSBsZWZ0ICsgMSkgLyBtb2R1bGVTaXplKTsKCSAgICAgICAgdmFyIG1hdHJpeEhlaWdodCA9IE1hdGgucm91bmQoKGJvdHRvbSAtIHRvcCArIDEpIC8gbW9kdWxlU2l6ZSk7CgkgICAgICAgIGlmIChtYXRyaXhXaWR0aCA8PSAwIHx8IG1hdHJpeEhlaWdodCA8PSAwKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKG1hdHJpeEhlaWdodCAhPT0gbWF0cml4V2lkdGgpIHsKCSAgICAgICAgICAgIC8vIE9ubHkgcG9zc2libHkgZGVjb2RlIHNxdWFyZSByZWdpb25zCgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gUHVzaCBpbiB0aGUgImJvcmRlciIgYnkgaGFsZiB0aGUgbW9kdWxlIHdpZHRoIHNvIHRoYXQgd2Ugc3RhcnQKCSAgICAgICAgLy8gc2FtcGxpbmcgaW4gdGhlIG1pZGRsZSBvZiB0aGUgbW9kdWxlLiBKdXN0IGluIGNhc2UgdGhlIGltYWdlIGlzIGEKCSAgICAgICAgLy8gbGl0dGxlIG9mZiwgdGhpcyB3aWxsIGhlbHAgcmVjb3Zlci4KCSAgICAgICAgdmFyIG51ZGdlID0gLyooaW50KSAqLyBNYXRoLmZsb29yKG1vZHVsZVNpemUgLyAyLjApOwoJICAgICAgICB0b3AgKz0gbnVkZ2U7CgkgICAgICAgIGxlZnQgKz0gbnVkZ2U7CgkgICAgICAgIC8vIEJ1dCBjYXJlZnVsIHRoYXQgdGhpcyBkb2VzIG5vdCBzYW1wbGUgb2ZmIHRoZSBlZGdlCgkgICAgICAgIC8vICJyaWdodCIgaXMgdGhlIGZhcnRoZXN0LXJpZ2h0IHZhbGlkIHBpeGVsIGxvY2F0aW9uIC0tIHJpZ2h0KzEgaXMgbm90IG5lY2Vzc2FyaWx5CgkgICAgICAgIC8vIFRoaXMgaXMgcG9zaXRpdmUgYnkgaG93IG11Y2ggdGhlIGlubmVyIHggbG9vcCBiZWxvdyB3b3VsZCBiZSB0b28gbGFyZ2UKCSAgICAgICAgdmFyIG51ZGdlZFRvb0ZhclJpZ2h0ID0gbGVmdCArIC8qKGludCkgKi8gTWF0aC5mbG9vcigobWF0cml4V2lkdGggLSAxKSAqIG1vZHVsZVNpemUpIC0gcmlnaHQ7CgkgICAgICAgIGlmIChudWRnZWRUb29GYXJSaWdodCA+IDApIHsKCSAgICAgICAgICAgIGlmIChudWRnZWRUb29GYXJSaWdodCA+IG51ZGdlKSB7CgkgICAgICAgICAgICAgICAgLy8gTmVpdGhlciB3YXkgZml0czsgYWJvcnQKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBsZWZ0IC09IG51ZGdlZFRvb0ZhclJpZ2h0OwoJICAgICAgICB9CgkgICAgICAgIC8vIFNlZSBsb2dpYyBhYm92ZQoJICAgICAgICB2YXIgbnVkZ2VkVG9vRmFyRG93biA9IHRvcCArIC8qKGludCkgKi8gTWF0aC5mbG9vcigobWF0cml4SGVpZ2h0IC0gMSkgKiBtb2R1bGVTaXplKSAtIGJvdHRvbTsKCSAgICAgICAgaWYgKG51ZGdlZFRvb0ZhckRvd24gPiAwKSB7CgkgICAgICAgICAgICBpZiAobnVkZ2VkVG9vRmFyRG93biA+IG51ZGdlKSB7CgkgICAgICAgICAgICAgICAgLy8gTmVpdGhlciB3YXkgZml0czsgYWJvcnQKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB0b3AgLT0gbnVkZ2VkVG9vRmFyRG93bjsKCSAgICAgICAgfQoJICAgICAgICAvLyBOb3cganVzdCByZWFkIG9mZiB0aGUgYml0cwoJICAgICAgICB2YXIgYml0cyA9IG5ldyBCaXRNYXRyaXhfMS5kZWZhdWx0KG1hdHJpeFdpZHRoLCBtYXRyaXhIZWlnaHQpOwoJICAgICAgICBmb3IgKHZhciB5ID0gMDsgeSA8IG1hdHJpeEhlaWdodDsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgaU9mZnNldCA9IHRvcCArIC8qKGludCkgKi8gTWF0aC5mbG9vcih5ICogbW9kdWxlU2l6ZSk7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IG1hdHJpeFdpZHRoOyB4KyspIHsKCSAgICAgICAgICAgICAgICBpZiAoaW1hZ2UuZ2V0KGxlZnQgKyAvKihpbnQpICovIE1hdGguZmxvb3IoeCAqIG1vZHVsZVNpemUpLCBpT2Zmc2V0KSkgewoJICAgICAgICAgICAgICAgICAgICBiaXRzLnNldCh4LCB5KTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGJpdHM7CgkgICAgfTsKCSAgICBRUkNvZGVSZWFkZXIubW9kdWxlU2l6ZSA9IGZ1bmN0aW9uIChsZWZ0VG9wQmxhY2ssIGltYWdlKSB7CgkgICAgICAgIHZhciBoZWlnaHQgPSBpbWFnZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgdmFyIHdpZHRoID0gaW1hZ2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIHggPSBsZWZ0VG9wQmxhY2tbMF07CgkgICAgICAgIHZhciB5ID0gbGVmdFRvcEJsYWNrWzFdOwoJICAgICAgICB2YXIgaW5CbGFjayA9IHRydWU7CgkgICAgICAgIHZhciB0cmFuc2l0aW9ucyA9IDA7CgkgICAgICAgIHdoaWxlICh4IDwgd2lkdGggJiYgeSA8IGhlaWdodCkgewoJICAgICAgICAgICAgaWYgKGluQmxhY2sgIT09IGltYWdlLmdldCh4LCB5KSkgewoJICAgICAgICAgICAgICAgIGlmICgrK3RyYW5zaXRpb25zID09PSA1KSB7CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBpbkJsYWNrID0gIWluQmxhY2s7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB4Kys7CgkgICAgICAgICAgICB5Kys7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHggPT09IHdpZHRoIHx8IHkgPT09IGhlaWdodCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiAoeCAtIGxlZnRUb3BCbGFja1swXSkgLyA3LjA7CgkgICAgfTsKCSAgICBRUkNvZGVSZWFkZXIuTk9fUE9JTlRTID0gbmV3IEFycmF5KCk7CgkgICAgcmV0dXJuIFFSQ29kZVJlYWRlcjsKCX0oKSk7Cgl2YXIgX2RlZmF1bHQgPSBRUkNvZGVSZWFkZXIkMS5kZWZhdWx0ID0gUVJDb2RlUmVhZGVyOwoKCXZhciB0b0dyYXlzY2FsZUJ1ZmZlciA9IGZ1bmN0aW9uIHRvR3JheXNjYWxlQnVmZmVyKGltYWdlQnVmZmVyLCB3aWR0aCwgaGVpZ2h0KSB7CgkgIHZhciBncmF5c2NhbGVCdWZmZXIgPSBuZXcgVWludDhDbGFtcGVkQXJyYXkod2lkdGggKiBoZWlnaHQpOwoKCSAgZm9yICh2YXIgaSA9IDAsIGogPSAwLCBsZW5ndGhfMSA9IGltYWdlQnVmZmVyLmxlbmd0aDsgaSA8IGxlbmd0aF8xOyBpICs9IDQsIGorKykgewoJICAgIHZhciBncmF5ID0gdm9pZCAwOwoJICAgIHZhciBhbHBoYSA9IGltYWdlQnVmZmVyW2kgKyAzXTsgLy8gVGhlIGNvbG9yIG9mIGZ1bGx5LXRyYW5zcGFyZW50IHBpeGVscyBpcyBpcnJlbGV2YW50LiBUaGV5IGFyZSBvZnRlbiwgdGVjaG5pY2FsbHksIGZ1bGx5LXRyYW5zcGFyZW50CgkgICAgLy8gYmxhY2sgKDAgYWxwaGEsIGFuZCB0aGVuIDAgUkdCKS4gVGhleSBhcmUgb2Z0ZW4gdXNlZCwgb2YgY291cnNlIGFzIHRoZSAid2hpdGUiIGFyZWEgaW4gYQoJICAgIC8vIGJhcmNvZGUgaW1hZ2UuIEZvcmNlIGFueSBzdWNoIHBpeGVsIHRvIGJlIHdoaXRlOgoKCSAgICBpZiAoYWxwaGEgPT09IDApIHsKCSAgICAgIGdyYXkgPSAweEZGOwoJICAgIH0gZWxzZSB7CgkgICAgICB2YXIgcGl4ZWxSID0gaW1hZ2VCdWZmZXJbaV07CgkgICAgICB2YXIgcGl4ZWxHID0gaW1hZ2VCdWZmZXJbaSArIDFdOwoJICAgICAgdmFyIHBpeGVsQiA9IGltYWdlQnVmZmVyW2kgKyAyXTsgLy8gLjI5OVIgKyAwLjU4N0cgKyAwLjExNEIgKFlVVi9ZSVEgZm9yIFBBTCBhbmQgTlRTQyksCgkgICAgICAvLyAoMzA2KlIpID4+IDEwIGlzIGFwcHJveGltYXRlbHkgZXF1YWwgdG8gUiowLjI5OSwgYW5kIHNvIG9uLgoJICAgICAgLy8gMHgyMDAgPj4gMTAgaXMgMC41LCBpdCBpbXBsZW1lbnRzIHJvdW5kaW5nLgoKCSAgICAgIGdyYXkgPSAzMDYgKiBwaXhlbFIgKyA2MDEgKiBwaXhlbEcgKyAxMTcgKiBwaXhlbEIgKyAweDIwMCA+PiAxMDsKCSAgICB9CgoJICAgIGdyYXlzY2FsZUJ1ZmZlcltqXSA9IGdyYXk7CgkgIH0KCgkgIHJldHVybiBncmF5c2NhbGVCdWZmZXI7Cgl9OwoKCXZhciByZWFkZXIgPSBuZXcgX2RlZmF1bHQoKTsKCXNlbGYuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIGZ1bmN0aW9uIChlKSB7CgkgIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tcmVzdHJpY3RlZC1nbG9iYWxzCgkgIHRyeSB7CgkgICAgdmFyIGx1bWluYW5jZXMgPSB0b0dyYXlzY2FsZUJ1ZmZlcihlLmRhdGEuZGF0YSwgZS5kYXRhLndpZHRoLCBlLmRhdGEuaGVpZ2h0KTsKCSAgICB2YXIgbHVtaW5hbmNlU291cmNlID0gbmV3IF9kZWZhdWx0JDEobHVtaW5hbmNlcywgZS5kYXRhLndpZHRoLCBlLmRhdGEuaGVpZ2h0KTsKCSAgICB2YXIgaHlicmlkQmluYXJpemVyID0gbmV3IF9kZWZhdWx0JDIobHVtaW5hbmNlU291cmNlKTsKCSAgICB2YXIgYmluYXJ5Qml0bWFwID0gbmV3IF9kZWZhdWx0JDMoaHlicmlkQmluYXJpemVyKTsKCSAgICB2YXIgZGVjb2RlZCA9IHJlYWRlci5kZWNvZGUoYmluYXJ5Qml0bWFwKTsKCSAgICBwb3N0TWVzc2FnZShkZWNvZGVkKTsKCSAgfSBjYXRjaCAoZXJyKSB7CgkgICAgcG9zdE1lc3NhZ2UobnVsbCk7CgkgIH0KCX0pOwoKfSkoKTsKCg==",null,!1),h=["constraints","onError","onLoad","onScan","resolution"];function G(g,e){var I=Object.keys(g);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(g);e&&(t=t.filter((function(e){return Object.getOwnPropertyDescriptor(g,e).enumerable}))),I.push.apply(I,t)}return I}function p(g){for(var e=1;e<arguments.length;e++){var I=null!=arguments[e]?arguments[e]:{};e%2?G(Object(I),!0).forEach((function(e){l(g,e,I[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(g,Object.getOwnPropertyDescriptors(I)):G(Object(I)).forEach((function(e){Object.defineProperty(g,e,Object.getOwnPropertyDescriptor(I,e))}))}return g}var y=function(){return new m},B=function(g){g&&(g.getVideoTracks&&g.getAudioTracks?(g.getVideoTracks().map((function(e){g.removeTrack(e),e.stop()})),g.getAudioTracks().map((function(e){g.removeTrack(e),e.stop()}))):g.stop())},v=function(e){var I=e.constraints,n=e.onError,l=e.onLoad,o=e.onScan,a=e.resolution,i=s(e,h),r=JSON.stringify(I),c=g.useRef(null),u=g.useRef(null),d=g.useRef(document.createElement("canvas")),Z=g.useRef(null),b=g.useRef(),m=A(g.useState(null),2),G=m[0],v=m[1],V=g.useRef(!1),W=g.useMemo(y,[y]);g.useEffect((function(){return function(){W.terminate()}}),[W]),g.useEffect((function(){W.onmessage=function(g){o&&o(g.data?p(p({},g.data),{},{canvas:d.current}):null),V.current=!1}}),[o,W]);var S=g.useCallback((function(){var g=u.current&&u.current.readyState===u.current.HAVE_ENOUGH_DATA;if(!V.current&&g){V.current=!0;var e=u.current.videoWidth,I=u.current.videoHeight,t=a/(e>I?e:I);I*=t,e*=t,d.current.width=e,d.current.height=I,Z.current=d.current.getContext("2d"),Z.current.drawImage(u.current,0,0,e,I);var n=Z.current.getImageData(0,0,e,I);W.postMessage(n)}b.current=requestAnimationFrame(S)}),[a,W]);return g.useEffect((function(){var g=JSON.parse(r),e=!0;return navigator.mediaDevices.getUserMedia(g).then((function(g){if(e){c.current=g;try{u.current&&(u.current.srcObject=g,u.current.setAttribute("playsinline",!0))}catch(I){v(window.URL.createObjectURL(g))}l&&l(),b.current=requestAnimationFrame(S)}else B(g)})).catch((function(g){return e?n(g):null})),function(){cancelAnimationFrame(b.current),e=!1,B(c.current),G&&window.URL.revokeObjectURL(G)}}),[S,r,n,l]),t.default.createElement("video",C({autoPlay:!0,playsInline:!0,src:G,ref:u},i))};return v.propTypes={constraints:n.default.object,onError:n.default.func.isRequired,onLoad:n.default.func,onScan:n.default.func.isRequired,resolution:n.default.number},v.defaultProps={constraints:{audio:!1,video:!0},resolution:640},v}(I(2791),I(2007))},6374:function(g,e,I){"use strict";I(1725);var t=I(2791),n=60103;if(e.Fragment=60107,"function"===typeof Symbol&&Symbol.for){var C=Symbol.for;n=C("react.element"),e.Fragment=C("react.fragment")}var l=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o=Object.prototype.hasOwnProperty,a={key:!0,ref:!0,__self:!0,__source:!0};function i(g,e,I){var t,C={},i=null,r=null;for(t in void 0!==I&&(i=""+I),void 0!==e.key&&(i=""+e.key),void 0!==e.ref&&(r=e.ref),e)o.call(e,t)&&!a.hasOwnProperty(t)&&(C[t]=e[t]);if(g&&g.defaultProps)for(t in e=g.defaultProps)void 0===C[t]&&(C[t]=e[t]);return{$$typeof:n,type:g,key:i,ref:r,props:C,_owner:l.current}}e.jsx=i,e.jsxs=i},9117:function(g,e,I){"use strict";var t=I(1725),n=60103,C=60106;e.Fragment=60107,e.StrictMode=60108,e.Profiler=60114;var l=60109,o=60110,a=60112;e.Suspense=60113;var i=60115,r=60116;if("function"===typeof Symbol&&Symbol.for){var c=Symbol.for;n=c("react.element"),C=c("react.portal"),e.Fragment=c("react.fragment"),e.StrictMode=c("react.strict_mode"),e.Profiler=c("react.profiler"),l=c("react.provider"),o=c("react.context"),a=c("react.forward_ref"),e.Suspense=c("react.suspense"),i=c("react.memo"),r=c("react.lazy")}var A="function"===typeof Symbol&&Symbol.iterator;function u(g){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+g,I=1;I<arguments.length;I++)e+="&args[]="+encodeURIComponent(arguments[I]);return"Minified React error #"+g+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},d={};function Z(g,e,I){this.props=g,this.context=e,this.refs=d,this.updater=I||s}function b(){}function m(g,e,I){this.props=g,this.context=e,this.refs=d,this.updater=I||s}Z.prototype.isReactComponent={},Z.prototype.setState=function(g,e){if("object"!==typeof g&&"function"!==typeof g&&null!=g)throw Error(u(85));this.updater.enqueueSetState(this,g,e,"setState")},Z.prototype.forceUpdate=function(g){this.updater.enqueueForceUpdate(this,g,"forceUpdate")},b.prototype=Z.prototype;var h=m.prototype=new b;h.constructor=m,t(h,Z.prototype),h.isPureReactComponent=!0;var G={current:null},p=Object.prototype.hasOwnProperty,y={key:!0,ref:!0,__self:!0,__source:!0};function B(g,e,I){var t,C={},l=null,o=null;if(null!=e)for(t in void 0!==e.ref&&(o=e.ref),void 0!==e.key&&(l=""+e.key),e)p.call(e,t)&&!y.hasOwnProperty(t)&&(C[t]=e[t]);var a=arguments.length-2;if(1===a)C.children=I;else if(1<a){for(var i=Array(a),r=0;r<a;r++)i[r]=arguments[r+2];C.children=i}if(g&&g.defaultProps)for(t in a=g.defaultProps)void 0===C[t]&&(C[t]=a[t]);return{$$typeof:n,type:g,key:l,ref:o,props:C,_owner:G.current}}function v(g){return"object"===typeof g&&null!==g&&g.$$typeof===n}var V=/\/+/g;function W(g,e){return"object"===typeof g&&null!==g&&null!=g.key?function(g){var e={"=":"=0",":":"=2"};return"$"+g.replace(/[=:]/g,(function(g){return e[g]}))}(""+g.key):e.toString(36)}function S(g,e,I,t,l){var o=typeof g;"undefined"!==o&&"boolean"!==o||(g=null);var a=!1;if(null===g)a=!0;else switch(o){case"string":case"number":a=!0;break;case"object":switch(g.$$typeof){case n:case C:a=!0}}if(a)return l=l(a=g),g=""===t?"."+W(a,0):t,Array.isArray(l)?(I="",null!=g&&(I=g.replace(V,"$&/")+"/"),S(l,e,I,"",(function(g){return g}))):null!=l&&(v(l)&&(l=function(g,e){return{$$typeof:n,type:g.type,key:e,ref:g.ref,props:g.props,_owner:g._owner}}(l,I+(!l.key||a&&a.key===l.key?"":(""+l.key).replace(V,"$&/")+"/")+g)),e.push(l)),1;if(a=0,t=""===t?".":t+":",Array.isArray(g))for(var i=0;i<g.length;i++){var r=t+W(o=g[i],i);a+=S(o,e,I,r,l)}else if(r=function(g){return null===g||"object"!==typeof g?null:"function"===typeof(g=A&&g[A]||g["@@iterator"])?g:null}(g),"function"===typeof r)for(g=r.call(g),i=0;!(o=g.next()).done;)a+=S(o=o.value,e,I,r=t+W(o,i++),l);else if("object"===o)throw e=""+g,Error(u(31,"[object Object]"===e?"object with keys {"+Object.keys(g).join(", ")+"}":e));return a}function f(g,e,I){if(null==g)return g;var t=[],n=0;return S(g,t,"","",(function(g){return e.call(I,g,n++)})),t}function k(g){if(-1===g._status){var e=g._result;e=e(),g._status=0,g._result=e,e.then((function(e){0===g._status&&(e=e.default,g._status=1,g._result=e)}),(function(e){0===g._status&&(g._status=2,g._result=e)}))}if(1===g._status)return g._result;throw g._result}var R={current:null};function X(){var g=R.current;if(null===g)throw Error(u(321));return g}var J={ReactCurrentDispatcher:R,ReactCurrentBatchConfig:{transition:0},ReactCurrentOwner:G,IsSomeRendererActing:{current:!1},assign:t};e.Children={map:f,forEach:function(g,e,I){f(g,(function(){e.apply(this,arguments)}),I)},count:function(g){var e=0;return f(g,(function(){e++})),e},toArray:function(g){return f(g,(function(g){return g}))||[]},only:function(g){if(!v(g))throw Error(u(143));return g}},e.Component=Z,e.PureComponent=m,e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=J,e.cloneElement=function(g,e,I){if(null===g||void 0===g)throw Error(u(267,g));var C=t({},g.props),l=g.key,o=g.ref,a=g._owner;if(null!=e){if(void 0!==e.ref&&(o=e.ref,a=G.current),void 0!==e.key&&(l=""+e.key),g.type&&g.type.defaultProps)var i=g.type.defaultProps;for(r in e)p.call(e,r)&&!y.hasOwnProperty(r)&&(C[r]=void 0===e[r]&&void 0!==i?i[r]:e[r])}var r=arguments.length-2;if(1===r)C.children=I;else if(1<r){i=Array(r);for(var c=0;c<r;c++)i[c]=arguments[c+2];C.children=i}return{$$typeof:n,type:g.type,key:l,ref:o,props:C,_owner:a}},e.createContext=function(g,e){return void 0===e&&(e=null),(g={$$typeof:o,_calculateChangedBits:e,_currentValue:g,_currentValue2:g,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:l,_context:g},g.Consumer=g},e.createElement=B,e.createFactory=function(g){var e=B.bind(null,g);return e.type=g,e},e.createRef=function(){return{current:null}},e.forwardRef=function(g){return{$$typeof:a,render:g}},e.isValidElement=v,e.lazy=function(g){return{$$typeof:r,_payload:{_status:-1,_result:g},_init:k}},e.memo=function(g,e){return{$$typeof:i,type:g,compare:void 0===e?null:e}},e.useCallback=function(g,e){return X().useCallback(g,e)},e.useContext=function(g,e){return X().useContext(g,e)},e.useDebugValue=function(){},e.useEffect=function(g,e){return X().useEffect(g,e)},e.useImperativeHandle=function(g,e,I){return X().useImperativeHandle(g,e,I)},e.useLayoutEffect=function(g,e){return X().useLayoutEffect(g,e)},e.useMemo=function(g,e){return X().useMemo(g,e)},e.useReducer=function(g,e,I){return X().useReducer(g,e,I)},e.useRef=function(g){return X().useRef(g)},e.useState=function(g){return X().useState(g)},e.version="17.0.2"},2791:function(g,e,I){"use strict";g.exports=I(9117)},184:function(g,e,I){"use strict";g.exports=I(6374)},9727:function(g){var e=function(g){"use strict";var e,I=Object.prototype,t=I.hasOwnProperty,n="function"===typeof Symbol?Symbol:{},C=n.iterator||"@@iterator",l=n.asyncIterator||"@@asyncIterator",o=n.toStringTag||"@@toStringTag";function a(g,e,I){return Object.defineProperty(g,e,{value:I,enumerable:!0,configurable:!0,writable:!0}),g[e]}try{a({},"")}catch(X){a=function(g,e,I){return g[e]=I}}function i(g,e,I,t){var n=e&&e.prototype instanceof Z?e:Z,C=Object.create(n.prototype),l=new f(t||[]);return C._invoke=function(g,e,I){var t=c;return function(n,C){if(t===u)throw new Error("Generator is already running");if(t===s){if("throw"===n)throw C;return R()}for(I.method=n,I.arg=C;;){var l=I.delegate;if(l){var o=V(l,I);if(o){if(o===d)continue;return o}}if("next"===I.method)I.sent=I._sent=I.arg;else if("throw"===I.method){if(t===c)throw t=s,I.arg;I.dispatchException(I.arg)}else"return"===I.method&&I.abrupt("return",I.arg);t=u;var a=r(g,e,I);if("normal"===a.type){if(t=I.done?s:A,a.arg===d)continue;return{value:a.arg,done:I.done}}"throw"===a.type&&(t=s,I.method="throw",I.arg=a.arg)}}}(g,I,l),C}function r(g,e,I){try{return{type:"normal",arg:g.call(e,I)}}catch(X){return{type:"throw",arg:X}}}g.wrap=i;var c="suspendedStart",A="suspendedYield",u="executing",s="completed",d={};function Z(){}function b(){}function m(){}var h={};a(h,C,(function(){return this}));var G=Object.getPrototypeOf,p=G&&G(G(k([])));p&&p!==I&&t.call(p,C)&&(h=p);var y=m.prototype=Z.prototype=Object.create(h);function B(g){["next","throw","return"].forEach((function(e){a(g,e,(function(g){return this._invoke(e,g)}))}))}function v(g,e){function I(n,C,l,o){var a=r(g[n],g,C);if("throw"!==a.type){var i=a.arg,c=i.value;return c&&"object"===typeof c&&t.call(c,"__await")?e.resolve(c.__await).then((function(g){I("next",g,l,o)}),(function(g){I("throw",g,l,o)})):e.resolve(c).then((function(g){i.value=g,l(i)}),(function(g){return I("throw",g,l,o)}))}o(a.arg)}var n;this._invoke=function(g,t){function C(){return new e((function(e,n){I(g,t,e,n)}))}return n=n?n.then(C,C):C()}}function V(g,I){var t=g.iterator[I.method];if(t===e){if(I.delegate=null,"throw"===I.method){if(g.iterator.return&&(I.method="return",I.arg=e,V(g,I),"throw"===I.method))return d;I.method="throw",I.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var n=r(t,g.iterator,I.arg);if("throw"===n.type)return I.method="throw",I.arg=n.arg,I.delegate=null,d;var C=n.arg;return C?C.done?(I[g.resultName]=C.value,I.next=g.nextLoc,"return"!==I.method&&(I.method="next",I.arg=e),I.delegate=null,d):C:(I.method="throw",I.arg=new TypeError("iterator result is not an object"),I.delegate=null,d)}function W(g){var e={tryLoc:g[0]};1 in g&&(e.catchLoc=g[1]),2 in g&&(e.finallyLoc=g[2],e.afterLoc=g[3]),this.tryEntries.push(e)}function S(g){var e=g.completion||{};e.type="normal",delete e.arg,g.completion=e}function f(g){this.tryEntries=[{tryLoc:"root"}],g.forEach(W,this),this.reset(!0)}function k(g){if(g){var I=g[C];if(I)return I.call(g);if("function"===typeof g.next)return g;if(!isNaN(g.length)){var n=-1,l=function I(){for(;++n<g.length;)if(t.call(g,n))return I.value=g[n],I.done=!1,I;return I.value=e,I.done=!0,I};return l.next=l}}return{next:R}}function R(){return{value:e,done:!0}}return b.prototype=m,a(y,"constructor",m),a(m,"constructor",b),b.displayName=a(m,o,"GeneratorFunction"),g.isGeneratorFunction=function(g){var e="function"===typeof g&&g.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},g.mark=function(g){return Object.setPrototypeOf?Object.setPrototypeOf(g,m):(g.__proto__=m,a(g,o,"GeneratorFunction")),g.prototype=Object.create(y),g},g.awrap=function(g){return{__await:g}},B(v.prototype),a(v.prototype,l,(function(){return this})),g.AsyncIterator=v,g.async=function(e,I,t,n,C){void 0===C&&(C=Promise);var l=new v(i(e,I,t,n),C);return g.isGeneratorFunction(I)?l:l.next().then((function(g){return g.done?g.value:l.next()}))},B(y),a(y,o,"Generator"),a(y,C,(function(){return this})),a(y,"toString",(function(){return"[object Generator]"})),g.keys=function(g){var e=[];for(var I in g)e.push(I);return e.reverse(),function I(){for(;e.length;){var t=e.pop();if(t in g)return I.value=t,I.done=!1,I}return I.done=!0,I}},g.values=k,f.prototype={constructor:f,reset:function(g){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(S),!g)for(var I in this)"t"===I.charAt(0)&&t.call(this,I)&&!isNaN(+I.slice(1))&&(this[I]=e)},stop:function(){this.done=!0;var g=this.tryEntries[0].completion;if("throw"===g.type)throw g.arg;return this.rval},dispatchException:function(g){if(this.done)throw g;var I=this;function n(t,n){return o.type="throw",o.arg=g,I.next=t,n&&(I.method="next",I.arg=e),!!n}for(var C=this.tryEntries.length-1;C>=0;--C){var l=this.tryEntries[C],o=l.completion;if("root"===l.tryLoc)return n("end");if(l.tryLoc<=this.prev){var a=t.call(l,"catchLoc"),i=t.call(l,"finallyLoc");if(a&&i){if(this.prev<l.catchLoc)return n(l.catchLoc,!0);if(this.prev<l.finallyLoc)return n(l.finallyLoc)}else if(a){if(this.prev<l.catchLoc)return n(l.catchLoc,!0)}else{if(!i)throw new Error("try statement without catch or finally");if(this.prev<l.finallyLoc)return n(l.finallyLoc)}}}},abrupt:function(g,e){for(var I=this.tryEntries.length-1;I>=0;--I){var n=this.tryEntries[I];if(n.tryLoc<=this.prev&&t.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var C=n;break}}C&&("break"===g||"continue"===g)&&C.tryLoc<=e&&e<=C.finallyLoc&&(C=null);var l=C?C.completion:{};return l.type=g,l.arg=e,C?(this.method="next",this.next=C.finallyLoc,d):this.complete(l)},complete:function(g,e){if("throw"===g.type)throw g.arg;return"break"===g.type||"continue"===g.type?this.next=g.arg:"return"===g.type?(this.rval=this.arg=g.arg,this.method="return",this.next="end"):"normal"===g.type&&e&&(this.next=e),d},finish:function(g){for(var e=this.tryEntries.length-1;e>=0;--e){var I=this.tryEntries[e];if(I.finallyLoc===g)return this.complete(I.completion,I.afterLoc),S(I),d}},catch:function(g){for(var e=this.tryEntries.length-1;e>=0;--e){var I=this.tryEntries[e];if(I.tryLoc===g){var t=I.completion;if("throw"===t.type){var n=t.arg;S(I)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(g,I,t){return this.delegate={iterator:k(g),resultName:I,nextLoc:t},"next"===this.method&&(this.arg=e),d}},g}(g.exports);try{regeneratorRuntime=e}catch(I){"object"===typeof globalThis?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}},6813:function(g,e){"use strict";var I,t,n,C;if("object"===typeof performance&&"function"===typeof performance.now){var l=performance;e.unstable_now=function(){return l.now()}}else{var o=Date,a=o.now();e.unstable_now=function(){return o.now()-a}}if("undefined"===typeof window||"function"!==typeof MessageChannel){var i=null,r=null,c=function g(){if(null!==i)try{var I=e.unstable_now();i(!0,I),i=null}catch(t){throw setTimeout(g,0),t}};I=function(g){null!==i?setTimeout(I,0,g):(i=g,setTimeout(c,0))},t=function(g,e){r=setTimeout(g,e)},n=function(){clearTimeout(r)},e.unstable_shouldYield=function(){return!1},C=e.unstable_forceFrameRate=function(){}}else{var A=window.setTimeout,u=window.clearTimeout;if("undefined"!==typeof console){var s=window.cancelAnimationFrame;"function"!==typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),"function"!==typeof s&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills")}var d=!1,Z=null,b=-1,m=5,h=0;e.unstable_shouldYield=function(){return e.unstable_now()>=h},C=function(){},e.unstable_forceFrameRate=function(g){0>g||125<g?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):m=0<g?Math.floor(1e3/g):5};var G=new MessageChannel,p=G.port2;G.port1.onmessage=function(){if(null!==Z){var g=e.unstable_now();h=g+m;try{Z(!0,g)?p.postMessage(null):(d=!1,Z=null)}catch(I){throw p.postMessage(null),I}}else d=!1},I=function(g){Z=g,d||(d=!0,p.postMessage(null))},t=function(g,I){b=A((function(){g(e.unstable_now())}),I)},n=function(){u(b),b=-1}}function y(g,e){var I=g.length;g.push(e);g:for(;;){var t=I-1>>>1,n=g[t];if(!(void 0!==n&&0<V(n,e)))break g;g[t]=e,g[I]=n,I=t}}function B(g){return void 0===(g=g[0])?null:g}function v(g){var e=g[0];if(void 0!==e){var I=g.pop();if(I!==e){g[0]=I;g:for(var t=0,n=g.length;t<n;){var C=2*(t+1)-1,l=g[C],o=C+1,a=g[o];if(void 0!==l&&0>V(l,I))void 0!==a&&0>V(a,l)?(g[t]=a,g[o]=I,t=o):(g[t]=l,g[C]=I,t=C);else{if(!(void 0!==a&&0>V(a,I)))break g;g[t]=a,g[o]=I,t=o}}}return e}return null}function V(g,e){var I=g.sortIndex-e.sortIndex;return 0!==I?I:g.id-e.id}var W=[],S=[],f=1,k=null,R=3,X=!1,J=!1,Y=!1;function H(g){for(var e=B(S);null!==e;){if(null===e.callback)v(S);else{if(!(e.startTime<=g))break;v(S),e.sortIndex=e.expirationTime,y(W,e)}e=B(S)}}function w(g){if(Y=!1,H(g),!J)if(null!==B(W))J=!0,I(N);else{var e=B(S);null!==e&&t(w,e.startTime-g)}}function N(g,I){J=!1,Y&&(Y=!1,n()),X=!0;var C=R;try{for(H(I),k=B(W);null!==k&&(!(k.expirationTime>I)||g&&!e.unstable_shouldYield());){var l=k.callback;if("function"===typeof l){k.callback=null,R=k.priorityLevel;var o=l(k.expirationTime<=I);I=e.unstable_now(),"function"===typeof o?k.callback=o:k===B(W)&&v(W),H(I)}else v(W);k=B(W)}if(null!==k)var a=!0;else{var i=B(S);null!==i&&t(w,i.startTime-I),a=!1}return a}finally{k=null,R=C,X=!1}}var K=C;e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(g){g.callback=null},e.unstable_continueExecution=function(){J||X||(J=!0,I(N))},e.unstable_getCurrentPriorityLevel=function(){return R},e.unstable_getFirstCallbackNode=function(){return B(W)},e.unstable_next=function(g){switch(R){case 1:case 2:case 3:var e=3;break;default:e=R}var I=R;R=e;try{return g()}finally{R=I}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=K,e.unstable_runWithPriority=function(g,e){switch(g){case 1:case 2:case 3:case 4:case 5:break;default:g=3}var I=R;R=g;try{return e()}finally{R=I}},e.unstable_scheduleCallback=function(g,C,l){var o=e.unstable_now();switch("object"===typeof l&&null!==l?l="number"===typeof(l=l.delay)&&0<l?o+l:o:l=o,g){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return g={id:f++,callback:C,priorityLevel:g,startTime:l,expirationTime:a=l+a,sortIndex:-1},l>o?(g.sortIndex=l,y(S,g),null===B(W)&&g===B(S)&&(Y?n():Y=!0,t(w,l-o))):(g.sortIndex=a,y(W,g),J||X||(J=!0,I(N))),g},e.unstable_wrapCallback=function(g){var e=R;return function(){var I=R;R=e;try{return g.apply(this,arguments)}finally{R=I}}}},5296:function(g,e,I){"use strict";g.exports=I(6813)},907:function(g,e,I){"use strict";function t(g,e){(null==e||e>g.length)&&(e=g.length);for(var I=0,t=new Array(e);I<e;I++)t[I]=g[I];return t}I.d(e,{Z:function(){return t}})},3878:function(g,e,I){"use strict";function t(g){if(Array.isArray(g))return g}I.d(e,{Z:function(){return t}})},4942:function(g,e,I){"use strict";function t(g,e,I){return e in g?Object.defineProperty(g,e,{value:I,enumerable:!0,configurable:!0,writable:!0}):g[e]=I,g}I.d(e,{Z:function(){return t}})},7462:function(g,e,I){"use strict";function t(){return t=Object.assign||function(g){for(var e=1;e<arguments.length;e++){var I=arguments[e];for(var t in I)Object.prototype.hasOwnProperty.call(I,t)&&(g[t]=I[t])}return g},t.apply(this,arguments)}I.d(e,{Z:function(){return t}})},9199:function(g,e,I){"use strict";function t(g){if("undefined"!==typeof Symbol&&null!=g[Symbol.iterator]||null!=g["@@iterator"])return Array.from(g)}I.d(e,{Z:function(){return t}})},5267:function(g,e,I){"use strict";function t(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}I.d(e,{Z:function(){return t}})},3366:function(g,e,I){"use strict";function t(g,e){if(null==g)return{};var I,t,n={},C=Object.keys(g);for(t=0;t<C.length;t++)I=C[t],e.indexOf(I)>=0||(n[I]=g[I]);return n}I.d(e,{Z:function(){return t}})},9439:function(g,e,I){"use strict";I.d(e,{Z:function(){return l}});var t=I(3878);var n=I(181),C=I(5267);function l(g,e){return(0,t.Z)(g)||function(g,e){var I=null==g?null:"undefined"!==typeof Symbol&&g[Symbol.iterator]||g["@@iterator"];if(null!=I){var t,n,C=[],l=!0,o=!1;try{for(I=I.call(g);!(l=(t=I.next()).done)&&(C.push(t.value),!e||C.length!==e);l=!0);}catch(a){o=!0,n=a}finally{try{l||null==I.return||I.return()}finally{if(o)throw n}}return C}}(g,e)||(0,n.Z)(g,e)||(0,C.Z)()}},3433:function(g,e,I){"use strict";I.d(e,{Z:function(){return l}});var t=I(907);var n=I(9199),C=I(181);function l(g){return function(g){if(Array.isArray(g))return(0,t.Z)(g)}(g)||(0,n.Z)(g)||(0,C.Z)(g)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},181:function(g,e,I){"use strict";I.d(e,{Z:function(){return n}});var t=I(907);function n(g,e){if(g){if("string"===typeof g)return(0,t.Z)(g,e);var I=Object.prototype.toString.call(g).slice(8,-1);return"Object"===I&&g.constructor&&(I=g.constructor.name),"Map"===I||"Set"===I?Array.from(g):"Arguments"===I||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(I)?(0,t.Z)(g,e):void 0}}}},e={};function I(t){var n=e[t];if(void 0!==n)return n.exports;var C=e[t]={exports:{}};return g[t].call(C.exports,C,C.exports,I),C.exports}I.n=function(g){var e=g&&g.__esModule?function(){return g.default}:function(){return g};return I.d(e,{a:e}),e},I.d=function(g,e){for(var t in e)I.o(e,t)&&!I.o(g,t)&&Object.defineProperty(g,t,{enumerable:!0,get:e[t]})},I.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(g){if("object"===typeof window)return window}}(),I.o=function(g,e){return Object.prototype.hasOwnProperty.call(g,e)},I.r=function(g){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(g,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(g,"__esModule",{value:!0})},function(){"use strict";var g,e=I(4164),t=I(2791),n=I(9439),C=I(7462),l=g||(g={});l.Pop="POP",l.Push="PUSH",l.Replace="REPLACE";var o=function(g){return g};function a(g){g.preventDefault(),g.returnValue=""}function i(){var g=[];return{get length(){return g.length},push:function(e){return g.push(e),function(){g=g.filter((function(g){return g!==e}))}},call:function(e){g.forEach((function(g){return g&&g(e)}))}}}function r(){return Math.random().toString(36).substr(2,8)}function c(g){var e=g.pathname;e=void 0===e?"/":e;var I=g.search;return I=void 0===I?"":I,g=void 0===(g=g.hash)?"":g,I&&"?"!==I&&(e+="?"===I.charAt(0)?I:"?"+I),g&&"#"!==g&&(e+="#"===g.charAt(0)?g:"#"+g),e}function A(g){var e={};if(g){var I=g.indexOf("#");0<=I&&(e.hash=g.substr(I),g=g.substr(0,I)),0<=(I=g.indexOf("?"))&&(e.search=g.substr(I),g=g.substr(0,I)),g&&(e.pathname=g)}return e}function u(g,e){if(!g)throw new Error(e)}var s=(0,t.createContext)(null);var d=(0,t.createContext)(null);var Z=(0,t.createContext)({outlet:null,matches:[]});function b(g){var e=g.to,I=g.replace,n=g.state;B()||u(!1);var C=V();return(0,t.useEffect)((function(){C(e,{replace:I,state:n})})),null}function m(g){return function(g){var e=(0,t.useContext)(Z).outlet;if(e)return(0,t.createElement)(W.Provider,{value:g},e);return e}(g.context)}function h(g){u(!1)}function G(e){var I=e.basename,n=void 0===I?"/":I,C=e.children,l=void 0===C?null:C,o=e.location,a=e.navigationType,i=void 0===a?g.Pop:a,r=e.navigator,c=e.static,Z=void 0!==c&&c;B()&&u(!1);var b=E(n),m=(0,t.useMemo)((function(){return{basename:b,navigator:r,static:Z}}),[b,r,Z]);"string"===typeof o&&(o=A(o));var h=o,G=h.pathname,p=void 0===G?"/":G,y=h.search,v=void 0===y?"":y,V=h.hash,W=void 0===V?"":V,S=h.state,f=void 0===S?null:S,k=h.key,R=void 0===k?"default":k,X=(0,t.useMemo)((function(){var g=K(p,b);return null==g?null:{pathname:g,search:v,hash:W,state:f,key:R}}),[b,p,v,W,f,R]);return null==X?null:(0,t.createElement)(s.Provider,{value:m},(0,t.createElement)(d.Provider,{children:l,value:{location:X,navigationType:i}}))}function p(g){var e=g.children,I=g.location;return function(g,e){B()||u(!1);var I=(0,t.useContext)(Z).matches,n=I[I.length-1],C=n?n.params:{},l=(n&&n.pathname,n?n.pathnameBase:"/");n&&n.route;0;var o,a=v();if(e){var i,r="string"===typeof e?A(e):e;"/"===l||(null==(i=r.pathname)?void 0:i.startsWith(l))||u(!1),o=r}else o=a;var c=o.pathname||"/",s="/"===l?c:c.slice(l.length)||"/",d=function(g,e,I){void 0===I&&(I="/");var t=K(("string"===typeof e?A(e):e).pathname||"/",I);if(null==t)return null;var n=k(g);!function(g){g.sort((function(g,e){return g.score!==e.score?e.score-g.score:function(g,e){var I=g.length===e.length&&g.slice(0,-1).every((function(g,I){return g===e[I]}));return I?g[g.length-1]-e[e.length-1]:0}(g.routesMeta.map((function(g){return g.childrenIndex})),e.routesMeta.map((function(g){return g.childrenIndex})))}))}(n);for(var C=null,l=0;null==C&&l<n.length;++l)C=Y(n[l],t);return C}(g,{pathname:s});0;return H(d&&d.map((function(g){return Object.assign({},g,{params:Object.assign({},C,g.params),pathname:F([l,g.pathname]),pathnameBase:"/"===g.pathnameBase?l:F([l,g.pathnameBase])})})),I)}(f(e),I)}function y(g){B()||u(!1);var e=(0,t.useContext)(s),I=e.basename,n=e.navigator,C=S(g),l=C.hash,o=C.pathname,a=C.search,i=o;if("/"!==I){var r=function(g){return""===g||""===g.pathname?"/":"string"===typeof g?A(g).pathname:g.pathname}(g),c=null!=r&&r.endsWith("/");i="/"===o?I+(c?"/":""):F([I,o])}return n.createHref({pathname:i,search:a,hash:l})}function B(){return null!=(0,t.useContext)(d)}function v(){return B()||u(!1),(0,t.useContext)(d).location}function V(){B()||u(!1);var g=(0,t.useContext)(s),e=g.basename,I=g.navigator,n=(0,t.useContext)(Z).matches,C=v().pathname,l=JSON.stringify(n.map((function(g){return g.pathnameBase}))),o=(0,t.useRef)(!1);(0,t.useEffect)((function(){o.current=!0}));var a=(0,t.useCallback)((function(g,t){if(void 0===t&&(t={}),o.current)if("number"!==typeof g){var n=N(g,JSON.parse(l),C);"/"!==e&&(n.pathname=F([e,n.pathname])),(t.replace?I.replace:I.push)(n,t.state)}else I.go(g)}),[e,I,l,C]);return a}var W=(0,t.createContext)(null);function S(g){var e=(0,t.useContext)(Z).matches,I=v().pathname,n=JSON.stringify(e.map((function(g){return g.pathnameBase})));return(0,t.useMemo)((function(){return N(g,JSON.parse(n),I)}),[g,n,I])}function f(g){var e=[];return t.Children.forEach(g,(function(g){if((0,t.isValidElement)(g))if(g.type!==t.Fragment){g.type!==h&&u(!1);var I={caseSensitive:g.props.caseSensitive,element:g.props.element,index:g.props.index,path:g.props.path};g.props.children&&(I.children=f(g.props.children)),e.push(I)}else e.push.apply(e,f(g.props.children))})),e}function k(g,e,I,t){return void 0===e&&(e=[]),void 0===I&&(I=[]),void 0===t&&(t=""),g.forEach((function(g,n){var C={relativePath:g.path||"",caseSensitive:!0===g.caseSensitive,childrenIndex:n,route:g};C.relativePath.startsWith("/")&&(C.relativePath.startsWith(t)||u(!1),C.relativePath=C.relativePath.slice(t.length));var l=F([t,C.relativePath]),o=I.concat(C);g.children&&g.children.length>0&&(!0===g.index&&u(!1),k(g.children,e,o,l)),(null!=g.path||g.index)&&e.push({path:l,score:J(l,g.index),routesMeta:o})})),e}var R=/^:\w+$/,X=function(g){return"*"===g};function J(g,e){var I=g.split("/"),t=I.length;return I.some(X)&&(t+=-2),e&&(t+=2),I.filter((function(g){return!X(g)})).reduce((function(g,e){return g+(R.test(e)?3:""===e?1:10)}),t)}function Y(g,e){for(var I=g.routesMeta,t={},n="/",C=[],l=0;l<I.length;++l){var o=I[l],a=l===I.length-1,i="/"===n?e:e.slice(n.length)||"/",r=w({path:o.relativePath,caseSensitive:o.caseSensitive,end:a},i);if(!r)return null;Object.assign(t,r.params);var c=o.route;C.push({params:t,pathname:F([n,r.pathname]),pathnameBase:F([n,r.pathnameBase]),route:c}),"/"!==r.pathnameBase&&(n=F([n,r.pathnameBase]))}return C}function H(g,e){return void 0===e&&(e=[]),null==g?null:g.reduceRight((function(I,n,C){return(0,t.createElement)(Z.Provider,{children:void 0!==n.route.element?n.route.element:(0,t.createElement)(m,null),value:{outlet:I,matches:e.concat(g.slice(0,C+1))}})}),null)}function w(g,e){"string"===typeof g&&(g={path:g,caseSensitive:!1,end:!0});var I=function(g,e,I){void 0===e&&(e=!1);void 0===I&&(I=!0);var t=[],n="^"+g.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/:(\w+)/g,(function(g,e){return t.push(e),"([^\\/]+)"}));g.endsWith("*")?(t.push("*"),n+="*"===g||"/*"===g?"(.*)$":"(?:\\/(.+)|\\/*)$"):n+=I?"\\/*$":"(?:\\b|\\/|$)";return[new RegExp(n,e?void 0:"i"),t]}(g.path,g.caseSensitive,g.end),t=(0,n.Z)(I,2),C=t[0],l=t[1],o=e.match(C);if(!o)return null;var a=o[0],i=a.replace(/(.)\/+$/,"$1"),r=o.slice(1);return{params:l.reduce((function(g,e,I){if("*"===e){var t=r[I]||"";i=a.slice(0,a.length-t.length).replace(/(.)\/+$/,"$1")}return g[e]=function(g,e){try{return decodeURIComponent(g)}catch(I){return g}}(r[I]||""),g}),{}),pathname:a,pathnameBase:i,pattern:g}}function N(g,e,I){var t,n="string"===typeof g?A(g):g,C=""===g||""===n.pathname?"/":n.pathname;if(null==C)t=I;else{var l=e.length-1;if(C.startsWith("..")){for(var o=C.split("/");".."===o[0];)o.shift(),l-=1;n.pathname=o.join("/")}t=l>=0?e[l]:"/"}var a=function(g,e){void 0===e&&(e="/");var I="string"===typeof g?A(g):g,t=I.pathname,n=I.search,C=void 0===n?"":n,l=I.hash,o=void 0===l?"":l,a=t?t.startsWith("/")?t:function(g,e){var I=e.replace(/\/+$/,"").split("/");return g.split("/").forEach((function(g){".."===g?I.length>1&&I.pop():"."!==g&&I.push(g)})),I.length>1?I.join("/"):"/"}(t,e):e;return{pathname:a,search:x(C),hash:z(o)}}(n,t);return C&&"/"!==C&&C.endsWith("/")&&!a.pathname.endsWith("/")&&(a.pathname+="/"),a}function K(g,e){if("/"===e)return g;if(!g.toLowerCase().startsWith(e.toLowerCase()))return null;var I=g.charAt(e.length);return I&&"/"!==I?null:g.slice(e.length)||"/"}var F=function(g){return g.join("/").replace(/\/\/+/g,"/")},E=function(g){return g.replace(/\/+$/,"").replace(/^\/*/,"/")},x=function(g){return g&&"?"!==g?g.startsWith("?")?g:"?"+g:""},z=function(g){return g&&"#"!==g?g.startsWith("#")?g:"#"+g:""},U=I(3366),M=I(8182),L=I(3433),T=I(2466),Q=I(6001),D=["sx"];function j(g){var e,I=g.sx,t=function(g){var e={systemProps:{},otherProps:{}};return Object.keys(g).forEach((function(I){Q.G[I]?e.systemProps[I]=g[I]:e.otherProps[I]=g[I]})),e}((0,U.Z)(g,D)),n=t.systemProps,l=t.otherProps;return e=Array.isArray(I)?[n].concat((0,L.Z)(I)):"function"===typeof I?function(){var g=I.apply(void 0,arguments);return(0,T.P)(g)?(0,C.Z)({},n,g):n}:(0,C.Z)({},n,I),(0,C.Z)({},l,{sx:e})}var P=I(767),O=I(7630),_=I(1046),q=I(4036),$=I(5159),gg=I(208);function eg(g){return(0,$.Z)("MuiTypography",g)}(0,gg.Z)("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);var Ig=I(184),tg=["align","className","component","gutterBottom","noWrap","paragraph","variant","variantMapping"],ng=(0,O.ZP)("span",{name:"MuiTypography",slot:"Root",overridesResolver:function(g,e){var I=g.ownerState;return[e.root,I.variant&&e[I.variant],"inherit"!==I.align&&e["align".concat((0,q.Z)(I.align))],I.noWrap&&e.noWrap,I.gutterBottom&&e.gutterBottom,I.paragraph&&e.paragraph]}})((function(g){var e=g.theme,I=g.ownerState;return(0,C.Z)({margin:0},I.variant&&e.typography[I.variant],"inherit"!==I.align&&{textAlign:I.align},I.noWrap&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},I.gutterBottom&&{marginBottom:"0.35em"},I.paragraph&&{marginBottom:16})})),Cg={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},lg={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},og=t.forwardRef((function(g,e){var I=(0,_.Z)({props:g,name:"MuiTypography"}),t=function(g){return lg[g]||g}(I.color),n=j((0,C.Z)({},I,{color:t})),l=n.align,o=void 0===l?"inherit":l,a=n.className,i=n.component,r=n.gutterBottom,c=void 0!==r&&r,A=n.noWrap,u=void 0!==A&&A,s=n.paragraph,d=void 0!==s&&s,Z=n.variant,b=void 0===Z?"body1":Z,m=n.variantMapping,h=void 0===m?Cg:m,G=(0,U.Z)(n,tg),p=(0,C.Z)({},n,{align:o,color:t,className:a,component:i,gutterBottom:c,noWrap:u,paragraph:d,variant:b,variantMapping:h}),y=i||(d?"p":h[b]||Cg[b])||"span",B=function(g){var e=g.align,I=g.gutterBottom,t=g.noWrap,n=g.paragraph,C=g.variant,l=g.classes,o={root:["root",C,"inherit"!==g.align&&"align".concat((0,q.Z)(e)),I&&"gutterBottom",t&&"noWrap",n&&"paragraph"]};return(0,P.Z)(o,eg,l)}(p);return(0,Ig.jsx)(ng,(0,C.Z)({as:y,ref:e,ownerState:p,className:(0,M.Z)(B.root,a)},G))})),ag=og,ig=["getTrigger","target"];function rg(g,e){var I=e.disableHysteresis,t=void 0!==I&&I,n=e.threshold,C=void 0===n?100:n,l=e.target,o=g.current;return l&&(g.current=void 0!==l.pageYOffset?l.pageYOffset:l.scrollTop),!(!t&&void 0!==o&&g.current<o)&&g.current>C}var cg="undefined"!==typeof window?window:null;var Ag=I(2065);function ug(g){return(0,$.Z)("MuiPaper",g)}(0,gg.Z)("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);var sg=["className","component","elevation","square","variant"],dg=function(g){return((g<1?5.11916*Math.pow(g,2):4.5*Math.log(g+1)+2)/100).toFixed(2)},Zg=(0,O.ZP)("div",{name:"MuiPaper",slot:"Root",overridesResolver:function(g,e){var I=g.ownerState;return[e.root,e[I.variant],!I.square&&e.rounded,"elevation"===I.variant&&e["elevation".concat(I.elevation)]]}})((function(g){var e=g.theme,I=g.ownerState;return(0,C.Z)({backgroundColor:e.palette.background.paper,color:e.palette.text.primary,transition:e.transitions.create("box-shadow")},!I.square&&{borderRadius:e.shape.borderRadius},"outlined"===I.variant&&{border:"1px solid ".concat(e.palette.divider)},"elevation"===I.variant&&(0,C.Z)({boxShadow:e.shadows[I.elevation]},"dark"===e.palette.mode&&{backgroundImage:"linear-gradient(".concat((0,Ag.Fq)("#fff",dg(I.elevation)),", ").concat((0,Ag.Fq)("#fff",dg(I.elevation)),")")}))})),bg=t.forwardRef((function(g,e){var I=(0,_.Z)({props:g,name:"MuiPaper"}),t=I.className,n=I.component,l=void 0===n?"div":n,o=I.elevation,a=void 0===o?1:o,i=I.square,r=void 0!==i&&i,c=I.variant,A=void 0===c?"elevation":c,u=(0,U.Z)(I,sg),s=(0,C.Z)({},I,{component:l,elevation:a,square:r,variant:A}),d=function(g){var e=g.square,I=g.elevation,t=g.variant,n=g.classes,C={root:["root",t,!e&&"rounded","elevation"===t&&"elevation".concat(I)]};return(0,P.Z)(C,ug,n)}(s);return(0,Ig.jsx)(Zg,(0,C.Z)({as:l,ownerState:s,className:(0,M.Z)(d.root,t),ref:e},u))})),mg=bg;function hg(g){return(0,$.Z)("MuiAppBar",g)}(0,gg.Z)("MuiAppBar",["root","positionFixed","positionAbsolute","positionSticky","positionStatic","positionRelative","colorDefault","colorPrimary","colorSecondary","colorInherit","colorTransparent"]);var Gg=["className","color","enableColorOnDark","position"],pg=(0,O.ZP)(mg,{name:"MuiAppBar",slot:"Root",overridesResolver:function(g,e){var I=g.ownerState;return[e.root,e["position".concat((0,q.Z)(I.position))],e["color".concat((0,q.Z)(I.color))]]}})((function(g){var e=g.theme,I=g.ownerState,t="light"===e.palette.mode?e.palette.grey[100]:e.palette.grey[900];return(0,C.Z)({display:"flex",flexDirection:"column",width:"100%",boxSizing:"border-box",flexShrink:0},"fixed"===I.position&&{position:"fixed",zIndex:e.zIndex.appBar,top:0,left:"auto",right:0,"@media print":{position:"absolute"}},"absolute"===I.position&&{position:"absolute",zIndex:e.zIndex.appBar,top:0,left:"auto",right:0},"sticky"===I.position&&{position:"sticky",zIndex:e.zIndex.appBar,top:0,left:"auto",right:0},"static"===I.position&&{position:"static"},"relative"===I.position&&{position:"relative"},"default"===I.color&&{backgroundColor:t,color:e.palette.getContrastText(t)},I.color&&"default"!==I.color&&"inherit"!==I.color&&"transparent"!==I.color&&{backgroundColor:e.palette[I.color].main,color:e.palette[I.color].contrastText},"inherit"===I.color&&{color:"inherit"},"dark"===e.palette.mode&&!I.enableColorOnDark&&{backgroundColor:null,color:null},"transparent"===I.color&&(0,C.Z)({backgroundColor:"transparent",color:"inherit"},"dark"===e.palette.mode&&{backgroundImage:"none"}))})),yg=t.forwardRef((function(g,e){var I=(0,_.Z)({props:g,name:"MuiAppBar"}),t=I.className,n=I.color,l=void 0===n?"primary":n,o=I.enableColorOnDark,a=void 0!==o&&o,i=I.position,r=void 0===i?"fixed":i,c=(0,U.Z)(I,Gg),A=(0,C.Z)({},I,{color:l,position:r,enableColorOnDark:a}),u=function(g){var e=g.color,I=g.position,t=g.classes,n={root:["root","color".concat((0,q.Z)(e)),"position".concat((0,q.Z)(I))]};return(0,P.Z)(n,hg,t)}(A);return(0,Ig.jsx)(pg,(0,C.Z)({square:!0,component:"header",ownerState:A,elevation:4,className:(0,M.Z)(u.root,t,"fixed"===r&&"mui-fixed"),ref:e},c))})),Bg=yg,vg=I(4942);function Vg(g){return(0,$.Z)("MuiToolbar",g)}(0,gg.Z)("MuiToolbar",["root","gutters","regular","dense"]);var Wg=["className","component","disableGutters","variant"],Sg=(0,O.ZP)("div",{name:"MuiToolbar",slot:"Root",overridesResolver:function(g,e){var I=g.ownerState;return[e.root,!I.disableGutters&&e.gutters,e[I.variant]]}})((function(g){var e=g.theme,I=g.ownerState;return(0,C.Z)({position:"relative",display:"flex",alignItems:"center"},!I.disableGutters&&(0,vg.Z)({paddingLeft:e.spacing(2),paddingRight:e.spacing(2)},e.breakpoints.up("sm"),{paddingLeft:e.spacing(3),paddingRight:e.spacing(3)}),"dense"===I.variant&&{minHeight:48})}),(function(g){var e=g.theme;return"regular"===g.ownerState.variant&&e.mixins.toolbar})),fg=t.forwardRef((function(g,e){var I=(0,_.Z)({props:g,name:"MuiToolbar"}),t=I.className,n=I.component,l=void 0===n?"div":n,o=I.disableGutters,a=void 0!==o&&o,i=I.variant,r=void 0===i?"regular":i,c=(0,U.Z)(I,Wg),A=(0,C.Z)({},I,{component:l,disableGutters:a,variant:r}),u=function(g){var e=g.classes,I={root:["root",!g.disableGutters&&"gutters",g.variant]};return(0,P.Z)(I,Vg,e)}(A);return(0,Ig.jsx)(Sg,(0,C.Z)({as:l,className:(0,M.Z)(u.root,t),ref:e,ownerState:A},c))})),kg=fg,Rg=I(4843),Xg=I(6868),Jg=I(3031);function Yg(g,e){return e||(e=g.slice(0)),Object.freeze(Object.defineProperties(g,{raw:{value:Object.freeze(e)}}))}function Hg(g){if(void 0===g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g}function wg(g,e){return wg=Object.setPrototypeOf||function(g,e){return g.__proto__=e,g},wg(g,e)}var Ng=t.createContext(null);function Kg(g,e){var I=Object.create(null);return g&&t.Children.map(g,(function(g){return g})).forEach((function(g){I[g.key]=function(g){return e&&(0,t.isValidElement)(g)?e(g):g}(g)})),I}function Fg(g,e,I){return null!=I[e]?I[e]:g.props[e]}function Eg(g,e,I){var n=Kg(g.children),C=function(g,e){function I(I){return I in e?e[I]:g[I]}g=g||{},e=e||{};var t,n=Object.create(null),C=[];for(var l in g)l in e?C.length&&(n[l]=C,C=[]):C.push(l);var o={};for(var a in e){if(n[a])for(t=0;t<n[a].length;t++){var i=n[a][t];o[n[a][t]]=I(i)}o[a]=I(a)}for(t=0;t<C.length;t++)o[C[t]]=I(C[t]);return o}(e,n);return Object.keys(C).forEach((function(l){var o=C[l];if((0,t.isValidElement)(o)){var a=l in e,i=l in n,r=e[l],c=(0,t.isValidElement)(r)&&!r.props.in;!i||a&&!c?i||!a||c?i&&a&&(0,t.isValidElement)(r)&&(C[l]=(0,t.cloneElement)(o,{onExited:I.bind(null,o),in:r.props.in,exit:Fg(o,"exit",g),enter:Fg(o,"enter",g)})):C[l]=(0,t.cloneElement)(o,{in:!1}):C[l]=(0,t.cloneElement)(o,{onExited:I.bind(null,o),in:!0,exit:Fg(o,"exit",g),enter:Fg(o,"enter",g)})}})),C}var xg=Object.values||function(g){return Object.keys(g).map((function(e){return g[e]}))},zg=function(g){var e,I;function n(e,I){var t,n=(t=g.call(this,e,I)||this).handleExited.bind(Hg(t));return t.state={contextValue:{isMounting:!0},handleExited:n,firstRender:!0},t}I=g,(e=n).prototype=Object.create(I.prototype),e.prototype.constructor=e,wg(e,I);var l=n.prototype;return l.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},l.componentWillUnmount=function(){this.mounted=!1},n.getDerivedStateFromProps=function(g,e){var I,n,C=e.children,l=e.handleExited;return{children:e.firstRender?(I=g,n=l,Kg(I.children,(function(g){return(0,t.cloneElement)(g,{onExited:n.bind(null,g),in:!0,appear:Fg(g,"appear",I),enter:Fg(g,"enter",I),exit:Fg(g,"exit",I)})}))):Eg(g,C,l),firstRender:!1}},l.handleExited=function(g,e){var I=Kg(this.props.children);g.key in I||(g.props.onExited&&g.props.onExited(e),this.mounted&&this.setState((function(e){var I=(0,C.Z)({},e.children);return delete I[g.key],{children:I}})))},l.render=function(){var g=this.props,e=g.component,I=g.childFactory,n=(0,U.Z)(g,["component","childFactory"]),C=this.state.contextValue,l=xg(this.state.children).map(I);return delete n.appear,delete n.enter,delete n.exit,null===e?t.createElement(Ng.Provider,{value:C},l):t.createElement(Ng.Provider,{value:C},t.createElement(e,n,l))},n}(t.Component);zg.propTypes={},zg.defaultProps={component:"div",childFactory:function(g){return g}};var Ug=zg,Mg=(I(8677),I(1672)),Lg=(I(2110),I(5438)),Tg=I(1346),Qg=I(6567),Dg=(0,Mg.w)((function(g,e){var I=g.styles,n=(0,Tg.O)([I],void 0,(0,t.useContext)(Mg.T)),C=(0,t.useRef)();return(0,t.useLayoutEffect)((function(){var g=e.key+"-global",I=new Qg.m({key:g,nonce:e.sheet.nonce,container:e.sheet.container,speedy:e.sheet.isSpeedy}),t=!1,l=document.querySelector('style[data-emotion="'+g+" "+n.name+'"]');return e.sheet.tags.length&&(I.before=e.sheet.tags[0]),null!==l&&(t=!0,l.setAttribute("data-emotion",g),I.hydrate([l])),C.current=[I,t],function(){I.flush()}}),[e]),(0,t.useLayoutEffect)((function(){var g=C.current,I=g[0];if(g[1])g[1]=!1;else{if(void 0!==n.next&&(0,Lg.M)(e,n.next,!0),I.tags.length){var t=I.tags[I.tags.length-1].nextElementSibling;I.before=t,I.flush()}e.insert("",n,I,!1)}}),[e,n.name]),null}));function jg(){for(var g=arguments.length,e=new Array(g),I=0;I<g;I++)e[I]=arguments[I];return(0,Tg.O)(e)}var Pg=function(){var g=jg.apply(void 0,arguments),e="animation-"+g.name;return{name:e,styles:"@keyframes "+e+"{"+g.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}};var Og=function(g){var e=g.className,I=g.classes,C=g.pulsate,l=void 0!==C&&C,o=g.rippleX,a=g.rippleY,i=g.rippleSize,r=g.in,c=g.onExited,A=g.timeout,u=t.useState(!1),s=(0,n.Z)(u,2),d=s[0],Z=s[1],b=(0,M.Z)(e,I.ripple,I.rippleVisible,l&&I.ripplePulsate),m={width:i,height:i,top:-i/2+a,left:-i/2+o},h=(0,M.Z)(I.child,d&&I.childLeaving,l&&I.childPulsate);return r||d||Z(!0),t.useEffect((function(){if(!r&&null!=c){var g=setTimeout(c,A);return function(){clearTimeout(g)}}}),[c,r,A]),(0,Ig.jsx)("span",{className:b,style:m,children:(0,Ig.jsx)("span",{className:h})})};var _g,qg,$g,ge,ee,Ie,te,ne,Ce=(0,gg.Z)("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),le=["center","classes","className"],oe=Pg(ee||(ee=_g||(_g=Yg(["\n  0% {\n    transform: scale(0);\n    opacity: 0.1;\n  }\n\n  100% {\n    transform: scale(1);\n    opacity: 0.3;\n  }\n"])))),ae=Pg(Ie||(Ie=qg||(qg=Yg(["\n  0% {\n    opacity: 1;\n  }\n\n  100% {\n    opacity: 0;\n  }\n"])))),ie=Pg(te||(te=$g||($g=Yg(["\n  0% {\n    transform: scale(1);\n  }\n\n  50% {\n    transform: scale(0.92);\n  }\n\n  100% {\n    transform: scale(1);\n  }\n"])))),re=(0,O.ZP)("span",{name:"MuiTouchRipple",slot:"Root",skipSx:!0})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),ce=(0,O.ZP)(Og,{name:"MuiTouchRipple",slot:"Ripple"})(ne||(ne=ge||(ge=Yg(["\n  opacity: 0;\n  position: absolute;\n\n  &."," {\n    opacity: 0.3;\n    transform: scale(1);\n    animation-name: ",";\n    animation-duration: ","ms;\n    animation-timing-function: ",";\n  }\n\n  &."," {\n    animation-duration: ","ms;\n  }\n\n  & ."," {\n    opacity: 1;\n    display: block;\n    width: 100%;\n    height: 100%;\n    border-radius: 50%;\n    background-color: currentColor;\n  }\n\n  & ."," {\n    opacity: 0;\n    animation-name: ",";\n    animation-duration: ","ms;\n    animation-timing-function: ",";\n  }\n\n  & ."," {\n    position: absolute;\n    /* @noflip */\n    left: 0px;\n    top: 0;\n    animation-name: ",";\n    animation-duration: 2500ms;\n    animation-timing-function: ",";\n    animation-iteration-count: infinite;\n    animation-delay: 200ms;\n  }\n"]))),Ce.rippleVisible,oe,550,(function(g){return g.theme.transitions.easing.easeInOut}),Ce.ripplePulsate,(function(g){return g.theme.transitions.duration.shorter}),Ce.child,Ce.childLeaving,ae,550,(function(g){return g.theme.transitions.easing.easeInOut}),Ce.childPulsate,ie,(function(g){return g.theme.transitions.easing.easeInOut})),Ae=t.forwardRef((function(g,e){var I=(0,_.Z)({props:g,name:"MuiTouchRipple"}),l=I.center,o=void 0!==l&&l,a=I.classes,i=void 0===a?{}:a,r=I.className,c=(0,U.Z)(I,le),A=t.useState([]),u=(0,n.Z)(A,2),s=u[0],d=u[1],Z=t.useRef(0),b=t.useRef(null);t.useEffect((function(){b.current&&(b.current(),b.current=null)}),[s]);var m=t.useRef(!1),h=t.useRef(null),G=t.useRef(null),p=t.useRef(null);t.useEffect((function(){return function(){clearTimeout(h.current)}}),[]);var y=t.useCallback((function(g){var e=g.pulsate,I=g.rippleX,t=g.rippleY,n=g.rippleSize,C=g.cb;d((function(g){return[].concat((0,L.Z)(g),[(0,Ig.jsx)(ce,{classes:{ripple:(0,M.Z)(i.ripple,Ce.ripple),rippleVisible:(0,M.Z)(i.rippleVisible,Ce.rippleVisible),ripplePulsate:(0,M.Z)(i.ripplePulsate,Ce.ripplePulsate),child:(0,M.Z)(i.child,Ce.child),childLeaving:(0,M.Z)(i.childLeaving,Ce.childLeaving),childPulsate:(0,M.Z)(i.childPulsate,Ce.childPulsate)},timeout:550,pulsate:e,rippleX:I,rippleY:t,rippleSize:n},Z.current)])})),Z.current+=1,b.current=C}),[i]),B=t.useCallback((function(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},I=arguments.length>2?arguments[2]:void 0,t=e.pulsate,n=void 0!==t&&t,C=e.center,l=void 0===C?o||e.pulsate:C,a=e.fakeElement,i=void 0!==a&&a;if("mousedown"===g.type&&m.current)m.current=!1;else{"touchstart"===g.type&&(m.current=!0);var r,c,A,u=i?null:p.current,s=u?u.getBoundingClientRect():{width:0,height:0,left:0,top:0};if(l||0===g.clientX&&0===g.clientY||!g.clientX&&!g.touches)r=Math.round(s.width/2),c=Math.round(s.height/2);else{var d=g.touches?g.touches[0]:g,Z=d.clientX,b=d.clientY;r=Math.round(Z-s.left),c=Math.round(b-s.top)}if(l)(A=Math.sqrt((2*Math.pow(s.width,2)+Math.pow(s.height,2))/3))%2===0&&(A+=1);else{var B=2*Math.max(Math.abs((u?u.clientWidth:0)-r),r)+2,v=2*Math.max(Math.abs((u?u.clientHeight:0)-c),c)+2;A=Math.sqrt(Math.pow(B,2)+Math.pow(v,2))}g.touches?null===G.current&&(G.current=function(){y({pulsate:n,rippleX:r,rippleY:c,rippleSize:A,cb:I})},h.current=setTimeout((function(){G.current&&(G.current(),G.current=null)}),80)):y({pulsate:n,rippleX:r,rippleY:c,rippleSize:A,cb:I})}}),[o,y]),v=t.useCallback((function(){B({},{pulsate:!0})}),[B]),V=t.useCallback((function(g,e){if(clearTimeout(h.current),"touchend"===g.type&&G.current)return G.current(),G.current=null,void(h.current=setTimeout((function(){V(g,e)})));G.current=null,d((function(g){return g.length>0?g.slice(1):g})),b.current=e}),[]);return t.useImperativeHandle(e,(function(){return{pulsate:v,start:B,stop:V}}),[v,B,V]),(0,Ig.jsx)(re,(0,C.Z)({className:(0,M.Z)(i.root,Ce.root,r),ref:p},c,{children:(0,Ig.jsx)(Ug,{component:null,exit:!0,children:s})}))})),ue=Ae;function se(g){return(0,$.Z)("MuiButtonBase",g)}var de,Ze=(0,gg.Z)("MuiButtonBase",["root","disabled","focusVisible"]),be=["action","centerRipple","children","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","LinkComponent","onBlur","onClick","onContextMenu","onDragLeave","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","tabIndex","TouchRippleProps","type"],me=(0,O.ZP)("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:function(g,e){return e.root}})((de={display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"}},(0,vg.Z)(de,"&.".concat(Ze.disabled),{pointerEvents:"none",cursor:"default"}),(0,vg.Z)(de,"@media print",{colorAdjust:"exact"}),de)),he=t.forwardRef((function(g,e){var I=(0,_.Z)({props:g,name:"MuiButtonBase"}),l=I.action,o=I.centerRipple,a=void 0!==o&&o,i=I.children,r=I.className,c=I.component,A=void 0===c?"button":c,u=I.disabled,s=void 0!==u&&u,d=I.disableRipple,Z=void 0!==d&&d,b=I.disableTouchRipple,m=void 0!==b&&b,h=I.focusRipple,G=void 0!==h&&h,p=I.LinkComponent,y=void 0===p?"a":p,B=I.onBlur,v=I.onClick,V=I.onContextMenu,W=I.onDragLeave,S=I.onFocus,f=I.onFocusVisible,k=I.onKeyDown,R=I.onKeyUp,X=I.onMouseDown,J=I.onMouseLeave,Y=I.onMouseUp,H=I.onTouchEnd,w=I.onTouchMove,N=I.onTouchStart,K=I.tabIndex,F=void 0===K?0:K,E=I.TouchRippleProps,x=I.type,z=(0,U.Z)(I,be),L=t.useRef(null),T=t.useRef(null),Q=(0,Jg.Z)(),D=Q.isFocusVisibleRef,j=Q.onFocus,O=Q.onBlur,q=Q.ref,$=t.useState(!1),gg=(0,n.Z)($,2),eg=gg[0],tg=gg[1];function ng(g,e){var I=arguments.length>2&&void 0!==arguments[2]?arguments[2]:m;return(0,Xg.Z)((function(t){return e&&e(t),!I&&T.current&&T.current[g](t),!0}))}s&&eg&&tg(!1),t.useImperativeHandle(l,(function(){return{focusVisible:function(){tg(!0),L.current.focus()}}}),[]),t.useEffect((function(){eg&&G&&!Z&&T.current.pulsate()}),[Z,G,eg]);var Cg=ng("start",X),lg=ng("stop",V),og=ng("stop",W),ag=ng("stop",Y),ig=ng("stop",(function(g){eg&&g.preventDefault(),J&&J(g)})),rg=ng("start",N),cg=ng("stop",H),Ag=ng("stop",w),ug=ng("stop",(function(g){O(g),!1===D.current&&tg(!1),B&&B(g)}),!1),sg=(0,Xg.Z)((function(g){L.current||(L.current=g.currentTarget),j(g),!0===D.current&&(tg(!0),f&&f(g)),S&&S(g)})),dg=function(){var g=L.current;return A&&"button"!==A&&!("A"===g.tagName&&g.href)},Zg=t.useRef(!1),bg=(0,Xg.Z)((function(g){G&&!Zg.current&&eg&&T.current&&" "===g.key&&(Zg.current=!0,T.current.stop(g,(function(){T.current.start(g)}))),g.target===g.currentTarget&&dg()&&" "===g.key&&g.preventDefault(),k&&k(g),g.target===g.currentTarget&&dg()&&"Enter"===g.key&&!s&&(g.preventDefault(),v&&v(g))})),mg=(0,Xg.Z)((function(g){G&&" "===g.key&&T.current&&eg&&!g.defaultPrevented&&(Zg.current=!1,T.current.stop(g,(function(){T.current.pulsate(g)}))),R&&R(g),v&&g.target===g.currentTarget&&dg()&&" "===g.key&&!g.defaultPrevented&&v(g)})),hg=A;"button"===hg&&(z.href||z.to)&&(hg=y);var Gg={};"button"===hg?(Gg.type=void 0===x?"button":x,Gg.disabled=s):(z.href||z.to||(Gg.role="button"),s&&(Gg["aria-disabled"]=s));var pg=(0,Rg.Z)(q,L),yg=(0,Rg.Z)(e,pg),Bg=t.useState(!1),vg=(0,n.Z)(Bg,2),Vg=vg[0],Wg=vg[1];t.useEffect((function(){Wg(!0)}),[]);var Sg=Vg&&!Z&&!s;var fg=(0,C.Z)({},I,{centerRipple:a,component:A,disabled:s,disableRipple:Z,disableTouchRipple:m,focusRipple:G,tabIndex:F,focusVisible:eg}),kg=function(g){var e=g.disabled,I=g.focusVisible,t=g.focusVisibleClassName,n=g.classes,C={root:["root",e&&"disabled",I&&"focusVisible"]},l=(0,P.Z)(C,se,n);return I&&t&&(l.root+=" ".concat(t)),l}(fg);return(0,Ig.jsxs)(me,(0,C.Z)({as:hg,className:(0,M.Z)(kg.root,r),ownerState:fg,onBlur:ug,onClick:v,onContextMenu:lg,onFocus:sg,onKeyDown:bg,onKeyUp:mg,onMouseDown:Cg,onMouseLeave:ig,onMouseUp:ag,onDragLeave:og,onTouchEnd:cg,onTouchMove:Ag,onTouchStart:rg,ref:yg,tabIndex:s?-1:F,type:x},Gg,z,{children:[i,Sg?(0,Ig.jsx)(ue,(0,C.Z)({ref:T,center:a},E)):null]}))})),Ge=he;function pe(g){return(0,$.Z)("MuiIconButton",g)}var ye=(0,gg.Z)("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge"]),Be=["edge","children","className","color","disabled","disableFocusRipple","size"],ve=(0,O.ZP)(Ge,{name:"MuiIconButton",slot:"Root",overridesResolver:function(g,e){var I=g.ownerState;return[e.root,"default"!==I.color&&e["color".concat((0,q.Z)(I.color))],I.edge&&e["edge".concat((0,q.Z)(I.edge))],e["size".concat((0,q.Z)(I.size))]]}})((function(g){var e=g.theme,I=g.ownerState;return(0,C.Z)({textAlign:"center",flex:"0 0 auto",fontSize:e.typography.pxToRem(24),padding:8,borderRadius:"50%",overflow:"visible",color:e.palette.action.active,transition:e.transitions.create("background-color",{duration:e.transitions.duration.shortest})},!I.disableRipple&&{"&:hover":{backgroundColor:(0,Ag.Fq)(e.palette.action.active,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"start"===I.edge&&{marginLeft:"small"===I.size?-3:-12},"end"===I.edge&&{marginRight:"small"===I.size?-3:-12})}),(function(g){var e=g.theme,I=g.ownerState;return(0,C.Z)({},"inherit"===I.color&&{color:"inherit"},"inherit"!==I.color&&"default"!==I.color&&(0,C.Z)({color:e.palette[I.color].main},!I.disableRipple&&{"&:hover":{backgroundColor:(0,Ag.Fq)(e.palette[I.color].main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}}),"small"===I.size&&{padding:5,fontSize:e.typography.pxToRem(18)},"large"===I.size&&{padding:12,fontSize:e.typography.pxToRem(28)},(0,vg.Z)({},"&.".concat(ye.disabled),{backgroundColor:"transparent",color:e.palette.action.disabled}))})),Ve=t.forwardRef((function(g,e){var I=(0,_.Z)({props:g,name:"MuiIconButton"}),t=I.edge,n=void 0!==t&&t,l=I.children,o=I.className,a=I.color,i=void 0===a?"default":a,r=I.disabled,c=void 0!==r&&r,A=I.disableFocusRipple,u=void 0!==A&&A,s=I.size,d=void 0===s?"medium":s,Z=(0,U.Z)(I,Be),b=(0,C.Z)({},I,{edge:n,color:i,disabled:c,disableFocusRipple:u,size:d}),m=function(g){var e=g.classes,I=g.disabled,t=g.color,n=g.edge,C=g.size,l={root:["root",I&&"disabled","default"!==t&&"color".concat((0,q.Z)(t)),n&&"edge".concat((0,q.Z)(n)),"size".concat((0,q.Z)(C))]};return(0,P.Z)(l,pe,e)}(b);return(0,Ig.jsx)(ve,(0,C.Z)({className:(0,M.Z)(m.root,o),centerRipple:!0,focusRipple:!u,disabled:c,ref:e,ownerState:b},Z,{children:l}))})),We=Ve,Se=I(594),fe=I(104),ke=I(3459),Re=["className","component"];var Xe=I(7125),Je=I(5547),Ye=function(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=g.defaultTheme,I=g.defaultClassName,n=void 0===I?"MuiBox-root":I,l=g.generateClassName,o=(0,Se.ZP)("div")(fe.Z),a=t.forwardRef((function(g,I){var t=(0,ke.Z)(e),a=j(g),i=a.className,r=a.component,c=void 0===r?"div":r,A=(0,U.Z)(a,Re);return(0,Ig.jsx)(o,(0,C.Z)({as:c,ref:I,className:(0,M.Z)(i,l?l(n):n),theme:t},A))}));return a}({defaultTheme:(0,Je.Z)(),defaultClassName:"MuiBox-root",generateClassName:Xe.Z.generate}),He=Ye,we=I(7394);function Ne(){return Ne=Object.assign||function(g){for(var e=1;e<arguments.length;e++){var I=arguments[e];for(var t in I)Object.prototype.hasOwnProperty.call(I,t)&&(g[t]=I[t])}return g},Ne.apply(this,arguments)}function Ke(g,e){if(null==g)return{};var I,t,n={},C=Object.keys(g);for(t=0;t<C.length;t++)I=C[t],e.indexOf(I)>=0||(n[I]=g[I]);return n}var Fe=["onClick","reloadDocument","replace","state","target","to"];function Ee(e){var I=e.basename,l=e.children,u=e.window,s=(0,t.useRef)();null==s.current&&(s.current=function(e){function I(){var g=s.location,e=d.state||{};return[e.idx,o({pathname:g.pathname,search:g.search,hash:g.hash,state:e.usr||null,key:e.key||"default"})]}function t(g){return"string"===typeof g?g:c(g)}function n(g,e){return void 0===e&&(e=null),o((0,C.Z)({pathname:h.pathname,hash:"",search:""},"string"===typeof g?A(g):g,{state:e,key:r()}))}function l(g){b=g,g=I(),m=g[0],h=g[1],G.call({action:b,location:h})}function u(g){d.go(g)}void 0===e&&(e={});var s=void 0===(e=e.window)?document.defaultView:e,d=s.history,Z=null;s.addEventListener("popstate",(function(){if(Z)p.call(Z),Z=null;else{var e=g.Pop,t=I(),n=t[0];if(t=t[1],p.length){if(null!=n){var C=m-n;C&&(Z={action:e,location:t,retry:function(){u(-1*C)}},u(C))}}else l(e)}}));var b=g.Pop,m=(e=I())[0],h=e[1],G=i(),p=i();return null==m&&(m=0,d.replaceState((0,C.Z)({},d.state,{idx:m}),"")),{get action(){return b},get location(){return h},createHref:t,push:function e(I,C){var o=g.Push,a=n(I,C);if(!p.length||(p.call({action:o,location:a,retry:function(){e(I,C)}}),0)){var i=[{usr:a.state,key:a.key,idx:m+1},t(a)];a=i[0],i=i[1];try{d.pushState(a,"",i)}catch(Rp){s.location.assign(i)}l(o)}},replace:function e(I,C){var o=g.Replace,a=n(I,C);p.length&&(p.call({action:o,location:a,retry:function(){e(I,C)}}),1)||(a=[{usr:a.state,key:a.key,idx:m},t(a)],d.replaceState(a[0],"",a[1]),l(o))},go:u,back:function(){u(-1)},forward:function(){u(1)},listen:function(g){return G.push(g)},block:function(g){var e=p.push(g);return 1===p.length&&s.addEventListener("beforeunload",a),function(){e(),p.length||s.removeEventListener("beforeunload",a)}}}}({window:u}));var d=s.current,Z=(0,t.useState)({action:d.action,location:d.location}),b=(0,n.Z)(Z,2),m=b[0],h=b[1];return(0,t.useLayoutEffect)((function(){return d.listen(h)}),[d]),(0,t.createElement)(G,{basename:I,children:l,location:m.location,navigationType:m.action,navigator:d})}var xe=(0,t.forwardRef)((function(g,e){var I=g.onClick,n=g.reloadDocument,C=g.replace,l=void 0!==C&&C,o=g.state,a=g.target,i=g.to,r=Ke(g,Fe),A=y(i),u=function(g,e){var I=void 0===e?{}:e,n=I.target,C=I.replace,l=I.state,o=V(),a=v(),i=S(g);return(0,t.useCallback)((function(e){if(0===e.button&&(!n||"_self"===n)&&!function(g){return!!(g.metaKey||g.altKey||g.ctrlKey||g.shiftKey)}(e)){e.preventDefault();var I=!!C||c(a)===c(i);o(g,{replace:I,state:l})}}),[a,o,i,C,l,n,g])}(i,{replace:l,state:o,target:a});return(0,t.createElement)("a",Ne({},r,{href:A,onClick:function(g){I&&I(g),g.defaultPrevented||n||u(g)},ref:e,target:a}))}));var ze=I(3007),Ue=function(g){var e=function(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=g.getTrigger,I=void 0===e?rg:e,l=g.target,o=void 0===l?cg:l,a=(0,U.Z)(g,ig),i=t.useRef(),r=t.useState((function(){return I(i,a)})),c=(0,n.Z)(r,2),A=c[0],u=c[1];return t.useEffect((function(){var g=function(){u(I(i,(0,C.Z)({target:o},a)))};return g(),o.addEventListener("scroll",g),function(){o.removeEventListener("scroll",g)}}),[o,I,JSON.stringify(a)]),A}({disableHysteresis:!0,threshold:40});return(0,Ig.jsx)(Bg,{elevation:e?4:0,position:"sticky",color:"default",children:(0,Ig.jsxs)(kg,{children:[g.linkBackTo&&(0,Ig.jsx)(We,{component:xe,to:g.linkBackTo,color:"inherit",edge:"start",children:(0,Ig.jsx)(we.Z,{titleAccess:"Navigate Back"})}),!g.linkBackTo&&(0,Ig.jsx)(ze.Z,{color:"primary",fontSize:"large"}),(0,Ig.jsx)(He,{ml:3,flex:"auto",children:(0,Ig.jsx)(ag,{variant:"h6",children:g.title})}),g.actions]})})},Me={home:"/home",signin:"/signin",main:"/",scanner:"/scanner",image:"/view",pc:"/pc",barcode:"/barcode/:qr"};function Le(g){return(0,$.Z)("MuiContainer",g)}(0,gg.Z)("MuiContainer",["root","disableGutters","fixed","maxWidthXs","maxWidthSm","maxWidthMd","maxWidthLg","maxWidthXl"]);var Te=["className","component","disableGutters","fixed","maxWidth"],Qe=(0,O.ZP)("div",{name:"MuiContainer",slot:"Root",overridesResolver:function(g,e){var I=g.ownerState;return[e.root,e["maxWidth".concat((0,q.Z)(String(I.maxWidth)))],I.fixed&&e.fixed,I.disableGutters&&e.disableGutters]}})((function(g){var e=g.theme,I=g.ownerState;return(0,C.Z)({width:"100%",marginLeft:"auto",boxSizing:"border-box",marginRight:"auto",display:"block"},!I.disableGutters&&(0,vg.Z)({paddingLeft:e.spacing(2),paddingRight:e.spacing(2)},e.breakpoints.up("sm"),{paddingLeft:e.spacing(3),paddingRight:e.spacing(3)}))}),(function(g){var e=g.theme;return g.ownerState.fixed&&Object.keys(e.breakpoints.values).reduce((function(g,I){var t=e.breakpoints.values[I];return 0!==t&&(g[e.breakpoints.up(I)]={maxWidth:"".concat(t).concat(e.breakpoints.unit)}),g}),{})}),(function(g){var e=g.theme,I=g.ownerState;return(0,C.Z)({},"xs"===I.maxWidth&&(0,vg.Z)({},e.breakpoints.up("xs"),{maxWidth:Math.max(e.breakpoints.values.xs,444)}),I.maxWidth&&"xs"!==I.maxWidth&&(0,vg.Z)({},e.breakpoints.up(I.maxWidth),{maxWidth:"".concat(e.breakpoints.values[I.maxWidth]).concat(e.breakpoints.unit)}))})),De=t.forwardRef((function(g,e){var I=(0,_.Z)({props:g,name:"MuiContainer"}),t=I.className,n=I.component,l=void 0===n?"div":n,o=I.disableGutters,a=void 0!==o&&o,i=I.fixed,r=void 0!==i&&i,c=I.maxWidth,A=void 0===c?"lg":c,u=(0,U.Z)(I,Te),s=(0,C.Z)({},I,{component:l,disableGutters:a,fixed:r,maxWidth:A}),d=function(g){var e=g.classes,I=g.fixed,t=g.disableGutters,n=g.maxWidth,C={root:["root",n&&"maxWidth".concat((0,q.Z)(String(n))),I&&"fixed",t&&"disableGutters"]};return(0,P.Z)(C,Le,e)}(s);return(0,Ig.jsx)(Qe,(0,C.Z)({as:l,ownerState:s,className:(0,M.Z)(d.root,t),ref:e},u))})),je=De,Pe=function(g){var e=g.children,I=g.maxWidth,t=void 0===I?"md":I,n=g.marginTop,C=void 0===n?3:n,l=g.marginBottom,o=void 0===l?5:l;return(0,Ig.jsx)(je,{maxWidth:t,children:(0,Ig.jsx)(He,{mt:C,mb:o,children:e})})},Oe=function(){return(0,Ig.jsxs)(Ig.Fragment,{children:[(0,Ig.jsx)(Ue,{title:"Signin",linkBackTo:Me.home}),(0,Ig.jsx)(Pe,{children:(0,Ig.jsx)(ag,{variant:"h3",children:"Coming soon"})})]})},_e=I(9008),qe=function(){var g=(0,t.useState)(100),e=(0,n.Z)(g,2),I=e[0],C=(e[1],(0,t.useState)("No Result")),l=(0,n.Z)(C,2),o=l[0],a=l[1];return(0,Ig.jsxs)("div",{children:[(0,Ig.jsx)(_e,{delay:I,style:{height:240,width:320},onError:function(g){return console.log(g)},onScan:function(g){null!=g&&(console.log(g),a(g.text),localStorage.setItem("qr",g.text))}}),(0,Ig.jsx)("p",{children:o})]})},$e=I(3878),gI=I(9199),eI=I(181),II=I(5267);function tI(g){return(0,$e.Z)(g)||(0,gI.Z)(g)||(0,eI.Z)(g)||(0,II.Z)()}function nI(g,e){if(null==g)return{};var I,t,n=(0,U.Z)(g,e);if(Object.getOwnPropertySymbols){var C=Object.getOwnPropertySymbols(g);for(t=0;t<C.length;t++)I=C[t],e.indexOf(I)>=0||Object.prototype.propertyIsEnumerable.call(g,I)&&(n[I]=g[I])}return n}function CI(g,e,I,t,n,C,l){try{var o=g[C](l),a=o.value}catch(i){return void I(i)}o.done?e(a):Promise.resolve(a).then(t,n)}function lI(g){return function(){var e=this,I=arguments;return new Promise((function(t,n){var C=g.apply(e,I);function l(g){CI(C,t,n,l,o,"next",g)}function o(g){CI(C,t,n,l,o,"throw",g)}l(void 0)}))}}function oI(g){return oI=Object.setPrototypeOf?Object.getPrototypeOf:function(g){return g.__proto__||Object.getPrototypeOf(g)},oI(g)}function aI(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(g){return!1}}function iI(g,e,I){return iI=aI()?Reflect.construct:function(g,e,I){var t=[null];t.push.apply(t,e);var n=new(Function.bind.apply(g,t));return I&&wg(n,I.prototype),n},iI.apply(null,arguments)}function rI(g){var e="function"===typeof Map?new Map:void 0;return rI=function(g){if(null===g||!function(g){return-1!==Function.toString.call(g).indexOf("[native code]")}(g))return g;if("function"!==typeof g)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof e){if(e.has(g))return e.get(g);e.set(g,I)}function I(){return iI(g,arguments,oI(this).constructor)}return I.prototype=Object.create(g.prototype,{constructor:{value:I,enumerable:!1,writable:!0,configurable:!0}}),wg(I,g)},rI(g)}function cI(g,e){var I="undefined"!==typeof Symbol&&g[Symbol.iterator]||g["@@iterator"];if(!I){if(Array.isArray(g)||(I=(0,eI.Z)(g))||e&&g&&"number"===typeof g.length){I&&(g=I);var t=0,n=function(){};return{s:n,n:function(){return t>=g.length?{done:!0}:{done:!1,value:g[t++]}},e:function(g){throw g},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var C,l=!0,o=!1;return{s:function(){I=I.call(g)},n:function(){var g=I.next();return l=g.done,g},e:function(g){o=!0,C=g},f:function(){try{l||null==I.return||I.return()}finally{if(o)throw C}}}}function AI(g,e){var I=Object.keys(g);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(g);e&&(t=t.filter((function(e){return Object.getOwnPropertyDescriptor(g,e).enumerable}))),I.push.apply(I,t)}return I}function uI(g){for(var e=1;e<arguments.length;e++){var I=null!=arguments[e]?arguments[e]:{};e%2?AI(Object(I),!0).forEach((function(e){(0,vg.Z)(g,e,I[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(g,Object.getOwnPropertyDescriptors(I)):AI(Object(I)).forEach((function(e){Object.defineProperty(g,e,Object.getOwnPropertyDescriptor(I,e))}))}return g}function sI(g,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");g.prototype=Object.create(e&&e.prototype,{constructor:{value:g,writable:!0,configurable:!0}}),Object.defineProperty(g,"prototype",{writable:!1}),e&&wg(g,e)}function dI(g){return dI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(g){return typeof g}:function(g){return g&&"function"==typeof Symbol&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},dI(g)}function ZI(g,e){if(e&&("object"===dI(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Hg(g)}function bI(g){var e=aI();return function(){var I,t=oI(g);if(e){var n=oI(this).constructor;I=Reflect.construct(t,arguments,n)}else I=t.apply(this,arguments);return ZI(this,I)}}function mI(g,e){if(!(g instanceof e))throw new TypeError("Cannot call a class as a function")}function hI(g,e){for(var I=0;I<e.length;I++){var t=e[I];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(g,t.key,t)}}function GI(g,e,I){return e&&hI(g.prototype,e),I&&hI(g,I),Object.defineProperty(g,"prototype",{writable:!1}),g}var pI=I(7757),yI=I.n(pI),BI=["override"],vI=["default"],VI=["cachePolicyForParams_UNSTABLE"],WI=yI().mark(Dt),SI=yI().mark(_n);var fI=function(g){var e=new Error(g);if(void 0===e.stack)try{throw e}catch(I){}return e};var kI=function(g){return!!g&&"function"===typeof g.then};var RI=function(g,e){if(null!=g)return g;throw fI(null!==e&&void 0!==e?e:"Got unexpected null or undefined")};function XI(g,e,I){return e in g?Object.defineProperty(g,e,{value:I,enumerable:!0,configurable:!0,writable:!0}):g[e]=I,g}var JI=function(){function g(){mI(this,g)}return GI(g,[{key:"getValue",value:function(){throw fI("BaseLoadable")}},{key:"toPromise",value:function(){throw fI("BaseLoadable")}},{key:"valueMaybe",value:function(){throw fI("BaseLoadable")}},{key:"valueOrThrow",value:function(){throw fI('Loadable expected value, but in "'.concat(this.state,'" state'))}},{key:"promiseMaybe",value:function(){throw fI("BaseLoadable")}},{key:"promiseOrThrow",value:function(){throw fI('Loadable expected promise, but in "'.concat(this.state,'" state'))}},{key:"errorMaybe",value:function(){throw fI("BaseLoadable")}},{key:"errorOrThrow",value:function(){throw fI('Loadable expected error, but in "'.concat(this.state,'" state'))}},{key:"is",value:function(g){return g.state===this.state&&g.contents===this.contents}},{key:"map",value:function(g){throw fI("BaseLoadable")}}]),g}(),YI=function(g){sI(I,g);var e=bI(I);function I(g){var t;return mI(this,I),XI(Hg(t=e.call(this)),"state","hasValue"),XI(Hg(t),"contents",void 0),t.contents=g,t}return GI(I,[{key:"getValue",value:function(){return this.contents}},{key:"toPromise",value:function(){return Promise.resolve(this.contents)}},{key:"valueMaybe",value:function(){return this.contents}},{key:"valueOrThrow",value:function(){return this.contents}},{key:"promiseMaybe",value:function(){}},{key:"errorMaybe",value:function(){}},{key:"map",value:function(g){var e=this;try{var I=g(this.contents);return kI(I)?FI(I):xI(I)?I:NI(I)}catch(t){return kI(t)?FI(t.next((function(){return e.map(g)}))):KI(t)}}}]),I}(JI),HI=function(g){sI(I,g);var e=bI(I);function I(g){var t;return mI(this,I),XI(Hg(t=e.call(this)),"state","hasError"),XI(Hg(t),"contents",void 0),t.contents=g,t}return GI(I,[{key:"getValue",value:function(){throw this.contents}},{key:"toPromise",value:function(){return Promise.reject(this.contents)}},{key:"valueMaybe",value:function(){}},{key:"promiseMaybe",value:function(){}},{key:"errorMaybe",value:function(){return this.contents}},{key:"errorOrThrow",value:function(){return this.contents}},{key:"map",value:function(g){return this}}]),I}(JI),wI=function(g){sI(I,g);var e=bI(I);function I(g){var t;return mI(this,I),XI(Hg(t=e.call(this)),"state","loading"),XI(Hg(t),"contents",void 0),t.contents=g,t}return GI(I,[{key:"getValue",value:function(){throw this.contents}},{key:"toPromise",value:function(){return this.contents}},{key:"valueMaybe",value:function(){}},{key:"promiseMaybe",value:function(){return this.contents}},{key:"promiseOrThrow",value:function(){return this.contents}},{key:"errorMaybe",value:function(){}},{key:"map",value:function(g){var e=this;return FI(this.contents.then((function(e){var I=g(e);if(xI(I)){var t=I;switch(t.state){case"hasValue":case"loading":return t.contents;case"hasError":throw t.contents}}return I})).catch((function(I){if(kI(I))return I.then((function(){return e.map(g).contents}));throw I})))}}]),I}(JI);function NI(g){return Object.freeze(new YI(g))}function KI(g){return Object.freeze(new HI(g))}function FI(g){return Object.freeze(new wI(g))}function EI(g){var e=function(g){return g.every((function(g){return"hasValue"===g.state}))?NI(g.map((function(g){return g.contents}))):g.some((function(g){return"hasError"===g.state}))?KI(RI(g.find((function(g){return"hasError"===g.state})),"Invalid loadable passed to loadableAll").contents):FI(Promise.all(g.map((function(g){return g.contents}))))}(Array.isArray(g)?g:Object.getOwnPropertyNames(g).map((function(e){return g[e]})));return Array.isArray(g)?e:e.map((function(e){return Object.getOwnPropertyNames(g).reduce((function(g,I,t){return uI(uI({},g),{},(0,vg.Z)({},I,e[t]))}),{})}))}function xI(g){return g instanceof JI}var zI={of:function(g){return kI(g)?FI(g):NI(g)},error:function(g){return KI(g)},all:EI,isLoadable:xI},UI={loadableWithValue:NI,loadableWithError:KI,loadableWithPromise:FI,loadableLoading:function(){return Object.freeze(new wI(new Promise((function(){}))))},loadableAll:EI,isLoadable:xI,RecoilLoadable:zI},MI=UI.loadableWithValue,LI=UI.loadableWithError,TI=UI.loadableWithPromise,QI=UI.loadableLoading,DI=UI.loadableAll,jI=UI.isLoadable,PI=UI.RecoilLoadable,OI=Object.freeze({__proto__:null,loadableWithValue:MI,loadableWithError:LI,loadableWithPromise:TI,loadableLoading:QI,loadableAll:DI,isLoadable:jI,RecoilLoadable:PI});var _I,qI=function(g){},$I=null!==(_I=t.useMutableSource)&&void 0!==_I?_I:t.unstable_useMutableSource;var gt={mutableSourceExists:function(){return $I&&!("undefined"!==typeof window&&window.$disableRecoilValueMutableSource_TEMP_HACK_DO_NOT_USE)},useMutableSource:$I},et=gt.mutableSourceExists,It=(new Map).set("recoil_hamt_2020",!0).set("recoil_memory_managament_2020",!0).set("recoil_suppress_rerender_in_callback",!0);function tt(g){var e;return!("recoil_early_rendering_2021"===g&&!et())&&(null!==(e=It.get(g))&&void 0!==e&&e)}tt.setPass=function(g){It.set(g,!0)},tt.setFail=function(g){It.set(g,!1)};var nt=tt;var Ct=function(g,e){return yI().mark((function I(){var t,n,C,l;return yI().wrap((function(I){for(;;)switch(I.prev=I.next){case 0:t=0,n=cI(g),I.prev=2,n.s();case 4:if((C=n.n()).done){I.next=10;break}return l=C.value,I.next=8,e(l,t++);case 8:I.next=4;break;case 10:I.next=15;break;case 12:I.prev=12,I.t0=I.catch(2),n.e(I.t0);case 15:return I.prev=15,n.f(),I.finish(15);case 18:case"end":return I.stop()}}),I,null,[[2,12,15,18]])}))()};var lt=function(g,e){var I=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return I.error,null},ot=lt,at=GI((function g(e){mI(this,g),XI(this,"key",void 0),this.key=e})),it=function(g){sI(I,g);var e=bI(I);function I(){return mI(this,I),e.apply(this,arguments)}return GI(I)}(at),rt=function(g){sI(I,g);var e=bI(I);function I(){return mI(this,I),e.apply(this,arguments)}return GI(I)}(at);var ct={AbstractRecoilValue:at,RecoilState:it,RecoilValueReadOnly:rt,isRecoilValue:function(g){return g instanceof it||g instanceof rt}},At=ct.AbstractRecoilValue,ut=ct.RecoilState,st=ct.RecoilValueReadOnly,dt=ct.isRecoilValue,Zt=Object.freeze({__proto__:null,AbstractRecoilValue:At,RecoilState:ut,RecoilValueReadOnly:st,isRecoilValue:dt}),bt=GI((function g(){mI(this,g)})),mt=new bt,ht=function(g){sI(I,g);var e=bI(I);function I(g){return mI(this,I),e.call(this,"Tried to set the value of Recoil selector ".concat(g," using an updater function, but it is an async selector in a pending or error state; this is not supported."))}return GI(I)}(rI(Error)),Gt=new Map,pt=new Map;var yt=function(g){sI(I,g);var e=bI(I);function I(){return mI(this,I),e.apply(this,arguments)}return GI(I)}(rI(Error));var Bt=new Map;function vt(g){return Bt.get(g)}var Vt={nodes:Gt,recoilValues:pt,registerNode:function(g){if(Gt.has(g.key)){var e='Duplicate atom key "'.concat(g.key,'". This is a FATAL ERROR in\n      production. But it is safe to ignore this warning if it occurred because of\n      hot module replacement.');console.warn(e)}Gt.set(g.key,g);var I=null==g.set?new Zt.RecoilValueReadOnly(g.key):new Zt.RecoilState(g.key);return pt.set(g.key,I),I},getNode:function(g){var e=Gt.get(g);if(null==e)throw new yt('Missing definition for RecoilValue: "'.concat(g,'""'));return e},getNodeMaybe:function(g){return Gt.get(g)},deleteNodeConfigIfPossible:function(g){var e;if(nt("recoil_memory_managament_2020")){var I,t=Gt.get(g);if(null===t||void 0===t||null===(e=t.shouldDeleteConfigOnRelease)||void 0===e?void 0:e.call(t))Gt.delete(g),null===(I=vt(g))||void 0===I||I(),Bt.delete(g)}},setConfigDeletionHandler:function(g,e){nt("recoil_memory_managament_2020")&&(void 0===e?Bt.delete(g):Bt.set(g,e))},getConfigDeletionHandler:vt,recoilValuesForKeys:function(g){return Ct(g,(function(g){return RI(pt.get(g))}))},NodeMissingError:yt,DefaultValue:bt,DEFAULT_VALUE:mt,RecoilValueNotReady:ht};var Wt={enqueueExecution:function(g,e){e()}};var St=function(g,e){return g(e={exports:{}},e.exports),e.exports}((function(g){var e="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(g){return typeof g}:function(g){return g&&"function"===typeof Symbol&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},I={},t=Math.pow(2,5),n=t-1,C=t/2,l=t/4,o={},a=function(g){return function(){return g}},i=I.hash=function(g){var I="undefined"===typeof g?"undefined":e(g);if("number"===I)return g;"string"!==I&&(g+="");for(var t=0,n=0,C=g.length;n<C;++n){t=(t<<5)-t+g.charCodeAt(n)|0}return t},r=function(g,e){return e>>>g&n},c=function(g){return 1<<g},A=function(g,e){return function(g){return g=(g=(858993459&(g-=g>>1&1431655765))+(g>>2&858993459))+(g>>4)&252645135,g+=g>>8,127&g+(g>>16)}(g&e-1)},u=function(g,e,I,t){var n=t;if(!g){var C=t.length;n=new Array(C);for(var l=0;l<C;++l)n[l]=t[l]}return n[e]=I,n},s=function(g,e,I){var t=I.length-1,n=0,C=0,l=I;if(g)n=C=e;else for(l=new Array(t);n<e;)l[C++]=I[n++];for(++n;n<=t;)l[C++]=I[n++];return g&&(l.length=t),l},d={__hamt_isEmpty:!0},Z=function(g){return g===d||g&&g.__hamt_isEmpty},b=function(g,e,I,t){return{type:1,edit:g,hash:e,key:I,value:t,_modify:B}},m=function(g,e,I){return{type:2,edit:g,hash:e,children:I,_modify:v}},h=function(g,e,I){return{type:3,edit:g,mask:e,children:I,_modify:V}},G=function(g,e,I){return{type:4,edit:g,size:e,children:I,_modify:W}},p=function g(e,I,t,n,C,l){if(t===C)return m(e,t,[l,n]);var o=r(I,t),a=r(I,C);return h(e,c(o)|c(a),o===a?[g(e,I+5,t,n,C,l)]:o<a?[n,l]:[l,n])},y=function(g,e){return g===e.edit},B=function(g,e,I,t,n,C,l){if(e(C,this.key)){var a=t(this.value);return a===this.value?this:a===o?(--l.value,d):y(g,this)?(this.value=a,this):b(g,n,C,a)}var i=t();return i===o?this:(++l.value,p(g,I,this.hash,this,n,b(g,n,C,i)))},v=function(g,e,I,t,n,C,l){if(n===this.hash){var a=function(g,e,I,t,n,C,l,a){for(var i=n.length,r=0;r<i;++r){var c=n[r];if(I(l,c.key)){var A=c.value,d=C(A);return d===A?n:d===o?(--a.value,s(g,r,n)):u(g,r,b(e,t,l,d),n)}}var Z=C();return Z===o?n:(++a.value,u(g,i,b(e,t,l,Z),n))}(y(g,this),g,e,this.hash,this.children,t,C,l);return a===this.children?this:a.length>1?m(g,this.hash,a):a[0]}var i=t();return i===o?this:(++l.value,p(g,I,this.hash,this,n,b(g,n,C,i)))},V=function(g,e,I,t,n,l,o){var a=this.mask,i=this.children,b=r(I,n),m=c(b),p=A(a,m),B=a&m,v=B?i[p]:d,V=v._modify(g,e,I+5,t,n,l,o);if(v===V)return this;var W,S=y(g,this),f=a,k=void 0;if(B&&Z(V)){if(!(f&=~m))return d;if(i.length<=2&&((W=i[1^p])===d||1===W.type||2===W.type))return i[1^p];k=s(S,p,i)}else if(B||Z(V))k=u(S,p,V,i);else{if(i.length>=C)return function(g,e,I,t,n){for(var C=[],l=t,o=0,a=0;l;++a)1&l&&(C[a]=n[o++]),l>>>=1;return C[e]=I,G(g,o+1,C)}(g,b,V,a,i);f|=m,k=function(g,e,I,t){var n=t.length;if(g){for(var C=n;C>=e;)t[C--]=t[C];return t[e]=I,t}for(var l=0,o=0,a=new Array(n+1);l<e;)a[o++]=t[l++];for(a[e]=I;l<n;)a[++o]=t[l++];return a}(S,p,V,i)}return S?(this.mask=f,this.children=k,this):h(g,f,k)},W=function(g,e,I,t,n,C,o){var a=this.size,i=this.children,c=r(I,n),A=i[c],s=(A||d)._modify(g,e,I+5,t,n,C,o);if(A===s)return this;var b=y(g,this),m=void 0;if(Z(A)&&!Z(s))++a,m=u(b,c,s,i);else if(!Z(A)&&Z(s)){if(--a<=l)return function(g,e,I,t){for(var n=new Array(e-1),C=0,l=0,o=0,a=t.length;o<a;++o)if(o!==I){var i=t[o];i&&!Z(i)&&(n[C++]=i,l|=1<<o)}return h(g,l,n)}(g,a,c,i);m=u(b,c,d,i)}else m=u(b,c,s,i);return b?(this.size=a,this.children=m,this):G(g,a,m)};function S(g,e,I,t,n){this._editable=g,this._edit=e,this._config=I,this._root=t,this._size=n}d._modify=function(g,e,I,t,n,C,l){var a=t();return a===o?d:(++l.value,b(g,n,C,a))},S.prototype.setTree=function(g,e){return this._editable?(this._root=g,this._size=e,this):g===this._root?this:new S(this._editable,this._edit,this._config,g,e)};var f=I.tryGetHash=function(g,e,I,t){for(var n=t._root,C=0,l=t._config.keyEq;;)switch(n.type){case 1:return l(I,n.key)?n.value:g;case 2:if(e===n.hash)for(var o=n.children,a=0,i=o.length;a<i;++a){var u=o[a];if(l(I,u.key))return u.value}return g;case 3:var s=r(C,e),d=c(s);if(n.mask&d){n=n.children[A(n.mask,d)],C+=5;break}return g;case 4:if(n=n.children[r(C,e)]){C+=5;break}return g;default:return g}};S.prototype.tryGetHash=function(g,e,I){return f(g,e,I,this)};var k=I.tryGet=function(g,e,I){return f(g,I._config.hash(e),e,I)};S.prototype.tryGet=function(g,e){return k(g,e,this)};var R=I.getHash=function(g,e,I){return f(void 0,g,e,I)};S.prototype.getHash=function(g,e){return R(g,e,this)};I.get=function(g,e){return f(void 0,e._config.hash(g),g,e)};S.prototype.get=function(g,e){return k(e,g,this)};var X=I.has=function(g,e,I){return f(o,g,e,I)!==o};S.prototype.hasHash=function(g,e){return X(g,e,this)};var J=I.has=function(g,e){return X(e._config.hash(g),g,e)};S.prototype.has=function(g){return J(g,this)};var Y=function(g,e){return g===e};I.make=function(g){return new S(0,0,{keyEq:g&&g.keyEq||Y,hash:g&&g.hash||i},d,0)},I.empty=I.make();var H=I.isEmpty=function(g){return g&&!!Z(g._root)};S.prototype.isEmpty=function(){return H(this)};var w=I.modifyHash=function(g,e,I,t){var n={value:t._size},C=t._root._modify(t._editable?t._edit:NaN,t._config.keyEq,0,g,e,I,n);return t.setTree(C,n.value)};S.prototype.modifyHash=function(g,e,I){return w(I,g,e,this)};var N=I.modify=function(g,e,I){return w(g,I._config.hash(e),e,I)};S.prototype.modify=function(g,e){return N(e,g,this)};var K=I.setHash=function(g,e,I,t){return w(a(I),g,e,t)};S.prototype.setHash=function(g,e,I){return K(g,e,I,this)};var F=I.set=function(g,e,I){return K(I._config.hash(g),g,e,I)};S.prototype.set=function(g,e){return F(g,e,this)};var E=a(o),x=I.removeHash=function(g,e,I){return w(E,g,e,I)};S.prototype.removeHash=S.prototype.deleteHash=function(g,e){return x(g,e,this)};var z=I.remove=function(g,e){return x(e._config.hash(g),g,e)};S.prototype.remove=S.prototype.delete=function(g){return z(g,this)};var U=I.beginMutation=function(g){return new S(g._editable+1,g._edit+1,g._config,g._root,g._size)};S.prototype.beginMutation=function(){return U(this)};var M=I.endMutation=function(g){return g._editable=g._editable&&g._editable-1,g};S.prototype.endMutation=function(){return M(this)};var L=I.mutate=function(g,e){var I=U(e);return g(I),M(I)};S.prototype.mutate=function(g){return L(g,this)};var T=function(g){return g&&Q(g[0],g[1],g[2],g[3],g[4])},Q=function(g,e,I,t,n){for(;I<g;){var C=e[I++];if(C&&!Z(C))return D(C,t,[g,e,I,t,n])}return T(n)},D=function(g,e,I){switch(g.type){case 1:return{value:e(g),rest:I};case 2:case 4:case 3:var t=g.children;return Q(t.length,t,0,e,I);default:return T(I)}},j={done:!0};function P(g){this.v=g}P.prototype.next=function(){if(!this.v)return j;var g=this.v;return this.v=T(g.rest),g},P.prototype[Symbol.iterator]=function(){return this};var O=function(g,e){return new P(D(g._root,e))},_=function(g){return[g.key,g.value]},q=I.entries=function(g){return O(g,_)};S.prototype.entries=S.prototype[Symbol.iterator]=function(){return q(this)};var $=function(g){return g.key},gg=I.keys=function(g){return O(g,$)};S.prototype.keys=function(){return gg(this)};var eg=function(g){return g.value},Ig=I.values=S.prototype.values=function(g){return O(g,eg)};S.prototype.values=function(){return Ig(this)};var tg=I.fold=function(g,e,I){var t=I._root;if(1===t.type)return g(e,t.value,t.key);for(var n=[t.children],C=void 0;C=n.pop();)for(var l=0,o=C.length;l<o;){var a=C[l++];a&&a.type&&(1===a.type?e=g(e,a.value,a.key):n.push(a.children))}return e};S.prototype.fold=function(g,e){return tg(g,e,this)};var ng=I.forEach=function(g,e){return tg((function(I,t,n){return g(t,n,e)}),null,e)};S.prototype.forEach=function(g){return ng(g,this)};var Cg=I.count=function(g){return g._size};S.prototype.count=function(){return Cg(this)},Object.defineProperty(S.prototype,"size",{get:S.prototype.count}),g.exports?g.exports=I:(void 0).hamt=I})),ft=function(){function g(e){mI(this,g),XI(this,"_map",void 0),this._map=new Map(null===e||void 0===e?void 0:e.entries())}return GI(g,[{key:"keys",value:function(){return this._map.keys()}},{key:"entries",value:function(){return this._map.entries()}},{key:"get",value:function(g){return this._map.get(g)}},{key:"has",value:function(g){return this._map.has(g)}},{key:"set",value:function(g,e){return this._map.set(g,e),this}},{key:"delete",value:function(g){return this._map.delete(g),this}},{key:"clone",value:function(){return Rt(this)}},{key:"toMap",value:function(){return new Map(this._map)}}]),g}(),kt=function(){function g(e){if(mI(this,g),XI(this,"_hamt",St.empty.beginMutation()),e instanceof g){var I=e._hamt.endMutation();e._hamt=I.beginMutation(),this._hamt=I.beginMutation()}else if(e){var t,C=cI(e.entries());try{for(C.s();!(t=C.n()).done;){var l=(0,n.Z)(t.value,2),o=l[0],a=l[1];this._hamt.set(o,a)}}catch(i){C.e(i)}finally{C.f()}}}return GI(g,[{key:"keys",value:function(){return this._hamt.keys()}},{key:"entries",value:function(){return this._hamt.entries()}},{key:"get",value:function(g){return this._hamt.get(g)}},{key:"has",value:function(g){return this._hamt.has(g)}},{key:"set",value:function(g,e){return this._hamt.set(g,e),this}},{key:"delete",value:function(g){return this._hamt.delete(g),this}},{key:"clone",value:function(){return Rt(this)}},{key:"toMap",value:function(){return new Map(this._hamt)}}]),g}();function Rt(g){return nt("recoil_hamt_2020")?new kt(g):new ft(g)}var Xt=Rt;var Jt=function(g){for(var e=new Set,I=arguments.length,t=new Array(I>1?I-1:0),n=1;n<I;n++)t[n-1]=arguments[n];var C,l=cI(g);try{g:for(l.s();!(C=l.n()).done;){var o,a=C.value,i=cI(t);try{for(i.s();!(o=i.n()).done;){var r=o.value;if(r.has(a))continue g}}catch(c){i.e(c)}finally{i.f()}e.add(a)}}catch(c){l.e(c)}finally{l.f()}return e};var Yt=function(g,e){var I=new Map;return g.forEach((function(g,t){I.set(t,e(g,t))})),I};function Ht(g,e,I){var t=e.nodeDeps,n=e.nodeToNodeSubscriptions;g.forEach((function(g,e){var C=t.get(e);C&&I&&C!==I.nodeDeps.get(e)||(t.set(e,new Set(g)),(null==C?g:Jt(g,C)).forEach((function(g){n.has(g)||n.set(g,new Set),RI(n.get(g)).add(e)})),C&&Jt(C,g).forEach((function(g){if(n.has(g)){var I=RI(n.get(g));I.delete(e),0===I.size&&n.delete(g)}})))}))}var wt=function(g){return{nodeDeps:Yt(g.nodeDeps,(function(g){return new Set(g)})),nodeToNodeSubscriptions:Yt(g.nodeToNodeSubscriptions,(function(g){return new Set(g)}))}},Nt=function(){return{nodeDeps:new Map,nodeToNodeSubscriptions:new Map}},Kt=function(g,e,I){var t,n,C,l,o=e.getState();I!==o.currentTree.version&&I!==(null===(t=o.nextTree)||void 0===t?void 0:t.version)&&I!==(null===(n=o.previousTree)||void 0===n?void 0:n.version)&&ot("Tried to save dependencies to a discarded tree");var a=e.getGraph(I);if(Ht(g,a),I===(null===(C=o.previousTree)||void 0===C?void 0:C.version)&&Ht(g,e.getGraph(o.currentTree.version),a),I===(null===(l=o.previousTree)||void 0===l?void 0:l.version)||I===o.currentTree.version){var i,r=null===(i=o.nextTree)||void 0===i?void 0:i.version;if(void 0!==r)Ht(g,e.getGraph(r),a)}},Ft=Object.freeze({__proto__:null,persistentMap:Xt}).persistentMap,Et=Nt,xt=0,zt=function(){return xt++};function Ut(){var g=zt();return{version:g,stateID:g,transactionMetadata:{},dirtyAtoms:new Set,atomValues:Ft(),nonvalidatedAtoms:Ft()}}var Mt=function(){var g=Ut();return{currentTree:g,nextTree:null,previousTree:null,commitDepth:0,knownAtoms:new Set,knownSelectors:new Set,transactionSubscriptions:new Map,nodeTransactionSubscriptions:new Map,nodeToComponentSubscriptions:new Map,queuedComponentCallbacks_DEPRECATED:[],suspendedComponentResolvers:new Set,graphsByVersion:(new Map).set(g.version,Et()),versionsUsedByComponent:new Map,retention:{referenceCounts:new Map,nodesRetainedByZone:new Map,retainablesToCheckForRelease:new Set},nodeCleanupFunctions:new Map}},Lt=zt;var Tt=function(){for(var g=new Set,e=arguments.length,I=new Array(e),t=0;t<e;t++)I[t]=arguments[t];for(var n=0,C=I;n<C.length;n++){var l,o=C[n],a=cI(o);try{for(a.s();!(l=a.n()).done;){var i=l.value;g.add(i)}}catch(r){a.e(r)}finally{a.f()}}return g};var Qt=function(g,e){var I=new Set(g);return I.add(e),I};function Dt(g,e){var I,t,n,C;return yI().wrap((function(l){for(;;)switch(l.prev=l.next){case 0:I=0,t=cI(g),l.prev=2,t.s();case 4:if((n=t.n()).done){l.next=11;break}if(C=n.value,!e(C,I++)){l.next=9;break}return l.next=9,C;case 9:l.next=4;break;case 11:l.next=16;break;case 13:l.prev=13,l.t0=l.catch(2),t.e(l.t0);case 16:return l.prev=16,t.f(),l.finish(16);case 19:case"end":return l.stop()}}),WI,null,[[2,13,16,19]])}var jt=Dt,Pt=GI((function g(){mI(this,g)}));var Ot={RetentionZone:Pt,retentionZone:function(){return new Pt}},_t=Qt,qt=Vt.getNode,$t=Vt.getNodeMaybe,gn=Vt.recoilValuesForKeys,en=Ot.RetentionZone,In=Object.freeze(new Set),tn=function(g){sI(I,g);var e=bI(I);function I(){return mI(this,I),e.apply(this,arguments)}return GI(I)}(rI(Error));function nn(g,e,I,t){var n=g.getState();if(!n.nodeCleanupFunctions.has(I)){var C=qt(I),l=function(g,e,I){if(!nt("recoil_memory_managament_2020"))return function(){};var t=g.getState().retention.nodesRetainedByZone;function n(g){var I=t.get(g);I||t.set(g,I=new Set),I.add(e)}if(I instanceof en)n(I);else if(Array.isArray(I)){var C,l=cI(I);try{for(l.s();!(C=l.n()).done;)n(C.value)}catch(o){l.e(o)}finally{l.f()}}return function(){if(nt("recoil_memory_managament_2020")){var t=g.getState().retention.nodesRetainedByZone;if(I instanceof en)l(I);else if(Array.isArray(I)){var n,C=cI(I);try{for(C.s();!(n=C.n()).done;)l(n.value)}catch(o){C.e(o)}finally{C.f()}}}function l(g){var I=t.get(g);I&&I.delete(e),I&&0===I.size&&t.delete(g)}}}(g,I,C.retainedBy),o=C.init(g,e,t);n.nodeCleanupFunctions.set(I,(function(){o(),l()}))}}function Cn(g,e,I){return qt(I).peek(g,e)}function ln(g,e,I){for(var t=new Set,n=Array.from(I),C=g.getGraph(e.version),l=n.pop();l;l=n.pop()){var o;t.add(l);var a,i=cI(null!==(o=C.nodeToNodeSubscriptions.get(l))&&void 0!==o?o:In);try{for(i.s();!(a=i.n()).done;){var r=a.value;t.has(r)||n.push(r)}}catch(c){i.e(c)}finally{i.f()}}return t}var on=function(g,e,I){return nn(g,e,I,"get"),qt(I).get(g,e)},an=Cn,rn=function(g,e,I,t){var n=qt(I);if(null==n.set)throw new tn("Attempt to set read-only RecoilValue: ".concat(I));var C=n.set;return nn(g,e,I,"set"),C(g,e,t)},cn=function(g,e){var I,t=g.getState();null===(I=t.nodeCleanupFunctions.get(e))||void 0===I||I(),t.nodeCleanupFunctions.delete(e)},An=function(g,e,I){var t,n=$t(e);return null===n||void 0===n||null===(t=n.invalidate)||void 0===t||t.call(n,g),uI(uI({},g),{},{atomValues:g.atomValues.clone().delete(e),nonvalidatedAtoms:g.nonvalidatedAtoms.clone().set(e,I),dirtyAtoms:_t(g.dirtyAtoms,e)})},un=function(g,e,I){var t,C,l,o=g.getState(),a=g.getGraph(e.version),i=o.knownAtoms.has(I)?"atom":o.knownSelectors.has(I)?"selector":void 0,r=jt(ln(g,e,new Set([I])),(function(g){return g!==I}));return{loadable:Cn(g,e,I),isActive:o.knownAtoms.has(I)||o.knownSelectors.has(I),isSet:"selector"!==i&&e.atomValues.has(I),isModified:e.dirtyAtoms.has(I),type:i,deps:gn(null!==(t=a.nodeDeps.get(I))&&void 0!==t?t:[]),subscribers:{nodes:gn(r),components:Ct(null!==(C=null===(l=o.nodeToComponentSubscriptions.get(I))||void 0===l?void 0:l.values())&&void 0!==C?C:[],(function(g){return{name:(0,n.Z)(g,1)[0]}}))}}},sn=ln,dn=nn,Zn=sn,bn=on,mn=rn,hn=Vt.getNodeMaybe,Gn=Vt.DefaultValue,pn=Vt.RecoilValueNotReady,yn=Zt.AbstractRecoilValue,Bn=Zt.RecoilState,vn=Zt.RecoilValueReadOnly,Vn=Zt.isRecoilValue;function Wn(g,e,I){if("set"===I.type){var t,C=I.recoilValue,l=function(g,e,I,t){var n=I.key;if("function"===typeof t){var C=bn(g,e,n);if("loading"===C.state)throw new pn(n);if("hasError"===C.state)throw C.contents;return t(C.contents)}return t}(g,e,C,I.valueOrUpdater),o=cI(mn(g,e,C.key,l).entries());try{for(o.s();!(t=o.n()).done;){var a=(0,n.Z)(t.value,2);Sn(e,a[0],a[1])}}catch(s){o.e(s)}finally{o.f()}}else if("setLoadable"===I.type){Sn(e,I.recoilValue.key,I.loadable)}else if("markModified"===I.type){var i=I.recoilValue.key;e.dirtyAtoms.add(i)}else if("setUnvalidated"===I.type){var r,c=I.recoilValue.key,A=I.unvalidatedValue,u=hn(c);null===u||void 0===u||null===(r=u.invalidate)||void 0===r||r.call(u,e),e.atomValues.delete(c),e.nonvalidatedAtoms.set(c,A),e.dirtyAtoms.add(c)}else ot("Unknown action ".concat(I.type))}function Sn(g,e,I){"hasValue"===I.state&&I.contents instanceof Gn?g.atomValues.delete(e):g.atomValues.set(e,I),g.dirtyAtoms.add(e),g.nonvalidatedAtoms.delete(e)}function fn(g,e){g.replaceState((function(I){var t,n=Xn(I),C=cI(e);try{for(C.s();!(t=C.n()).done;){var l=t.value;Wn(g,n,l)}}catch(o){C.e(o)}finally{C.f()}return Jn(g,n),n}))}function kn(g,e){if(Rn.length){var I=Rn[Rn.length-1],t=I.get(g);t||I.set(g,t=[]),t.push(e)}else fn(g,[e])}var Rn=[];function Xn(g){return uI(uI({},g),{},{atomValues:g.atomValues.clone(),nonvalidatedAtoms:g.nonvalidatedAtoms.clone(),dirtyAtoms:new Set(g.dirtyAtoms)})}function Jn(g,e){var I,t=cI(Zn(g,e,e.dirtyAtoms));try{for(t.s();!(I=t.n()).done;){var n,C,l=I.value;null===(n=hn(l))||void 0===n||null===(C=n.invalidate)||void 0===C||C.call(n,e)}}catch(o){t.e(o)}finally{t.f()}}function Yn(g,e,I){kn(g,{type:"set",recoilValue:e,valueOrUpdater:I})}var Hn=0;var wn={RecoilValueReadOnly:vn,AbstractRecoilValue:yn,RecoilState:Bn,getRecoilValueAsLoadable:function(g,e){var I,t,n=e.key,C=arguments.length>2&&void 0!==arguments[2]?arguments[2]:g.getState().currentTree,l=g.getState();C.version!==l.currentTree.version&&C.version!==(null===(I=l.nextTree)||void 0===I?void 0:I.version)&&C.version!==(null===(t=l.previousTree)||void 0===t?void 0:t.version)&&ot("Tried to read from a discarded tree");var o=bn(g,C,n);return"loading"===o.state&&o.contents.catch((function(){})),o},setRecoilValue:Yn,setRecoilValueLoadable:function(g,e,I){if(I instanceof Gn)return Yn(g,e,I);kn(g,{type:"setLoadable",recoilValue:e,loadable:I})},markRecoilValueModified:function(g,e){kn(g,{type:"markModified",recoilValue:e})},setUnvalidatedRecoilValue:function(g,e,I){kn(g,{type:"setUnvalidated",recoilValue:e,unvalidatedValue:I})},subscribeToRecoilValue:function(g,e,I){var t=e.key,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,C=Hn++,l=g.getState();if(l.nodeToComponentSubscriptions.has(t)||l.nodeToComponentSubscriptions.set(t,new Map),RI(l.nodeToComponentSubscriptions.get(t)).set(C,[null!==n&&void 0!==n?n:"<not captured>",I]),nt("recoil_early_rendering_2021")){var o=g.getState().nextTree;o&&o.dirtyAtoms.has(t)&&I(o)}return{release:function(){var e=g.getState(),I=e.nodeToComponentSubscriptions.get(t);void 0!==I&&I.has(C)?(I.delete(C),0===I.size&&e.nodeToComponentSubscriptions.delete(t)):ot("Subscription missing at release time for atom ".concat(t,". This is a bug in Recoil."))}}},isRecoilValue:Vn,applyAtomValueWrites:function(g,e){var I=g.clone();return e.forEach((function(g,e){"hasValue"===g.state&&g.contents instanceof Gn?I.delete(e):I.set(e,g)})),I},batchStart:function(){var g=new Map;return Rn.push(g),function(){var e,I=cI(g);try{for(I.s();!(e=I.n()).done;){var t=(0,n.Z)(e.value,2);fn(t[0],t[1])}}catch(C){I.e(C)}finally{I.f()}Rn.pop()!==g&&ot("Incorrect order of batch popping")}},writeLoadableToTreeState:Sn,invalidateDownstreams:Jn,copyTreeState:Xn,invalidateDownstreams_FOR_TESTING:Jn};var Nn=function(g,e,I){for(var t=g.entries(),n=t.next();!n.done;){var C=n.value;if(e.call(I,C[1],C[0],g))return!0;n=t.next()}return!1},Kn=cn,Fn=Vt.deleteNodeConfigIfPossible,En=Vt.getNode,xn=Ot.RetentionZone,zn=new Set;function Un(g,e){var I=g.getState(),t=I.currentTree;if(I.nextTree)ot("releaseNodesNowOnCurrentTree should only be called at the end of a batch");else{var n,C=new Set,l=cI(e);try{for(l.s();!(n=l.n()).done;){var o=n.value;if(o instanceof xn){var a,i=cI(Ln(I,o));try{for(i.s();!(a=i.n()).done;){var r=a.value;C.add(r)}}catch(s){i.e(s)}finally{i.f()}}else C.add(o)}}catch(s){l.e(s)}finally{l.f()}var c,A=function(g,e){var I=g.getState(),t=I.currentTree,n=g.getGraph(t.version),C=new Set,l=new Set;return o(e),C;function o(e){var a,i=new Set,r=function(g,e,I,t,n){var C=g.getGraph(e.version),l=[],o=new Set;for(;I.size>0;)a(RI(I.values().next().value));return l;function a(g){if(t.has(g)||n.has(g))I.delete(g);else if(!o.has(g)){var e=C.nodeToNodeSubscriptions.get(g);if(e){var i,r=cI(e);try{for(r.s();!(i=r.n()).done;){a(i.value)}}catch(s){r.e(s)}finally{r.f()}}o.add(g),I.delete(g),l.push(g)}}}(g,t,e,C,l),c=cI(r);try{for(c.s();!(a=c.n()).done;){var A,u=a.value;if("recoilRoot"!==En(u).retainedBy)if((null!==(A=I.retention.referenceCounts.get(u))&&void 0!==A?A:0)>0)l.add(u);else if(Tn(u).some((function(g){return I.retention.referenceCounts.get(g)})))l.add(u);else{var d=n.nodeToNodeSubscriptions.get(u);d&&Nn(d,(function(g){return l.has(g)}))?l.add(u):(C.add(u),i.add(u))}else l.add(u)}}catch(s){c.e(s)}finally{c.f()}var Z,b=new Set,m=cI(i);try{for(m.s();!(Z=m.n()).done;){var h,G=Z.value,p=cI(null!==(y=n.nodeDeps.get(G))&&void 0!==y?y:zn);try{for(p.s();!(h=p.n()).done;){var y,B=h.value;C.has(B)||b.add(B)}}catch(s){p.e(s)}finally{p.f()}}}catch(s){m.e(s)}finally{m.f()}b.size&&o(b)}}(g,C),u=cI(A);try{for(u.s();!(c=u.n()).done;){Mn(g,t,c.value)}}catch(s){u.e(s)}finally{u.f()}}}function Mn(g,e,I){if(nt("recoil_memory_managament_2020")){Kn(g,I);var t=g.getState();t.knownAtoms.delete(I),t.knownSelectors.delete(I),t.nodeTransactionSubscriptions.delete(I),t.retention.referenceCounts.delete(I);var n,C=cI(Tn(I));try{for(C.s();!(n=C.n()).done;){var l,o=n.value;null===(l=t.retention.nodesRetainedByZone.get(o))||void 0===l||l.delete(I)}}catch(s){C.e(s)}finally{C.f()}e.atomValues.delete(I),e.dirtyAtoms.delete(I),e.nonvalidatedAtoms.delete(I);var a=t.graphsByVersion.get(e.version);if(a){var i=a.nodeDeps.get(I);if(void 0!==i){a.nodeDeps.delete(I);var r,c=cI(i);try{for(c.s();!(r=c.n()).done;){var A,u=r.value;null===(A=a.nodeToNodeSubscriptions.get(u))||void 0===A||A.delete(I)}}catch(s){c.e(s)}finally{c.f()}}a.nodeToNodeSubscriptions.delete(I)}Fn(I)}}function Ln(g,e){var I;return null!==(I=g.retention.nodesRetainedByZone.get(e))&&void 0!==I?I:zn}function Tn(g){var e=En(g).retainedBy;return void 0===e||"components"===e||"recoilRoot"===e?[]:e instanceof xn?[e]:e}function Qn(g,e){nt("recoil_memory_managament_2020")&&(g.getState().retention.referenceCounts.delete(e),function(g,e){var I=g.getState();I.nextTree?I.retention.retainablesToCheckForRelease.add(e):Un(g,new Set([e]))}(g,e))}var Dn=12e4,jn=function(g,e,I){var t;if(nt("recoil_memory_managament_2020")){var n=g.getState().retention.referenceCounts,C=(null!==(t=n.get(e))&&void 0!==t?t:0)+I;0===C?Qn(g,e):n.set(e,C)}},Pn=function(g){if(nt("recoil_memory_managament_2020")){var e=g.getState();Un(g,e.retention.retainablesToCheckForRelease),e.retention.retainablesToCheckForRelease.clear()}},On=function(g){return void 0===g?"recoilRoot":g};function _n(g){var e,I,t,n,C,l;return yI().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:e=cI(g),o.prev=1,e.s();case 3:if((I=e.n()).done){o.next=24;break}t=I.value,n=cI(t),o.prev=6,n.s();case 8:if((C=n.n()).done){o.next=14;break}return l=C.value,o.next=12,l;case 12:o.next=8;break;case 14:o.next=19;break;case 16:o.prev=16,o.t0=o.catch(6),n.e(o.t0);case 19:return o.prev=19,n.f(),o.finish(19);case 22:o.next=3;break;case 24:o.next=29;break;case 26:o.prev=26,o.t1=o.catch(1),e.e(o.t1);case 29:return o.prev=29,e.f(),o.finish(29);case 32:case"end":return o.stop()}}),SI,null,[[1,26,29,32],[6,16,19,22]])}var qn=_n,$n={isSSR:"undefined"===typeof window,isReactNative:"undefined"!==typeof navigator&&"ReactNative"===navigator.product},gC=e.unstable_batchedUpdates,eC=wn.batchStart,IC={unstable_batchedUpdates:{unstable_batchedUpdates:gC}.unstable_batchedUpdates}.unstable_batchedUpdates,tC=function(g){IC((function(){var e=function(){};try{e=eC(),g()}finally{e()}}))},nC=$n.isSSR,CC=tC,lC=dn,oC=un,aC=Nt,iC=Vt.DEFAULT_VALUE,rC=Vt.recoilValues,cC=Vt.recoilValuesForKeys,AC=wn.AbstractRecoilValue,uC=wn.getRecoilValueAsLoadable,sC=wn.setRecoilValue,dC=wn.setUnvalidatedRecoilValue,ZC=jn,bC=Lt,mC=Mt,hC=function(){function g(e){var I=this;mI(this,g),XI(this,"_store",void 0),XI(this,"_refCount",0),XI(this,"getLoadable",(function(g){return I.checkRefCount_INTERNAL(),uC(I._store,g)})),XI(this,"getPromise",(function(g){return I.checkRefCount_INTERNAL(),I.getLoadable(g).toPromise()})),XI(this,"getNodes_UNSTABLE",(function(g){if(I.checkRefCount_INTERNAL(),!0===(null===g||void 0===g?void 0:g.isModified)){if(!1===(null===g||void 0===g?void 0:g.isInitialized))return[];var e=I._store.getState().currentTree;return cC(e.dirtyAtoms)}var t=I._store.getState().knownAtoms,n=I._store.getState().knownSelectors;return null==(null===g||void 0===g?void 0:g.isInitialized)?rC.values():!0===g.isInitialized?cC(qn([I._store.getState().knownAtoms,I._store.getState().knownSelectors])):jt(rC.values(),(function(g){var e=g.key;return!t.has(e)&&!n.has(e)}))})),XI(this,"getInfo_UNSTABLE",(function(g){var e=g.key;return I.checkRefCount_INTERNAL(),oC(I._store,I._store.getState().currentTree,e)})),XI(this,"map",(function(g){I.checkRefCount_INTERNAL();var e=new yC(I,CC);return g(e),pC(e.getStore_INTERNAL())})),XI(this,"asyncMap",function(){var g=lI(yI().mark((function g(e){var t;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return I.checkRefCount_INTERNAL(),t=new yC(I,CC),g.next=4,e(t);case 4:return g.abrupt("return",pC(t.getStore_INTERNAL()));case 5:case"end":return g.stop()}}),g)})));return function(e){return g.apply(this,arguments)}}()),this._store={getState:function(){return e},replaceState:function(g){e.currentTree=g(e.currentTree)},getGraph:function(g){var I=e.graphsByVersion;if(I.has(g))return RI(I.get(g));var t=aC();return I.set(g,t),t},subscribeToTransactions:function(){return{release:function(){}}},addTransactionMetadata:function(){throw fI("Cannot subscribe to Snapshots")}};var t,n=cI(this._store.getState().nodeCleanupFunctions.keys());try{for(n.s();!(t=n.n()).done;){var C=t.value;lC(this._store,e.currentTree,C,"get"),ZC(this._store,C,1)}}catch(l){n.e(l)}finally{n.f()}this.retain(),this.autorelease_INTERNAL()}return GI(g,[{key:"retain",value:function(){var g=this;if(!nt("recoil_memory_managament_2020"))return function(){};this._refCount++;var e=!1;return function(){e||(e=!0,g.release_INTERNAL())}}},{key:"autorelease_INTERNAL",value:function(){var g=this;nt("recoil_memory_managament_2020")&&(nC||window.setTimeout((function(){return g.release_INTERNAL()}),0))}},{key:"release_INTERNAL",value:function(){nt("recoil_memory_managament_2020")&&(this._refCount--,this._refCount)}},{key:"checkRefCount_INTERNAL",value:function(){nt("recoil_memory_managament_2020")&&this._refCount}},{key:"getStore_INTERNAL",value:function(){return this.checkRefCount_INTERNAL(),this._store}},{key:"getID",value:function(){return this.checkRefCount_INTERNAL(),this.getID_INTERNAL()}},{key:"getID_INTERNAL",value:function(){return this.checkRefCount_INTERNAL(),this._store.getState().currentTree.stateID}}]),g}();function GC(g,e){var I=arguments.length>2&&void 0!==arguments[2]&&arguments[2],t=g.getState(),n=I?bC():e.version;return{currentTree:I?{version:n,stateID:n,transactionMetadata:uI({},e.transactionMetadata),dirtyAtoms:new Set(e.dirtyAtoms),atomValues:e.atomValues.clone(),nonvalidatedAtoms:e.nonvalidatedAtoms.clone()}:e,commitDepth:0,nextTree:null,previousTree:null,knownAtoms:new Set(t.knownAtoms),knownSelectors:new Set(t.knownSelectors),transactionSubscriptions:new Map,nodeTransactionSubscriptions:new Map,nodeToComponentSubscriptions:new Map,queuedComponentCallbacks_DEPRECATED:[],suspendedComponentResolvers:new Set,graphsByVersion:(new Map).set(n,g.getGraph(e.version)),versionsUsedByComponent:new Map,retention:{referenceCounts:new Map,nodesRetainedByZone:new Map,retainablesToCheckForRelease:new Set},nodeCleanupFunctions:new Map}}function pC(g){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"current",I=g.getState(),t="current"===e?I.currentTree:RI(I.previousTree);return new hC(GC(g,t))}var yC=function(g){sI(I,g);var e=bI(I);function I(g,t){var C;return mI(this,I),XI(Hg(C=e.call(this,GC(g.getStore_INTERNAL(),g.getStore_INTERNAL().getState().currentTree,!0))),"_batch",void 0),XI(Hg(C),"set",(function(g,e){C.checkRefCount_INTERNAL();var I=C.getStore_INTERNAL();C._batch((function(){ZC(I,g.key,1),sC(C.getStore_INTERNAL(),g,e)}))})),XI(Hg(C),"reset",(function(g){C.checkRefCount_INTERNAL();var e=C.getStore_INTERNAL();C._batch((function(){ZC(e,g.key,1),sC(C.getStore_INTERNAL(),g,iC)}))})),XI(Hg(C),"setUnvalidatedAtomValues_DEPRECATED",(function(g){C.checkRefCount_INTERNAL();var e=C.getStore_INTERNAL();CC((function(){var I,t=cI(g.entries());try{for(t.s();!(I=t.n()).done;){var C=(0,n.Z)(I.value,2),l=C[0],o=C[1];ZC(e,l,1),dC(e,new AC(l),o)}}catch(a){t.e(a)}finally{t.f()}}))})),C._batch=t,C}return GI(I)}(hC),BC={Snapshot:hC,MutableSnapshot:yC,freshSnapshot:function(g){var e=new hC(mC());return null!=g?e.map(g):e},cloneSnapshot:pC},vC=BC.Snapshot,VC=BC.MutableSnapshot,WC=BC.freshSnapshot,SC=BC.cloneSnapshot,fC=Object.freeze({__proto__:null,Snapshot:vC,MutableSnapshot:VC,freshSnapshot:WC,cloneSnapshot:SC}),kC=Lt,RC=Mt,XC=cn,JC=sn,YC=rn,HC=An,wC=Nt,NC=wt,KC=wn.applyAtomValueWrites,FC=Pn,EC=fC.freshSnapshot,xC=t.useCallback,zC=t.useContext,UC=t.useEffect,MC=t.useMemo,LC=t.useRef,TC=t.useState;function QC(){throw fI("This component must be used inside a <RecoilRoot> component.")}var DC=Object.freeze({getState:QC,replaceState:QC,getGraph:QC,subscribeToTransactions:QC,addTransactionMetadata:QC}),jC=!1;function PC(g){if(jC)throw fI("An atom update was triggered within the execution of a state updater function. State updater functions provided to Recoil must be pure functions.");var e=g.getState();if(null===e.nextTree){nt("recoil_memory_managament_2020")&&nt("recoil_release_on_cascading_update_killswitch_2021")&&e.commitDepth>0&&FC(g);var I=e.currentTree.version,t=kC();e.nextTree=uI(uI({},e.currentTree),{},{version:t,stateID:t,dirtyAtoms:new Set,transactionMetadata:{}}),e.graphsByVersion.set(t,NC(RI(e.graphsByVersion.get(I))))}}var OC=t.createContext({current:DC}),_C=function(){return zC(OC)},qC=t.createContext(null);function $C(g,e,I){var t,C=cI(JC(g,I,I.dirtyAtoms));try{for(C.s();!(t=C.n()).done;){var l=t.value,o=e.nodeToComponentSubscriptions.get(l);if(o){var a,i=cI(o);try{for(i.s();!(a=i.n()).done;){var r=(0,n.Z)(a.value,2),c=(r[0],(0,n.Z)(r[1],2));c[0];(0,c[1])(I)}}catch(A){i.e(A)}finally{i.f()}}}}catch(A){C.e(A)}finally{C.f()}}function gl(g){var e=g.getState(),I=e.currentTree,t=I.dirtyAtoms;if(t.size){var C,l=cI(e.nodeTransactionSubscriptions);try{for(l.s();!(C=l.n()).done;){var o=(0,n.Z)(C.value,2),a=o[0],i=o[1];if(t.has(a)){var r,c=cI(i);try{for(c.s();!(r=c.n()).done;){var A=(0,n.Z)(r.value,2);A[0];(0,A[1])(g)}}catch(Z){c.e(Z)}finally{c.f()}}}}catch(Z){l.e(Z)}finally{l.f()}var u,s=cI(e.transactionSubscriptions);try{for(s.s();!(u=s.n()).done;){var d=(0,n.Z)(u.value,2);d[0];(0,d[1])(g)}}catch(Z){s.e(Z)}finally{s.f()}nt("recoil_early_rendering_2021")&&!e.suspendedComponentResolvers.size||($C(g,e,I),e.suspendedComponentResolvers.forEach((function(g){return g()})),e.suspendedComponentResolvers.clear())}e.queuedComponentCallbacks_DEPRECATED.forEach((function(g){return g(I)})),e.queuedComponentCallbacks_DEPRECATED.splice(0,e.queuedComponentCallbacks_DEPRECATED.length)}function el(g){var e=g.setNotifyBatcherOfChange,I=_C(),t=TC([]),C=(0,n.Z)(t,2),l=(C[0],C[1]);return e((function(){return l({})})),UC((function(){Wt.enqueueExecution("Batcher",(function(){!function(g){var e=g.current.getState();e.commitDepth++;try{var I=e.nextTree;if(null===I)return;e.previousTree=e.currentTree,e.currentTree=I,e.nextTree=null,gl(g.current),null!=e.previousTree?e.graphsByVersion.delete(e.previousTree.version):ot("Ended batch with no previous state, which is unexpected","recoil"),e.previousTree=null,nt("recoil_memory_managament_2020")&&FC(g.current)}finally{e.commitDepth--}}(I)}))})),UC((function(){return function(){e((function(){}))}}),[e]),null}var Il=0;function tl(g){var e,I,n=g.initializeState_DEPRECATED,C=g.initializeState,l=g.store_INTERNAL,o=g.children,a=LC(null),i=xC((function(g){a.current=g}),[a]),r=null!==(e=t.createMutableSource)&&void 0!==e?e:t.unstable_createMutableSource,c=null!==l&&void 0!==l?l:{getState:function(){return I.current},replaceState:function(g){var e=A.current.getState();PC(A.current);var I,t=RI(e.nextTree);try{jC=!0,I=g(t)}finally{jC=!1}I!==t&&(e.nextTree=I,nt("recoil_early_rendering_2021")&&$C(c,e,I),RI(a.current)())},getGraph:function(g){var e=I.current.graphsByVersion;if(e.has(g))return RI(e.get(g));var t=wC();return e.set(g,t),t},subscribeToTransactions:function(g,e){if(null==e){var I=A.current.getState().transactionSubscriptions,t=Il++;return I.set(t,g),{release:function(){I.delete(t)}}}var n=A.current.getState().nodeTransactionSubscriptions;n.has(e)||n.set(e,new Map);var C=Il++;return RI(n.get(e)).set(C,g),{release:function(){var g=n.get(e);g&&(g.delete(C),0===g.size&&n.delete(e))}}},addTransactionMetadata:function(g){PC(A.current);for(var e=0,I=Object.keys(g);e<I.length;e++){var t=I[e];RI(A.current.getState().nextTree).transactionMetadata[t]=g[t]}}},A=LC(c);I=LC(null!=n?function(g,e){var I=RC();return e({set:function(e,t){var n,C=I.currentTree,l=YC(g,C,e.key,t),o=new Set(l.keys()),a=C.nonvalidatedAtoms.clone(),i=cI(o);try{for(i.s();!(n=i.n()).done;){var r=n.value;a.delete(r)}}catch(c){i.e(c)}finally{i.f()}I.currentTree=uI(uI({},C),{},{dirtyAtoms:Tt(C.dirtyAtoms,o),atomValues:KC(C.atomValues,l),nonvalidatedAtoms:a})},setUnvalidatedAtomValues:function(g){g.forEach((function(g,e){I.currentTree=HC(I.currentTree,e,g)}))}}),I}(c,n):null!=C?function(g){return EC().map(g).getStore_INTERNAL().getState()}(C):RC());var u=MC((function(){return r?r(I,(function(){return I.current.currentTree.version})):null}),[r,I]);return UC((function(){return function(){var g,e=cI(A.current.getState().knownAtoms);try{for(e.s();!(g=e.n()).done;){var I=g.value;XC(A.current,I)}}catch(t){e.e(t)}finally{e.f()}}}),[]),t.createElement(OC.Provider,{value:A},t.createElement(qC.Provider,{value:u},t.createElement(el,{setNotifyBatcherOfChange:i}),o))}var nl=_C,Cl=function(){var g=zC(qC);return null==g&&qI("Attempted to use a Recoil hook outside of a <RecoilRoot>. <RecoilRoot> must be an ancestor of any component that uses Recoil hooks."),g},ll=function(g){var e=g.override,I=nI(g,BI),n=_C();return!1===e&&n.current!==DC?g.children:t.createElement(tl,I)};var ol=t.useRef;var al=function(){return ol(),"<component name not available>"};var il=function(g,e){if(g===e)return!0;if(g.length!==e.length)return!1;for(var I=0,t=g.length;I<t;I++)if(g[I]!==e[I])return!1;return!0},rl=t.useEffect,cl=t.useRef;var Al=function(g){var e=cl();return rl((function(){e.current=g})),e.current},ul=nl,sl=Dn,dl=jn,Zl=Ot.RetentionZone,bl=$n.isSSR,ml=t.useEffect,hl=t.useRef;var Gl=function(g){if(nt("recoil_memory_managament_2020"))return function(g){var e=(Array.isArray(g)?g:[g]).map((function(g){return g instanceof Zl?g:g.key})),I=ul();ml((function(){if(nt("recoil_memory_managament_2020")){var g=I.current;if(t.current&&!bl)window.clearTimeout(t.current),t.current=null;else{var n,C=cI(e);try{for(C.s();!(n=C.n()).done;){var l=n.value;dl(g,l,1)}}catch(o){C.e(o)}finally{C.f()}}return function(){var I,t=cI(e);try{for(t.s();!(I=t.n()).done;){var n=I.value;dl(g,n,-1)}}catch(o){t.e(o)}finally{t.f()}}}}),[I].concat((0,L.Z)(e)));var t=hl(),n=Al(e);if(!bl&&(void 0===n||!il(n,e))){var C,l=I.current,o=cI(e);try{for(o.s();!(C=o.n()).done;){var a=C.value;dl(l,a,1)}}catch(A){o.e(A)}finally{o.f()}if(n){var i,r=cI(n);try{for(r.s();!(i=r.n()).done;){var c=i.value;dl(l,c,-1)}}catch(A){r.e(A)}finally{r.f()}}t.current&&window.clearTimeout(t.current),t.current=window.setTimeout((function(){t.current=null;var g,I=cI(e);try{for(I.s();!(g=I.n()).done;){var n=g.value;dl(l,n,-1)}}catch(A){I.e(A)}finally{I.f()}}),sl)}}(g)},pl=tC,yl=Vt.DEFAULT_VALUE,Bl=Cl,vl=nl,Vl=(Zt.isRecoilValue,wn.AbstractRecoilValue),Wl=wn.getRecoilValueAsLoadable,Sl=wn.setRecoilValue,fl=wn.setUnvalidatedRecoilValue,kl=wn.subscribeToRecoilValue,Rl=gt.mutableSourceExists,Xl=gt.useMutableSource,Jl=t.useCallback,Yl=t.useEffect,Hl=(t.useMemo,t.useRef),wl=t.useState;function Nl(g,e,I){if("hasValue"===g.state)return g.contents;if("loading"===g.state)throw new Promise((function(g){I.current.getState().suspendedComponentResolvers.add(g)}));throw"hasError"===g.state?g.contents:fI('Invalid value of loadable atom "'.concat(e.key,'"'))}function Kl(g){return nt("recoil_memory_managament_2020")&&Gl(g),Rl()?function(g){var e=vl(),I=Jl((function(){var I,t=e.current,n=t.getState(),C=nt("recoil_early_rendering_2021")&&null!==(I=n.nextTree)&&void 0!==I?I:n.currentTree;return Wl(t,g,C)}),[e,g]),t=Jl((function(){return I()}),[I]),n=al(),C=Jl((function(t,C){var l=e.current;return kl(l,g,(function(){if(!nt("recoil_suppress_rerender_in_callback"))return C();var g=I();a.current.is(g)||C(),a.current=g}),n).release}),[e,g,n,I]),l=Bl(),o=Xl(l,t,C),a=Hl(o);return Yl((function(){a.current=o})),o}(g):function(g){var e=vl(),I=wl([]),t=(0,n.Z)(I,2),C=(t[0],t[1]),l=al();Yl((function(){var I=e.current,t=I.getState(),n=kl(I,g,(function(e){var t;if(!nt("recoil_suppress_rerender_in_callback"))return C([]);var n=Wl(I,g,I.getState().currentTree);(null===(t=a.current)||void 0===t?void 0:t.is(n))||C(n),a.current=n}),l);if(t.nextTree)I.getState().queuedComponentCallbacks_DEPRECATED.push((function(){a.current=null,C([])}));else{var o;if(!nt("recoil_suppress_rerender_in_callback"))return C([]);var i=Wl(I,g,I.getState().currentTree);(null===(o=a.current)||void 0===o?void 0:o.is(i))||C(i),a.current=i}return n.release}),[l,g,e]);var o=Wl(e.current,g),a=Hl(o);return Yl((function(){a.current=o})),o}(g)}function Fl(g){var e=vl();return Nl(Kl(g),g,e)}function El(g){var e=vl();return Jl((function(I){Sl(e.current,g,I)}),[e,g])}var xl=function(g){return[Fl(g),El(g)]},zl=function(g){return[Kl(g),El(g)]},Ul=Fl,Ml=Kl,Ll=function(g){var e=vl();return Jl((function(){Sl(e.current,g,yl)}),[e,g])},Tl=El,Ql=function(){var g=vl();return function(e){var I=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};pl((function(){g.current.addTransactionMetadata(I),e.forEach((function(e,I){return fl(g.current,new Vl(I),e)}))}))}};var Dl=function(g,e){var I,t=new Map,C=cI(g);try{for(C.s();!(I=C.n()).done;){var l=(0,n.Z)(I.value,2),o=l[0],a=l[1];e(a,o)&&t.set(o,a)}}catch(i){C.e(i)}finally{C.f()}return t};var jl=function(g,e){var I,t=new Set,n=cI(g);try{for(n.s();!(I=n.n()).done;){var C=I.value;e(C)&&t.add(C)}}catch(l){n.e(l)}finally{n.f()}return t};var Pl=function(){for(var g=new Map,e=arguments.length,I=new Array(e),t=0;t<e;t++)I[t]=arguments[t];for(var n=0;n<I.length;n++)for(var C=I[n].keys(),l=void 0;!(l=C.next()).done;)g.set(l.value,I[n].get(l.value));return g},Ol=tC,_l=Vt.DEFAULT_VALUE,ql=Vt.getNode,$l=Vt.nodes,go=nl,eo=wn.AbstractRecoilValue,Io=wn.setRecoilValueLoadable,to=Dn,no=(fC.Snapshot,fC.cloneSnapshot),Co=$n.isSSR,lo=t.useCallback,oo=t.useEffect,ao=t.useRef,io=t.useState;function ro(g){var e=go();oo((function(){return e.current.subscribeToTransactions(g).release}),[g,e])}function co(g){var e=g.atomValues.toMap(),I=Yt(Dl(e,(function(g,e){var I=ql(e).persistence_UNSTABLE;return null!=I&&"none"!==I.type&&"hasValue"===g.state})),(function(g){return g.contents}));return Pl(g.nonvalidatedAtoms.toMap(),I)}var Ao=function(){var g=go(),e=io((function(){return no(g.current)})),I=(0,n.Z)(e,2),t=I[0],C=I[1],l=Al(t),o=ao();return oo((function(){return o.current&&!Co&&window.clearTimeout(o.current),t.retain()}),[t]),ro(lo((function(g){return C(no(g))}),[])),l===t||Co||(o.current&&(null===l||void 0===l||l.release_INTERNAL(),window.clearTimeout(o.current)),t.retain(),o.current=window.setTimeout((function(){t.release_INTERNAL(),o.current=null}),to)),t},uo=function(){var g=go();return lo((function(e){var I,t=g.current.getState(),n=null!==(I=t.nextTree)&&void 0!==I?I:t.currentTree,C=e.getStore_INTERNAL().getState().currentTree;Ol((function(){for(var I=new Set,t=0,l=[n.atomValues.keys(),C.atomValues.keys()];t<l.length;t++){var o,a=cI(l[t]);try{for(a.s();!(o=a.n()).done;){var i,r,c=o.value;(null===(i=n.atomValues.get(c))||void 0===i?void 0:i.contents)!==(null===(r=C.atomValues.get(c))||void 0===r?void 0:r.contents)&&ql(c).shouldRestoreFromSnapshots&&I.add(c)}}catch(A){a.e(A)}finally{a.f()}}I.forEach((function(e){Io(g.current,new eo(e),C.atomValues.has(e)?RI(C.atomValues.get(e)):_l)})),g.current.replaceState((function(g){return uI(uI({},g),{},{stateID:e.getID_INTERNAL()})}))}))}),[g])},so=function(g){ro(lo((function(e){var I=no(e,"current"),t=no(e,"previous");g({snapshot:I,previousSnapshot:t})}),[g]))},Zo=function(g){ro(lo((function(e){var I=e.getState().previousTree,t=e.getState().currentTree;I||(ot("Transaction subscribers notified without a previous tree being present -- this is a bug in Recoil"),I=e.getState().currentTree);var n=co(t),C=co(I),l=Yt($l,(function(g){var e,I,t,n;return{persistence_UNSTABLE:{type:null!==(e=null===(I=g.persistence_UNSTABLE)||void 0===I?void 0:I.type)&&void 0!==e?e:"none",backButton:null!==(t=null===(n=g.persistence_UNSTABLE)||void 0===n?void 0:n.backButton)&&void 0!==t&&t}}})),o=jl(t.dirtyAtoms,(function(g){return n.has(g)||C.has(g)}));g({atomValues:n,previousAtomValues:C,atomInfo:l,modifiedAtoms:o,transactionMetadata:uI({},t.transactionMetadata)})}),[g]))},bo=un,mo=nl;var ho=function(){var g=mo();return function(e){var I=e.key;return bo(g.current,g.current.getState().currentTree,I)}},Go=ll,po=nl,yo=t.useMemo;var Bo=function(){var g=po().current;return yo((function(){return function(e){var I=e.children;return t.createElement(Go,{store_INTERNAL:g},I)}}),[g])},vo=OI.loadableWithValue,Vo=Vt.DEFAULT_VALUE,Wo=Vt.getNode,So=wn.copyTreeState,fo=wn.getRecoilValueAsLoadable,ko=wn.invalidateDownstreams,Ro=wn.writeLoadableToTreeState;function Xo(g){return"atom"===Wo(g.key).nodeType}var Jo=function(){function g(e,I){var t=this;mI(this,g),XI(this,"_store",void 0),XI(this,"_treeState",void 0),XI(this,"_changes",void 0),XI(this,"get",(function(g){if(t._changes.has(g.key))return t._changes.get(g.key);if(!Xo(g))throw fI("Reading selectors within atomicUpdate is not supported");var e=fo(t._store,g,t._treeState);if("hasValue"===e.state)return e.contents;throw"hasError"===e.state?e.contents:fI("Expected Recoil atom ".concat(g.key," to have a value, but it is in a loading state."))})),XI(this,"set",(function(g,e){if(!Xo(g))throw fI("Setting selectors within atomicUpdate is not supported");if("function"===typeof e){var I=t.get(g);t._changes.set(g.key,e(I))}else t._changes.set(g.key,e)})),XI(this,"reset",(function(g){t.set(g,Vo)})),this._store=e,this._treeState=I,this._changes=new Map}return GI(g,[{key:"newTreeState_INTERNAL",value:function(){if(0===this._changes.size)return this._treeState;var g,e=So(this._treeState),I=cI(this._changes);try{for(I.s();!(g=I.n()).done;){var t=(0,n.Z)(g.value,2),C=t[0],l=t[1];Ro(e,C,vo(l))}}catch(o){I.e(o)}finally{I.f()}return ko(this._store,e),e}}]),g}();var Yo=function(g){return function(e){g.replaceState((function(I){var t=new Jo(g,I);return e(t),t.newTreeState_INTERNAL()}))}},Ho=Yo,wo=Object.freeze({__proto__:null,atomicUpdater:Ho});var No=function(g,e){if(!g)throw new Error(e)},Ko=wo.atomicUpdater,Fo=tC,Eo=Vt.DEFAULT_VALUE,xo=nl,zo=wn.setRecoilValue,Uo=(fC.Snapshot,fC.cloneSnapshot),Mo=uo,Lo=t.useCallback,To=GI((function g(){mI(this,g)})),Qo=new To;var Do=function(g,e){var I=xo(),t=Mo();return Lo((function(){for(var e=arguments.length,n=new Array(e),C=0;C<e;C++)n[C]=arguments[C];function l(g,e){zo(I.current,g,e)}function o(g){zo(I.current,g,Eo)}var a=Uo(I.current),i=Ko(I.current),r=Qo;return Fo((function(){var e="useRecoilCallback expects a function that returns a function: it accepts a function of the type (RecoilInterface) => T = R and returns a callback function T => R, where RecoilInterface is an object {snapshot, set, ...} and T and R are the argument and return types of the callback you want to create.  Please see the docs at recoiljs.org for details.";if("function"!==typeof g)throw fI(e);var I=g({set:l,reset:o,snapshot:a,gotoSnapshot:t,transact_UNSTABLE:i});if("function"!==typeof I)throw fI(e);r=I.apply(void 0,n)})),r instanceof To&&No(!1),r}),null!=e?[].concat((0,L.Z)(e),[I]):void 0)},jo=Vt.getNode,Po=nl,Oo=t.useCallback;var _o=function(g){var e=Po();return Oo((function(){var I,t=e.current,n=t.getState().currentTree,C=jo(g.key);null===(I=C.clearCache)||void 0===I||I.call(C,t,n)}),[g,e])},qo=wo.atomicUpdater,$o=nl,ga=t.useMemo;var ea=function(g,e){var I=$o();return ga((function(){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var C=qo(I.current);C((function(e){g(e).apply(void 0,t)}))}}),null!=e?[].concat((0,L.Z)(e),[I]):void 0)};function Ia(g,e,I){if("string"===typeof g&&!g.includes('"')&&!g.includes("\\"))return'"'.concat(g,'"');switch(typeof g){case"undefined":return"";case"boolean":return g?"true":"false";case"number":case"symbol":return String(g);case"string":return JSON.stringify(g);case"function":if(!0!==(null===e||void 0===e?void 0:e.allowFunctions))throw fI("Attempt to serialize function in a Recoil cache key");return"__FUNCTION(".concat(g.name,")__")}if(null===g)return"null";var t;if("object"!==typeof g)return null!==(t=JSON.stringify(g))&&void 0!==t?t:"";if(kI(g))return"__PROMISE__";if(Array.isArray(g))return"[".concat(g.map((function(g,I){return Ia(g,e,I.toString())})),"]");if("function"===typeof g.toJSON)return Ia(g.toJSON(I),e,I);if(g instanceof Map){var C,l={},o=cI(g);try{for(o.s();!(C=o.n()).done;){var a=(0,n.Z)(C.value,2),i=a[0],r=a[1];l["string"===typeof i?i:Ia(i,e)]=r}}catch(c){o.e(c)}finally{o.f()}return Ia(l,e,I)}return g instanceof Set?Ia(Array.from(g).sort((function(g,I){return Ia(g,e).localeCompare(Ia(I,e))})),e,I):void 0!==Symbol&&null!=g[Symbol.iterator]&&"function"===typeof g[Symbol.iterator]?Ia(Array.from(g),e,I):"{".concat(Object.keys(g).filter((function(e){return void 0!==g[e]})).sort().map((function(I){return"".concat(Ia(I,e),":").concat(Ia(g[I],e,I))})).join(","),"}")}var ta=function(g){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{allowFunctions:!1};return Ia(g,e)},na=function(){function g(e){var I,t,n;mI(this,g),XI(this,"_numLeafs",void 0),XI(this,"_root",void 0),XI(this,"_onHit",void 0),XI(this,"_onSet",void 0),XI(this,"_mapNodeValue",void 0),this._numLeafs=0,this._root=null,this._onHit=null!==(I=null===e||void 0===e?void 0:e.onHit)&&void 0!==I?I:function(){},this._onSet=null!==(t=null===e||void 0===e?void 0:e.onSet)&&void 0!==t?t:function(){},this._mapNodeValue=null!==(n=null===e||void 0===e?void 0:e.mapNodeValue)&&void 0!==n?n:function(g){return g}}return GI(g,[{key:"size",value:function(){return this._numLeafs}},{key:"root",value:function(){return this._root}},{key:"get",value:function(g,e){var I;return null===(I=this.getLeafNode(g,e))||void 0===I?void 0:I.value}},{key:"getLeafNode",value:function(g,e){var I=this;return Ca(this.root(),(function(e){return I._mapNodeValue(g(e))}),{onNodeVisit:function(g){null===e||void 0===e||e.onNodeVisit(g),"leaf"===g.type&&I._onHit(g)}})}},{key:"set",value:function(g,e,I){var t,C=this,l=null;!function o(){l=la(C.root(),g.map((function(g){var e=(0,n.Z)(g,2),I=e[0],t=e[1];return[I,C._mapNodeValue(t)]})),null,e,null,{onNodeVisit:function(g){null===I||void 0===I||I.onNodeVisit(g),"leaf"===g.type&&(t=g)}},(function(){C.clear(),o()}))}(),this.root()||(this._root=l),this._numLeafs++,this._onSet(RI(t))}},{key:"delete",value:function(g){if(!this.root())return!1;var e=RI(this.root());return!!oa(e,g,g.parent)&&(g===e||"branch"===e.type&&!e.branches.size?(this._root=null,this._numLeafs=0,!0):(this._numLeafs-=ia(g),!0))}},{key:"clear",value:function(){this._numLeafs=0,this._root=null}}]),g}(),Ca=function g(e,I,t){var n;if(null!=e){if(null===t||void 0===t||null===(n=t.onNodeVisit)||void 0===n||n.call(t,e),"leaf"===e.type)return e;var C=I(e.nodeKey);return g(e.branches.get(C),I,t)}},la=function g(e,I,t,C,l,o,a){var i,r;if(null==e)if(0===I.length)r={type:"leaf",value:C,parent:t,branchKey:l};else{var c=tI(I),A=c[0],u=c.slice(1),s=(0,n.Z)(A,2),d=s[0],Z=s[1];(r={type:"branch",nodeKey:d,parent:t,branches:new Map,branchKey:l}).branches.set(Z,g(null,u,r,C,Z,o,a))}else if(r=e,I.length){var b=tI(I),m=b[0],h=b.slice(1),G=(0,n.Z)(m,2),p=G[0],y=G[1];if("branch"!==e.type||e.nodeKey!==p)return ot("Existing cache must have a branch midway through the route with matching node key. Resetting cache."),a(),r;e.branches.set(y,g(e.branches.get(y),h,e,C,y,o,a))}return null===o||void 0===o||null===(i=o.onNodeVisit)||void 0===i||i.call(o,r),r},oa=function(g,e,I){return I?(I.branches.delete(e.branchKey),aa(g,I,I.parent)):g===e},aa=function g(e,I,t){return t?(0===I.branches.size&&t.branches.delete(I.branchKey),g(e,t,t.parent)):e===I},ia=function g(e){return"leaf"===e.type?1:Array.from(e.branches.values()).reduce((function(e,I){return e+g(I)}),0)},ra={TreeCache:na}.TreeCache,ca=Object.freeze({__proto__:null,TreeCache:ra}),Aa=function(){function g(e){var I;mI(this,g),XI(this,"_maxSize",void 0),XI(this,"_size",void 0),XI(this,"_head",void 0),XI(this,"_tail",void 0),XI(this,"_map",void 0),XI(this,"_keyMapper",void 0),this._maxSize=e.maxSize,this._size=0,this._head=null,this._tail=null,this._map=new Map,this._keyMapper=null!==(I=e.mapKey)&&void 0!==I?I:function(g){return g}}return GI(g,[{key:"head",value:function(){return this._head}},{key:"tail",value:function(){return this._tail}},{key:"size",value:function(){return this._size}},{key:"maxSize",value:function(){return this._maxSize}},{key:"has",value:function(g){return this._map.has(this._keyMapper(g))}},{key:"get",value:function(g){var e=this._keyMapper(g),I=this._map.get(e);if(I)return this.set(g,I.value),I.value}},{key:"set",value:function(g,e){var I=this._keyMapper(g);this._map.get(I)&&this.delete(g);var t=this.head(),n={key:g,right:t,left:null,value:e};t?t.left=n:this._tail=n,this._map.set(I,n),this._head=n,this._size++,this._maybeDeleteLRU()}},{key:"_maybeDeleteLRU",value:function(){this.size()>this.maxSize()&&this.deleteLru()}},{key:"deleteLru",value:function(){var g=this.tail();g&&this.delete(g.key)}},{key:"delete",value:function(g){var e=this._keyMapper(g);if(this._size&&this._map.has(e)){var I=RI(this._map.get(e)),t=I.right,n=I.left;t&&(t.left=I.left),n&&(n.right=I.right),I===this.head()&&(this._head=t),I===this.tail()&&(this._tail=n),this._map.delete(e),this._size--}}},{key:"clear",value:function(){this._size=0,this._head=null,this._tail=null,this._map=new Map}}]),g}(),ua={LRUCache:Aa}.LRUCache,sa=Object.freeze({__proto__:null,LRUCache:ua}),da=sa.LRUCache,Za=ca.TreeCache;var ba=function(g){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(g){return g},I=new da({maxSize:g}),t=new Za({mapNodeValue:e,onHit:function(g){I.set(g,!0)},onSet:function(e){var n=I.tail();I.set(e,!0),n&&t.size()>g&&t.delete(n.key)}});return t},ma=ca.TreeCache,ha={equality:"reference",eviction:"keep-all",maxSize:1/0};function Ga(g){switch(g){case"reference":return function(g){return g};case"value":return function(g){return ta(g)}}throw fI("Unrecognized equality policy ".concat(g))}function pa(g,e,I){switch(g){case"keep-all":return new ma({mapNodeValue:I});case"lru":return ba(RI(e),I);case"most-recent":return ba(1,I)}throw fI("Unrecognized eviction policy ".concat(g))}var ya=function(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ha,e=g.equality,I=void 0===e?ha.equality:e,t=g.eviction,n=void 0===t?ha.eviction:t,C=g.maxSize,l=void 0===C?ha.maxSize:C,o=Ga(I),a=pa(n,l,o);return a};var Ba=function(g){return function(){return null}},va=OI.loadableWithError,Va=OI.loadableWithPromise,Wa=OI.loadableWithValue,Sa=on,fa=an,ka=rn,Ra=Kt,Xa=Vt.DEFAULT_VALUE,Ja=Vt.RecoilValueNotReady,Ya=Vt.getConfigDeletionHandler,Ha=Vt.getNode,wa=Vt.registerNode,Na=Zt.isRecoilValue,Ka=Zt.AbstractRecoilValue,Fa=wn.markRecoilValueModified,Ea=wn.setRecoilValueLoadable,xa=On,za=fC.cloneSnapshot,Ua=Ba,Ma=GI((function g(){mI(this,g)})),La=new Ma,Ta=[],Qa=new Map,Da=function(){var g=0;return function(){return g++}}();var ja=function(g){var e=null,I=g.key,t=g.get,C=g.cachePolicy_UNSTABLE,l=null!=g.set?g.set:void 0,o=new Set,a=ya(null!==C&&void 0!==C?C:{equality:"reference",eviction:"keep-all"}),i=xa(g.retainedBy_UNSTABLE),r=new Map,c=0;function A(){return!nt("recoil_memory_managament_2020")||c>0}function u(g){return r.has(g)||r.set(g,{depValuesDiscoveredSoFarDuringAsyncWork:null,latestLoadable:null,latestExecutionId:null,stateVersion:null}),RI(r.get(g))}function s(g){return c++,g.getState().knownSelectors.add(I),function(){c--,g.getState().knownSelectors.delete(I),r.delete(g)}}function d(){return void 0!==Ya(I)&&!A()}function Z(g,e,I){if("loading"===e.state){var t=Qa.get(I);null==t&&Qa.set(I,t=new Set),t.add(g)}}function b(g,e,I){var t=g.getState().knownSelectors.has(I);if(t&&e.atomValues.has(I))return RI(e.atomValues.get(I));var n=Sa(g,e,I);return"loading"!==n.state&&t&&e.atomValues.set(I,n),n}function m(g,e,I,t,C,l){return e.then((function(t){if(!A())throw k(g,C),La;null!=l.loadingDepKey&&l.loadingDepPromise===e?I.atomValues.set(l.loadingDepKey,Wa(t)):g.getState().knownSelectors.forEach((function(g){I.atomValues.delete(g)}));var o=y(g,I);if(o&&"hasValue"===o.state)return S(o,g),o.contents;if(!R(g,C)){var a,i=V(I);if("loading"===(null===i||void 0===i||null===(a=i.latestLoadable)||void 0===a?void 0:a.state))return i.latestLoadable.contents}var r=p(g,I,C),c=(0,n.Z)(r,2),u=c[0],s=c[1];if(R(g,C)&&f(s,g,C),"loading"!==u.state&&(J(I,B(s),u),G(g,I,new Set(s.keys()),C),h(g,u,C)),"hasError"===u.state)throw u.contents;return u.contents})).catch((function(e){if(e instanceof Ma)throw ot("Selector was released while it had dependencies"),La;if(!A())throw k(g,C),La;var n=va(e);throw X(e),J(I,B(t),va(e)),G(g,I,new Set(t.keys()),C),h(g,n,C),e}))}function h(g,e,t){R(g,t)&&(S(e,g),function(g,e){var t=Qa.get(e);if(void 0!==t){var n,C=cI(t);try{for(C.s();!(n=C.n()).done;){var l=n.value;Ea(l,new Ka(I),g)}}catch(o){C.e(o)}finally{C.f()}Qa.delete(e)}}(e,t))}function G(g,e,t,n){var C,l,o,a,i,r,c;(R(g,n)||e.version===(null===(C=g.getState())||void 0===C||null===(l=C.currentTree)||void 0===l?void 0:l.version)||e.version===(null===(o=g.getState())||void 0===o||null===(a=o.nextTree)||void 0===a?void 0:a.version))&&Ra(new Map([[I,t]]),g,null!==(i=null===(r=g.getState())||void 0===r||null===(c=r.nextTree)||void 0===c?void 0:c.version)&&void 0!==i?i:g.getState().currentTree.version)}function p(g,e,n){var C,l,o=Ua(I),a=!1,i={loadingDepKey:null,loadingDepPromise:null},r=new Map,c=new Set;function u(I){var t=I.key;!function(g,e,I,t,n){I.add(t),G(g,e,I,n)}(g,e,c,t,n);var C=b(g,e,t);switch(r.set(t,C),C.state){case"hasValue":return C.contents;case"hasError":throw C.contents;case"loading":throw i.loadingDepKey=t,i.loadingDepPromise=C.contents,C.contents}throw fI("Invalid Loadable state")}G(g,e,c,n);var s=!1;try{C=t({get:u,getCallback:function(e){return function(){if(!s)throw fI("getCallback() should only be called asynchronously after the selector is evalutated.  It can be used for selectors to return objects with callbacks that can obtain the current Recoil state without a subscription.");var I=za(g),t=e({snapshot:I});if("function"!==typeof t)throw fI("getCallback() expects a function that returns a function.");return t.apply(void 0,arguments)}}}),C=Na(C)?u(C):C,s=!0,kI(C)?C=function(g,e,I,t,n,C){return e.then((function(e){if(!A())throw k(g,n),La;var C=Wa(e);return X(e),J(I,B(t),C),G(g,I,new Set(t.keys()),n),h(g,C,n),e})).catch((function(e){if(!A())throw k(g,n),La;if(R(g,n)&&f(t,g,n),kI(e))return m(g,e,I,t,n,C);var l=va(e);throw X(e),J(I,B(t),l),G(g,I,new Set(t.keys()),n),h(g,l,n),e}))}(g,C,e,r,n,i).finally(o):o()}catch(d){kI(C=d)?C=m(g,C,e,r,n,i).finally(o):(a=!0,o())}return"loading"!==(l=a?va(C):kI(C)?Va(C):Wa(C)).state&&X(l.contents),[l,r]}function y(g,e){var t,n=new Set,C=u(g);try{t=a.get((function(I){return"string"!==typeof I&&No(!1),b(g,e,I).contents}),{onNodeVisit:function(g){"branch"===g.type&&g.nodeKey!==I&&"string"===typeof g.nodeKey&&(n.add(g.nodeKey),o.add(g.nodeKey))}})}catch(l){throw fI('Problem with cache lookup for selector "'.concat(I,'": ').concat(l.message))}return t&&G(g,e,n,C.latestExecutionId),t}function B(g){return Array.from(g.entries()).map((function(g){var e=(0,n.Z)(g,2);return[e[0],e[1].contents]}))}function v(g,e){var I=Da(),t=p(g,e,I),C=(0,n.Z)(t,2),l=C[0],o=C[1];return S(l,g,o,I,e),function(g,e,I){"loading"!==I.state&&J(g,e,I)}(e,B(o),l),Z(g,l,I),l}function V(g){var e,I=null!==(e=Array.from(r.entries()).find((function(e){var I=(0,n.Z)(e,2),t=I[0],C=I[1];return null!=C.latestLoadable&&null!=C.latestExecutionId&&!function(g,e){var I,t,C=u(g),l=null!==(I=C.depValuesDiscoveredSoFarDuringAsyncWork)&&void 0!==I?I:new Map,o=Array((null!==(t=W.get(e.version))&&void 0!==t?t:new Map).entries()),a=W.has(e.version)&&o.length===l.size&&o.every((function(g){var e=(0,n.Z)(g,2),I=e[0],t=e[1];return l.get(I)===t}));if(null==l||e.version===C.stateVersion||a)return!1;return W.set(e.version,new Map(l)),Array.from(l).some((function(I){var t=(0,n.Z)(I,2),C=t[0],l=t[1];return b(g,e,C).contents!==l.contents}))}(t,g)})))&&void 0!==e?e:[];return(0,n.Z)(I,2)[1]}var W=new Map;function S(g,e,I,t,n){var C=u(e);"loading"===g.state?(C.depValuesDiscoveredSoFarDuringAsyncWork=I,C.latestExecutionId=t,C.latestLoadable=g,C.stateVersion=null===n||void 0===n?void 0:n.version):(C.depValuesDiscoveredSoFarDuringAsyncWork=null,C.latestExecutionId=null,C.latestLoadable=null,C.stateVersion=null)}function f(g,e,I){var t=u(e);R(e,I)&&(t.depValuesDiscoveredSoFarDuringAsyncWork=g)}function k(g,e){R(g,e)&&r.delete(g)}function R(g,e){return e===u(g).latestExecutionId}function X(g){0}function J(g,e,t){g.atomValues.set(I,t);try{a.set(e,t)}catch(n){throw fI('Problem with setting cache for selector "'.concat(I,'": ').concat(n.message))}}function Y(g,e){return a.get((function(I){"string"!==typeof I&&No(!1);var t=fa(g,e,I);return null===t||void 0===t?void 0:t.contents}))}function H(g,e){return function(g){if(Ta.includes(I)){var e="Recoil selector has circular dependencies: ".concat(Ta.slice(Ta.indexOf(I)).join(" \u2192 "));return va(fI(e))}Ta.push(I);try{return g()}finally{Ta.pop()}}((function(){return function(g,e){var I=y(g,e);if(null!=I)return S(I,g),I;var t=V(e);if(t){var n=t;return Z(g,RI(n.latestLoadable),RI(n.latestExecutionId)),RI(n.latestLoadable)}return v(g,e)}(g,e)}))}function w(g){g.atomValues.delete(I)}function N(g,I){null==e&&No(!1);var t,n=cI(o);try{for(n.s();!(t=n.n()).done;){var C,l=t.value,i=Ha(l);null===(C=i.clearCache)||void 0===C||C.call(i,g,I)}}catch(r){n.e(r)}finally{n.f()}w(I),a.clear(),Fa(g,e)}if(null!=l){return e=wa({key:I,nodeType:"selector",peek:Y,get:H,set:function(g,e,I){var t=!1,n=new Map;function C(I){var n=I.key;if(t)throw fI("Recoil: Async selector sets are not currently supported.");var C=b(g,e,n);if("hasValue"===C.state)return C.contents;throw"loading"===C.state?new Ja(n):C.contents}function o(I,l){if(t)throw fI("Recoil: Async selector sets are not currently supported.");var o="function"===typeof l?l(C(I)):l;ka(g,e,I.key,o).forEach((function(g,e){return n.set(e,g)}))}var a=l({set:o,get:C,reset:function(g){o(g,Xa)}},I);if(void 0!==a)throw kI(a)?fI("Recoil: Async selector sets are not currently supported."):fI("Recoil: selector set should be a void function.");return t=!0,n},init:s,invalidate:w,clearCache:N,shouldDeleteConfigOnRelease:d,dangerouslyAllowMutability:g.dangerouslyAllowMutability,shouldRestoreFromSnapshots:!1,retainedBy:i})}return e=wa({key:I,nodeType:"selector",peek:Y,get:H,init:s,invalidate:w,clearCache:N,shouldDeleteConfigOnRelease:d,dangerouslyAllowMutability:g.dangerouslyAllowMutability,shouldRestoreFromSnapshots:!1,retainedBy:i})},Pa=OI.loadableWithError,Oa=OI.loadableWithPromise,_a=OI.loadableWithValue,qa=un,$a=Vt.DEFAULT_VALUE,gi=Vt.DefaultValue,ei=Vt.getConfigDeletionHandler,Ii=Vt.registerNode,ti=Vt.setConfigDeletionHandler,ni=Zt.isRecoilValue,Ci=wn.getRecoilValueAsLoadable,li=wn.markRecoilValueModified,oi=wn.setRecoilValue,ai=wn.setRecoilValueLoadable,ii=On;function ri(g){var e=g.key,I=g.persistence_UNSTABLE,t=ii(g.retainedBy_UNSTABLE),n=0,C=kI(g.default)?Oa(g.default.then((function(g){return C=_a(g),g})).catch((function(g){throw C=Pa(g),g}))):_a(g.default);a(g.default);var l=void 0,o=new Map;function a(g){return g}var i=Ii({key:e,nodeType:"atom",peek:function(g,I){var t,n;return null!==(t=null!==(n=I.atomValues.get(e))&&void 0!==n?n:l)&&void 0!==t?t:C},get:function(g,t){if(t.atomValues.has(e))return RI(t.atomValues.get(e));if(t.nonvalidatedAtoms.has(e)){if(null!=l)return l;if(null==I)return qI("Tried to restore a persisted value for atom ".concat(e," but it has no persistence settings.")),C;var n=t.nonvalidatedAtoms.get(e),o=I.validator(n,$a),a=o instanceof gi?C:_a(o);return l=a}return C},set:function(g,I,t){if(I.atomValues.has(e)){var n=RI(I.atomValues.get(e));if("hasValue"===n.state&&t===n.contents)return new Map}else if(!I.nonvalidatedAtoms.has(e)&&t instanceof gi)return new Map;return l=void 0,(new Map).set(e,_a(t))},init:function(I,t,l){n++;var a=I.getState().knownAtoms.has(e);if(I.getState().knownAtoms.add(e),"loading"===C.state){var r=function(){var g;(null!==(g=I.getState().nextTree)&&void 0!==g?g:I.getState().currentTree).atomValues.has(e)||li(I,i)};C.contents.then(r).catch(r)}var c=$a,A=null;if(null!=g.effects_UNSTABLE&&!a){var u,s=function(g){if(b&&g.key===e&&!(c instanceof gi)){var t=c;return t instanceof gi?C:kI(t)?Oa(t.then((function(g){return g instanceof gi?C.toPromise():g}))):_a(t)}return Ci(I,g)},d=function(g){return s(g).toPromise()},Z=function(g){var t,n=qa(I,null!==(t=I.getState().nextTree)&&void 0!==t?t:I.getState().currentTree,g.key);return!b||g.key!==e||c instanceof gi?n:uI(uI({},n),{},{isSet:!0,loadable:s(g)})},b=!0,m=function(g){return function(e){if(b){var t=c instanceof gi||kI(c)?"hasValue"===C.state?C.contents:$a:c;c="function"===typeof e?e(t):e,kI(c)&&(c=c.then((function(e){return A={effect:g,value:e},e})))}else{if(kI(e))throw fI("Setting atoms to async values is not implemented.");"function"!==typeof e&&(A={effect:g,value:e}),oi(I,i,"function"===typeof e?function(I){var t=e(I);return A={effect:g,value:t},t}:e)}}},h=function(g){return function(){return m(g)($a)}},G=function(g){return function(t){I.subscribeToTransactions((function(I){var n,l=I.getState(),o=l.currentTree,a=l.previousTree;a||(ot("Transaction subscribers notified without a next tree being present -- this is a bug in Recoil"),a=o);var i=null!==(n=o.atomValues.get(e))&&void 0!==n?n:C;if("hasValue"===i.state){var r,c,u,s,d=i.contents,Z=null!==(r=a.atomValues.get(e))&&void 0!==r?r:C,b="hasValue"===Z.state?Z.contents:$a;(null===(c=A)||void 0===c?void 0:c.effect)!==g||(null===(u=A)||void 0===u?void 0:u.value)!==d?t(d,b,!o.atomValues.has(e)):(null===(s=A)||void 0===s?void 0:s.effect)===g&&(A=null)}}),e)}},p=cI(null!==(y=g.effects_UNSTABLE)&&void 0!==y?y:[]);try{for(p.s();!(u=p.n()).done;){var y,B,v=u.value,V=v({node:i,trigger:l,setSelf:m(v),resetSelf:h(v),onSet:G(v),getPromise:d,getLoadable:s,getInfo_UNSTABLE:Z});if(null!=V)o.set(I,[].concat((0,L.Z)(null!==(B=o.get(I))&&void 0!==B?B:[]),[V]))}}catch(k){p.e(k)}finally{p.f()}b=!1}if(!(c instanceof gi)){var W,S=c,f=kI(S)?Oa(function(g,I){var t=I.then((function(I){var n,C;return(null===(C=(null!==(n=g.getState().nextTree)&&void 0!==n?n:g.getState().currentTree).atomValues.get(e))||void 0===C?void 0:C.contents)===t&&oi(g,i,I),I})).catch((function(I){var n,C;throw(null===(C=(null!==(n=g.getState().nextTree)&&void 0!==n?n:g.getState().currentTree).atomValues.get(e))||void 0===C?void 0:C.contents)===t&&ai(g,i,Pa(I)),I}));return t}(I,S)):_a(S);t.atomValues.set(e,f),null===(W=I.getState().nextTree)||void 0===W||W.atomValues.set(e,f)}return function(){var g;n--,null===(g=o.get(I))||void 0===g||g.forEach((function(g){return g()})),o.delete(I),I.getState().knownAtoms.delete(e)}},invalidate:function(){l=void 0},shouldDeleteConfigOnRelease:function(){return void 0!==ei(e)&&n<=0},dangerouslyAllowMutability:g.dangerouslyAllowMutability,persistence_UNSTABLE:g.persistence_UNSTABLE?{type:g.persistence_UNSTABLE.type,backButton:g.persistence_UNSTABLE.backButton}:void 0,shouldRestoreFromSnapshots:!0,retainedBy:t});return i}function ci(g){var e=g.default,I=nI(g,vI);return ni(e)?function(g){var e=ci(uI(uI({},g),{},{default:$a,persistence_UNSTABLE:void 0===g.persistence_UNSTABLE?void 0:uI(uI({},g.persistence_UNSTABLE),{},{validator:function(e){return e instanceof gi?e:RI(g.persistence_UNSTABLE).validator(e,$a)}}),effects_UNSTABLE:g.effects_UNSTABLE})),I=ja({key:"".concat(g.key,"__withFallback"),get:function(I){var t=(0,I.get)(e);return t instanceof gi?g.default:t},set:function(g,I){return(0,g.set)(e,I)},dangerouslyAllowMutability:g.dangerouslyAllowMutability});return ti(I.key,ei(g.key)),I}(uI(uI({},I),{},{default:e})):ri(uI(uI({},I),{},{default:e}))}var Ai=ci,ui=function(){function g(e){var I;mI(this,g),XI(this,"_map",void 0),XI(this,"_keyMapper",void 0),this._map=new Map,this._keyMapper=null!==(I=null===e||void 0===e?void 0:e.mapKey)&&void 0!==I?I:function(g){return g}}return GI(g,[{key:"size",value:function(){return this._map.size}},{key:"has",value:function(g){return this._map.has(this._keyMapper(g))}},{key:"get",value:function(g){return this._map.get(this._keyMapper(g))}},{key:"set",value:function(g,e){this._map.set(this._keyMapper(g),e)}},{key:"delete",value:function(g){this._map.delete(this._keyMapper(g))}},{key:"clear",value:function(){this._map.clear()}}]),g}(),si={MapCache:ui}.MapCache,di=Object.freeze({__proto__:null,MapCache:si}),Zi=sa.LRUCache,bi=di.MapCache,mi={equality:"reference",eviction:"none",maxSize:1/0};function hi(g){switch(g){case"reference":return function(g){return g};case"value":return function(g){return ta(g)}}throw fI("Unrecognized equality policy ".concat(g))}function Gi(g,e,I){switch(g){case"keep-all":return new bi({mapKey:I});case"lru":return new Zi({mapKey:I,maxSize:RI(e)});case"most-recent":return new Zi({mapKey:I,maxSize:1})}throw fI("Unrecognized eviction policy ".concat(g))}var pi=function(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:mi,e=g.equality,I=void 0===e?mi.equality:e,t=g.eviction,n=void 0===t?mi.eviction:t,C=g.maxSize,l=void 0===C?mi.maxSize:C,o=hi(I),a=Gi(n,l,o);return a},yi=Vt.setConfigDeletionHandler;var Bi=function(g){var e,I,t=pi({equality:null!==(e=null===(I=g.cachePolicyForParams_UNSTABLE)||void 0===I?void 0:I.equality)&&void 0!==e?e:"value",eviction:"keep-all"});return function(e){var I,n=t.get(e);if(null!=n)return n;g.cachePolicyForParams_UNSTABLE;var C=nI(g,VI),l=Ai(uI(uI({},C),{},{key:"".concat(g.key,"__").concat(null!==(I=ta(e))&&void 0!==I?I:"void"),default:"function"===typeof g.default?g.default(e):g.default,retainedBy_UNSTABLE:"function"===typeof g.retainedBy_UNSTABLE?g.retainedBy_UNSTABLE(e):g.retainedBy_UNSTABLE,effects_UNSTABLE:"function"===typeof g.effects_UNSTABLE?g.effects_UNSTABLE(e):g.effects_UNSTABLE}));return t.set(e,l),yi(l.key,(function(){t.delete(e)})),l}},vi=Vt.setConfigDeletionHandler,Vi=0;var Wi=function(g){var e,I,t=pi({equality:null!==(e=null===(I=g.cachePolicyForParams_UNSTABLE)||void 0===I?void 0:I.equality)&&void 0!==e?e:"value",eviction:"keep-all"});return function(e){var I,n=t.get(e);if(null!=n)return n;var C,l="".concat(g.key,"__selectorFamily/").concat(null!==(I=ta(e,{allowFunctions:!0}))&&void 0!==I?I:"void","/").concat(Vi++),o=function(I){return g.get(e)(I)},a=g.cachePolicy_UNSTABLE,i="function"===typeof g.retainedBy_UNSTABLE?g.retainedBy_UNSTABLE(e):g.retainedBy_UNSTABLE;if(null!=g.set){var r=g.set;C=ja({key:l,get:o,set:function(g,I){return r(e)(g,I)},cachePolicy_UNSTABLE:a,dangerouslyAllowMutability:g.dangerouslyAllowMutability,retainedBy_UNSTABLE:i})}else C=ja({key:l,get:o,cachePolicy_UNSTABLE:a,dangerouslyAllowMutability:g.dangerouslyAllowMutability,retainedBy_UNSTABLE:i});return t.set(e,C),vi(C.key,(function(){t.delete(e)})),C}},Si=Wi({key:"__constant",get:function(g){return function(){return g}},cachePolicyForParams_UNSTABLE:{equality:"reference"}});var fi=function(g){return Si(g)},ki=Wi({key:"__error",get:function(g){return function(){throw fI(g)}},cachePolicyForParams_UNSTABLE:{equality:"reference"}});var Ri=function(g){return ki(g)};var Xi=function(g){return g},Ji=OI.loadableWithError,Yi=OI.loadableWithPromise,Hi=OI.loadableWithValue;function wi(g,e){var I,t=Array(e.length).fill(void 0),C=Array(e.length).fill(void 0),l=cI(e.entries());try{for(l.s();!(I=l.n()).done;){var o=(0,n.Z)(I.value,2),a=o[0],i=o[1];try{t[a]=g(i)}catch(r){C[a]=r}}}catch(c){l.e(c)}finally{l.f()}return[t,C]}function Ni(g){return null!=g&&!kI(g)}function Ki(g){return Array.isArray(g)?g:Object.getOwnPropertyNames(g).map((function(e){return g[e]}))}function Fi(g,e){return Array.isArray(g)?e:Object.getOwnPropertyNames(g).reduce((function(g,I,t){return uI(uI({},g),{},(0,vg.Z)({},I,e[t]))}),{})}function Ei(g,e,I){return Fi(g,I.map((function(g,I){return null==g?Hi(e[I]):kI(g)?Yi(g):Ji(g)})))}var xi=Wi({key:"__waitForNone",get:function(g){return function(e){var I=wi(e.get,Ki(g)),t=(0,n.Z)(I,2),C=t[0],l=t[1];return Ei(g,C,l)}},dangerouslyAllowMutability:!0}),zi=Wi({key:"__waitForAny",get:function(g){return function(e){var I=wi(e.get,Ki(g)),t=(0,n.Z)(I,2),C=t[0],l=t[1];return l.some((function(g){return!kI(g)}))?Ei(g,C,l):new Promise((function(e){var I,t=cI(l.entries());try{var o=function(){var t=(0,n.Z)(I.value,2),o=t[0],a=t[1];kI(a)&&a.then((function(I){C[o]=I,l[o]=void 0,e(Ei(g,C,l))})).catch((function(I){l[o]=I,e(Ei(g,C,l))}))};for(t.s();!(I=t.n()).done;)o()}catch(a){t.e(a)}finally{t.f()}}))}},dangerouslyAllowMutability:!0}),Ui={waitForNone:xi,waitForAny:zi,waitForAll:Wi({key:"__waitForAll",get:function(g){return function(e){var I=wi(e.get,Ki(g)),t=(0,n.Z)(I,2),C=t[0],l=t[1];if(l.every((function(g){return null==g})))return Fi(g,C);var o=l.find(Ni);if(null!=o)throw o;return Promise.all(l).then((function(e){return Fi(g,(I=C,e.map((function(g,e){return void 0===g?I[e]:g}))));var I}))}},dangerouslyAllowMutability:!0}),waitForAllSettled:Wi({key:"__waitForAllSettled",get:function(g){return function(e){var I=wi(e.get,Ki(g)),t=(0,n.Z)(I,2),C=t[0],l=t[1];return l.every((function(g){return!kI(g)}))?Ei(g,C,l):Promise.all(l.map((function(g,e){return kI(g)?g.then((function(g){C[e]=g,l[e]=void 0})).catch((function(g){C[e]=void 0,l[e]=g})):null}))).then((function(){return Ei(g,C,l)}))}},dangerouslyAllowMutability:!0}),noWait:Wi({key:"__noWait",get:function(g){return function(e){var I=e.get;try{return Hi(I(g))}catch(t){return kI(t)?Yi(t):Ji(t)}}},dangerouslyAllowMutability:!0})},Mi=OI.RecoilLoadable,Li=Vt.DefaultValue,Ti=ll,Qi=Zt.isRecoilValue,Di=Ot.retentionZone,ji=fC.freshSnapshot,Pi={DefaultValue:Li,isRecoilValue:Qi,RecoilLoadable:Mi,RecoilRoot:Ti,useRecoilBridgeAcrossReactRoots_UNSTABLE:Bo,atom:Ai,selector:ja,atomFamily:Bi,selectorFamily:Wi,constSelector:fi,errorSelector:Ri,readOnlySelector:Xi,noWait:Ui.noWait,waitForNone:Ui.waitForNone,waitForAny:Ui.waitForAny,waitForAll:Ui.waitForAll,waitForAllSettled:Ui.waitForAllSettled,useRecoilValue:Ul,useRecoilValueLoadable:Ml,useRecoilState:xl,useRecoilStateLoadable:zl,useSetRecoilState:Tl,useResetRecoilState:Ll,useGetRecoilValueInfo_UNSTABLE:ho,useRecoilRefresher_UNSTABLE:_o,useRecoilCallback:Do,useRecoilTransaction_UNSTABLE:ea,useGotoRecoilSnapshot:uo,useRecoilSnapshot:Ao,useRecoilTransactionObserver_UNSTABLE:so,useTransactionObservation_UNSTABLE:Zo,useSetUnvalidatedAtomValues_UNSTABLE:Ql,snapshot_UNSTABLE:ji,useRetain:Gl,retentionZone:Di},Oi=Pi.RecoilRoot,_i=Pi.useSetRecoilState,qi=(0,Pi.atom)({key:"session",default:{isAuthenticating:!0,user:null}});function $i(g,e){for(;!Object.prototype.hasOwnProperty.call(g,e)&&null!==(g=oI(g)););return g}function gr(){return gr="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(g,e,I){var t=$i(g,e);if(t){var n=Object.getOwnPropertyDescriptor(t,e);return n.get?n.get.call(arguments.length<3?g:I):n.value}},gr.apply(this,arguments)}var er=function(g){for(var e=[],I=0,t=0;t<g.length;t++){var n=g.charCodeAt(t);n<128?e[I++]=n:n<2048?(e[I++]=n>>6|192,e[I++]=63&n|128):55296===(64512&n)&&t+1<g.length&&56320===(64512&g.charCodeAt(t+1))?(n=65536+((1023&n)<<10)+(1023&g.charCodeAt(++t)),e[I++]=n>>18|240,e[I++]=n>>12&63|128,e[I++]=n>>6&63|128,e[I++]=63&n|128):(e[I++]=n>>12|224,e[I++]=n>>6&63|128,e[I++]=63&n|128)}return e},Ir={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray:function(g,e){if(!Array.isArray(g))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var I=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,t=[],n=0;n<g.length;n+=3){var C=g[n],l=n+1<g.length,o=l?g[n+1]:0,a=n+2<g.length,i=a?g[n+2]:0,r=C>>2,c=(3&C)<<4|o>>4,A=(15&o)<<2|i>>6,u=63&i;a||(u=64,l||(A=64)),t.push(I[r],I[c],I[A],I[u])}return t.join("")},encodeString:function(g,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(g):this.encodeByteArray(er(g),e)},decodeString:function(g,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(g):function(g){for(var e=[],I=0,t=0;I<g.length;){var n=g[I++];if(n<128)e[t++]=String.fromCharCode(n);else if(n>191&&n<224){var C=g[I++];e[t++]=String.fromCharCode((31&n)<<6|63&C)}else if(n>239&&n<365){var l=((7&n)<<18|(63&g[I++])<<12|(63&g[I++])<<6|63&g[I++])-65536;e[t++]=String.fromCharCode(55296+(l>>10)),e[t++]=String.fromCharCode(56320+(1023&l))}else{var o=g[I++],a=g[I++];e[t++]=String.fromCharCode((15&n)<<12|(63&o)<<6|63&a)}}return e.join("")}(this.decodeStringToByteArray(g,e))},decodeStringToByteArray:function(g,e){this.init_();for(var I=e?this.charToByteMapWebSafe_:this.charToByteMap_,t=[],n=0;n<g.length;){var C=I[g.charAt(n++)],l=n<g.length?I[g.charAt(n)]:0,o=++n<g.length?I[g.charAt(n)]:64,a=++n<g.length?I[g.charAt(n)]:64;if(++n,null==C||null==l||null==o||null==a)throw Error();var i=C<<2|l>>4;if(t.push(i),64!==o){var r=l<<4&240|o>>2;if(t.push(r),64!==a){var c=o<<6&192|a;t.push(c)}}}return t},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var g=0;g<this.ENCODED_VALS.length;g++)this.byteToCharMap_[g]=this.ENCODED_VALS.charAt(g),this.charToByteMap_[this.byteToCharMap_[g]]=g,this.byteToCharMapWebSafe_[g]=this.ENCODED_VALS_WEBSAFE.charAt(g),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[g]]=g,g>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(g)]=g,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(g)]=g)}}},tr=function(g){try{return Ir.decodeString(g,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};var nr=function(){function g(){var e=this;mI(this,g),this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(g,I){e.resolve=g,e.reject=I}))}return GI(g,[{key:"wrapCallback",value:function(g){var e=this;return function(I,t){I?e.reject(I):e.resolve(t),"function"===typeof g&&(e.promise.catch((function(){})),1===g.length?g(I):g(I,t))}}}]),g}();function Cr(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}var lr=function(g){sI(I,g);var e=bI(I);function I(g,t,n){var C;return mI(this,I),(C=e.call(this,t)).code=g,C.customData=n,C.name="FirebaseError",Object.setPrototypeOf(Hg(C),I.prototype),Error.captureStackTrace&&Error.captureStackTrace(Hg(C),or.prototype.create),C}return GI(I)}(rI(Error)),or=function(){function g(e,I,t){mI(this,g),this.service=e,this.serviceName=I,this.errors=t}return GI(g,[{key:"create",value:function(g){var e=(arguments.length<=1?void 0:arguments[1])||{},I="".concat(this.service,"/").concat(g),t=this.errors[g],n=t?ar(t,e):"Error",C="".concat(this.serviceName,": ").concat(n," (").concat(I,")."),l=new lr(I,C,e);return l}}]),g}();function ar(g,e){return g.replace(ir,(function(g,I){var t=e[I];return null!=t?String(t):"<".concat(I,"?>")}))}var ir=/\{\$([^}]+)}/g;function rr(g,e){if(g===e)return!0;for(var I=Object.keys(g),t=Object.keys(e),n=0,C=I;n<C.length;n++){var l=C[n];if(!t.includes(l))return!1;var o=g[l],a=e[l];if(cr(o)&&cr(a)){if(!rr(o,a))return!1}else if(o!==a)return!1}for(var i=0,r=t;i<r.length;i++){var c=r[i];if(!I.includes(c))return!1}return!0}function cr(g){return null!==g&&"object"===typeof g}function Ar(g){for(var e=[],I=function(){var g=(0,n.Z)(C[t],2),I=g[0],l=g[1];Array.isArray(l)?l.forEach((function(g){e.push(encodeURIComponent(I)+"="+encodeURIComponent(g))})):e.push(encodeURIComponent(I)+"="+encodeURIComponent(l))},t=0,C=Object.entries(g);t<C.length;t++)I();return e.length?"&"+e.join("&"):""}function ur(g){var e={};return g.replace(/^\?/,"").split("&").forEach((function(g){if(g){var I=g.split("="),t=(0,n.Z)(I,2),C=t[0],l=t[1];e[decodeURIComponent(C)]=decodeURIComponent(l)}})),e}function sr(g){var e=g.indexOf("?");if(!e)return"";var I=g.indexOf("#",e);return g.substring(e,I>0?I:void 0)}var dr=function(){function g(e,I){var t=this;mI(this,g),this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=I,this.task.then((function(){e(t)})).catch((function(g){t.error(g)}))}return GI(g,[{key:"next",value:function(g){this.forEachObserver((function(e){e.next(g)}))}},{key:"error",value:function(g){this.forEachObserver((function(e){e.error(g)})),this.close(g)}},{key:"complete",value:function(){this.forEachObserver((function(g){g.complete()})),this.close()}},{key:"subscribe",value:function(g,e,I){var t,n=this;if(void 0===g&&void 0===e&&void 0===I)throw new Error("Missing Observer.");t=function(g,e){if("object"!==typeof g||null===g)return!1;var I,t=cI(e);try{for(t.s();!(I=t.n()).done;){var n=I.value;if(n in g&&"function"===typeof g[n])return!0}}catch(C){t.e(C)}finally{t.f()}return!1}(g,["next","error","complete"])?g:{next:g,error:e,complete:I},void 0===t.next&&(t.next=Zr),void 0===t.error&&(t.error=Zr),void 0===t.complete&&(t.complete=Zr);var C=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{n.finalError?t.error(n.finalError):t.complete()}catch(g){}})),this.observers.push(t),C}},{key:"unsubscribeOne",value:function(g){void 0!==this.observers&&void 0!==this.observers[g]&&(delete this.observers[g],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}},{key:"forEachObserver",value:function(g){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,g)}},{key:"sendOne",value:function(g,e){var I=this;this.task.then((function(){if(void 0!==I.observers&&void 0!==I.observers[g])try{e(I.observers[g])}catch(t){"undefined"!==typeof console&&console.error&&console.error(t)}}))}},{key:"close",value:function(g){var e=this;this.finalized||(this.finalized=!0,void 0!==g&&(this.finalError=g),this.task.then((function(){e.observers=void 0,e.onNoObservers=void 0})))}}]),g}();function Zr(){}function br(g){return g&&g._delegate?g._delegate:g}var mr=function(){function g(e,I,t){mI(this,g),this.name=e,this.instanceFactory=I,this.type=t,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return GI(g,[{key:"setInstantiationMode",value:function(g){return this.instantiationMode=g,this}},{key:"setMultipleInstances",value:function(g){return this.multipleInstances=g,this}},{key:"setServiceProps",value:function(g){return this.serviceProps=g,this}},{key:"setInstanceCreatedCallback",value:function(g){return this.onInstanceCreated=g,this}}]),g}(),hr="[DEFAULT]",Gr=function(){function g(e,I){mI(this,g),this.name=e,this.container=I,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return GI(g,[{key:"get",value:function(g){var e=this.normalizeInstanceIdentifier(g);if(!this.instancesDeferred.has(e)){var I=new nr;if(this.instancesDeferred.set(e,I),this.isInitialized(e)||this.shouldAutoInitialize())try{var t=this.getOrInitializeService({instanceIdentifier:e});t&&I.resolve(t)}catch(n){}}return this.instancesDeferred.get(e).promise}},{key:"getImmediate",value:function(g){var e,I=this.normalizeInstanceIdentifier(null===g||void 0===g?void 0:g.identifier),t=null!==(e=null===g||void 0===g?void 0:g.optional)&&void 0!==e&&e;if(!this.isInitialized(I)&&!this.shouldAutoInitialize()){if(t)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:I})}catch(n){if(t)return null;throw n}}},{key:"getComponent",value:function(){return this.component}},{key:"setComponent",value:function(g){if(g.name!==this.name)throw Error("Mismatching Component ".concat(g.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=g,this.shouldAutoInitialize()){if(function(g){return"EAGER"===g.instantiationMode}(g))try{this.getOrInitializeService({instanceIdentifier:hr})}catch(i){}var e,I=cI(this.instancesDeferred.entries());try{for(I.s();!(e=I.n()).done;){var t=(0,n.Z)(e.value,2),C=t[0],l=t[1],o=this.normalizeInstanceIdentifier(C);try{var a=this.getOrInitializeService({instanceIdentifier:o});l.resolve(a)}catch(i){}}}catch(r){I.e(r)}finally{I.f()}}}},{key:"clearInstance",value:function(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:hr;this.instancesDeferred.delete(g),this.instancesOptions.delete(g),this.instances.delete(g)}},{key:"delete",value:function(){var g=lI(pI.mark((function g(){var e;return pI.wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return e=Array.from(this.instances.values()),g.next=3,Promise.all([].concat((0,L.Z)(e.filter((function(g){return"INTERNAL"in g})).map((function(g){return g.INTERNAL.delete()}))),(0,L.Z)(e.filter((function(g){return"_delete"in g})).map((function(g){return g._delete()})))));case 3:case"end":return g.stop()}}),g,this)})));return function(){return g.apply(this,arguments)}}()},{key:"isComponentSet",value:function(){return null!=this.component}},{key:"isInitialized",value:function(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:hr;return this.instances.has(g)}},{key:"getOptions",value:function(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:hr;return this.instancesOptions.get(g)||{}}},{key:"initialize",value:function(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=g.options,I=void 0===e?{}:e,t=this.normalizeInstanceIdentifier(g.instanceIdentifier);if(this.isInitialized(t))throw Error("".concat(this.name,"(").concat(t,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));var C,l=this.getOrInitializeService({instanceIdentifier:t,options:I}),o=cI(this.instancesDeferred.entries());try{for(o.s();!(C=o.n()).done;){var a=(0,n.Z)(C.value,2),i=a[0],r=a[1],c=this.normalizeInstanceIdentifier(i);t===c&&r.resolve(l)}}catch(A){o.e(A)}finally{o.f()}return l}},{key:"onInit",value:function(g,e){var I,t=this.normalizeInstanceIdentifier(e),n=null!==(I=this.onInitCallbacks.get(t))&&void 0!==I?I:new Set;n.add(g),this.onInitCallbacks.set(t,n);var C=this.instances.get(t);return C&&g(C,t),function(){n.delete(g)}}},{key:"invokeOnInitCallbacks",value:function(g,e){var I=this.onInitCallbacks.get(e);if(I){var t,n=cI(I);try{for(n.s();!(t=n.n()).done;){var C=t.value;try{C(g,e)}catch(By){}}}catch(l){n.e(l)}finally{n.f()}}}},{key:"getOrInitializeService",value:function(g){var e,I=g.instanceIdentifier,t=g.options,n=void 0===t?{}:t,C=this.instances.get(I);if(!C&&this.component&&(C=this.component.instanceFactory(this.container,{instanceIdentifier:(e=I,e===hr?void 0:e),options:n}),this.instances.set(I,C),this.instancesOptions.set(I,n),this.invokeOnInitCallbacks(C,I),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,I,C)}catch(By){}return C||null}},{key:"normalizeInstanceIdentifier",value:function(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:hr;return this.component?this.component.multipleInstances?g:hr:g}},{key:"shouldAutoInitialize",value:function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}]),g}();var pr,yr,Br=function(){function g(e){mI(this,g),this.name=e,this.providers=new Map}return GI(g,[{key:"addComponent",value:function(g){var e=this.getProvider(g.name);if(e.isComponentSet())throw new Error("Component ".concat(g.name," has already been registered with ").concat(this.name));e.setComponent(g)}},{key:"addOrOverwriteComponent",value:function(g){this.getProvider(g.name).isComponentSet()&&this.providers.delete(g.name),this.addComponent(g)}},{key:"getProvider",value:function(g){if(this.providers.has(g))return this.providers.get(g);var e=new Gr(g,this);return this.providers.set(g,e),e}},{key:"getProviders",value:function(){return Array.from(this.providers.values())}}]),g}(),vr=[];!function(g){g[g.DEBUG=0]="DEBUG",g[g.VERBOSE=1]="VERBOSE",g[g.INFO=2]="INFO",g[g.WARN=3]="WARN",g[g.ERROR=4]="ERROR",g[g.SILENT=5]="SILENT"}(yr||(yr={}));var Vr,Wr,Sr={debug:yr.DEBUG,verbose:yr.VERBOSE,info:yr.INFO,warn:yr.WARN,error:yr.ERROR,silent:yr.SILENT},fr=yr.INFO,kr=(pr={},(0,vg.Z)(pr,yr.DEBUG,"log"),(0,vg.Z)(pr,yr.VERBOSE,"log"),(0,vg.Z)(pr,yr.INFO,"info"),(0,vg.Z)(pr,yr.WARN,"warn"),(0,vg.Z)(pr,yr.ERROR,"error"),pr),Rr=function(g,e){if(!(e<g.logLevel)){var I=(new Date).toISOString(),t=kr[e];if(!t)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(e,")"));for(var n,C=arguments.length,l=new Array(C>2?C-2:0),o=2;o<C;o++)l[o-2]=arguments[o];(n=console)[t].apply(n,["[".concat(I,"]  ").concat(g.name,":")].concat(l))}},Xr=function(){function g(e){mI(this,g),this.name=e,this._logLevel=fr,this._logHandler=Rr,this._userLogHandler=null,vr.push(this)}return GI(g,[{key:"logLevel",get:function(){return this._logLevel},set:function(g){if(!(g in yr))throw new TypeError('Invalid value "'.concat(g,'" assigned to `logLevel`'));this._logLevel=g}},{key:"setLogLevel",value:function(g){this._logLevel="string"===typeof g?Sr[g]:g}},{key:"logHandler",get:function(){return this._logHandler},set:function(g){if("function"!==typeof g)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=g}},{key:"userLogHandler",get:function(){return this._userLogHandler},set:function(g){this._userLogHandler=g}},{key:"debug",value:function(){for(var g=arguments.length,e=new Array(g),I=0;I<g;I++)e[I]=arguments[I];this._userLogHandler&&this._userLogHandler.apply(this,[this,yr.DEBUG].concat(e)),this._logHandler.apply(this,[this,yr.DEBUG].concat(e))}},{key:"log",value:function(){for(var g=arguments.length,e=new Array(g),I=0;I<g;I++)e[I]=arguments[I];this._userLogHandler&&this._userLogHandler.apply(this,[this,yr.VERBOSE].concat(e)),this._logHandler.apply(this,[this,yr.VERBOSE].concat(e))}},{key:"info",value:function(){for(var g=arguments.length,e=new Array(g),I=0;I<g;I++)e[I]=arguments[I];this._userLogHandler&&this._userLogHandler.apply(this,[this,yr.INFO].concat(e)),this._logHandler.apply(this,[this,yr.INFO].concat(e))}},{key:"warn",value:function(){for(var g=arguments.length,e=new Array(g),I=0;I<g;I++)e[I]=arguments[I];this._userLogHandler&&this._userLogHandler.apply(this,[this,yr.WARN].concat(e)),this._logHandler.apply(this,[this,yr.WARN].concat(e))}},{key:"error",value:function(){for(var g=arguments.length,e=new Array(g),I=0;I<g;I++)e[I]=arguments[I];this._userLogHandler&&this._userLogHandler.apply(this,[this,yr.ERROR].concat(e)),this._logHandler.apply(this,[this,yr.ERROR].concat(e))}}]),g}();var Jr=function(){function g(e){mI(this,g),this.container=e}return GI(g,[{key:"getPlatformInfoString",value:function(){return this.container.getProviders().map((function(g){if(function(g){var e=g.getComponent();return"VERSION"===(null===e||void 0===e?void 0:e.type)}(g)){var e=g.getImmediate();return"".concat(e.library,"/").concat(e.version)}return null})).filter((function(g){return g})).join(" ")}}]),g}();var Yr="@firebase/app",Hr="0.7.13",wr=new Xr("@firebase/app"),Nr="[DEFAULT]",Kr=(Vr={},(0,vg.Z)(Vr,Yr,"fire-core"),(0,vg.Z)(Vr,"@firebase/app-compat","fire-core-compat"),(0,vg.Z)(Vr,"@firebase/analytics","fire-analytics"),(0,vg.Z)(Vr,"@firebase/analytics-compat","fire-analytics-compat"),(0,vg.Z)(Vr,"@firebase/app-check","fire-app-check"),(0,vg.Z)(Vr,"@firebase/app-check-compat","fire-app-check-compat"),(0,vg.Z)(Vr,"@firebase/auth","fire-auth"),(0,vg.Z)(Vr,"@firebase/auth-compat","fire-auth-compat"),(0,vg.Z)(Vr,"@firebase/database","fire-rtdb"),(0,vg.Z)(Vr,"@firebase/database-compat","fire-rtdb-compat"),(0,vg.Z)(Vr,"@firebase/functions","fire-fn"),(0,vg.Z)(Vr,"@firebase/functions-compat","fire-fn-compat"),(0,vg.Z)(Vr,"@firebase/installations","fire-iid"),(0,vg.Z)(Vr,"@firebase/installations-compat","fire-iid-compat"),(0,vg.Z)(Vr,"@firebase/messaging","fire-fcm"),(0,vg.Z)(Vr,"@firebase/messaging-compat","fire-fcm-compat"),(0,vg.Z)(Vr,"@firebase/performance","fire-perf"),(0,vg.Z)(Vr,"@firebase/performance-compat","fire-perf-compat"),(0,vg.Z)(Vr,"@firebase/remote-config","fire-rc"),(0,vg.Z)(Vr,"@firebase/remote-config-compat","fire-rc-compat"),(0,vg.Z)(Vr,"@firebase/storage","fire-gcs"),(0,vg.Z)(Vr,"@firebase/storage-compat","fire-gcs-compat"),(0,vg.Z)(Vr,"@firebase/firestore","fire-fst"),(0,vg.Z)(Vr,"@firebase/firestore-compat","fire-fst-compat"),(0,vg.Z)(Vr,"fire-js","fire-js"),(0,vg.Z)(Vr,"firebase","fire-js-all"),Vr),Fr=new Map,Er=new Map;function xr(g,e){try{g.container.addComponent(e)}catch(I){wr.debug("Component ".concat(e.name," failed to register with FirebaseApp ").concat(g.name),I)}}function zr(g){var e=g.name;if(Er.has(e))return wr.debug("There were multiple attempts to register component ".concat(e,".")),!1;Er.set(e,g);var I,t=cI(Fr.values());try{for(t.s();!(I=t.n()).done;){xr(I.value,g)}}catch(n){t.e(n)}finally{t.f()}return!0}function Ur(g,e){return g.container.getProvider(e)}var Mr,Lr=(Wr={},(0,vg.Z)(Wr,"no-app","No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()"),(0,vg.Z)(Wr,"bad-app-name","Illegal App name: '{$appName}"),(0,vg.Z)(Wr,"duplicate-app","Firebase App named '{$appName}' already exists with different options or config"),(0,vg.Z)(Wr,"app-deleted","Firebase App named '{$appName}' already deleted"),(0,vg.Z)(Wr,"invalid-app-argument","firebase.{$appName}() takes either no argument or a Firebase App instance."),(0,vg.Z)(Wr,"invalid-log-argument","First argument to `onLog` must be null or a function."),Wr),Tr=new or("app","Firebase",Lr),Qr=function(){function g(e,I,t){var n=this;mI(this,g),this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},I),this._name=I.name,this._automaticDataCollectionEnabled=I.automaticDataCollectionEnabled,this._container=t,this.container.addComponent(new mr("app",(function(){return n}),"PUBLIC"))}return GI(g,[{key:"automaticDataCollectionEnabled",get:function(){return this.checkDestroyed(),this._automaticDataCollectionEnabled},set:function(g){this.checkDestroyed(),this._automaticDataCollectionEnabled=g}},{key:"name",get:function(){return this.checkDestroyed(),this._name}},{key:"options",get:function(){return this.checkDestroyed(),this._options}},{key:"config",get:function(){return this.checkDestroyed(),this._config}},{key:"container",get:function(){return this._container}},{key:"isDeleted",get:function(){return this._isDeleted},set:function(g){this._isDeleted=g}},{key:"checkDestroyed",value:function(){if(this.isDeleted)throw Tr.create("app-deleted",{appName:this._name})}}]),g}(),Dr="9.6.3";function jr(g){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("object"!==typeof e){var I=e;e={name:I}}var t=Object.assign({name:Nr,automaticDataCollectionEnabled:!1},e),n=t.name;if("string"!==typeof n||!n)throw Tr.create("bad-app-name",{appName:String(n)});var C=Fr.get(n);if(C){if(rr(g,C.options)&&rr(t,C.config))return C;throw Tr.create("duplicate-app",{appName:n})}var l,o=new Br(n),a=cI(Er.values());try{for(a.s();!(l=a.n()).done;){var i=l.value;o.addComponent(i)}}catch(c){a.e(c)}finally{a.f()}var r=new Qr(g,t,o);return Fr.set(n,r),r}function Pr(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Nr,e=Fr.get(g);if(!e)throw Tr.create("no-app",{appName:g});return e}function Or(g,e,I){var t,n=null!==(t=Kr[g])&&void 0!==t?t:g;I&&(n+="-".concat(I));var C=n.match(/\s|\//),l=e.match(/\s|\//);if(C||l){var o=['Unable to register library "'.concat(n,'" with version "').concat(e,'":')];return C&&o.push('library name "'.concat(n,'" contains illegal characters (whitespace or "/")')),C&&l&&o.push("and"),l&&o.push('version name "'.concat(e,'" contains illegal characters (whitespace or "/")')),void wr.warn(o.join(" "))}zr(new mr("".concat(n,"-version"),(function(){return{library:n,version:e}}),"VERSION"))}Mr="",zr(new mr("platform-logger",(function(g){return new Jr(g)}),"PRIVATE")),Or(Yr,Hr,Mr),Or(Yr,Hr,"esm2017"),Or("fire-js","");function _r(g,e){var I={};for(var t in g)Object.prototype.hasOwnProperty.call(g,t)&&e.indexOf(t)<0&&(I[t]=g[t]);if(null!=g&&"function"===typeof Object.getOwnPropertySymbols){var n=0;for(t=Object.getOwnPropertySymbols(g);n<t.length;n++)e.indexOf(t[n])<0&&Object.prototype.propertyIsEnumerable.call(g,t[n])&&(I[t[n]]=g[t[n]])}return I}Object.create;var qr;Object.create;function $r(){return(0,vg.Z)({},"dependent-sdk-initialized-before-auth","Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.")}var gc=$r,ec=new or("auth","Firebase",$r()),Ic=new Xr("@firebase/auth");function tc(g){if(Ic.logLevel<=yr.ERROR){for(var e=arguments.length,I=new Array(e>1?e-1:0),t=1;t<e;t++)I[t-1]=arguments[t];Ic.error.apply(Ic,["Auth (".concat(Dr,"): ").concat(g)].concat(I))}}function nc(g){for(var e=arguments.length,I=new Array(e>1?e-1:0),t=1;t<e;t++)I[t-1]=arguments[t];throw oc.apply(void 0,[g].concat(I))}function Cc(g){for(var e=arguments.length,I=new Array(e>1?e-1:0),t=1;t<e;t++)I[t-1]=arguments[t];return oc.apply(void 0,[g].concat(I))}function lc(g,e,I){var t=Object.assign(Object.assign({},gc()),(0,vg.Z)({},e,I));return new or("auth","Firebase",t).create(e,{appName:g.name})}function oc(g){for(var e=arguments.length,I=new Array(e>1?e-1:0),t=1;t<e;t++)I[t-1]=arguments[t];if("string"!==typeof g){var n,C=I[0],l=(0,L.Z)(I.slice(1));return l[0]&&(l[0].appName=g.name),(n=g._errorFactory).create.apply(n,[C].concat((0,L.Z)(l)))}return ec.create.apply(ec,[g].concat(I))}function ac(g,e){if(!g){for(var I=arguments.length,t=new Array(I>2?I-2:0),n=2;n<I;n++)t[n-2]=arguments[n];throw oc.apply(void 0,[e].concat(t))}}function ic(g){var e="INTERNAL ASSERTION FAILED: "+g;throw tc(e),new Error(e)}function rc(g,e){g||ic(e)}var cc=new Map;function Ac(g){rc(g instanceof Function,"Expected a class definition");var e=cc.get(g);return e?(rc(e instanceof g,"Instance stored in cache mismatched with class"),e):(e=new g,cc.set(g,e),e)}function uc(g,e){var I=Ur(g,"auth");if(I.isInitialized()){var t=I.getImmediate();if(rr(I.getOptions(),null!==e&&void 0!==e?e:{}))return t;nc(t,"already-initialized")}return I.initialize({options:e})}function sc(){var g;return"undefined"!==typeof self&&(null===(g=self.location)||void 0===g?void 0:g.href)||""}function dc(){return"http:"===Zc()||"https:"===Zc()}function Zc(){var g;return"undefined"!==typeof self&&(null===(g=self.location)||void 0===g?void 0:g.protocol)||null}function bc(){return!("undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(dc()||function(){var g="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof g&&void 0!==g.id}()||"connection"in navigator))||navigator.onLine}var mc=function(){function g(e,I){mI(this,g),this.shortDelay=e,this.longDelay=I,rc(I>e,"Short delay should be less than long delay!"),this.isMobile="undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Cr())||"object"===typeof navigator&&"ReactNative"===navigator.product}return GI(g,[{key:"get",value:function(){return bc()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}]),g}();function hc(g,e){rc(g.emulator,"Emulator should always be set here");var I=g.emulator.url;return e?"".concat(I).concat(e.startsWith("/")?e.slice(1):e):I}var Gc=function(){function g(){mI(this,g)}return GI(g,null,[{key:"initialize",value:function(g,e,I){this.fetchImpl=g,e&&(this.headersImpl=e),I&&(this.responseImpl=I)}},{key:"fetch",value:function(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:void ic("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}},{key:"headers",value:function(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:void ic("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}},{key:"response",value:function(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:void ic("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}]),g}(),pc=(qr={},(0,vg.Z)(qr,"CREDENTIAL_MISMATCH","custom-token-mismatch"),(0,vg.Z)(qr,"MISSING_CUSTOM_TOKEN","internal-error"),(0,vg.Z)(qr,"INVALID_IDENTIFIER","invalid-email"),(0,vg.Z)(qr,"MISSING_CONTINUE_URI","internal-error"),(0,vg.Z)(qr,"INVALID_PASSWORD","wrong-password"),(0,vg.Z)(qr,"MISSING_PASSWORD","internal-error"),(0,vg.Z)(qr,"EMAIL_EXISTS","email-already-in-use"),(0,vg.Z)(qr,"PASSWORD_LOGIN_DISABLED","operation-not-allowed"),(0,vg.Z)(qr,"INVALID_IDP_RESPONSE","invalid-credential"),(0,vg.Z)(qr,"INVALID_PENDING_TOKEN","invalid-credential"),(0,vg.Z)(qr,"FEDERATED_USER_ID_ALREADY_LINKED","credential-already-in-use"),(0,vg.Z)(qr,"MISSING_REQ_TYPE","internal-error"),(0,vg.Z)(qr,"EMAIL_NOT_FOUND","user-not-found"),(0,vg.Z)(qr,"RESET_PASSWORD_EXCEED_LIMIT","too-many-requests"),(0,vg.Z)(qr,"EXPIRED_OOB_CODE","expired-action-code"),(0,vg.Z)(qr,"INVALID_OOB_CODE","invalid-action-code"),(0,vg.Z)(qr,"MISSING_OOB_CODE","internal-error"),(0,vg.Z)(qr,"CREDENTIAL_TOO_OLD_LOGIN_AGAIN","requires-recent-login"),(0,vg.Z)(qr,"INVALID_ID_TOKEN","invalid-user-token"),(0,vg.Z)(qr,"TOKEN_EXPIRED","user-token-expired"),(0,vg.Z)(qr,"USER_NOT_FOUND","user-token-expired"),(0,vg.Z)(qr,"TOO_MANY_ATTEMPTS_TRY_LATER","too-many-requests"),(0,vg.Z)(qr,"INVALID_CODE","invalid-verification-code"),(0,vg.Z)(qr,"INVALID_SESSION_INFO","invalid-verification-id"),(0,vg.Z)(qr,"INVALID_TEMPORARY_PROOF","invalid-credential"),(0,vg.Z)(qr,"MISSING_SESSION_INFO","missing-verification-id"),(0,vg.Z)(qr,"SESSION_EXPIRED","code-expired"),(0,vg.Z)(qr,"MISSING_ANDROID_PACKAGE_NAME","missing-android-pkg-name"),(0,vg.Z)(qr,"UNAUTHORIZED_DOMAIN","unauthorized-continue-uri"),(0,vg.Z)(qr,"INVALID_OAUTH_CLIENT_ID","invalid-oauth-client-id"),(0,vg.Z)(qr,"ADMIN_ONLY_OPERATION","admin-restricted-operation"),(0,vg.Z)(qr,"INVALID_MFA_PENDING_CREDENTIAL","invalid-multi-factor-session"),(0,vg.Z)(qr,"MFA_ENROLLMENT_NOT_FOUND","multi-factor-info-not-found"),(0,vg.Z)(qr,"MISSING_MFA_ENROLLMENT_ID","missing-multi-factor-info"),(0,vg.Z)(qr,"MISSING_MFA_PENDING_CREDENTIAL","missing-multi-factor-session"),(0,vg.Z)(qr,"SECOND_FACTOR_EXISTS","second-factor-already-in-use"),(0,vg.Z)(qr,"SECOND_FACTOR_LIMIT_EXCEEDED","maximum-second-factor-count-exceeded"),(0,vg.Z)(qr,"BLOCKING_FUNCTION_ERROR_RESPONSE","internal-error"),qr),yc=new mc(3e4,6e4);function Bc(g,e){return g.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:g.tenantId}):e}function vc(g,e,I,t){return Vc.apply(this,arguments)}function Vc(){return Vc=lI(yI().mark((function g(e,I,t,n){var C,l=arguments;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return C=l.length>4&&void 0!==l[4]?l[4]:{},g.abrupt("return",Wc(e,C,lI(yI().mark((function g(){var C,l,o,a;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return C={},l={},n&&("GET"===I?l=n:C={body:JSON.stringify(n)}),o=Ar(Object.assign({key:e.config.apiKey},l)).slice(1),g.next=6,e._getAdditionalHeaders();case 6:return(a=g.sent)["Content-Type"]="application/json",e.languageCode&&(a["X-Firebase-Locale"]=e.languageCode),g.abrupt("return",Gc.fetch()(Rc(e,e.config.apiHost,t,o),Object.assign({method:I,headers:a,referrerPolicy:"no-referrer"},C)));case 10:case"end":return g.stop()}}),g)})))));case 2:case"end":return g.stop()}}),g)}))),Vc.apply(this,arguments)}function Wc(g,e,I){return Sc.apply(this,arguments)}function Sc(){return(Sc=lI(yI().mark((function g(e,I,t){var C,l,o,a,i,r,c,A,u,s;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return e._canInitEmulator=!1,C=Object.assign(Object.assign({},pc),I),g.prev=2,l=new Xc(e),g.next=6,Promise.race([t(),l.promise]);case 6:return o=g.sent,l.clearNetworkTimeout(),g.next=10,o.json();case 10:if(!("needConfirmation"in(a=g.sent))){g.next=13;break}throw Jc(e,"account-exists-with-different-credential",a);case 13:if(!o.ok||"errorMessage"in a){g.next=17;break}return g.abrupt("return",a);case 17:if(i=o.ok?a.errorMessage:a.error.message,r=i.split(" : "),c=(0,n.Z)(r,2),A=c[0],u=c[1],"FEDERATED_USER_ID_ALREADY_LINKED"!==A){g.next=23;break}throw Jc(e,"credential-already-in-use",a);case 23:if("EMAIL_EXISTS"!==A){g.next=25;break}throw Jc(e,"email-already-in-use",a);case 25:if(s=C[A]||A.toLowerCase().replace(/[_\s]+/g,"-"),!u){g.next=30;break}throw lc(e,s,u);case 30:nc(e,s);case 31:g.next=38;break;case 33:if(g.prev=33,g.t0=g.catch(2),!(g.t0 instanceof lr)){g.next=37;break}throw g.t0;case 37:nc(e,"network-request-failed");case 38:case"end":return g.stop()}}),g,null,[[2,33]])})))).apply(this,arguments)}function fc(g,e,I,t){return kc.apply(this,arguments)}function kc(){return kc=lI(yI().mark((function g(e,I,t,n){var C,l,o=arguments;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return C=o.length>4&&void 0!==o[4]?o[4]:{},g.next=3,vc(e,I,t,n,C);case 3:return"mfaPendingCredential"in(l=g.sent)&&nc(e,"multi-factor-auth-required",{_serverResponse:l}),g.abrupt("return",l);case 6:case"end":return g.stop()}}),g)}))),kc.apply(this,arguments)}function Rc(g,e,I,t){var n="".concat(e).concat(I,"?").concat(t);return g.config.emulator?hc(g.config,n):"".concat(g.config.apiScheme,"://").concat(n)}var Xc=function(){function g(e){var I=this;mI(this,g),this.auth=e,this.timer=null,this.promise=new Promise((function(g,e){I.timer=setTimeout((function(){return e(Cc(I.auth,"timeout"))}),yc.get())}))}return GI(g,[{key:"clearNetworkTimeout",value:function(){clearTimeout(this.timer)}}]),g}();function Jc(g,e,I){var t={appName:g.name};I.email&&(t.email=I.email),I.phoneNumber&&(t.phoneNumber=I.phoneNumber);var n=Cc(g,e,t);return n.customData._tokenResponse=I,n}function Yc(g,e){return Hc.apply(this,arguments)}function Hc(){return(Hc=lI(yI().mark((function g(e,I){return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.abrupt("return",vc(e,"POST","/v1/accounts:delete",I));case 1:case"end":return g.stop()}}),g)})))).apply(this,arguments)}function wc(g,e){return Nc.apply(this,arguments)}function Nc(){return(Nc=lI(yI().mark((function g(e,I){return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.abrupt("return",vc(e,"POST","/v1/accounts:lookup",I));case 1:case"end":return g.stop()}}),g)})))).apply(this,arguments)}function Kc(g){if(g)try{var e=new Date(Number(g));if(!isNaN(e.getTime()))return e.toUTCString()}catch(I){}}function Fc(){return Fc=lI(yI().mark((function g(e){var I,t,n,C,l,o,a=arguments;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return I=a.length>1&&void 0!==a[1]&&a[1],t=br(e),g.next=4,t.getIdToken(I);case 4:return n=g.sent,ac((C=xc(n))&&C.exp&&C.auth_time&&C.iat,t.auth,"internal-error"),l="object"===typeof C.firebase?C.firebase:void 0,o=null===l||void 0===l?void 0:l.sign_in_provider,g.abrupt("return",{claims:C,token:n,authTime:Kc(Ec(C.auth_time)),issuedAtTime:Kc(Ec(C.iat)),expirationTime:Kc(Ec(C.exp)),signInProvider:o||null,signInSecondFactor:(null===l||void 0===l?void 0:l.sign_in_second_factor)||null});case 10:case"end":return g.stop()}}),g)}))),Fc.apply(this,arguments)}function Ec(g){return 1e3*Number(g)}function xc(g){var e=g.split("."),I=(0,n.Z)(e,3),t=I[0],C=I[1],l=I[2];if(void 0===t||void 0===C||void 0===l)return tc("JWT malformed, contained fewer than 3 sections"),null;try{var o=tr(C);return o?JSON.parse(o):(tc("Failed to decode base64 JWT payload"),null)}catch(a){return tc("Caught error parsing JWT payload as JSON",a),null}}function zc(g,e){return Uc.apply(this,arguments)}function Uc(){return Uc=lI(yI().mark((function g(e,I){var t=arguments;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(!(t.length>2&&void 0!==t[2]&&t[2])){g.next=3;break}return g.abrupt("return",I);case 3:return g.prev=3,g.next=6,I;case 6:return g.abrupt("return",g.sent);case 9:if(g.prev=9,g.t0=g.catch(3),!(g.t0 instanceof lr&&Mc(g.t0))){g.next=15;break}if(e.auth.currentUser!==e){g.next=15;break}return g.next=15,e.auth.signOut();case 15:throw g.t0;case 16:case"end":return g.stop()}}),g,null,[[3,9]])}))),Uc.apply(this,arguments)}function Mc(g){var e=g.code;return e==="auth/".concat("user-disabled")||e==="auth/".concat("user-token-expired")}var Lc=function(){function g(e){mI(this,g),this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}return GI(g,[{key:"_start",value:function(){this.isRunning||(this.isRunning=!0,this.schedule())}},{key:"_stop",value:function(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}},{key:"getInterval",value:function(g){var e;if(g){var I=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),I}this.errorBackoff=3e4;var t=(null!==(e=this.user.stsTokenManager.expirationTime)&&void 0!==e?e:0)-Date.now()-3e5;return Math.max(0,t)}},{key:"schedule",value:function(){var g=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isRunning){var I=this.getInterval(e);this.timerId=setTimeout(lI(yI().mark((function e(){return yI().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.iteration();case 2:case"end":return e.stop()}}),e)}))),I)}}},{key:"iteration",value:function(){var g=lI(yI().mark((function g(){return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.prev=0,g.next=3,this.user.getIdToken(!0);case 3:g.next=9;break;case 5:return g.prev=5,g.t0=g.catch(0),g.t0.code==="auth/".concat("network-request-failed")&&this.schedule(!0),g.abrupt("return");case 9:this.schedule();case 10:case"end":return g.stop()}}),g,this,[[0,5]])})));return function(){return g.apply(this,arguments)}}()}]),g}(),Tc=function(){function g(e,I){mI(this,g),this.createdAt=e,this.lastLoginAt=I,this._initializeTime()}return GI(g,[{key:"_initializeTime",value:function(){this.lastSignInTime=Kc(this.lastLoginAt),this.creationTime=Kc(this.createdAt)}},{key:"_copy",value:function(g){this.createdAt=g.createdAt,this.lastLoginAt=g.lastLoginAt,this._initializeTime()}},{key:"toJSON",value:function(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}]),g}();function Qc(g){return Dc.apply(this,arguments)}function Dc(){return Dc=lI(yI().mark((function g(e){var I,t,n,C,l,o,a,i,r,c,A;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return t=e.auth,g.next=3,e.getIdToken();case 3:return n=g.sent,g.next=6,zc(e,wc(t,{idToken:n}));case 6:ac(null===(C=g.sent)||void 0===C?void 0:C.users.length,t,"internal-error"),l=C.users[0],e._notifyReloadListener(l),o=(null===(I=l.providerUserInfo)||void 0===I?void 0:I.length)?Oc(l.providerUserInfo):[],a=Pc(e.providerData,o),i=e.isAnonymous,r=!(e.email&&l.passwordHash)&&!(null===a||void 0===a?void 0:a.length),c=!!i&&r,A={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:a,metadata:new Tc(l.createdAt,l.lastLoginAt),isAnonymous:c},Object.assign(e,A);case 17:case"end":return g.stop()}}),g)}))),Dc.apply(this,arguments)}function jc(){return(jc=lI(yI().mark((function g(e){var I;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return I=br(e),g.next=3,Qc(I);case 3:return g.next=5,I.auth._persistUserIfCurrent(I);case 5:I.auth._notifyListenersIfCurrent(I);case 6:case"end":return g.stop()}}),g)})))).apply(this,arguments)}function Pc(g,e){var I=g.filter((function(g){return!e.some((function(e){return e.providerId===g.providerId}))}));return[].concat((0,L.Z)(I),(0,L.Z)(e))}function Oc(g){return g.map((function(g){var e=g.providerId,I=_r(g,["providerId"]);return{providerId:e,uid:I.rawId||"",displayName:I.displayName||null,email:I.email||null,phoneNumber:I.phoneNumber||null,photoURL:I.photoUrl||null}}))}function _c(g,e){return qc.apply(this,arguments)}function qc(){return qc=lI(yI().mark((function g(e,I){var t;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,Wc(e,{},lI(yI().mark((function g(){var t,n,C,l,o,a;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return t=Ar({grant_type:"refresh_token",refresh_token:I}).slice(1),n=e.config,C=n.tokenApiHost,l=n.apiKey,o=Rc(e,C,"/v1/token","key=".concat(l)),g.next=5,e._getAdditionalHeaders();case 5:return(a=g.sent)["Content-Type"]="application/x-www-form-urlencoded",g.abrupt("return",Gc.fetch()(o,{method:"POST",headers:a,body:t}));case 8:case"end":return g.stop()}}),g)}))));case 2:return t=g.sent,g.abrupt("return",{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token});case 4:case"end":return g.stop()}}),g)}))),qc.apply(this,arguments)}var $c=function(){function g(){mI(this,g),this.refreshToken=null,this.accessToken=null,this.expirationTime=null}return GI(g,[{key:"isExpired",get:function(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}},{key:"updateFromServerResponse",value:function(g){ac(g.idToken,"internal-error"),ac("undefined"!==typeof g.idToken,"internal-error"),ac("undefined"!==typeof g.refreshToken,"internal-error");var e="expiresIn"in g&&"undefined"!==typeof g.expiresIn?Number(g.expiresIn):function(g){var e=xc(g);return ac(e,"internal-error"),ac("undefined"!==typeof e.exp,"internal-error"),ac("undefined"!==typeof e.iat,"internal-error"),Number(e.exp)-Number(e.iat)}(g.idToken);this.updateTokensAndExpiration(g.idToken,g.refreshToken,e)}},{key:"getToken",value:function(){var g=lI(yI().mark((function g(e){var I,t=arguments;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(I=t.length>1&&void 0!==t[1]&&t[1],ac(!this.accessToken||this.refreshToken,e,"user-token-expired"),I||!this.accessToken||this.isExpired){g.next=4;break}return g.abrupt("return",this.accessToken);case 4:if(!this.refreshToken){g.next=8;break}return g.next=7,this.refresh(e,this.refreshToken);case 7:return g.abrupt("return",this.accessToken);case 8:return g.abrupt("return",null);case 9:case"end":return g.stop()}}),g,this)})));return function(e){return g.apply(this,arguments)}}()},{key:"clearRefreshToken",value:function(){this.refreshToken=null}},{key:"refresh",value:function(){var g=lI(yI().mark((function g(e,I){var t,n,C,l;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,_c(e,I);case 2:t=g.sent,n=t.accessToken,C=t.refreshToken,l=t.expiresIn,this.updateTokensAndExpiration(n,C,Number(l));case 7:case"end":return g.stop()}}),g,this)})));return function(e,I){return g.apply(this,arguments)}}()},{key:"updateTokensAndExpiration",value:function(g,e,I){this.refreshToken=e||null,this.accessToken=g||null,this.expirationTime=Date.now()+1e3*I}},{key:"toJSON",value:function(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}},{key:"_assign",value:function(g){this.accessToken=g.accessToken,this.refreshToken=g.refreshToken,this.expirationTime=g.expirationTime}},{key:"_clone",value:function(){return Object.assign(new g,this.toJSON())}},{key:"_performRefresh",value:function(){return ic("not implemented")}}],[{key:"fromJSON",value:function(e,I){var t=I.refreshToken,n=I.accessToken,C=I.expirationTime,l=new g;return t&&(ac("string"===typeof t,"internal-error",{appName:e}),l.refreshToken=t),n&&(ac("string"===typeof n,"internal-error",{appName:e}),l.accessToken=n),C&&(ac("number"===typeof C,"internal-error",{appName:e}),l.expirationTime=C),l}}]),g}();function gA(g,e){ac("string"===typeof g||"undefined"===typeof g,"internal-error",{appName:e})}var eA=function(){function g(e){mI(this,g);var I=e.uid,t=e.auth,n=e.stsTokenManager,C=_r(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.emailVerified=!1,this.isAnonymous=!1,this.tenantId=null,this.providerData=[],this.proactiveRefresh=new Lc(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=I,this.auth=t,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=C.displayName||null,this.email=C.email||null,this.emailVerified=C.emailVerified||!1,this.phoneNumber=C.phoneNumber||null,this.photoURL=C.photoURL||null,this.isAnonymous=C.isAnonymous||!1,this.tenantId=C.tenantId||null,this.metadata=new Tc(C.createdAt||void 0,C.lastLoginAt||void 0)}return GI(g,[{key:"getIdToken",value:function(){var g=lI(yI().mark((function g(e){var I;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,zc(this,this.stsTokenManager.getToken(this.auth,e));case 2:if(ac(I=g.sent,this.auth,"internal-error"),this.accessToken===I){g.next=9;break}return this.accessToken=I,g.next=8,this.auth._persistUserIfCurrent(this);case 8:this.auth._notifyListenersIfCurrent(this);case 9:return g.abrupt("return",I);case 10:case"end":return g.stop()}}),g,this)})));return function(e){return g.apply(this,arguments)}}()},{key:"getIdTokenResult",value:function(g){return function(g){return Fc.apply(this,arguments)}(this,g)}},{key:"reload",value:function(){return function(g){return jc.apply(this,arguments)}(this)}},{key:"_assign",value:function(g){this!==g&&(ac(this.uid===g.uid,this.auth,"internal-error"),this.displayName=g.displayName,this.photoURL=g.photoURL,this.email=g.email,this.emailVerified=g.emailVerified,this.phoneNumber=g.phoneNumber,this.isAnonymous=g.isAnonymous,this.tenantId=g.tenantId,this.providerData=g.providerData.map((function(g){return Object.assign({},g)})),this.metadata._copy(g.metadata),this.stsTokenManager._assign(g.stsTokenManager))}},{key:"_clone",value:function(e){return new g(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}))}},{key:"_onReload",value:function(g){ac(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=g,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}},{key:"_notifyReloadListener",value:function(g){this.reloadListener?this.reloadListener(g):this.reloadUserInfo=g}},{key:"_startProactiveRefresh",value:function(){this.proactiveRefresh._start()}},{key:"_stopProactiveRefresh",value:function(){this.proactiveRefresh._stop()}},{key:"_updateTokensIfNecessary",value:function(){var g=lI(yI().mark((function g(e){var I,t,n=arguments;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(I=n.length>1&&void 0!==n[1]&&n[1],t=!1,e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),t=!0),!I){g.next=6;break}return g.next=6,Qc(this);case 6:return g.next=8,this.auth._persistUserIfCurrent(this);case 8:t&&this.auth._notifyListenersIfCurrent(this);case 9:case"end":return g.stop()}}),g,this)})));return function(e){return g.apply(this,arguments)}}()},{key:"delete",value:function(){var g=lI(yI().mark((function g(){var e;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.getIdToken();case 2:return e=g.sent,g.next=5,zc(this,Yc(this.auth,{idToken:e}));case 5:return this.stsTokenManager.clearRefreshToken(),g.abrupt("return",this.auth.signOut());case 7:case"end":return g.stop()}}),g,this)})));return function(){return g.apply(this,arguments)}}()},{key:"toJSON",value:function(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((function(g){return Object.assign({},g)})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}},{key:"refreshToken",get:function(){return this.stsTokenManager.refreshToken||""}}],[{key:"_fromJSON",value:function(e,I){var t,n,C,l,o,a,i,r,c=null!==(t=I.displayName)&&void 0!==t?t:void 0,A=null!==(n=I.email)&&void 0!==n?n:void 0,u=null!==(C=I.phoneNumber)&&void 0!==C?C:void 0,s=null!==(l=I.photoURL)&&void 0!==l?l:void 0,d=null!==(o=I.tenantId)&&void 0!==o?o:void 0,Z=null!==(a=I._redirectEventId)&&void 0!==a?a:void 0,b=null!==(i=I.createdAt)&&void 0!==i?i:void 0,m=null!==(r=I.lastLoginAt)&&void 0!==r?r:void 0,h=I.uid,G=I.emailVerified,p=I.isAnonymous,y=I.providerData,B=I.stsTokenManager;ac(h&&B,e,"internal-error");var v=$c.fromJSON(this.name,B);ac("string"===typeof h,e,"internal-error"),gA(c,e.name),gA(A,e.name),ac("boolean"===typeof G,e,"internal-error"),ac("boolean"===typeof p,e,"internal-error"),gA(u,e.name),gA(s,e.name),gA(d,e.name),gA(Z,e.name),gA(b,e.name),gA(m,e.name);var V=new g({uid:h,auth:e,email:A,emailVerified:G,displayName:c,isAnonymous:p,photoURL:s,phoneNumber:u,tenantId:d,stsTokenManager:v,createdAt:b,lastLoginAt:m});return y&&Array.isArray(y)&&(V.providerData=y.map((function(g){return Object.assign({},g)}))),Z&&(V._redirectEventId=Z),V}},{key:"_fromIdTokenResponse",value:function(){var e=lI(yI().mark((function e(I,t){var n,C,l,o=arguments;return yI().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>2&&void 0!==o[2]&&o[2],(C=new $c).updateFromServerResponse(t),l=new g({uid:t.localId,auth:I,stsTokenManager:C,isAnonymous:n}),e.next=6,Qc(l);case 6:return e.abrupt("return",l);case 7:case"end":return e.stop()}}),e)})));return function(g,I){return e.apply(this,arguments)}}()}]),g}(),IA=function(){function g(){mI(this,g),this.type="NONE",this.storage={}}return GI(g,[{key:"_isAvailable",value:function(){var g=lI(yI().mark((function g(){return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.abrupt("return",!0);case 1:case"end":return g.stop()}}),g)})));return function(){return g.apply(this,arguments)}}()},{key:"_set",value:function(){var g=lI(yI().mark((function g(e,I){return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:this.storage[e]=I;case 1:case"end":return g.stop()}}),g,this)})));return function(e,I){return g.apply(this,arguments)}}()},{key:"_get",value:function(){var g=lI(yI().mark((function g(e){var I;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return I=this.storage[e],g.abrupt("return",void 0===I?null:I);case 2:case"end":return g.stop()}}),g,this)})));return function(e){return g.apply(this,arguments)}}()},{key:"_remove",value:function(){var g=lI(yI().mark((function g(e){return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:delete this.storage[e];case 1:case"end":return g.stop()}}),g,this)})));return function(e){return g.apply(this,arguments)}}()},{key:"_addListener",value:function(g,e){}},{key:"_removeListener",value:function(g,e){}}]),g}();IA.type="NONE";var tA=IA;function nA(g,e,I){return"firebase".concat(":",g,":").concat(e,":").concat(I)}var CA=function(){function g(e,I,t){mI(this,g),this.persistence=e,this.auth=I,this.userKey=t;var n=this.auth,C=n.config,l=n.name;this.fullUserKey=nA(this.userKey,C.apiKey,l),this.fullPersistenceKey=nA("persistence",C.apiKey,l),this.boundEventHandler=I._onStorageEvent.bind(I),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}return GI(g,[{key:"setCurrentUser",value:function(g){return this.persistence._set(this.fullUserKey,g.toJSON())}},{key:"getCurrentUser",value:function(){var g=lI(yI().mark((function g(){var e;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.persistence._get(this.fullUserKey);case 2:return e=g.sent,g.abrupt("return",e?eA._fromJSON(this.auth,e):null);case 4:case"end":return g.stop()}}),g,this)})));return function(){return g.apply(this,arguments)}}()},{key:"removeCurrentUser",value:function(){return this.persistence._remove(this.fullUserKey)}},{key:"savePersistenceForRedirect",value:function(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}},{key:"setPersistence",value:function(){var g=lI(yI().mark((function g(e){var I;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(this.persistence!==e){g.next=2;break}return g.abrupt("return");case 2:return g.next=4,this.getCurrentUser();case 4:return I=g.sent,g.next=7,this.removeCurrentUser();case 7:if(this.persistence=e,!I){g.next=10;break}return g.abrupt("return",this.setCurrentUser(I));case 10:case"end":return g.stop()}}),g,this)})));return function(e){return g.apply(this,arguments)}}()},{key:"delete",value:function(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}}],[{key:"create",value:function(){var e=lI(yI().mark((function e(I,t){var n,C,l,o,a,i,r,c,A,u,s,d=arguments;return yI().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=d.length>2&&void 0!==d[2]?d[2]:"authUser",t.length){e.next=3;break}return e.abrupt("return",new g(Ac(tA),I,n));case 3:return e.next=5,Promise.all(t.map(function(){var g=lI(yI().mark((function g(e){return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,e._isAvailable();case 2:if(!g.sent){g.next=4;break}return g.abrupt("return",e);case 4:return g.abrupt("return",void 0);case 5:case"end":return g.stop()}}),g)})));return function(e){return g.apply(this,arguments)}}()));case 5:C=e.sent.filter((function(g){return g})),l=C[0]||Ac(tA),o=nA(n,I.config.apiKey,I.name),a=null,i=cI(t),e.prev=10,i.s();case 12:if((r=i.n()).done){e.next=29;break}return c=r.value,e.prev=14,e.next=17,c._get(o);case 17:if(!(A=e.sent)){e.next=23;break}return u=eA._fromJSON(I,A),c!==l&&(a=u),l=c,e.abrupt("break",29);case 23:e.next=27;break;case 25:e.prev=25,e.t0=e.catch(14);case 27:e.next=12;break;case 29:e.next=34;break;case 31:e.prev=31,e.t1=e.catch(10),i.e(e.t1);case 34:return e.prev=34,i.f(),e.finish(34);case 37:if(s=C.filter((function(g){return g._shouldAllowMigration})),l._shouldAllowMigration&&s.length){e.next=40;break}return e.abrupt("return",new g(l,I,n));case 40:if(l=s[0],!a){e.next=44;break}return e.next=44,l._set(o,a.toJSON());case 44:return e.next=46,Promise.all(t.map(function(){var g=lI(yI().mark((function g(e){return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(e===l){g.next=8;break}return g.prev=1,g.next=4,e._remove(o);case 4:g.next=8;break;case 6:g.prev=6,g.t0=g.catch(1);case 8:case"end":return g.stop()}}),g,null,[[1,6]])})));return function(e){return g.apply(this,arguments)}}()));case 46:return e.abrupt("return",new g(l,I,n));case 47:case"end":return e.stop()}}),e,null,[[10,31,34,37],[14,25]])})));return function(g,I){return e.apply(this,arguments)}}()}]),g}();function lA(g){var e=g.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(rA(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(oA(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(AA(e))return"Blackberry";if(uA(e))return"Webos";if(aA(e))return"Safari";if((e.includes("chrome/")||iA(e))&&!e.includes("edge/"))return"Chrome";if(cA(e))return"Android";var I=g.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);return 2===(null===I||void 0===I?void 0:I.length)?I[1]:"Other"}function oA(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Cr();return/firefox\//i.test(g)}function aA(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Cr(),e=g.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function iA(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Cr();return/crios\//i.test(g)}function rA(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Cr();return/iemobile/i.test(g)}function cA(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Cr();return/android/i.test(g)}function AA(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Cr();return/blackberry/i.test(g)}function uA(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Cr();return/webos/i.test(g)}function sA(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Cr();return/iphone|ipad|ipod/i.test(g)}function dA(){var g,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Cr();return sA(e)&&!!(null===(g=window.navigator)||void 0===g?void 0:g.standalone)}function ZA(){return function(){var g=Cr();return g.indexOf("MSIE ")>=0||g.indexOf("Trident/")>=0}()&&10===document.documentMode}function bA(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Cr();return sA(g)||cA(g)||uA(g)||AA(g)||/windows phone/i.test(g)||rA(g)}function mA(g){var e,I=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(g){case"Browser":e=lA(Cr());break;case"Worker":e="".concat(lA(Cr()),"-").concat(g);break;default:e=g}var t=I.length?I.join(","):"FirebaseCore-web";return"".concat(e,"/","JsCore","/").concat(Dr,"/").concat(t)}var hA=function(){function g(e,I){mI(this,g),this.app=e,this.config=I,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new pA(this),this.idTokenSubscription=new pA(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ec,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=I.sdkClientVersion}return GI(g,[{key:"_initializeWithPersistence",value:function(g,e){var I=this;return e&&(this._popupRedirectResolver=Ac(e)),this._initializationPromise=this.queue(lI(yI().mark((function t(){var n,C;return yI().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!I._deleted){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,CA.create(I,g);case 4:if(I.persistenceManager=t.sent,!I._deleted){t.next=7;break}return t.abrupt("return");case 7:if(!(null===(n=I._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)){t.next=15;break}return t.prev=8,t.next=11,I._popupRedirectResolver._initialize(I);case 11:t.next=15;break;case 13:t.prev=13,t.t0=t.catch(8);case 15:return t.next=17,I.initializeCurrentUser(e);case 17:if(I.lastNotifiedUid=(null===(C=I.currentUser)||void 0===C?void 0:C.uid)||null,!I._deleted){t.next=20;break}return t.abrupt("return");case 20:I._isInitialized=!0;case 21:case"end":return t.stop()}}),t,null,[[8,13]])})))),this._initializationPromise}},{key:"_onStorageEvent",value:function(){var g=lI(yI().mark((function g(){var e;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(!this._deleted){g.next=2;break}return g.abrupt("return");case 2:return g.next=4,this.assertedPersistence.getCurrentUser();case 4:if(e=g.sent,this.currentUser||e){g.next=7;break}return g.abrupt("return");case 7:if(!this.currentUser||!e||this.currentUser.uid!==e.uid){g.next=12;break}return this._currentUser._assign(e),g.next=11,this.currentUser.getIdToken();case 11:return g.abrupt("return");case 12:return g.next=14,this._updateCurrentUser(e);case 14:case"end":return g.stop()}}),g,this)})));return function(){return g.apply(this,arguments)}}()},{key:"initializeCurrentUser",value:function(){var g=lI(yI().mark((function g(e){var I,t,n,C,l;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.assertedPersistence.getCurrentUser();case 2:if(t=g.sent,!e||!this.config.authDomain){g.next=12;break}return g.next=6,this.getOrInitRedirectPersistenceManager();case 6:return n=null===(I=this.redirectUser)||void 0===I?void 0:I._redirectEventId,C=null===t||void 0===t?void 0:t._redirectEventId,g.next=10,this.tryRedirectSignIn(e);case 10:l=g.sent,n&&n!==C||!(null===l||void 0===l?void 0:l.user)||(t=l.user);case 12:if(t){g.next=14;break}return g.abrupt("return",this.directlySetCurrentUser(null));case 14:if(t._redirectEventId){g.next=16;break}return g.abrupt("return",this.reloadAndSetCurrentUserOrClear(t));case 16:return ac(this._popupRedirectResolver,this,"argument-error"),g.next=19,this.getOrInitRedirectPersistenceManager();case 19:if(!this.redirectUser||this.redirectUser._redirectEventId!==t._redirectEventId){g.next=21;break}return g.abrupt("return",this.directlySetCurrentUser(t));case 21:return g.abrupt("return",this.reloadAndSetCurrentUserOrClear(t));case 22:case"end":return g.stop()}}),g,this)})));return function(e){return g.apply(this,arguments)}}()},{key:"tryRedirectSignIn",value:function(){var g=lI(yI().mark((function g(e){var I;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return I=null,g.prev=1,g.next=4,this._popupRedirectResolver._completeRedirectFn(this,e,!0);case 4:I=g.sent,g.next=11;break;case 7:return g.prev=7,g.t0=g.catch(1),g.next=11,this._setRedirectUser(null);case 11:return g.abrupt("return",I);case 12:case"end":return g.stop()}}),g,this,[[1,7]])})));return function(e){return g.apply(this,arguments)}}()},{key:"reloadAndSetCurrentUserOrClear",value:function(){var g=lI(yI().mark((function g(e){return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.prev=0,g.next=3,Qc(e);case 3:g.next=9;break;case 5:if(g.prev=5,g.t0=g.catch(0),g.t0.code==="auth/".concat("network-request-failed")){g.next=9;break}return g.abrupt("return",this.directlySetCurrentUser(null));case 9:return g.abrupt("return",this.directlySetCurrentUser(e));case 10:case"end":return g.stop()}}),g,this,[[0,5]])})));return function(e){return g.apply(this,arguments)}}()},{key:"useDeviceLanguage",value:function(){this.languageCode=function(){if("undefined"===typeof navigator)return null;var g=navigator;return g.languages&&g.languages[0]||g.language||null}()}},{key:"_delete",value:function(){var g=lI(yI().mark((function g(){return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:this._deleted=!0;case 1:case"end":return g.stop()}}),g,this)})));return function(){return g.apply(this,arguments)}}()},{key:"updateCurrentUser",value:function(){var g=lI(yI().mark((function g(e){var I;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return(I=e?br(e):null)&&ac(I.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),g.abrupt("return",this._updateCurrentUser(I&&I._clone(this)));case 3:case"end":return g.stop()}}),g,this)})));return function(e){return g.apply(this,arguments)}}()},{key:"_updateCurrentUser",value:function(){var g=lI(yI().mark((function g(e){var I=this;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(!this._deleted){g.next=2;break}return g.abrupt("return");case 2:return e&&ac(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),g.abrupt("return",this.queue(lI(yI().mark((function g(){return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,I.directlySetCurrentUser(e);case 2:I.notifyAuthListeners();case 3:case"end":return g.stop()}}),g)})))));case 4:case"end":return g.stop()}}),g,this)})));return function(e){return g.apply(this,arguments)}}()},{key:"signOut",value:function(){var g=lI(yI().mark((function g(){return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(!this.redirectPersistenceManager&&!this._popupRedirectResolver){g.next=3;break}return g.next=3,this._setRedirectUser(null);case 3:return g.abrupt("return",this._updateCurrentUser(null));case 4:case"end":return g.stop()}}),g,this)})));return function(){return g.apply(this,arguments)}}()},{key:"setPersistence",value:function(g){var e=this;return this.queue(lI(yI().mark((function I(){return yI().wrap((function(I){for(;;)switch(I.prev=I.next){case 0:return I.next=2,e.assertedPersistence.setPersistence(Ac(g));case 2:case"end":return I.stop()}}),I)}))))}},{key:"_getPersistence",value:function(){return this.assertedPersistence.persistence.type}},{key:"_updateErrorMap",value:function(g){this._errorFactory=new or("auth","Firebase",g())}},{key:"onAuthStateChanged",value:function(g,e,I){return this.registerStateListener(this.authStateSubscription,g,e,I)}},{key:"onIdTokenChanged",value:function(g,e,I){return this.registerStateListener(this.idTokenSubscription,g,e,I)}},{key:"toJSON",value:function(){var g;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(g=this._currentUser)||void 0===g?void 0:g.toJSON()}}},{key:"_setRedirectUser",value:function(){var g=lI(yI().mark((function g(e,I){var t;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.getOrInitRedirectPersistenceManager(I);case 2:return t=g.sent,g.abrupt("return",null===e?t.removeCurrentUser():t.setCurrentUser(e));case 4:case"end":return g.stop()}}),g,this)})));return function(e,I){return g.apply(this,arguments)}}()},{key:"getOrInitRedirectPersistenceManager",value:function(){var g=lI(yI().mark((function g(e){var I;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(this.redirectPersistenceManager){g.next=9;break}return ac(I=e&&Ac(e)||this._popupRedirectResolver,this,"argument-error"),g.next=5,CA.create(this,[Ac(I._redirectPersistence)],"redirectUser");case 5:return this.redirectPersistenceManager=g.sent,g.next=8,this.redirectPersistenceManager.getCurrentUser();case 8:this.redirectUser=g.sent;case 9:return g.abrupt("return",this.redirectPersistenceManager);case 10:case"end":return g.stop()}}),g,this)})));return function(e){return g.apply(this,arguments)}}()},{key:"_redirectUserForId",value:function(){var g=lI(yI().mark((function g(e){var I,t;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(!this._isInitialized){g.next=3;break}return g.next=3,this.queue(lI(yI().mark((function g(){return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:case"end":return g.stop()}}),g)}))));case 3:if((null===(I=this._currentUser)||void 0===I?void 0:I._redirectEventId)!==e){g.next=5;break}return g.abrupt("return",this._currentUser);case 5:if((null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId)!==e){g.next=7;break}return g.abrupt("return",this.redirectUser);case 7:return g.abrupt("return",null);case 8:case"end":return g.stop()}}),g,this)})));return function(e){return g.apply(this,arguments)}}()},{key:"_persistUserIfCurrent",value:function(){var g=lI(yI().mark((function g(e){var I=this;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(e!==this.currentUser){g.next=2;break}return g.abrupt("return",this.queue(lI(yI().mark((function g(){return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.abrupt("return",I.directlySetCurrentUser(e));case 1:case"end":return g.stop()}}),g)})))));case 2:case"end":return g.stop()}}),g,this)})));return function(e){return g.apply(this,arguments)}}()},{key:"_notifyListenersIfCurrent",value:function(g){g===this.currentUser&&this.notifyAuthListeners()}},{key:"_key",value:function(){return"".concat(this.config.authDomain,":").concat(this.config.apiKey,":").concat(this.name)}},{key:"_startProactiveRefresh",value:function(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}},{key:"_stopProactiveRefresh",value:function(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}},{key:"_currentUser",get:function(){return this.currentUser}},{key:"notifyAuthListeners",value:function(){var g,e;if(this._isInitialized){this.idTokenSubscription.next(this.currentUser);var I=null!==(e=null===(g=this.currentUser)||void 0===g?void 0:g.uid)&&void 0!==e?e:null;this.lastNotifiedUid!==I&&(this.lastNotifiedUid=I,this.authStateSubscription.next(this.currentUser))}}},{key:"registerStateListener",value:function(g,e,I,t){var n=this;if(this._deleted)return function(){};var C="function"===typeof e?e:e.next.bind(e),l=this._isInitialized?Promise.resolve():this._initializationPromise;return ac(l,this,"internal-error"),l.then((function(){return C(n.currentUser)})),"function"===typeof e?g.addObserver(e,I,t):g.addObserver(e)}},{key:"directlySetCurrentUser",value:function(){var g=lI(yI().mark((function g(e){return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(this.currentUser&&this.currentUser!==e&&(this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh()),this.currentUser=e,!e){g.next=7;break}return g.next=5,this.assertedPersistence.setCurrentUser(e);case 5:g.next=9;break;case 7:return g.next=9,this.assertedPersistence.removeCurrentUser();case 9:case"end":return g.stop()}}),g,this)})));return function(e){return g.apply(this,arguments)}}()},{key:"queue",value:function(g){return this.operations=this.operations.then(g,g),this.operations}},{key:"assertedPersistence",get:function(){return ac(this.persistenceManager,this,"internal-error"),this.persistenceManager}},{key:"_logFramework",value:function(g){g&&!this.frameworks.includes(g)&&(this.frameworks.push(g),this.frameworks.sort(),this.clientVersion=mA(this.config.clientPlatform,this._getFrameworks()))}},{key:"_getFrameworks",value:function(){return this.frameworks}},{key:"_getAdditionalHeaders",value:function(){var g=lI(yI().mark((function g(){var e;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return e=(0,vg.Z)({},"X-Client-Version",this.clientVersion),this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId),g.abrupt("return",e);case 3:case"end":return g.stop()}}),g,this)})));return function(){return g.apply(this,arguments)}}()}]),g}();function GA(g){return br(g)}var pA=function(){function g(e){var I=this;mI(this,g),this.auth=e,this.observer=null,this.addObserver=function(g,e){var I=new dr(g,e);return I.subscribe.bind(I)}((function(g){return I.observer=g}))}return GI(g,[{key:"next",get:function(){return ac(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}]),g}();var yA=function(){function g(e,I){mI(this,g),this.providerId=e,this.signInMethod=I}return GI(g,[{key:"toJSON",value:function(){return ic("not implemented")}},{key:"_getIdTokenResponse",value:function(g){return ic("not implemented")}},{key:"_linkToIdToken",value:function(g,e){return ic("not implemented")}},{key:"_getReauthenticationResolver",value:function(g){return ic("not implemented")}}]),g}();function BA(g,e){return vA.apply(this,arguments)}function vA(){return(vA=lI(yI().mark((function g(e,I){return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.abrupt("return",vc(e,"POST","/v1/accounts:update",I));case 1:case"end":return g.stop()}}),g)})))).apply(this,arguments)}function VA(g,e){return WA.apply(this,arguments)}function WA(){return(WA=lI(yI().mark((function g(e,I){return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.abrupt("return",fc(e,"POST","/v1/accounts:signInWithPassword",Bc(e,I)));case 1:case"end":return g.stop()}}),g)})))).apply(this,arguments)}function SA(g,e){return fA.apply(this,arguments)}function fA(){return(fA=lI(yI().mark((function g(e,I){return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.abrupt("return",fc(e,"POST","/v1/accounts:signInWithEmailLink",Bc(e,I)));case 1:case"end":return g.stop()}}),g)})))).apply(this,arguments)}function kA(g,e){return RA.apply(this,arguments)}function RA(){return(RA=lI(yI().mark((function g(e,I){return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.abrupt("return",fc(e,"POST","/v1/accounts:signInWithEmailLink",Bc(e,I)));case 1:case"end":return g.stop()}}),g)})))).apply(this,arguments)}var XA=function(g){sI(I,g);var e=bI(I);function I(g,t,n){var C,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return mI(this,I),(C=e.call(this,"password",n))._email=g,C._password=t,C._tenantId=l,C}return GI(I,[{key:"toJSON",value:function(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}},{key:"_getIdTokenResponse",value:function(){var g=lI(yI().mark((function g(e){return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:g.t0=this.signInMethod,g.next="password"===g.t0?3:"emailLink"===g.t0?4:5;break;case 3:return g.abrupt("return",VA(e,{returnSecureToken:!0,email:this._email,password:this._password}));case 4:return g.abrupt("return",SA(e,{email:this._email,oobCode:this._password}));case 5:nc(e,"internal-error");case 6:case"end":return g.stop()}}),g,this)})));return function(e){return g.apply(this,arguments)}}()},{key:"_linkToIdToken",value:function(){var g=lI(yI().mark((function g(e,I){return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:g.t0=this.signInMethod,g.next="password"===g.t0?3:"emailLink"===g.t0?4:5;break;case 3:return g.abrupt("return",BA(e,{idToken:I,returnSecureToken:!0,email:this._email,password:this._password}));case 4:return g.abrupt("return",kA(e,{idToken:I,email:this._email,oobCode:this._password}));case 5:nc(e,"internal-error");case 6:case"end":return g.stop()}}),g,this)})));return function(e,I){return g.apply(this,arguments)}}()},{key:"_getReauthenticationResolver",value:function(g){return this._getIdTokenResponse(g)}}],[{key:"_fromEmailAndPassword",value:function(g,e){return new I(g,e,"password")}},{key:"_fromEmailAndCode",value:function(g,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new I(g,e,"emailLink",t)}},{key:"fromJSON",value:function(g){var e="string"===typeof g?JSON.parse(g):g;if((null===e||void 0===e?void 0:e.email)&&(null===e||void 0===e?void 0:e.password)){if("password"===e.signInMethod)return this._fromEmailAndPassword(e.email,e.password);if("emailLink"===e.signInMethod)return this._fromEmailAndCode(e.email,e.password,e.tenantId)}return null}}]),I}(yA);function JA(g,e){return YA.apply(this,arguments)}function YA(){return(YA=lI(yI().mark((function g(e,I){return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.abrupt("return",fc(e,"POST","/v1/accounts:signInWithIdp",Bc(e,I)));case 1:case"end":return g.stop()}}),g)})))).apply(this,arguments)}var HA=function(g){sI(I,g);var e=bI(I);function I(){var g;return mI(this,I),(g=e.apply(this,arguments)).pendingToken=null,g}return GI(I,[{key:"toJSON",value:function(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}},{key:"_getIdTokenResponse",value:function(g){return JA(g,this.buildRequest())}},{key:"_linkToIdToken",value:function(g,e){var I=this.buildRequest();return I.idToken=e,JA(g,I)}},{key:"_getReauthenticationResolver",value:function(g){var e=this.buildRequest();return e.autoCreate=!1,JA(g,e)}},{key:"buildRequest",value:function(){var g={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)g.pendingToken=this.pendingToken;else{var e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),g.postBody=Ar(e)}return g}}],[{key:"_fromParams",value:function(g){var e=new I(g.providerId,g.signInMethod);return g.idToken||g.accessToken?(g.idToken&&(e.idToken=g.idToken),g.accessToken&&(e.accessToken=g.accessToken),g.nonce&&!g.pendingToken&&(e.nonce=g.nonce),g.pendingToken&&(e.pendingToken=g.pendingToken)):g.oauthToken&&g.oauthTokenSecret?(e.accessToken=g.oauthToken,e.secret=g.oauthTokenSecret):nc("argument-error"),e}},{key:"fromJSON",value:function(g){var e="string"===typeof g?JSON.parse(g):g,t=e.providerId,n=e.signInMethod,C=_r(e,["providerId","signInMethod"]);if(!t||!n)return null;var l=new I(t,n);return l.idToken=C.idToken||void 0,l.accessToken=C.accessToken||void 0,l.secret=C.secret,l.nonce=C.nonce,l.pendingToken=C.pendingToken||null,l}}]),I}(yA);function wA(g,e){return NA.apply(this,arguments)}function NA(){return(NA=lI(yI().mark((function g(e,I){return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.abrupt("return",vc(e,"POST","/v1/accounts:sendVerificationCode",Bc(e,I)));case 1:case"end":return g.stop()}}),g)})))).apply(this,arguments)}function KA(){return(KA=lI(yI().mark((function g(e,I){return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.abrupt("return",fc(e,"POST","/v1/accounts:signInWithPhoneNumber",Bc(e,I)));case 1:case"end":return g.stop()}}),g)})))).apply(this,arguments)}function FA(){return(FA=lI(yI().mark((function g(e,I){var t;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,fc(e,"POST","/v1/accounts:signInWithPhoneNumber",Bc(e,I));case 2:if(!(t=g.sent).temporaryProof){g.next=5;break}throw Jc(e,"account-exists-with-different-credential",t);case 5:return g.abrupt("return",t);case 6:case"end":return g.stop()}}),g)})))).apply(this,arguments)}var EA=(0,vg.Z)({},"USER_NOT_FOUND","user-not-found");function xA(){return(xA=lI(yI().mark((function g(e,I){var t;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return t=Object.assign(Object.assign({},I),{operation:"REAUTH"}),g.abrupt("return",fc(e,"POST","/v1/accounts:signInWithPhoneNumber",Bc(e,t),EA));case 2:case"end":return g.stop()}}),g)})))).apply(this,arguments)}var zA=function(g){sI(I,g);var e=bI(I);function I(g){var t;return mI(this,I),(t=e.call(this,"phone","phone")).params=g,t}return GI(I,[{key:"_getIdTokenResponse",value:function(g){return function(g,e){return KA.apply(this,arguments)}(g,this._makeVerificationRequest())}},{key:"_linkToIdToken",value:function(g,e){return function(g,e){return FA.apply(this,arguments)}(g,Object.assign({idToken:e},this._makeVerificationRequest()))}},{key:"_getReauthenticationResolver",value:function(g){return function(g,e){return xA.apply(this,arguments)}(g,this._makeVerificationRequest())}},{key:"_makeVerificationRequest",value:function(){var g=this.params,e=g.temporaryProof,I=g.phoneNumber,t=g.verificationId,n=g.verificationCode;return e&&I?{temporaryProof:e,phoneNumber:I}:{sessionInfo:t,code:n}}},{key:"toJSON",value:function(){var g={providerId:this.providerId};return this.params.phoneNumber&&(g.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(g.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(g.verificationCode=this.params.verificationCode),this.params.verificationId&&(g.verificationId=this.params.verificationId),g}}],[{key:"_fromVerification",value:function(g,e){return new I({verificationId:g,verificationCode:e})}},{key:"_fromTokenResponse",value:function(g,e){return new I({phoneNumber:g,temporaryProof:e})}},{key:"fromJSON",value:function(g){"string"===typeof g&&(g=JSON.parse(g));var e=g,t=e.verificationId,n=e.verificationCode,C=e.phoneNumber,l=e.temporaryProof;return n||t||C||l?new I({verificationId:t,verificationCode:n,phoneNumber:C,temporaryProof:l}):null}}]),I}(yA);var UA=function(){function g(e){var I,t,n,C,l,o;mI(this,g);var a=ur(sr(e)),i=null!==(I=a.apiKey)&&void 0!==I?I:null,r=null!==(t=a.oobCode)&&void 0!==t?t:null,c=function(g){switch(g){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(n=a.mode)&&void 0!==n?n:null);ac(i&&r&&c,"argument-error"),this.apiKey=i,this.operation=c,this.code=r,this.continueUrl=null!==(C=a.continueUrl)&&void 0!==C?C:null,this.languageCode=null!==(l=a.languageCode)&&void 0!==l?l:null,this.tenantId=null!==(o=a.tenantId)&&void 0!==o?o:null}return GI(g,null,[{key:"parseLink",value:function(e){var I=function(g){var e=ur(sr(g)).link,I=e?ur(sr(e)).deep_link_id:null,t=ur(sr(g)).deep_link_id;return(t?ur(sr(t)).link:null)||t||I||e||g}(e);try{return new g(I)}catch(By){return null}}}]),g}();var MA=function(){function g(){mI(this,g),this.providerId=g.PROVIDER_ID}return GI(g,null,[{key:"credential",value:function(g,e){return XA._fromEmailAndPassword(g,e)}},{key:"credentialWithLink",value:function(g,e){var I=UA.parseLink(e);return ac(I,"argument-error"),XA._fromEmailAndCode(g,I.code,I.tenantId)}}]),g}();MA.PROVIDER_ID="password",MA.EMAIL_PASSWORD_SIGN_IN_METHOD="password",MA.EMAIL_LINK_SIGN_IN_METHOD="emailLink";var LA=function(){function g(e){mI(this,g),this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}return GI(g,[{key:"setDefaultLanguage",value:function(g){this.defaultLanguageCode=g}},{key:"setCustomParameters",value:function(g){return this.customParameters=g,this}},{key:"getCustomParameters",value:function(){return this.customParameters}}]),g}(),TA=function(g){sI(I,g);var e=bI(I);function I(){var g;return mI(this,I),(g=e.apply(this,arguments)).scopes=[],g}return GI(I,[{key:"addScope",value:function(g){return this.scopes.includes(g)||this.scopes.push(g),this}},{key:"getScopes",value:function(){return(0,L.Z)(this.scopes)}}]),I}(LA),QA=function(g){sI(I,g);var e=bI(I);function I(){return mI(this,I),e.call(this,"facebook.com")}return GI(I,null,[{key:"credential",value:function(g){return HA._fromParams({providerId:I.PROVIDER_ID,signInMethod:I.FACEBOOK_SIGN_IN_METHOD,accessToken:g})}},{key:"credentialFromResult",value:function(g){return I.credentialFromTaggedObject(g)}},{key:"credentialFromError",value:function(g){return I.credentialFromTaggedObject(g.customData||{})}},{key:"credentialFromTaggedObject",value:function(g){var e=g._tokenResponse;if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return I.credential(e.oauthAccessToken)}catch(By){return null}}}]),I}(TA);QA.FACEBOOK_SIGN_IN_METHOD="facebook.com",QA.PROVIDER_ID="facebook.com";var DA=function(g){sI(I,g);var e=bI(I);function I(){var g;return mI(this,I),(g=e.call(this,"google.com")).addScope("profile"),g}return GI(I,null,[{key:"credential",value:function(g,e){return HA._fromParams({providerId:I.PROVIDER_ID,signInMethod:I.GOOGLE_SIGN_IN_METHOD,idToken:g,accessToken:e})}},{key:"credentialFromResult",value:function(g){return I.credentialFromTaggedObject(g)}},{key:"credentialFromError",value:function(g){return I.credentialFromTaggedObject(g.customData||{})}},{key:"credentialFromTaggedObject",value:function(g){var e=g._tokenResponse;if(!e)return null;var t=e.oauthIdToken,n=e.oauthAccessToken;if(!t&&!n)return null;try{return I.credential(t,n)}catch(By){return null}}}]),I}(TA);DA.GOOGLE_SIGN_IN_METHOD="google.com",DA.PROVIDER_ID="google.com";var jA=function(g){sI(I,g);var e=bI(I);function I(){return mI(this,I),e.call(this,"github.com")}return GI(I,null,[{key:"credential",value:function(g){return HA._fromParams({providerId:I.PROVIDER_ID,signInMethod:I.GITHUB_SIGN_IN_METHOD,accessToken:g})}},{key:"credentialFromResult",value:function(g){return I.credentialFromTaggedObject(g)}},{key:"credentialFromError",value:function(g){return I.credentialFromTaggedObject(g.customData||{})}},{key:"credentialFromTaggedObject",value:function(g){var e=g._tokenResponse;if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return I.credential(e.oauthAccessToken)}catch(By){return null}}}]),I}(TA);jA.GITHUB_SIGN_IN_METHOD="github.com",jA.PROVIDER_ID="github.com";var PA=function(g){sI(I,g);var e=bI(I);function I(){return mI(this,I),e.call(this,"twitter.com")}return GI(I,null,[{key:"credential",value:function(g,e){return HA._fromParams({providerId:I.PROVIDER_ID,signInMethod:I.TWITTER_SIGN_IN_METHOD,oauthToken:g,oauthTokenSecret:e})}},{key:"credentialFromResult",value:function(g){return I.credentialFromTaggedObject(g)}},{key:"credentialFromError",value:function(g){return I.credentialFromTaggedObject(g.customData||{})}},{key:"credentialFromTaggedObject",value:function(g){var e=g._tokenResponse;if(!e)return null;var t=e.oauthAccessToken,n=e.oauthTokenSecret;if(!t||!n)return null;try{return I.credential(t,n)}catch(By){return null}}}]),I}(TA);PA.TWITTER_SIGN_IN_METHOD="twitter.com",PA.PROVIDER_ID="twitter.com";var OA=function(){function g(e){mI(this,g),this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}return GI(g,null,[{key:"_fromIdTokenResponse",value:function(){var e=lI(yI().mark((function e(I,t,n){var C,l,o,a,i=arguments;return yI().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return C=i.length>3&&void 0!==i[3]&&i[3],e.next=3,eA._fromIdTokenResponse(I,n,C);case 3:return l=e.sent,o=_A(n),a=new g({user:l,providerId:o,_tokenResponse:n,operationType:t}),e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})));return function(g,I,t){return e.apply(this,arguments)}}()},{key:"_forOperation",value:function(){var e=lI(yI().mark((function e(I,t,n){var C;return yI().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I._updateTokensIfNecessary(n,!0);case 2:return C=_A(n),e.abrupt("return",new g({user:I,providerId:C,_tokenResponse:n,operationType:t}));case 4:case"end":return e.stop()}}),e)})));return function(g,I,t){return e.apply(this,arguments)}}()}]),g}();function _A(g){return g.providerId?g.providerId:"phoneNumber"in g?"phone":null}var qA=function(g){sI(I,g);var e=bI(I);function I(g,t,n,C){var l,o;return mI(this,I),(l=e.call(this,t.code,t.message)).operationType=n,l.user=C,Object.setPrototypeOf(Hg(l),I.prototype),l.customData={appName:g.name,tenantId:null!==(o=g.tenantId)&&void 0!==o?o:void 0,_serverResponse:t.customData._serverResponse,operationType:n},l}return GI(I,null,[{key:"_fromErrorAndOperation",value:function(g,e,t,n){return new I(g,e,t,n)}}]),I}(lr);function $A(g,e,I,t){return("reauthenticate"===e?I._getReauthenticationResolver(g):I._getIdTokenResponse(g)).catch((function(I){if(I.code==="auth/".concat("multi-factor-auth-required"))throw qA._fromErrorAndOperation(g,I,e,t);throw I}))}function gu(g,e){return eu.apply(this,arguments)}function eu(){return eu=lI(yI().mark((function g(e,I){var t,n,C=arguments;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return t=C.length>2&&void 0!==C[2]&&C[2],g.t0=zc,g.t1=e,g.t2=I,g.t3=e.auth,g.next=7,e.getIdToken();case 7:return g.t4=g.sent,g.t5=g.t2._linkToIdToken.call(g.t2,g.t3,g.t4),g.t6=t,g.next=12,(0,g.t0)(g.t1,g.t5,g.t6);case 12:return n=g.sent,g.abrupt("return",OA._forOperation(e,"link",n));case 14:case"end":return g.stop()}}),g)}))),eu.apply(this,arguments)}function Iu(g,e){return tu.apply(this,arguments)}function tu(){return tu=lI(yI().mark((function g(e,I){var t,n,C,l,o,a,i=arguments;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return t=i.length>2&&void 0!==i[2]&&i[2],n=e.auth,C="reauthenticate",g.prev=3,g.next=6,zc(e,$A(n,C,I,e),t);case 6:return ac((l=g.sent).idToken,n,"internal-error"),ac(o=xc(l.idToken),n,"internal-error"),a=o.sub,ac(e.uid===a,n,"user-mismatch"),g.abrupt("return",OA._forOperation(e,C,l));case 15:throw g.prev=15,g.t0=g.catch(3),(null===g.t0||void 0===g.t0?void 0:g.t0.code)==="auth/".concat("user-not-found")&&nc(n,"user-mismatch"),g.t0;case 19:case"end":return g.stop()}}),g,null,[[3,15]])}))),tu.apply(this,arguments)}function nu(g,e){return Cu.apply(this,arguments)}function Cu(){return Cu=lI(yI().mark((function g(e,I){var t,n,C,l,o=arguments;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return t=o.length>2&&void 0!==o[2]&&o[2],n="signIn",g.next=4,$A(e,n,I);case 4:return C=g.sent,g.next=7,OA._fromIdTokenResponse(e,n,C);case 7:if(l=g.sent,t){g.next=11;break}return g.next=11,e._updateCurrentUser(l.user);case 11:return g.abrupt("return",l);case 12:case"end":return g.stop()}}),g)}))),Cu.apply(this,arguments)}function lu(g,e){return vc(g,"POST","/v2/accounts/mfaEnrollment:start",Bc(g,e))}new WeakMap;var ou="__sak",au=function(){function g(e,I){mI(this,g),this.storageRetriever=e,this.type=I}return GI(g,[{key:"_isAvailable",value:function(){try{return this.storage?(this.storage.setItem(ou,"1"),this.storage.removeItem(ou),Promise.resolve(!0)):Promise.resolve(!1)}catch(By){return Promise.resolve(!1)}}},{key:"_set",value:function(g,e){return this.storage.setItem(g,JSON.stringify(e)),Promise.resolve()}},{key:"_get",value:function(g){var e=this.storage.getItem(g);return Promise.resolve(e?JSON.parse(e):null)}},{key:"_remove",value:function(g){return this.storage.removeItem(g),Promise.resolve()}},{key:"storage",get:function(){return this.storageRetriever()}}]),g}();var iu=function(g){sI(I,g);var e=bI(I);function I(){var g;return mI(this,I),(g=e.call(this,(function(){return window.localStorage}),"LOCAL")).boundEventHandler=function(e,I){return g.onStorageEvent(e,I)},g.listeners={},g.localCache={},g.pollTimer=null,g.safariLocalStorageNotSynced=function(){var g=Cr();return aA(g)||sA(g)}()&&function(){try{return!(!window||window===window.top)}catch(g){return!1}}(),g.fallbackToPolling=bA(),g._shouldAllowMigration=!0,g}return GI(I,[{key:"forAllChangedKeys",value:function(g){for(var e=0,I=Object.keys(this.listeners);e<I.length;e++){var t=I[e],n=this.storage.getItem(t),C=this.localCache[t];n!==C&&g(t,C,n)}}},{key:"onStorageEvent",value:function(g){var e=this,I=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(g.key){var t=g.key;if(I?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){var n=this.storage.getItem(t);if(g.newValue!==n)null!==g.newValue?this.storage.setItem(t,g.newValue):this.storage.removeItem(t);else if(this.localCache[t]===g.newValue&&!I)return}var C=function(){var g=e.storage.getItem(t);(I||e.localCache[t]!==g)&&e.notifyListeners(t,g)},l=this.storage.getItem(t);ZA()&&l!==g.newValue&&g.newValue!==g.oldValue?setTimeout(C,10):C()}else this.forAllChangedKeys((function(g,I,t){e.notifyListeners(g,t)}))}},{key:"notifyListeners",value:function(g,e){this.localCache[g]=e;var I=this.listeners[g];if(I)for(var t=0,n=Array.from(I);t<n.length;t++){(0,n[t])(e?JSON.parse(e):e)}}},{key:"startPolling",value:function(){var g=this;this.stopPolling(),this.pollTimer=setInterval((function(){g.forAllChangedKeys((function(e,I,t){g.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:I,newValue:t}),!0)}))}),1e3)}},{key:"stopPolling",value:function(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}},{key:"attachListener",value:function(){window.addEventListener("storage",this.boundEventHandler)}},{key:"detachListener",value:function(){window.removeEventListener("storage",this.boundEventHandler)}},{key:"_addListener",value:function(g,e){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[g]||(this.listeners[g]=new Set,this.localCache[g]=this.storage.getItem(g)),this.listeners[g].add(e)}},{key:"_removeListener",value:function(g,e){this.listeners[g]&&(this.listeners[g].delete(e),0===this.listeners[g].size&&delete this.listeners[g]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}},{key:"_set",value:function(){var g=lI(yI().mark((function g(e,t){return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,gr(oI(I.prototype),"_set",this).call(this,e,t);case 2:this.localCache[e]=JSON.stringify(t);case 3:case"end":return g.stop()}}),g,this)})));return function(e,I){return g.apply(this,arguments)}}()},{key:"_get",value:function(){var g=lI(yI().mark((function g(e){var t;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,gr(oI(I.prototype),"_get",this).call(this,e);case 2:return t=g.sent,this.localCache[e]=JSON.stringify(t),g.abrupt("return",t);case 5:case"end":return g.stop()}}),g,this)})));return function(e){return g.apply(this,arguments)}}()},{key:"_remove",value:function(){var g=lI(yI().mark((function g(e){return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,gr(oI(I.prototype),"_remove",this).call(this,e);case 2:delete this.localCache[e];case 3:case"end":return g.stop()}}),g,this)})));return function(e){return g.apply(this,arguments)}}()}]),I}(au);iu.type="LOCAL";var ru=iu,cu=function(g){sI(I,g);var e=bI(I);function I(){return mI(this,I),e.call(this,(function(){return window.sessionStorage}),"SESSION")}return GI(I,[{key:"_addListener",value:function(g,e){}},{key:"_removeListener",value:function(g,e){}}]),I}(au);cu.type="SESSION";var Au=cu;function uu(g){return Promise.all(g.map(function(){var g=lI(yI().mark((function g(e){var I;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.prev=0,g.next=3,e;case 3:return I=g.sent,g.abrupt("return",{fulfilled:!0,value:I});case 7:return g.prev=7,g.t0=g.catch(0),g.abrupt("return",{fulfilled:!1,reason:g.t0});case 10:case"end":return g.stop()}}),g,null,[[0,7]])})));return function(e){return g.apply(this,arguments)}}()))}var su=function(){function g(e){mI(this,g),this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}return GI(g,[{key:"isListeningto",value:function(g){return this.eventTarget===g}},{key:"handleEvent",value:function(){var g=lI(yI().mark((function g(e){var I,t,n,C,l,o,a,i;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(t=(I=e).data,n=t.eventId,C=t.eventType,l=t.data,null===(o=this.handlersMap[C])||void 0===o?void 0:o.size){g.next=5;break}return g.abrupt("return");case 5:return I.ports[0].postMessage({status:"ack",eventId:n,eventType:C}),a=Array.from(o).map(function(){var g=lI(yI().mark((function g(e){return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.abrupt("return",e(I.origin,l));case 1:case"end":return g.stop()}}),g)})));return function(e){return g.apply(this,arguments)}}()),g.next=9,uu(a);case 9:i=g.sent,I.ports[0].postMessage({status:"done",eventId:n,eventType:C,response:i});case 11:case"end":return g.stop()}}),g,this)})));return function(e){return g.apply(this,arguments)}}()},{key:"_subscribe",value:function(g,e){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[g]||(this.handlersMap[g]=new Set),this.handlersMap[g].add(e)}},{key:"_unsubscribe",value:function(g,e){this.handlersMap[g]&&e&&this.handlersMap[g].delete(e),e&&0!==this.handlersMap[g].size||delete this.handlersMap[g],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}],[{key:"_getInstance",value:function(e){var I=this.receivers.find((function(g){return g.isListeningto(e)}));if(I)return I;var t=new g(e);return this.receivers.push(t),t}}]),g}();function du(){for(var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,I="",t=0;t<e;t++)I+=Math.floor(10*Math.random());return g+I}su.receivers=[];var Zu=function(){function g(e){mI(this,g),this.target=e,this.handlers=new Set}return GI(g,[{key:"removeMessageHandler",value:function(g){g.messageChannel&&(g.messageChannel.port1.removeEventListener("message",g.onMessage),g.messageChannel.port1.close()),this.handlers.delete(g)}},{key:"_send",value:function(){var g=lI(yI().mark((function g(e,I){var t,n,C,l,o=this,a=arguments;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(t=a.length>2&&void 0!==a[2]?a[2]:50,n="undefined"!==typeof MessageChannel?new MessageChannel:null){g.next=4;break}throw new Error("connection_unavailable");case 4:return g.abrupt("return",new Promise((function(g,a){var i=du("",20);n.port1.start();var r=setTimeout((function(){a(new Error("unsupported_event"))}),t);l={messageChannel:n,onMessage:function(e){var I=e;if(I.data.eventId===i)switch(I.data.status){case"ack":clearTimeout(r),C=setTimeout((function(){a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(C),g(I.data.response);break;default:clearTimeout(r),clearTimeout(C),a(new Error("invalid_response"))}}},o.handlers.add(l),n.port1.addEventListener("message",l.onMessage),o.target.postMessage({eventType:e,eventId:i,data:I},[n.port2])})).finally((function(){l&&o.removeMessageHandler(l)})));case 5:case"end":return g.stop()}}),g)})));return function(e,I){return g.apply(this,arguments)}}()}]),g}();function bu(){return window}function mu(){return"undefined"!==typeof bu().WorkerGlobalScope&&"function"===typeof bu().importScripts}function hu(){return Gu.apply(this,arguments)}function Gu(){return(Gu=lI(yI().mark((function g(){var e;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(null===navigator||void 0===navigator?void 0:navigator.serviceWorker){g.next=2;break}return g.abrupt("return",null);case 2:return g.prev=2,g.next=5,navigator.serviceWorker.ready;case 5:return e=g.sent,g.abrupt("return",e.active);case 9:return g.prev=9,g.t0=g.catch(2),g.abrupt("return",null);case 12:case"end":return g.stop()}}),g,null,[[2,9]])})))).apply(this,arguments)}function pu(){var g;return(null===(g=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===g?void 0:g.controller)||null}var yu="firebaseLocalStorageDb",Bu="firebaseLocalStorage",vu="fbase_key",Vu=function(){function g(e){mI(this,g),this.request=e}return GI(g,[{key:"toPromise",value:function(){var g=this;return new Promise((function(e,I){g.request.addEventListener("success",(function(){e(g.request.result)})),g.request.addEventListener("error",(function(){I(g.request.error)}))}))}}]),g}();function Wu(g,e){return g.transaction([Bu],e?"readwrite":"readonly").objectStore(Bu)}function Su(){var g=indexedDB.deleteDatabase(yu);return new Vu(g).toPromise()}function fu(){var g=indexedDB.open(yu,1);return new Promise((function(e,I){g.addEventListener("error",(function(){I(g.error)})),g.addEventListener("upgradeneeded",(function(){var e=g.result;try{e.createObjectStore(Bu,{keyPath:vu})}catch(t){I(t)}})),g.addEventListener("success",lI(yI().mark((function I(){var t;return yI().wrap((function(I){for(;;)switch(I.prev=I.next){case 0:if((t=g.result).objectStoreNames.contains(Bu)){I.next=12;break}return t.close(),I.next=5,Su();case 5:return I.t0=e,I.next=8,fu();case 8:I.t1=I.sent,(0,I.t0)(I.t1),I.next=13;break;case 12:e(t);case 13:case"end":return I.stop()}}),I)}))))}))}function ku(g,e,I){return Ru.apply(this,arguments)}function Ru(){return Ru=lI(yI().mark((function g(e,I,t){var n,C;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return C=Wu(e,!0).put((n={},(0,vg.Z)(n,vu,I),(0,vg.Z)(n,"value",t),n)),g.abrupt("return",new Vu(C).toPromise());case 2:case"end":return g.stop()}}),g)}))),Ru.apply(this,arguments)}function Xu(g,e){return Ju.apply(this,arguments)}function Ju(){return Ju=lI(yI().mark((function g(e,I){var t,n;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return t=Wu(e,!1).get(I),g.next=3,new Vu(t).toPromise();case 3:return n=g.sent,g.abrupt("return",void 0===n?null:n.value);case 5:case"end":return g.stop()}}),g)}))),Ju.apply(this,arguments)}function Yu(g,e){var I=Wu(g,!0).delete(e);return new Vu(I).toPromise()}var Hu=function(){function g(){mI(this,g),this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((function(){}),(function(){}))}return GI(g,[{key:"_openDb",value:function(){var g=lI(yI().mark((function g(){return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(!this.db){g.next=2;break}return g.abrupt("return",this.db);case 2:return g.next=4,fu();case 4:return this.db=g.sent,g.abrupt("return",this.db);case 6:case"end":return g.stop()}}),g,this)})));return function(){return g.apply(this,arguments)}}()},{key:"_withRetries",value:function(){var g=lI(yI().mark((function g(e){var I,t;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:I=0;case 1:return g.prev=2,g.next=5,this._openDb();case 5:return t=g.sent,g.next=8,e(t);case 8:return g.abrupt("return",g.sent);case 11:if(g.prev=11,g.t0=g.catch(2),!(I++>3)){g.next=15;break}throw g.t0;case 15:this.db&&(this.db.close(),this.db=void 0);case 16:g.next=1;break;case 18:case"end":return g.stop()}}),g,this,[[2,11]])})));return function(e){return g.apply(this,arguments)}}()},{key:"initializeServiceWorkerMessaging",value:function(){var g=lI(yI().mark((function g(){return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.abrupt("return",mu()?this.initializeReceiver():this.initializeSender());case 1:case"end":return g.stop()}}),g,this)})));return function(){return g.apply(this,arguments)}}()},{key:"initializeReceiver",value:function(){var g=lI(yI().mark((function g(){var e=this;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:this.receiver=su._getInstance(mu()?self:null),this.receiver._subscribe("keyChanged",function(){var g=lI(yI().mark((function g(I,t){var n;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,e._poll();case 2:return n=g.sent,g.abrupt("return",{keyProcessed:n.includes(t.key)});case 4:case"end":return g.stop()}}),g)})));return function(e,I){return g.apply(this,arguments)}}()),this.receiver._subscribe("ping",function(){var g=lI(yI().mark((function g(e,I){return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.abrupt("return",["keyChanged"]);case 1:case"end":return g.stop()}}),g)})));return function(e,I){return g.apply(this,arguments)}}());case 3:case"end":return g.stop()}}),g,this)})));return function(){return g.apply(this,arguments)}}()},{key:"initializeSender",value:function(){var g=lI(yI().mark((function g(){var e,I,t;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,hu();case 2:if(this.activeServiceWorker=g.sent,this.activeServiceWorker){g.next=5;break}return g.abrupt("return");case 5:return this.sender=new Zu(this.activeServiceWorker),g.next=8,this.sender._send("ping",{},800);case 8:if(t=g.sent){g.next=11;break}return g.abrupt("return");case 11:(null===(e=t[0])||void 0===e?void 0:e.fulfilled)&&(null===(I=t[0])||void 0===I?void 0:I.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0);case 12:case"end":return g.stop()}}),g,this)})));return function(){return g.apply(this,arguments)}}()},{key:"notifyServiceWorker",value:function(){var g=lI(yI().mark((function g(e){return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(this.sender&&this.activeServiceWorker&&pu()===this.activeServiceWorker){g.next=2;break}return g.abrupt("return");case 2:return g.prev=2,g.next=5,this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50);case 5:g.next=9;break;case 7:g.prev=7,g.t0=g.catch(2);case 9:case"end":return g.stop()}}),g,this,[[2,7]])})));return function(e){return g.apply(this,arguments)}}()},{key:"_isAvailable",value:function(){var g=lI(yI().mark((function g(){var e;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(g.prev=0,indexedDB){g.next=3;break}return g.abrupt("return",!1);case 3:return g.next=5,fu();case 5:return e=g.sent,g.next=8,ku(e,ou,"1");case 8:return g.next=10,Yu(e,ou);case 10:return g.abrupt("return",!0);case 13:g.prev=13,g.t0=g.catch(0);case 15:return g.abrupt("return",!1);case 16:case"end":return g.stop()}}),g,null,[[0,13]])})));return function(){return g.apply(this,arguments)}}()},{key:"_withPendingWrite",value:function(){var g=lI(yI().mark((function g(e){return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return this.pendingWrites++,g.prev=1,g.next=4,e();case 4:return g.prev=4,this.pendingWrites--,g.finish(4);case 7:case"end":return g.stop()}}),g,this,[[1,,4,7]])})));return function(e){return g.apply(this,arguments)}}()},{key:"_set",value:function(){var g=lI(yI().mark((function g(e,I){var t=this;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.abrupt("return",this._withPendingWrite(lI(yI().mark((function g(){return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,t._withRetries((function(g){return ku(g,e,I)}));case 2:return t.localCache[e]=I,g.abrupt("return",t.notifyServiceWorker(e));case 4:case"end":return g.stop()}}),g)})))));case 1:case"end":return g.stop()}}),g,this)})));return function(e,I){return g.apply(this,arguments)}}()},{key:"_get",value:function(){var g=lI(yI().mark((function g(e){var I;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this._withRetries((function(g){return Xu(g,e)}));case 2:return I=g.sent,this.localCache[e]=I,g.abrupt("return",I);case 5:case"end":return g.stop()}}),g,this)})));return function(e){return g.apply(this,arguments)}}()},{key:"_remove",value:function(){var g=lI(yI().mark((function g(e){var I=this;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.abrupt("return",this._withPendingWrite(lI(yI().mark((function g(){return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,I._withRetries((function(g){return Yu(g,e)}));case 2:return delete I.localCache[e],g.abrupt("return",I.notifyServiceWorker(e));case 4:case"end":return g.stop()}}),g)})))));case 1:case"end":return g.stop()}}),g,this)})));return function(e){return g.apply(this,arguments)}}()},{key:"_poll",value:function(){var g=lI(yI().mark((function g(){var e,I,t,n,C,l,o,a,i,r,c;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this._withRetries((function(g){var e=Wu(g,!1).getAll();return new Vu(e).toPromise()}));case 2:if(e=g.sent){g.next=5;break}return g.abrupt("return",[]);case 5:if(0===this.pendingWrites){g.next=7;break}return g.abrupt("return",[]);case 7:I=[],t=new Set,n=cI(e);try{for(n.s();!(C=n.n()).done;)l=C.value,o=l.fbase_key,a=l.value,t.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(a)&&(this.notifyListeners(o,a),I.push(o))}catch(A){n.e(A)}finally{n.f()}for(i=0,r=Object.keys(this.localCache);i<r.length;i++)c=r[i],this.localCache[c]&&!t.has(c)&&(this.notifyListeners(c,null),I.push(c));return g.abrupt("return",I);case 13:case"end":return g.stop()}}),g,this)})));return function(){return g.apply(this,arguments)}}()},{key:"notifyListeners",value:function(g,e){this.localCache[g]=e;var I=this.listeners[g];if(I)for(var t=0,n=Array.from(I);t<n.length;t++){(0,n[t])(e)}}},{key:"startPolling",value:function(){var g=this;this.stopPolling(),this.pollTimer=setInterval(lI(yI().mark((function e(){return yI().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",g._poll());case 1:case"end":return e.stop()}}),e)}))),800)}},{key:"stopPolling",value:function(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}},{key:"_addListener",value:function(g,e){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[g]||(this.listeners[g]=new Set,this._get(g)),this.listeners[g].add(e)}},{key:"_removeListener",value:function(g,e){this.listeners[g]&&(this.listeners[g].delete(e),0===this.listeners[g].size&&delete this.listeners[g]),0===Object.keys(this.listeners).length&&this.stopPolling()}}]),g}();Hu.type="LOCAL";var wu=Hu;function Nu(g,e){return vc(g,"POST","/v2/accounts/mfaSignIn:start",Bc(g,e))}function Ku(g){return new Promise((function(e,I){var t=document.createElement("script");t.setAttribute("src",g),t.onload=e,t.onerror=function(g){var e=Cc("internal-error");e.customData=g,I(e)},t.type="text/javascript",t.charset="UTF-8",function(){var g,e;return null!==(e=null===(g=document.getElementsByTagName("head"))||void 0===g?void 0:g[0])&&void 0!==e?e:document}().appendChild(t)}))}function Fu(g){return"__".concat(g).concat(Math.floor(1e6*Math.random()))}Fu("rcb"),new mc(3e4,6e4);var Eu="recaptcha";function xu(g,e,I){return zu.apply(this,arguments)}function zu(){return zu=lI(yI().mark((function g(e,I,t){var n,C,l,o,a,i,r,c,A;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,t.verify();case 2:if(C=g.sent,g.prev=3,ac("string"===typeof C,e,"argument-error"),ac(t.type===Eu,e,"argument-error"),!("session"in(l="string"===typeof I?{phoneNumber:I}:I))){g.next=26;break}if(o=l.session,!("phoneNumber"in l)){g.next=17;break}return ac("enroll"===o.type,e,"internal-error"),g.next=13,lu(e,{idToken:o.credential,phoneEnrollmentInfo:{phoneNumber:l.phoneNumber,recaptchaToken:C}});case 13:return a=g.sent,g.abrupt("return",a.phoneSessionInfo.sessionInfo);case 17:return ac("signin"===o.type,e,"internal-error"),ac(i=(null===(n=l.multiFactorHint)||void 0===n?void 0:n.uid)||l.multiFactorUid,e,"missing-multi-factor-info"),g.next=22,Nu(e,{mfaPendingCredential:o.credential,mfaEnrollmentId:i,phoneSignInInfo:{recaptchaToken:C}});case 22:return r=g.sent,g.abrupt("return",r.phoneResponseInfo.sessionInfo);case 24:g.next=31;break;case 26:return g.next=28,wA(e,{phoneNumber:l.phoneNumber,recaptchaToken:C});case 28:return c=g.sent,A=c.sessionInfo,g.abrupt("return",A);case 31:return g.prev=31,t._reset(),g.finish(31);case 34:case"end":return g.stop()}}),g,null,[[3,,31,34]])}))),zu.apply(this,arguments)}var Uu=function(){function g(e){mI(this,g),this.providerId=g.PROVIDER_ID,this.auth=GA(e)}return GI(g,[{key:"verifyPhoneNumber",value:function(g,e){return xu(this.auth,g,br(e))}}],[{key:"credential",value:function(g,e){return zA._fromVerification(g,e)}},{key:"credentialFromResult",value:function(e){var I=e;return g.credentialFromTaggedObject(I)}},{key:"credentialFromError",value:function(e){return g.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(g){var e=g._tokenResponse;if(!e)return null;var I=e.phoneNumber,t=e.temporaryProof;return I&&t?zA._fromTokenResponse(I,t):null}}]),g}();function Mu(g,e){return e?Ac(e):(ac(g._popupRedirectResolver,g,"argument-error"),g._popupRedirectResolver)}Uu.PROVIDER_ID="phone",Uu.PHONE_SIGN_IN_METHOD="phone";var Lu=function(g){sI(I,g);var e=bI(I);function I(g){var t;return mI(this,I),(t=e.call(this,"custom","custom")).params=g,t}return GI(I,[{key:"_getIdTokenResponse",value:function(g){return JA(g,this._buildIdpRequest())}},{key:"_linkToIdToken",value:function(g,e){return JA(g,this._buildIdpRequest(e))}},{key:"_getReauthenticationResolver",value:function(g){return JA(g,this._buildIdpRequest())}},{key:"_buildIdpRequest",value:function(g){var e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return g&&(e.idToken=g),e}}]),I}(yA);function Tu(g){return nu(g.auth,new Lu(g),g.bypassAuthState)}function Qu(g){var e=g.auth,I=g.user;return ac(I,e,"internal-error"),Iu(I,new Lu(g),g.bypassAuthState)}function Du(g){return ju.apply(this,arguments)}function ju(){return(ju=lI(yI().mark((function g(e){var I,t;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return I=e.auth,ac(t=e.user,I,"internal-error"),g.abrupt("return",gu(t,new Lu(e),e.bypassAuthState));case 3:case"end":return g.stop()}}),g)})))).apply(this,arguments)}var Pu=function(){function g(e,I,t,n){var C=arguments.length>4&&void 0!==arguments[4]&&arguments[4];mI(this,g),this.auth=e,this.resolver=t,this.user=n,this.bypassAuthState=C,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(I)?I:[I]}return GI(g,[{key:"execute",value:function(){var g=this;return new Promise(function(){var e=lI(yI().mark((function e(I,t){return yI().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g.pendingPromise={resolve:I,reject:t},e.prev=1,e.next=4,g.resolver._initialize(g.auth);case 4:return g.eventManager=e.sent,e.next=7,g.onExecution();case 7:g.eventManager.registerConsumer(g),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),g.reject(e.t0);case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(g,I){return e.apply(this,arguments)}}())}},{key:"onAuthEvent",value:function(){var g=lI(yI().mark((function g(e){var I,t,n,C,l,o,a;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(I=e.urlResponse,t=e.sessionId,n=e.postBody,C=e.tenantId,l=e.error,o=e.type,!l){g.next=4;break}return this.reject(l),g.abrupt("return");case 4:return a={auth:this.auth,requestUri:I,sessionId:t,tenantId:C||void 0,postBody:n||void 0,user:this.user,bypassAuthState:this.bypassAuthState},g.prev=5,g.t0=this,g.next=9,this.getIdpTask(o)(a);case 9:g.t1=g.sent,g.t0.resolve.call(g.t0,g.t1),g.next=16;break;case 13:g.prev=13,g.t2=g.catch(5),this.reject(g.t2);case 16:case"end":return g.stop()}}),g,this,[[5,13]])})));return function(e){return g.apply(this,arguments)}}()},{key:"onError",value:function(g){this.reject(g)}},{key:"getIdpTask",value:function(g){switch(g){case"signInViaPopup":case"signInViaRedirect":return Tu;case"linkViaPopup":case"linkViaRedirect":return Du;case"reauthViaPopup":case"reauthViaRedirect":return Qu;default:nc(this.auth,"internal-error")}}},{key:"resolve",value:function(g){rc(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(g),this.unregisterAndCleanUp()}},{key:"reject",value:function(g){rc(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(g),this.unregisterAndCleanUp()}},{key:"unregisterAndCleanUp",value:function(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}]),g}(),Ou=new mc(2e3,1e4);var _u=function(g){sI(I,g);var e=bI(I);function I(g,t,n,C,l){var o;return mI(this,I),(o=e.call(this,g,t,C,l)).provider=n,o.authWindow=null,o.pollId=null,I.currentPopupAction&&I.currentPopupAction.cancel(),I.currentPopupAction=Hg(o),o}return GI(I,[{key:"executeNotNull",value:function(){var g=lI(yI().mark((function g(){var e;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.execute();case 2:return ac(e=g.sent,this.auth,"internal-error"),g.abrupt("return",e);case 5:case"end":return g.stop()}}),g,this)})));return function(){return g.apply(this,arguments)}}()},{key:"onExecution",value:function(){var g=lI(yI().mark((function g(){var e,I=this;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return rc(1===this.filter.length,"Popup operations only handle one event"),e=du(),g.next=4,this.resolver._openPopup(this.auth,this.provider,this.filter[0],e);case 4:this.authWindow=g.sent,this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((function(g){I.reject(g)})),this.resolver._isIframeWebStorageSupported(this.auth,(function(g){g||I.reject(Cc(I.auth,"web-storage-unsupported"))})),this.pollUserCancellation();case 9:case"end":return g.stop()}}),g,this)})));return function(){return g.apply(this,arguments)}}()},{key:"eventId",get:function(){var g;return(null===(g=this.authWindow)||void 0===g?void 0:g.associatedEvent)||null}},{key:"cancel",value:function(){this.reject(Cc(this.auth,"cancelled-popup-request"))}},{key:"cleanUp",value:function(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,I.currentPopupAction=null}},{key:"pollUserCancellation",value:function(){var g=this;!function e(){var I,t;(null===(t=null===(I=g.authWindow)||void 0===I?void 0:I.window)||void 0===t?void 0:t.closed)?g.pollId=window.setTimeout((function(){g.pollId=null,g.reject(Cc(g.auth,"popup-closed-by-user"))}),2e3):g.pollId=window.setTimeout(e,Ou.get())}()}}]),I}(Pu);_u.currentPopupAction=null;var qu=new Map,$u=function(g){sI(I,g);var e=bI(I);function I(g,t){var n,C=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return mI(this,I),(n=e.call(this,g,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,C)).eventId=null,n}return GI(I,[{key:"execute",value:function(){var g=lI(yI().mark((function g(){var e,t;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(e=qu.get(this.auth._key())){g.next=21;break}return g.prev=2,g.next=5,gs(this.resolver,this.auth);case 5:if(!g.sent){g.next=12;break}return g.next=9,gr(oI(I.prototype),"execute",this).call(this);case 9:g.t0=g.sent,g.next=13;break;case 12:g.t0=null;case 13:t=g.t0,e=function(){return Promise.resolve(t)},g.next=20;break;case 17:g.prev=17,g.t1=g.catch(2),e=function(){return Promise.reject(g.t1)};case 20:qu.set(this.auth._key(),e);case 21:return this.bypassAuthState||qu.set(this.auth._key(),(function(){return Promise.resolve(null)})),g.abrupt("return",e());case 23:case"end":return g.stop()}}),g,this,[[2,17]])})));return function(){return g.apply(this,arguments)}}()},{key:"onAuthEvent",value:function(){var g=lI(yI().mark((function g(e){var t;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if("signInViaRedirect"!==e.type){g.next=4;break}return g.abrupt("return",gr(oI(I.prototype),"onAuthEvent",this).call(this,e));case 4:if("unknown"!==e.type){g.next=7;break}return this.resolve(null),g.abrupt("return");case 7:if(!e.eventId){g.next=17;break}return g.next=10,this.auth._redirectUserForId(e.eventId);case 10:if(!(t=g.sent)){g.next=16;break}return this.user=t,g.abrupt("return",gr(oI(I.prototype),"onAuthEvent",this).call(this,e));case 16:this.resolve(null);case 17:case"end":return g.stop()}}),g,this)})));return function(e){return g.apply(this,arguments)}}()},{key:"onExecution",value:function(){var g=lI(yI().mark((function g(){return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:case"end":return g.stop()}}),g)})));return function(){return g.apply(this,arguments)}}()},{key:"cleanUp",value:function(){}}]),I}(Pu);function gs(g,e){return es.apply(this,arguments)}function es(){return(es=lI(yI().mark((function g(e,I){var t,n,C;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return t=ts(I),n=Is(e),g.next=4,n._isAvailable();case 4:if(g.sent){g.next=6;break}return g.abrupt("return",!1);case 6:return g.next=8,n._get(t);case 8:return g.t0=g.sent,C="true"===g.t0,g.next=12,n._remove(t);case 12:return g.abrupt("return",C);case 13:case"end":return g.stop()}}),g)})))).apply(this,arguments)}function Is(g){return Ac(g._redirectPersistence)}function ts(g){return nA("pendingRedirect",g.config.apiKey,g.name)}function ns(g,e){return Cs.apply(this,arguments)}function Cs(){return Cs=lI(yI().mark((function g(e,I){var t,n,C,l,o,a=arguments;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return t=a.length>2&&void 0!==a[2]&&a[2],n=GA(e),C=Mu(n,I),l=new $u(n,C,t),g.next=6,l.execute();case 6:if(!(o=g.sent)||t){g.next=13;break}return delete o.user._redirectEventId,g.next=11,n._persistUserIfCurrent(o.user);case 11:return g.next=13,n._setRedirectUser(null,I);case 13:return g.abrupt("return",o);case 14:case"end":return g.stop()}}),g)}))),Cs.apply(this,arguments)}var ls=function(){function g(e){mI(this,g),this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}return GI(g,[{key:"registerConsumer",value:function(g){this.consumers.add(g),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,g)&&(this.sendToConsumer(this.queuedRedirectEvent,g),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}},{key:"unregisterConsumer",value:function(g){this.consumers.delete(g)}},{key:"onEvent",value:function(g){var e=this;if(this.hasEventBeenHandled(g))return!1;var I=!1;return this.consumers.forEach((function(t){e.isEventForConsumer(g,t)&&(I=!0,e.sendToConsumer(g,t),e.saveEventToCache(g))})),this.hasHandledPotentialRedirect||!function(g){switch(g.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return as(g);default:return!1}}(g)||(this.hasHandledPotentialRedirect=!0,I||(this.queuedRedirectEvent=g,I=!0)),I}},{key:"sendToConsumer",value:function(g,e){var I;if(g.error&&!as(g)){var t=(null===(I=g.error.code)||void 0===I?void 0:I.split("auth/")[1])||"internal-error";e.onError(Cc(this.auth,t))}else e.onAuthEvent(g)}},{key:"isEventForConsumer",value:function(g,e){var I=null===e.eventId||!!g.eventId&&g.eventId===e.eventId;return e.filter.includes(g.type)&&I}},{key:"hasEventBeenHandled",value:function(g){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(os(g))}},{key:"saveEventToCache",value:function(g){this.cachedEventUids.add(os(g)),this.lastProcessedEventTime=Date.now()}}]),g}();function os(g){return[g.type,g.eventId,g.sessionId,g.tenantId].filter((function(g){return g})).join("-")}function as(g){var e=g.type,I=g.error;return"unknown"===e&&(null===I||void 0===I?void 0:I.code)==="auth/".concat("no-auth-event")}function is(g){return rs.apply(this,arguments)}function rs(){return rs=lI(yI().mark((function g(e){var I,t=arguments;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return I=t.length>1&&void 0!==t[1]?t[1]:{},g.abrupt("return",vc(e,"GET","/v1/projects",I));case 2:case"end":return g.stop()}}),g)}))),rs.apply(this,arguments)}var cs=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,As=/^https?/;function us(){return(us=lI(yI().mark((function g(e){var I,t,n,C,l;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(!e.config.emulator){g.next=2;break}return g.abrupt("return");case 2:return g.next=4,is(e);case 4:I=g.sent,t=I.authorizedDomains,n=cI(t),g.prev=7,n.s();case 9:if((C=n.n()).done){g.next=20;break}if(l=C.value,g.prev=11,!ss(l)){g.next=14;break}return g.abrupt("return");case 14:g.next=18;break;case 16:g.prev=16,g.t0=g.catch(11);case 18:g.next=9;break;case 20:g.next=25;break;case 22:g.prev=22,g.t1=g.catch(7),n.e(g.t1);case 25:return g.prev=25,n.f(),g.finish(25);case 28:nc(e,"unauthorized-domain");case 29:case"end":return g.stop()}}),g,null,[[7,22,25,28],[11,16]])})))).apply(this,arguments)}function ss(g){var e=sc(),I=new URL(e),t=I.protocol,n=I.hostname;if(g.startsWith("chrome-extension://")){var C=new URL(g);return""===C.hostname&&""===n?"chrome-extension:"===t&&g.replace("chrome-extension://","")===e.replace("chrome-extension://",""):"chrome-extension:"===t&&C.hostname===n}if(!As.test(t))return!1;if(cs.test(g))return n===g;var l=g.replace(/\./g,"\\.");return new RegExp("^(.+\\."+l+"|"+l+")$","i").test(n)}var ds=new mc(3e4,6e4);function Zs(){var g=bu().___jsl;if(null===g||void 0===g?void 0:g.H)for(var e=0,I=Object.keys(g.H);e<I.length;e++){var t=I[e];if(g.H[t].r=g.H[t].r||[],g.H[t].L=g.H[t].L||[],g.H[t].r=(0,L.Z)(g.H[t].L),g.CP)for(var n=0;n<g.CP.length;n++)g.CP[n]=null}}var bs=null;function ms(g){return bs=bs||function(g){return new Promise((function(e,I){var t,n,C;function l(){Zs(),gapi.load("gapi.iframes",{callback:function(){e(gapi.iframes.getContext())},ontimeout:function(){Zs(),I(Cc(g,"network-request-failed"))},timeout:ds.get()})}if(null===(n=null===(t=bu().gapi)||void 0===t?void 0:t.iframes)||void 0===n?void 0:n.Iframe)e(gapi.iframes.getContext());else{if(!(null===(C=bu().gapi)||void 0===C?void 0:C.load)){var o=Fu("iframefcb");return bu()[o]=function(){gapi.load?l():I(Cc(g,"network-request-failed"))},Ku("https://apis.google.com/js/api.js?onload=".concat(o)).catch((function(g){return I(g)}))}l()}})).catch((function(g){throw bs=null,g}))}(g),bs}var hs=new mc(5e3,15e3),Gs={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},ps=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function ys(g){var e=g.config;ac(e.authDomain,g,"auth-domain-config-required");var I=e.emulator?hc(e,"emulator/auth/iframe"):"https://".concat(g.config.authDomain,"/").concat("__/auth/iframe"),t={apiKey:e.apiKey,appName:g.name,v:Dr},n=ps.get(g.config.apiHost);n&&(t.eid=n);var C=g._getFrameworks();return C.length&&(t.fw=C.join(",")),"".concat(I,"?").concat(Ar(t).slice(1))}function Bs(g){return vs.apply(this,arguments)}function vs(){return vs=lI(yI().mark((function g(e){var I,t;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,ms(e);case 2:return I=g.sent,ac(t=bu().gapi,e,"internal-error"),g.abrupt("return",I.open({where:document.body,url:ys(e),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Gs,dontclear:!0},(function(g){return new Promise(function(){var I=lI(yI().mark((function I(t,n){var C,l,o;return yI().wrap((function(I){for(;;)switch(I.prev=I.next){case 0:return o=function(){bu().clearTimeout(l),t(g)},I.next=3,g.restyle({setHideOnLeave:!1});case 3:C=Cc(e,"network-request-failed"),l=bu().setTimeout((function(){n(C)}),hs.get()),g.ping(o).then(o,(function(){n(C)}));case 6:case"end":return I.stop()}}),I)})));return function(g,e){return I.apply(this,arguments)}}())})));case 6:case"end":return g.stop()}}),g)}))),vs.apply(this,arguments)}var Vs={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Ws="_blank",Ss="http://localhost",fs=function(){function g(e){mI(this,g),this.window=e,this.associatedEvent=null}return GI(g,[{key:"close",value:function(){if(this.window)try{this.window.close()}catch(g){}}}]),g}();function ks(g,e,I){var t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,C=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600,l=Math.max((window.screen.availHeight-C)/2,0).toString(),o=Math.max((window.screen.availWidth-t)/2,0).toString(),a="",i=Object.assign(Object.assign({},Vs),{width:t.toString(),height:C.toString(),top:l,left:o}),r=Cr().toLowerCase();I&&(a=iA(r)?Ws:I),oA(r)&&(e=e||Ss,i.scrollbars="yes");var c=Object.entries(i).reduce((function(g,e){var I=(0,n.Z)(e,2),t=I[0],C=I[1];return"".concat(g).concat(t,"=").concat(C,",")}),"");if(dA(r)&&"_self"!==a)return Rs(e||"",a),new fs(null);var A=window.open(e||"",a,c);ac(A,g,"popup-blocked");try{A.focus()}catch(u){}return new fs(A)}function Rs(g,e){var I=document.createElement("a");I.href=g,I.target=e;var t=document.createEvent("MouseEvent");t.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),I.dispatchEvent(t)}var Xs="__/auth/handler",Js="emulator/auth/handler";function Ys(g,e,I,t,C,l){ac(g.config.authDomain,g,"auth-domain-config-required"),ac(g.config.apiKey,g,"invalid-api-key");var o={apiKey:g.config.apiKey,appName:g.name,authType:I,redirectUrl:t,v:Dr,eventId:C};if(e instanceof LA){e.setDefaultLanguage(g.languageCode),o.providerId=e.providerId||"",function(g){for(var e in g)if(Object.prototype.hasOwnProperty.call(g,e))return!1;return!0}(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(var a=0,i=Object.entries(l||{});a<i.length;a++){var r=(0,n.Z)(i[a],2),c=r[0],A=r[1];o[c]=A}}if(e instanceof TA){var u=e.getScopes().filter((function(g){return""!==g}));u.length>0&&(o.scopes=u.join(","))}g.tenantId&&(o.tid=g.tenantId);for(var s=o,d=0,Z=Object.keys(s);d<Z.length;d++){var b=Z[d];void 0===s[b]&&delete s[b]}return"".concat(function(g){var e=g.config;if(!e.emulator)return"https://".concat(e.authDomain,"/").concat(Xs);return hc(e,Js)}(g),"?").concat(Ar(s).slice(1))}var Hs="webStorageSupport",ws=function(){function g(){mI(this,g),this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Au,this._completeRedirectFn=ns}return GI(g,[{key:"_openPopup",value:function(){var g=lI(yI().mark((function g(e,I,t,n){var C,l;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return rc(null===(C=this.eventManagers[e._key()])||void 0===C?void 0:C.manager,"_initialize() not called before _openPopup()"),l=Ys(e,I,t,sc(),n),g.abrupt("return",ks(e,l,du()));case 3:case"end":return g.stop()}}),g,this)})));return function(e,I,t,n){return g.apply(this,arguments)}}()},{key:"_openRedirect",value:function(){var g=lI(yI().mark((function g(e,I,t,n){return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this._originValidation(e);case 2:return C=Ys(e,I,t,sc(),n),bu().location.href=C,g.abrupt("return",new Promise((function(){})));case 4:case"end":return g.stop()}var C}),g,this)})));return function(e,I,t,n){return g.apply(this,arguments)}}()},{key:"_initialize",value:function(g){var e=this,I=g._key();if(this.eventManagers[I]){var t=this.eventManagers[I],n=t.manager,C=t.promise;return n?Promise.resolve(n):(rc(C,"If manager is not set, promise should be"),C)}var l=this.initAndGetManager(g);return this.eventManagers[I]={promise:l},l.catch((function(){delete e.eventManagers[I]})),l}},{key:"initAndGetManager",value:function(){var g=lI(yI().mark((function g(e){var I,t;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,Bs(e);case 2:return I=g.sent,t=new ls(e),I.register("authEvent",(function(g){return ac(null===g||void 0===g?void 0:g.authEvent,e,"invalid-auth-event"),{status:t.onEvent(g.authEvent)?"ACK":"ERROR"}}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:t},this.iframes[e._key()]=I,g.abrupt("return",t);case 8:case"end":return g.stop()}}),g,this)})));return function(e){return g.apply(this,arguments)}}()},{key:"_isIframeWebStorageSupported",value:function(g,e){this.iframes[g._key()].send(Hs,{type:Hs},(function(I){var t,n=null===(t=null===I||void 0===I?void 0:I[0])||void 0===t?void 0:t.webStorageSupport;void 0!==n&&e(!!n),nc(g,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}},{key:"_originValidation",value:function(g){var e=g._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=function(g){return us.apply(this,arguments)}(g)),this.originValidationPromises[e]}},{key:"_shouldInitProactively",get:function(){return bA()||aA()||sA()}}]),g}(),Ns=ws,Ks=function(g){sI(I,g);var e=bI(I);function I(g){var t;return mI(this,I),(t=e.call(this,"phone")).credential=g,t}return GI(I,[{key:"_finalizeEnroll",value:function(g,e,I){return function(g,e){return vc(g,"POST","/v2/accounts/mfaEnrollment:finalize",Bc(g,e))}(g,{idToken:e,displayName:I,phoneVerificationInfo:this.credential._makeVerificationRequest()})}},{key:"_finalizeSignIn",value:function(g,e){return function(g,e){return vc(g,"POST","/v2/accounts/mfaSignIn:finalize",Bc(g,e))}(g,{mfaPendingCredential:e,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}],[{key:"_fromCredential",value:function(g){return new I(g)}}]),I}(function(){function g(e){mI(this,g),this.factorId=e}return GI(g,[{key:"_process",value:function(g,e,I){switch(e.type){case"enroll":return this._finalizeEnroll(g,e.credential,I);case"signin":return this._finalizeSignIn(g,e.credential);default:return ic("unexpected MultiFactorSessionType")}}}]),g}());(function(){function g(){mI(this,g)}return GI(g,null,[{key:"assertion",value:function(g){return Ks._fromCredential(g)}}]),g}()).FACTOR_ID="phone";var Fs,Es="@firebase/auth",xs="0.19.5",zs=function(){function g(e){mI(this,g),this.auth=e,this.internalListeners=new Map}return GI(g,[{key:"getUid",value:function(){var g;return this.assertAuthConfigured(),(null===(g=this.auth.currentUser)||void 0===g?void 0:g.uid)||null}},{key:"getToken",value:function(){var g=lI(yI().mark((function g(e){var I;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return this.assertAuthConfigured(),g.next=3,this.auth._initializationPromise;case 3:if(this.auth.currentUser){g.next=5;break}return g.abrupt("return",null);case 5:return g.next=7,this.auth.currentUser.getIdToken(e);case 7:return I=g.sent,g.abrupt("return",{accessToken:I});case 9:case"end":return g.stop()}}),g,this)})));return function(e){return g.apply(this,arguments)}}()},{key:"addAuthTokenListener",value:function(g){if(this.assertAuthConfigured(),!this.internalListeners.has(g)){var e=this.auth.onIdTokenChanged((function(e){var I;g((null===(I=e)||void 0===I?void 0:I.stsTokenManager.accessToken)||null)}));this.internalListeners.set(g,e),this.updateProactiveRefresh()}}},{key:"removeAuthTokenListener",value:function(g){this.assertAuthConfigured();var e=this.internalListeners.get(g);e&&(this.internalListeners.delete(g),e(),this.updateProactiveRefresh())}},{key:"assertAuthConfigured",value:function(){ac(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}},{key:"updateProactiveRefresh",value:function(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}]),g}();function Us(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Pr(),e=Ur(g,"auth");return e.isInitialized()?e.getImmediate():uc(g,{popupRedirectResolver:Ns,persistence:[wu,ru,Au]})}Fs="Browser",zr(new mr("auth",(function(g,e){var I=e.options,t=g.getProvider("app").getImmediate(),n=t.options,C=n.apiKey,l=n.authDomain;return function(g){ac(C&&!C.includes(":"),"invalid-api-key",{appName:g.name}),ac(!(null===l||void 0===l?void 0:l.includes(":")),"argument-error",{appName:g.name});var e={apiKey:C,authDomain:l,clientPlatform:Fs,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:mA(Fs)},t=new hA(g,e);return function(g,e){var I=(null===e||void 0===e?void 0:e.persistence)||[],t=(Array.isArray(I)?I:[I]).map(Ac);(null===e||void 0===e?void 0:e.errorMap)&&g._updateErrorMap(e.errorMap),g._initializeWithPersistence(t,null===e||void 0===e?void 0:e.popupRedirectResolver)}(t,I),t}(t)}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((function(g,e,I){g.getProvider("auth-internal").initialize()}))),zr(new mr("auth-internal",(function(g){return function(g){return new zs(g)}(GA(g.getProvider("auth").getImmediate()))}),"PRIVATE").setInstantiationMode("EXPLICIT")),Or(Es,xs,function(g){switch(g){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(Fs)),Or(Es,xs,"esm2017");var Ms="firebasestorage.googleapis.com",Ls=function(g){sI(I,g);var e=bI(I);function I(g,t){var n;return mI(this,I),(n=e.call(this,Ts(g),"Firebase Storage: ".concat(t," (").concat(Ts(g),")"))).customData={serverResponse:null},n._baseMessage=n.message,Object.setPrototypeOf(Hg(n),I.prototype),n}return GI(I,[{key:"_codeEquals",value:function(g){return Ts(g)===this.code}},{key:"serverResponse",get:function(){return this.customData.serverResponse},set:function(g){this.customData.serverResponse=g,this.customData.serverResponse?this.message="".concat(this._baseMessage,"\n").concat(this.customData.serverResponse):this.message=this._baseMessage}}]),I}(lr);function Ts(g){return"storage/"+g}function Qs(){return new Ls("unknown","An unknown error occurred, please check the error payload for server response.")}function Ds(){return new Ls("canceled","User canceled the upload/download.")}function js(g){return new Ls("invalid-argument",g)}function Ps(){return new Ls("app-deleted","The Firebase app was deleted.")}function Os(g){throw new Ls("internal-error","Internal error: "+g)}var _s,qs=function(){function g(e,I){mI(this,g),this.bucket=e,this.path_=I}return GI(g,[{key:"path",get:function(){return this.path_}},{key:"isRoot",get:function(){return 0===this.path.length}},{key:"fullServerUrl",value:function(){var g=encodeURIComponent;return"/b/"+g(this.bucket)+"/o/"+g(this.path)}},{key:"bucketOnlyServerUrl",value:function(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}}],[{key:"makeFromBucketSpec",value:function(e,I){var t;try{t=g.makeFromUrl(e,I)}catch(n){return new g(e,"")}if(""===t.path)return t;throw new Ls("invalid-default-bucket","Invalid default bucket '"+e+"'.")}},{key:"makeFromUrl",value:function(e,I){var t=null,n="([A-Za-z0-9.\\-_]+)";var C=new RegExp("^gs://"+n+"(/(.*))?$","i");function l(g){g.path_=decodeURIComponent(g.path)}for(var o=I.replace(/[.]/g,"\\."),a=[{regex:C,indices:{bucket:1,path:3},postModify:function(g){"/"===g.path.charAt(g.path.length-1)&&(g.path_=g.path_.slice(0,-1))}},{regex:new RegExp("^https?://".concat(o,"/").concat("v[A-Za-z0-9_]+","/b/").concat(n,"/o").concat("(/([^?#]*).*)?$"),"i"),indices:{bucket:1,path:3},postModify:l},{regex:new RegExp("^https?://".concat(I===Ms?"(?:storage.googleapis.com|storage.cloud.google.com)":I,"/").concat(n,"/").concat("([^?#]*)"),"i"),indices:{bucket:1,path:2},postModify:l}],i=0;i<a.length;i++){var r=a[i],c=r.regex.exec(e);if(c){var A=c[r.indices.bucket],u=c[r.indices.path];u||(u=""),t=new g(A,u),r.postModify(t);break}}if(null==t)throw function(g){return new Ls("invalid-url","Invalid URL '"+g+"'.")}(e);return t}}]),g}(),$s=function(){function g(e){mI(this,g),this.promise_=Promise.reject(e)}return GI(g,[{key:"getPromise",value:function(){return this.promise_}},{key:"cancel",value:function(){}}]),g}();function gd(g){return"string"===typeof g||g instanceof String}function ed(g,e,I,t){if(t<e)throw js("Invalid value for '".concat(g,"'. Expected ").concat(e," or greater."));if(t>I)throw js("Invalid value for '".concat(g,"'. Expected ").concat(I," or less."))}function Id(g,e,I){var t=e;return null==I&&(t="https://".concat(e)),"".concat(I,"://").concat(t,"/v0").concat(g)}function td(g){var e=encodeURIComponent,I="?";for(var t in g){if(g.hasOwnProperty(t))I=I+(e(t)+"="+e(g[t]))+"&"}return I=I.slice(0,-1)}!function(g){g[g.NO_ERROR=0]="NO_ERROR",g[g.NETWORK_ERROR=1]="NETWORK_ERROR",g[g.ABORT=2]="ABORT"}(_s||(_s={}));var nd=function(){function g(e,I,t,n,C,l,o,a,i,r,c){var A=this;mI(this,g),this.url_=e,this.method_=I,this.headers_=t,this.body_=n,this.successCodes_=C,this.additionalRetryCodes_=l,this.callback_=o,this.errorCallback_=a,this.timeout_=i,this.progressCallback_=r,this.connectionFactory_=c,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((function(g,e){A.resolve_=g,A.reject_=e,A.start_()}))}return GI(g,[{key:"start_",value:function(){var g=this,e=function(e,I){var t=g.resolve_,n=g.reject_,C=I.connection;if(I.wasSuccessCode)try{var l=g.callback_(C,C.getResponse());!function(g){return void 0!==g}(l)?t():t(l)}catch(a){n(a)}else if(null!==C){var o=Qs();o.serverResponse=C.getErrorText(),g.errorCallback_?n(g.errorCallback_(C,o)):n(o)}else{if(I.canceled)n(g.appDelete_?Ps():Ds());else n(new Ls("retry-limit-exceeded","Max retry time for operation exceeded, please try again."))}};this.canceled_?e(0,new Cd(!1,null,!0)):this.backoffId_=function(g,e,I){var t=1,n=null,C=null,l=!1,o=0;function a(){return 2===o}var i=!1;function r(){if(!i){i=!0;for(var g=arguments.length,I=new Array(g),t=0;t<g;t++)I[t]=arguments[t];e.apply(null,I)}}function c(e){n=setTimeout((function(){n=null,g(u,a())}),e)}function A(){C&&clearTimeout(C)}function u(g){if(i)A();else{for(var e=arguments.length,I=new Array(e>1?e-1:0),n=1;n<e;n++)I[n-1]=arguments[n];if(g)return A(),void r.call.apply(r,[null,g].concat(I));var C;if(a()||l)return A(),void r.call.apply(r,[null,g].concat(I));t<64&&(t*=2),1===o?(o=2,C=0):C=1e3*(t+Math.random()),c(C)}}var s=!1;function d(g){s||(s=!0,A(),i||(null!==n?(g||(o=2),clearTimeout(n),c(0)):g||(o=1)))}return c(0),C=setTimeout((function(){l=!0,d(!0)}),I),d}((function(e,I){if(I)e(!1,new Cd(!1,null,!0));else{var t=g.connectionFactory_();g.pendingConnection_=t;var n=function(e){var I=e.loaded,t=e.lengthComputable?e.total:-1;null!==g.progressCallback_&&g.progressCallback_(I,t)};null!==g.progressCallback_&&t.addUploadProgressListener(n),t.send(g.url_,g.method_,g.body_,g.headers_).then((function(){null!==g.progressCallback_&&t.removeUploadProgressListener(n),g.pendingConnection_=null;var I=t.getErrorCode()===_s.NO_ERROR,C=t.getStatus();if(I&&!g.isRetryStatusCode_(C)){var l=-1!==g.successCodes_.indexOf(C);e(!0,new Cd(l,t))}else{var o=t.getErrorCode()===_s.ABORT;e(!1,new Cd(!1,null,o))}}))}}),e,this.timeout_)}},{key:"getPromise",value:function(){return this.promise_}},{key:"cancel",value:function(g){this.canceled_=!0,this.appDelete_=g||!1,null!==this.backoffId_&&function(g){g(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}},{key:"isRetryStatusCode_",value:function(g){var e=g>=500&&g<600,I=-1!==[408,429].indexOf(g),t=-1!==this.additionalRetryCodes_.indexOf(g);return e||I||t}}]),g}(),Cd=GI((function g(e,I,t){mI(this,g),this.wasSuccessCode=e,this.connection=I,this.canceled=!!t}));function ld(g){var e;try{e=JSON.parse(g)}catch(I){return null}return function(g){return"object"===typeof g&&!Array.isArray(g)}(e)?e:null}function od(g){var e=g.lastIndexOf("/",g.length-2);return-1===e?g:g.slice(e+1)}function ad(g,e){return e}var id=GI((function g(e,I,t,n){mI(this,g),this.server=e,this.local=I||e,this.writable=!!t,this.xform=n||ad})),rd=null;function cd(){if(rd)return rd;var g=[];g.push(new id("bucket")),g.push(new id("generation")),g.push(new id("metageneration")),g.push(new id("name","fullPath",!0));var e=new id("name");e.xform=function(g,e){return function(g){return!gd(g)||g.length<2?g:od(g)}(e)},g.push(e);var I=new id("size");return I.xform=function(g,e){return void 0!==e?Number(e):e},g.push(I),g.push(new id("timeCreated")),g.push(new id("updated")),g.push(new id("md5Hash",null,!0)),g.push(new id("cacheControl",null,!0)),g.push(new id("contentDisposition",null,!0)),g.push(new id("contentEncoding",null,!0)),g.push(new id("contentLanguage",null,!0)),g.push(new id("contentType",null,!0)),g.push(new id("metadata","customMetadata",!0)),rd=g}function Ad(g,e,I){for(var t={type:"file"},n=I.length,C=0;C<n;C++){var l=I[C];t[l.local]=l.xform(t,e[l.server])}return function(g,e){Object.defineProperty(g,"ref",{get:function(){var I=g.bucket,t=g.fullPath,n=new qs(I,t);return e._makeStorageReference(n)}})}(t,g),t}function ud(g,e,I){var t=ld(e);return null===t?null:Ad(g,t,I)}function sd(g,e,I){var t=ld(I);return null===t?null:function(g,e,I){var t={prefixes:[],items:[],nextPageToken:I.nextPageToken};if(I.prefixes){var n,C=cI(I.prefixes);try{for(C.s();!(n=C.n()).done;){var l=n.value.replace(/\/$/,""),o=g._makeStorageReference(new qs(e,l));t.prefixes.push(o)}}catch(A){C.e(A)}finally{C.f()}}if(I.items){var a,i=cI(I.items);try{for(i.s();!(a=i.n()).done;){var r=a.value,c=g._makeStorageReference(new qs(e,r.name));t.items.push(c)}}catch(A){i.e(A)}finally{i.f()}}return t}(g,e,t)}var dd=GI((function g(e,I,t,n){mI(this,g),this.url=e,this.method=I,this.handler=t,this.timeout=n,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}));function Zd(g){if(!g)throw Qs()}function bd(g,e){return function(I,t){var n=ud(g,t,e);return Zd(null!==n),function(g,e,I,t){var n=ld(e);if(null===n)return null;if(!gd(n.downloadTokens))return null;var C=n.downloadTokens;if(0===C.length)return null;var l=encodeURIComponent;return C.split(",").map((function(e){var n=g.bucket,C=g.fullPath;return Id("/b/"+l(n)+"/o/"+l(C),I,t)+td({alt:"media",token:e})}))[0]}(n,t,g.host,g._protocol)}}function md(g){return function(e,I){var t,n,C;return 401===e.getStatus()?t=e.getErrorText().includes("Firebase App Check token is invalid")?new Ls("unauthorized-app","This app does not have permission to access Firebase Storage on this project."):new Ls("unauthenticated","User is not authenticated, please authenticate using Firebase Authentication and try again."):402===e.getStatus()?(C=g.bucket,t=new Ls("quota-exceeded","Quota for bucket '"+C+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===e.getStatus()?(n=g.path,t=new Ls("unauthorized","User does not have permission to access '"+n+"'.")):t=I,t.serverResponse=I.serverResponse,t}}function hd(g){var e=md(g);return function(I,t){var n,C=e(I,t);return 404===I.getStatus()&&(n=g.path,C=new Ls("object-not-found","Object '"+n+"' does not exist.")),C.serverResponse=t.serverResponse,C}}function Gd(g,e,I,t,n){var C={};e.isRoot?C.prefix="":C.prefix=e.path+"/",I&&I.length>0&&(C.delimiter=I),t&&(C.pageToken=t),n&&(C.maxResults=n);var l=Id(e.bucketOnlyServerUrl(),g.host,g._protocol),o=g.maxOperationRetryTime,a=new dd(l,"GET",function(g,e){return function(I,t){var n=sd(g,e,t);return Zd(null!==n),n}}(g,e.bucket),o);return a.urlParams=C,a.errorHandler=md(e),a}var pd=function(){function g(){var e=this;mI(this,g),this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=_s.NO_ERROR,this.sendPromise_=new Promise((function(g){e.xhr_.addEventListener("abort",(function(){e.errorCode_=_s.ABORT,g()})),e.xhr_.addEventListener("error",(function(){e.errorCode_=_s.NETWORK_ERROR,g()})),e.xhr_.addEventListener("load",(function(){g()}))}))}return GI(g,[{key:"send",value:function(g,e,I,t){if(this.sent_)throw Os("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(e,g,!0),void 0!==t)for(var n in t)t.hasOwnProperty(n)&&this.xhr_.setRequestHeader(n,t[n].toString());return void 0!==I?this.xhr_.send(I):this.xhr_.send(),this.sendPromise_}},{key:"getErrorCode",value:function(){if(!this.sent_)throw Os("cannot .getErrorCode() before sending");return this.errorCode_}},{key:"getStatus",value:function(){if(!this.sent_)throw Os("cannot .getStatus() before sending");try{return this.xhr_.status}catch(g){return-1}}},{key:"getResponse",value:function(){if(!this.sent_)throw Os("cannot .getResponse() before sending");return this.xhr_.response}},{key:"getErrorText",value:function(){if(!this.sent_)throw Os("cannot .getErrorText() before sending");return this.xhr_.statusText}},{key:"abort",value:function(){this.xhr_.abort()}},{key:"getResponseHeader",value:function(g){return this.xhr_.getResponseHeader(g)}},{key:"addUploadProgressListener",value:function(g){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",g)}},{key:"removeUploadProgressListener",value:function(g){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",g)}}]),g}(),yd=function(g){sI(I,g);var e=bI(I);function I(){return mI(this,I),e.apply(this,arguments)}return GI(I,[{key:"initXhr",value:function(){this.xhr_.responseType="text"}}]),I}(pd);function Bd(){return new yd}var vd=function(){function g(e,I){mI(this,g),this._service=e,this._location=I instanceof qs?I:qs.makeFromUrl(I,e.host)}return GI(g,[{key:"toString",value:function(){return"gs://"+this._location.bucket+"/"+this._location.path}},{key:"_newRef",value:function(e,I){return new g(e,I)}},{key:"root",get:function(){var g=new qs(this._location.bucket,"");return this._newRef(this._service,g)}},{key:"bucket",get:function(){return this._location.bucket}},{key:"fullPath",get:function(){return this._location.path}},{key:"name",get:function(){return od(this._location.path)}},{key:"storage",get:function(){return this._service}},{key:"parent",get:function(){var e=function(g){if(0===g.length)return null;var e=g.lastIndexOf("/");return-1===e?"":g.slice(0,e)}(this._location.path);if(null===e)return null;var I=new qs(this._location.bucket,e);return new g(this._service,I)}},{key:"_throwIfRoot",value:function(g){if(""===this._location.path)throw function(g){return new Ls("invalid-root-operation","The operation '"+g+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(g)}}]),g}();function Vd(g,e,I){return Wd.apply(this,arguments)}function Wd(){return Wd=lI(yI().mark((function g(e,I,t){var n,C,l,o;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return l={pageToken:t},g.next=3,Sd(e,l);case 3:if(o=g.sent,(n=I.prefixes).push.apply(n,(0,L.Z)(o.prefixes)),(C=I.items).push.apply(C,(0,L.Z)(o.items)),null==o.nextPageToken){g.next=9;break}return g.next=9,Vd(e,I,o.nextPageToken);case 9:case"end":return g.stop()}}),g)}))),Wd.apply(this,arguments)}function Sd(g,e){null!=e&&"number"===typeof e.maxResults&&ed("options.maxResults",1,1e3,e.maxResults);var I=e||{},t=Gd(g.storage,g._location,"/",I.pageToken,I.maxResults);return g.storage.makeRequestWithTokens(t,Bd)}function fd(g){g._throwIfRoot("getDownloadURL");var e=function(g,e,I){var t=Id(e.fullServerUrl(),g.host,g._protocol),n=g.maxOperationRetryTime,C=new dd(t,"GET",bd(g,I),n);return C.errorHandler=hd(e),C}(g.storage,g._location,cd());return g.storage.makeRequestWithTokens(e,Bd).then((function(g){if(null===g)throw new Ls("no-download-url","The given file does not have any download URLs.");return g}))}function kd(g,e){var I=function(g,e){var I=e.split("/").filter((function(g){return g.length>0})).join("/");return 0===g.length?I:g+"/"+I}(g._location.path,e),t=new qs(g._location.bucket,I);return new vd(g.storage,t)}function Rd(g,e){if(g instanceof Yd){var I=g;if(null==I._bucket)throw new Ls("no-default-bucket","No default bucket found. Did you set the 'storageBucket' property when initializing the app?");var t=new vd(I,I._bucket);return null!=e?Rd(t,e):t}return void 0!==e?kd(g,e):g}function Xd(g,e){if(e&&/^[A-Za-z]+:\/\//.test(e)){if(g instanceof Yd)return new vd(g,e);throw js("To use ref(service, url), the first argument must be a Storage instance.")}return Rd(g,e)}function Jd(g,e){var I=null===e||void 0===e?void 0:e.storageBucket;return null==I?null:qs.makeFromBucketSpec(I,g)}var Yd=function(){function g(e,I,t,n,C){mI(this,g),this.app=e,this._authProvider=I,this._appCheckProvider=t,this._url=n,this._firebaseVersion=C,this._bucket=null,this._host=Ms,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=n?qs.makeFromBucketSpec(n,this._host):Jd(this._host,this.app.options)}return GI(g,[{key:"host",get:function(){return this._host},set:function(g){this._host=g,null!=this._url?this._bucket=qs.makeFromBucketSpec(this._url,g):this._bucket=Jd(g,this.app.options)}},{key:"maxUploadRetryTime",get:function(){return this._maxUploadRetryTime},set:function(g){ed("time",0,Number.POSITIVE_INFINITY,g),this._maxUploadRetryTime=g}},{key:"maxOperationRetryTime",get:function(){return this._maxOperationRetryTime},set:function(g){ed("time",0,Number.POSITIVE_INFINITY,g),this._maxOperationRetryTime=g}},{key:"_getAuthToken",value:function(){var g=lI(yI().mark((function g(){var e,I;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(!this._overrideAuthToken){g.next=2;break}return g.abrupt("return",this._overrideAuthToken);case 2:if(!(e=this._authProvider.getImmediate({optional:!0}))){g.next=9;break}return g.next=6,e.getToken();case 6:if(null===(I=g.sent)){g.next=9;break}return g.abrupt("return",I.accessToken);case 9:return g.abrupt("return",null);case 10:case"end":return g.stop()}}),g,this)})));return function(){return g.apply(this,arguments)}}()},{key:"_getAppCheckToken",value:function(){var g=lI(yI().mark((function g(){var e,I;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(!(e=this._appCheckProvider.getImmediate({optional:!0}))){g.next=6;break}return g.next=4,e.getToken();case 4:return I=g.sent,g.abrupt("return",I.token);case 6:return g.abrupt("return",null);case 7:case"end":return g.stop()}}),g,this)})));return function(){return g.apply(this,arguments)}}()},{key:"_delete",value:function(){return this._deleted||(this._deleted=!0,this._requests.forEach((function(g){return g.cancel()})),this._requests.clear()),Promise.resolve()}},{key:"_makeStorageReference",value:function(g){return new vd(this,g)}},{key:"_makeRequest",value:function(g,e,I,t){var n=this;if(this._deleted)return new $s(Ps());var C=function(g,e,I,t,n,C){var l=td(g.urlParams),o=g.url+l,a=Object.assign({},g.headers);return function(g,e){e&&(g["X-Firebase-GMPID"]=e)}(a,e),function(g,e){null!==e&&e.length>0&&(g.Authorization="Firebase "+e)}(a,I),function(g,e){g["X-Firebase-Storage-Version"]="webjs/"+(null!==e&&void 0!==e?e:"AppManager")}(a,C),function(g,e){null!==e&&(g["X-Firebase-AppCheck"]=e)}(a,t),new nd(o,g.method,a,g.body,g.successCodes,g.additionalRetryCodes,g.handler,g.errorHandler,g.timeout,g.progressCallback,n)}(g,this._appId,I,t,e,this._firebaseVersion);return this._requests.add(C),C.getPromise().then((function(){return n._requests.delete(C)}),(function(){return n._requests.delete(C)})),C}},{key:"makeRequestWithTokens",value:function(){var g=lI(yI().mark((function g(e,I){var t,C,l,o;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,Promise.all([this._getAuthToken(),this._getAppCheckToken()]);case 2:return t=g.sent,C=(0,n.Z)(t,2),l=C[0],o=C[1],g.abrupt("return",this._makeRequest(e,I,l,o).getPromise());case 7:case"end":return g.stop()}}),g,this)})));return function(e,I){return g.apply(this,arguments)}}()}]),g}(),Hd="@firebase/storage",wd="0.9.1",Nd="storage";function Kd(g){return function(g){var e={prefixes:[],items:[]};return Vd(g,e).then((function(){return e}))}(g=br(g))}function Fd(g){return fd(g=br(g))}function Ed(g,e){return Xd(g=br(g),e)}function xd(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Pr(),e=arguments.length>1?arguments[1]:void 0,I=Ur(g=br(g),Nd),t=I.getImmediate({identifier:e});return t}function zd(g,e){var I=e.instanceIdentifier,t=g.getProvider("app").getImmediate(),n=g.getProvider("auth-internal"),C=g.getProvider("app-check-internal");return new Yd(t,n,C,I,Dr)}function Ud(g){return(0,$.Z)("MuiToggleButton",g)}zr(new mr(Nd,zd,"PUBLIC").setMultipleInstances(!0)),Or(Hd,wd,""),Or(Hd,wd,"esm2017");var Md=(0,gg.Z)("MuiToggleButton",["root","disabled","selected","standard","primary","secondary","sizeSmall","sizeMedium","sizeLarge"]),Ld=["children","className","color","disabled","disableFocusRipple","fullWidth","onChange","onClick","selected","size","value"],Td=(0,O.ZP)(Ge,{name:"MuiToggleButton",slot:"Root",overridesResolver:function(g,e){var I=g.ownerState;return[e.root,e["size".concat((0,q.Z)(I.size))]]}})((function(g){var e,I=g.theme,t=g.ownerState,n="standard"===t.color?I.palette.text.primary:I.palette[t.color].main;return(0,C.Z)({},I.typography.button,{borderRadius:I.shape.borderRadius,padding:11,border:"1px solid ".concat(I.palette.divider),color:I.palette.action.active},t.fullWidth&&{width:"100%"},(e={},(0,vg.Z)(e,"&.".concat(Md.disabled),{color:I.palette.action.disabled,border:"1px solid ".concat(I.palette.action.disabledBackground)}),(0,vg.Z)(e,"&:hover",{textDecoration:"none",backgroundColor:(0,Ag.Fq)(I.palette.text.primary,I.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}),(0,vg.Z)(e,"&.".concat(Md.selected),{color:n,backgroundColor:(0,Ag.Fq)(n,I.palette.action.selectedOpacity),"&:hover":{backgroundColor:(0,Ag.Fq)(n,I.palette.action.selectedOpacity+I.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:(0,Ag.Fq)(n,I.palette.action.selectedOpacity)}}}),e),"small"===t.size&&{padding:7,fontSize:I.typography.pxToRem(13)},"large"===t.size&&{padding:15,fontSize:I.typography.pxToRem(15)})})),Qd=t.forwardRef((function(g,e){var I=(0,_.Z)({props:g,name:"MuiToggleButton"}),t=I.children,n=I.className,l=I.color,o=void 0===l?"standard":l,a=I.disabled,i=void 0!==a&&a,r=I.disableFocusRipple,c=void 0!==r&&r,A=I.fullWidth,u=void 0!==A&&A,s=I.onChange,d=I.onClick,Z=I.selected,b=I.size,m=void 0===b?"medium":b,h=I.value,G=(0,U.Z)(I,Ld),p=(0,C.Z)({},I,{color:o,disabled:i,disableFocusRipple:c,fullWidth:u,size:m}),y=function(g){var e=g.classes,I=g.fullWidth,t=g.selected,n=g.disabled,C=g.size,l=g.color,o={root:["root",t&&"selected",n&&"disabled",I&&"fullWidth","size".concat((0,q.Z)(C)),l]};return(0,P.Z)(o,Ud,e)}(p);return(0,Ig.jsx)(Td,(0,C.Z)({className:(0,M.Z)(y.root,n),disabled:i,focusRipple:!c,ref:e,onClick:function(g){d&&(d(g,h),g.defaultPrevented)||s&&s(g,h)},onChange:s,value:h,ownerState:p,"aria-pressed":Z},G,{children:t}))})),Dd=Qd,jd=I(5735);function Pd(g){return(0,$.Z)("MuiButton",g)}var Od=(0,gg.Z)("MuiButton",["root","text","textInherit","textPrimary","textSecondary","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","contained","containedInherit","containedPrimary","containedSecondary","disableElevation","focusVisible","disabled","colorInherit","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","iconSizeSmall","iconSizeMedium","iconSizeLarge"]);var _d=t.createContext({}),qd=["children","color","component","className","disabled","disableElevation","disableFocusRipple","endIcon","focusVisibleClassName","fullWidth","size","startIcon","type","variant"],$d=function(g){return(0,C.Z)({},"small"===g.size&&{"& > *:nth-of-type(1)":{fontSize:18}},"medium"===g.size&&{"& > *:nth-of-type(1)":{fontSize:20}},"large"===g.size&&{"& > *:nth-of-type(1)":{fontSize:22}})},gZ=(0,O.ZP)(Ge,{shouldForwardProp:function(g){return(0,O.FO)(g)||"classes"===g},name:"MuiButton",slot:"Root",overridesResolver:function(g,e){var I=g.ownerState;return[e.root,e[I.variant],e["".concat(I.variant).concat((0,q.Z)(I.color))],e["size".concat((0,q.Z)(I.size))],e["".concat(I.variant,"Size").concat((0,q.Z)(I.size))],"inherit"===I.color&&e.colorInherit,I.disableElevation&&e.disableElevation,I.fullWidth&&e.fullWidth]}})((function(g){var e,I=g.theme,t=g.ownerState;return(0,C.Z)({},I.typography.button,(e={minWidth:64,padding:"6px 16px",borderRadius:I.shape.borderRadius,transition:I.transitions.create(["background-color","box-shadow","border-color","color"],{duration:I.transitions.duration.short}),"&:hover":(0,C.Z)({textDecoration:"none",backgroundColor:(0,Ag.Fq)(I.palette.text.primary,I.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"text"===t.variant&&"inherit"!==t.color&&{backgroundColor:(0,Ag.Fq)(I.palette[t.color].main,I.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"outlined"===t.variant&&"inherit"!==t.color&&{border:"1px solid ".concat(I.palette[t.color].main),backgroundColor:(0,Ag.Fq)(I.palette[t.color].main,I.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"contained"===t.variant&&{backgroundColor:I.palette.grey.A100,boxShadow:I.shadows[4],"@media (hover: none)":{boxShadow:I.shadows[2],backgroundColor:I.palette.grey[300]}},"contained"===t.variant&&"inherit"!==t.color&&{backgroundColor:I.palette[t.color].dark,"@media (hover: none)":{backgroundColor:I.palette[t.color].main}}),"&:active":(0,C.Z)({},"contained"===t.variant&&{boxShadow:I.shadows[8]})},(0,vg.Z)(e,"&.".concat(Od.focusVisible),(0,C.Z)({},"contained"===t.variant&&{boxShadow:I.shadows[6]})),(0,vg.Z)(e,"&.".concat(Od.disabled),(0,C.Z)({color:I.palette.action.disabled},"outlined"===t.variant&&{border:"1px solid ".concat(I.palette.action.disabledBackground)},"outlined"===t.variant&&"secondary"===t.color&&{border:"1px solid ".concat(I.palette.action.disabled)},"contained"===t.variant&&{color:I.palette.action.disabled,boxShadow:I.shadows[0],backgroundColor:I.palette.action.disabledBackground})),e),"text"===t.variant&&{padding:"6px 8px"},"text"===t.variant&&"inherit"!==t.color&&{color:I.palette[t.color].main},"outlined"===t.variant&&{padding:"5px 15px",border:"1px solid ".concat("light"===I.palette.mode?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)")},"outlined"===t.variant&&"inherit"!==t.color&&{color:I.palette[t.color].main,border:"1px solid ".concat((0,Ag.Fq)(I.palette[t.color].main,.5))},"contained"===t.variant&&{color:I.palette.getContrastText(I.palette.grey[300]),backgroundColor:I.palette.grey[300],boxShadow:I.shadows[2]},"contained"===t.variant&&"inherit"!==t.color&&{color:I.palette[t.color].contrastText,backgroundColor:I.palette[t.color].main},"inherit"===t.color&&{color:"inherit",borderColor:"currentColor"},"small"===t.size&&"text"===t.variant&&{padding:"4px 5px",fontSize:I.typography.pxToRem(13)},"large"===t.size&&"text"===t.variant&&{padding:"8px 11px",fontSize:I.typography.pxToRem(15)},"small"===t.size&&"outlined"===t.variant&&{padding:"3px 9px",fontSize:I.typography.pxToRem(13)},"large"===t.size&&"outlined"===t.variant&&{padding:"7px 21px",fontSize:I.typography.pxToRem(15)},"small"===t.size&&"contained"===t.variant&&{padding:"4px 10px",fontSize:I.typography.pxToRem(13)},"large"===t.size&&"contained"===t.variant&&{padding:"8px 22px",fontSize:I.typography.pxToRem(15)},t.fullWidth&&{width:"100%"})}),(function(g){var e;return g.ownerState.disableElevation&&(e={boxShadow:"none","&:hover":{boxShadow:"none"}},(0,vg.Z)(e,"&.".concat(Od.focusVisible),{boxShadow:"none"}),(0,vg.Z)(e,"&:active",{boxShadow:"none"}),(0,vg.Z)(e,"&.".concat(Od.disabled),{boxShadow:"none"}),e)})),eZ=(0,O.ZP)("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:function(g,e){var I=g.ownerState;return[e.startIcon,e["iconSize".concat((0,q.Z)(I.size))]]}})((function(g){var e=g.ownerState;return(0,C.Z)({display:"inherit",marginRight:8,marginLeft:-4},"small"===e.size&&{marginLeft:-2},$d(e))})),IZ=(0,O.ZP)("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:function(g,e){var I=g.ownerState;return[e.endIcon,e["iconSize".concat((0,q.Z)(I.size))]]}})((function(g){var e=g.ownerState;return(0,C.Z)({display:"inherit",marginRight:-4,marginLeft:8},"small"===e.size&&{marginRight:-2},$d(e))})),tZ=t.forwardRef((function(g,e){var I=t.useContext(_d),n=(0,jd.Z)(I,g),l=(0,_.Z)({props:n,name:"MuiButton"}),o=l.children,a=l.color,i=void 0===a?"primary":a,r=l.component,c=void 0===r?"button":r,A=l.className,u=l.disabled,s=void 0!==u&&u,d=l.disableElevation,Z=void 0!==d&&d,b=l.disableFocusRipple,m=void 0!==b&&b,h=l.endIcon,G=l.focusVisibleClassName,p=l.fullWidth,y=void 0!==p&&p,B=l.size,v=void 0===B?"medium":B,V=l.startIcon,W=l.type,S=l.variant,f=void 0===S?"text":S,k=(0,U.Z)(l,qd),R=(0,C.Z)({},l,{color:i,component:c,disabled:s,disableElevation:Z,disableFocusRipple:m,fullWidth:y,size:v,type:W,variant:f}),X=function(g){var e=g.color,I=g.disableElevation,t=g.fullWidth,n=g.size,l=g.variant,o=g.classes,a={root:["root",l,"".concat(l).concat((0,q.Z)(e)),"size".concat((0,q.Z)(n)),"".concat(l,"Size").concat((0,q.Z)(n)),"inherit"===e&&"colorInherit",I&&"disableElevation",t&&"fullWidth"],label:["label"],startIcon:["startIcon","iconSize".concat((0,q.Z)(n))],endIcon:["endIcon","iconSize".concat((0,q.Z)(n))]},i=(0,P.Z)(a,Pd,o);return(0,C.Z)({},o,i)}(R),J=V&&(0,Ig.jsx)(eZ,{className:X.startIcon,ownerState:R,children:V}),Y=h&&(0,Ig.jsx)(IZ,{className:X.endIcon,ownerState:R,children:h});return(0,Ig.jsxs)(gZ,(0,C.Z)({ownerState:R,className:(0,M.Z)(A,I.className),component:c,disabled:s,focusRipple:!m,focusVisibleClassName:(0,M.Z)(X.focusVisible,G),ref:e,type:W},k,{classes:X,children:[J,o,Y]}))})),nZ=tZ;I(7441);function CZ(g,e){return void 0!==e&&void 0!==g&&(Array.isArray(e)?e.indexOf(g)>=0:g===e)}function lZ(g){return(0,$.Z)("MuiToggleButtonGroup",g)}var oZ=(0,gg.Z)("MuiToggleButtonGroup",["root","selected","vertical","disabled","grouped","groupedHorizontal","groupedVertical"]),aZ=["children","className","color","disabled","exclusive","fullWidth","onChange","orientation","size","value"],iZ=(0,O.ZP)("div",{name:"MuiToggleButtonGroup",slot:"Root",overridesResolver:function(g,e){var I=g.ownerState;return[(0,vg.Z)({},"& .".concat(oZ.grouped),e.grouped),(0,vg.Z)({},"& .".concat(oZ.grouped),e["grouped".concat((0,q.Z)(I.orientation))]),e.root,"vertical"===I.orientation&&e.vertical,I.fullWidth&&e.fullWidth]}})((function(g){var e=g.ownerState,I=g.theme;return(0,C.Z)({display:"inline-flex",borderRadius:I.shape.borderRadius},"vertical"===e.orientation&&{flexDirection:"column"},e.fullWidth&&{width:"100%"},(0,vg.Z)({},"& .".concat(oZ.grouped),(0,C.Z)({},"horizontal"===e.orientation?(0,vg.Z)({"&:not(:first-of-type)":{marginLeft:-1,borderLeft:"1px solid transparent",borderTopLeftRadius:0,borderBottomLeftRadius:0},"&:not(:last-of-type)":{borderTopRightRadius:0,borderBottomRightRadius:0}},"&.".concat(oZ.selected," + .").concat(oZ.grouped,".").concat(oZ.selected),{borderLeft:0,marginLeft:0}):(0,vg.Z)({"&:not(:first-of-type)":{marginTop:-1,borderTop:"1px solid transparent",borderTopLeftRadius:0,borderTopRightRadius:0},"&:not(:last-of-type)":{borderBottomLeftRadius:0,borderBottomRightRadius:0}},"&.".concat(oZ.selected," + .").concat(oZ.grouped,".").concat(oZ.selected),{borderTop:0,marginTop:0}))))})),rZ=t.forwardRef((function(g,e){var I=(0,_.Z)({props:g,name:"MuiToggleButtonGroup"}),n=I.children,l=I.className,o=I.color,a=void 0===o?"standard":o,i=I.disabled,r=void 0!==i&&i,c=I.exclusive,A=void 0!==c&&c,u=I.fullWidth,s=void 0!==u&&u,d=I.onChange,Z=I.orientation,b=void 0===Z?"horizontal":Z,m=I.size,h=void 0===m?"medium":m,G=I.value,p=(0,U.Z)(I,aZ),y=(0,C.Z)({},I,{disabled:r,fullWidth:s,orientation:b,size:h}),B=function(g){var e=g.classes,I=g.orientation,t=g.fullWidth,n=g.disabled,C={root:["root","vertical"===I&&"vertical",t&&"fullWidth"],grouped:["grouped","grouped".concat((0,q.Z)(I)),n&&"disabled"]};return(0,P.Z)(C,lZ,e)}(y),v=function(g,e){if(d){var I,t=G&&G.indexOf(e);G&&t>=0?(I=G.slice()).splice(t,1):I=G?G.concat(e):[e],d(g,I)}},V=function(g,e){d&&d(g,G===e?null:e)};return(0,Ig.jsx)(iZ,(0,C.Z)({role:"group",className:(0,M.Z)(B.root,l),ref:e,ownerState:y},p,{children:t.Children.map(n,(function(g){return t.isValidElement(g)?t.cloneElement(g,{className:(0,M.Z)(B.grouped,g.props.className),onChange:A?V:v,selected:void 0===g.props.selected?CZ(g.props.value,G):g.props.selected,size:g.props.size||h,fullWidth:s,color:g.props.color||a,disabled:g.props.disabled||r}):null}))}))})),cZ=rZ;function AZ(g){return(0,$.Z)("MuiCard",g)}(0,gg.Z)("MuiCard",["root"]);var uZ=["className","raised"],sZ=(0,O.ZP)(mg,{name:"MuiCard",slot:"Root",overridesResolver:function(g,e){return e.root}})((function(){return{overflow:"hidden"}})),dZ=t.forwardRef((function(g,e){var I=(0,_.Z)({props:g,name:"MuiCard"}),t=I.className,n=I.raised,l=void 0!==n&&n,o=(0,U.Z)(I,uZ),a=(0,C.Z)({},I,{raised:l}),i=function(g){var e=g.classes;return(0,P.Z)({root:["root"]},AZ,e)}(a);return(0,Ig.jsx)(sZ,(0,C.Z)({className:(0,M.Z)(i.root,t),elevation:l?8:void 0,ref:e,ownerState:a},o))})),ZZ=dZ;function bZ(g){return(0,$.Z)("MuiCardActionArea",g)}var mZ=(0,gg.Z)("MuiCardActionArea",["root","focusVisible","focusHighlight"]),hZ=["children","className","focusVisibleClassName"],GZ=(0,O.ZP)(Ge,{name:"MuiCardActionArea",slot:"Root",overridesResolver:function(g,e){return e.root}})((function(g){var e,I=g.theme;return e={display:"block",textAlign:"inherit",width:"100%"},(0,vg.Z)(e,"&:hover .".concat(mZ.focusHighlight),{opacity:I.palette.action.hoverOpacity,"@media (hover: none)":{opacity:0}}),(0,vg.Z)(e,"&.".concat(mZ.focusVisible," .").concat(mZ.focusHighlight),{opacity:I.palette.action.focusOpacity}),e})),pZ=(0,O.ZP)("span",{name:"MuiCardActionArea",slot:"FocusHighlight",overridesResolver:function(g,e){return e.focusHighlight}})((function(g){var e=g.theme;return{overflow:"hidden",pointerEvents:"none",position:"absolute",top:0,right:0,bottom:0,left:0,borderRadius:"inherit",opacity:0,backgroundColor:"currentcolor",transition:e.transitions.create("opacity",{duration:e.transitions.duration.short})}})),yZ=t.forwardRef((function(g,e){var I=(0,_.Z)({props:g,name:"MuiCardActionArea"}),t=I.children,n=I.className,l=I.focusVisibleClassName,o=(0,U.Z)(I,hZ),a=I,i=function(g){var e=g.classes;return(0,P.Z)({root:["root"],focusHighlight:["focusHighlight"]},bZ,e)}(a);return(0,Ig.jsxs)(GZ,(0,C.Z)({className:(0,M.Z)(i.root,n),focusVisibleClassName:(0,M.Z)(l,i.focusVisible),ref:e,ownerState:a},o,{children:[t,(0,Ig.jsx)(pZ,{className:i.focusHighlight,ownerState:a})]}))})),BZ=yZ;function vZ(g){return(0,$.Z)("MuiCardMedia",g)}(0,gg.Z)("MuiCardMedia",["root","media","img"]);var VZ=["children","className","component","image","src","style"],WZ=(0,O.ZP)("div",{name:"MuiCardMedia",slot:"Root",overridesResolver:function(g,e){var I=g.ownerState,t=I.isMediaComponent,n=I.isImageComponent;return[e.root,t&&e.media,n&&e.img]}})((function(g){var e=g.ownerState;return(0,C.Z)({display:"block",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"},e.isMediaComponent&&{width:"100%"},e.isImageComponent&&{objectFit:"cover"})})),SZ=["video","audio","picture","iframe","img"],fZ=["picture","img"],kZ=t.forwardRef((function(g,e){var I=(0,_.Z)({props:g,name:"MuiCardMedia"}),t=I.children,n=I.className,l=I.component,o=void 0===l?"div":l,a=I.image,i=I.src,r=I.style,c=(0,U.Z)(I,VZ),A=-1!==SZ.indexOf(o),u=!A&&a?(0,C.Z)({backgroundImage:'url("'.concat(a,'")')},r):r,s=(0,C.Z)({},I,{component:o,isMediaComponent:A,isImageComponent:-1!==fZ.indexOf(o)}),d=function(g){var e=g.classes,I={root:["root",g.isMediaComponent&&"media",g.isImageComponent&&"img"]};return(0,P.Z)(I,vZ,e)}(s);return(0,Ig.jsx)(WZ,(0,C.Z)({className:(0,M.Z)(d.root,n),as:o,role:!A&&a?"img":void 0,ref:e,style:u,ownerState:s,src:A?a||i:void 0},c,{children:t}))})),RZ=kZ;function XZ(g){return(0,$.Z)("MuiCardContent",g)}(0,gg.Z)("MuiCardContent",["root"]);var JZ=["className","component"],YZ=(0,O.ZP)("div",{name:"MuiCardContent",slot:"Root",overridesResolver:function(g,e){return e.root}})((function(){return{padding:16,"&:last-child":{paddingBottom:24}}})),HZ=t.forwardRef((function(g,e){var I=(0,_.Z)({props:g,name:"MuiCardContent"}),t=I.className,n=I.component,l=void 0===n?"div":n,o=(0,U.Z)(I,JZ),a=(0,C.Z)({},I,{component:l}),i=function(g){var e=g.classes;return(0,P.Z)({root:["root"]},XZ,e)}(a);return(0,Ig.jsx)(YZ,(0,C.Z)({as:l,className:(0,M.Z)(i.root,t),ownerState:a,ref:e},o))})),wZ=HZ;function NZ(g){return(0,$.Z)("MuiCardActions",g)}(0,gg.Z)("MuiCardActions",["root","spacing"]);var KZ=["disableSpacing","className"],FZ=(0,O.ZP)("div",{name:"MuiCardActions",slot:"Root",overridesResolver:function(g,e){var I=g.ownerState;return[e.root,!I.disableSpacing&&e.spacing]}})((function(g){var e=g.ownerState;return(0,C.Z)({display:"flex",alignItems:"center",padding:8},!e.disableSpacing&&{"& > :not(:first-of-type)":{marginLeft:8}})})),EZ=t.forwardRef((function(g,e){var I=(0,_.Z)({props:g,name:"MuiCardActions"}),t=I.disableSpacing,n=void 0!==t&&t,l=I.className,o=(0,U.Z)(I,KZ),a=(0,C.Z)({},I,{disableSpacing:n}),i=function(g){var e=g.classes,I={root:["root",!g.disableSpacing&&"spacing"]};return(0,P.Z)(I,NZ,e)}(a);return(0,Ig.jsx)(FZ,(0,C.Z)({className:(0,M.Z)(i.root,l),ownerState:a,ref:e},o))})),xZ=EZ,zZ=I(3579),UZ=I(165),MZ=I(3950),LZ=I(36),TZ=I(9823),QZ=I(9008),DZ=function(){var g=(0,t.useState)([]),e=(0,n.Z)(g,2),I=e[0],C=e[1],l=(0,t.useState)([]),o=(0,n.Z)(l,2),a=(o[0],o[1],(0,t.useState)(1)),i=(0,n.Z)(a,2),r=(i[0],i[1],(0,t.useState)(100)),c=(0,n.Z)(r,2),A=c[0],u=(c[1],(0,t.useState)("No Result")),s=(0,n.Z)(u,2),d=(s[0],s[1]),b=(0,t.useState)(!1),m=(0,n.Z)(b,2),h=m[0],G=m[1],p=(0,t.useState)("left"),y=(0,n.Z)(p,2),B=y[0],v=y[1],V=function(){var g=(0,t.useContext)(Z).matches,e=g[g.length-1];return e?e.params:{}}().qr,W=[(0,Ig.jsx)(Dd,{value:"right",children:(0,Ig.jsx)(zZ.Z,{})},"right"),(0,Ig.jsx)(Dd,{value:"left",children:(0,Ig.jsx)(UZ.Z,{})},"left")],S={value:B,onChange:function(g,e){v(e)},exclusive:!0},f=function(){var g=lI(yI().mark((function g(e){var I,t,n;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return C((function(g){return[]})),I=xd(),t=Ed(I,"right"===B?"user_images/".concat(e,"/output/small_images/"):"model_images/"),g.next=5,Kd(t);case 5:n=g.sent,[],n.items.sort(),n.items.map(function(){var g=lI(yI().mark((function g(e){var t,n,l;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,Fd(Ed(I,e._location.path_));case 2:t=g.sent,n=Ed(I,t),l=n.name,C((function(g){return[].concat((0,L.Z)(g),[{url:t,name:l.slice(0,-4).toUpperCase()}])}));case 6:case"end":return g.stop()}}),g)})));return function(e){return g.apply(this,arguments)}}());case 9:case"end":return g.stop()}}),g)})));return function(e){return g.apply(this,arguments)}}();(0,t.useEffect)((function(){console.log(V),f(localStorage.getItem("qr"))}),[B]);return(0,Ig.jsxs)("div",{children:[!h&&(0,Ig.jsx)("div",{style:{position:"sticky",top:0,zIndex:9999,backgroundColor:"white",padding:20,paddingBottom:20,borderTop:"2px #2196f3 solid",borderBottom:"2px #2196f3 solid"},children:(0,Ig.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,Ig.jsxs)("div",{children:[(0,Ig.jsx)(nZ,{color:"primary",onClick:function(){return f(localStorage.getItem("qr"))},children:(0,Ig.jsx)(MZ.Z,{})}),(0,Ig.jsx)(nZ,{color:"primary",children:(0,Ig.jsx)(LZ.Z,{style:{color:localStorage.getItem("qr")?"green":""},onClick:function(){return G(!0)}})})]}),(0,Ig.jsx)("div",{children:(0,Ig.jsx)(He,{sx:{display:"flex",flexDirection:"column",alignItems:"right","& > :not(style) + :not(style)":{mt:2}},children:(0,Ig.jsx)(cZ,uI(uI({size:"small"},S),{},{children:W}))})})]})}),(0,Ig.jsxs)(Pe,{children:[h&&(0,Ig.jsxs)("div",{children:[(0,Ig.jsx)(nZ,{color:"primary",sx:{borderRadius:28},onClick:function(){return G(!1)},children:(0,Ig.jsx)(TZ.Z,{})}),(0,Ig.jsx)("br",{}),(0,Ig.jsx)("br",{}),(0,Ig.jsx)("br",{}),(0,Ig.jsx)("br",{}),(0,Ig.jsx)("br",{}),(0,Ig.jsx)("br",{}),(0,Ig.jsx)("br",{}),(0,Ig.jsx)("br",{}),(0,Ig.jsx)("div",{style:{padding:10,border:"3px #2196f3 dotted",paddingBottom:7},children:(0,Ig.jsx)(QZ,{delay:A,style:{height:"100%",width:"100%"},onError:function(g){return console.log(g)},onScan:function(g){null!=g&&(console.log(g),d(g.text),localStorage.setItem("qr",g.text),f(g.text),G(!1))},facingMode:"rear"})})]}),!h&&I.map((function(g,e){return(0,Ig.jsx)(ZZ,{sx:{marginBottom:5},style:{height:"900",boxShadow:"0 10px 20px rgba(0,0,0,0.06), 0 6px 6px rgba(0,0,0,0.08)"},children:(0,Ig.jsxs)(BZ,{children:[B&&(0,Ig.jsx)(RZ,{component:"img",height:"140",image:"".concat(g.url),alt:"green iguana"}),(0,Ig.jsxs)(wZ,{style:{margin:0,borderTop:"1px solid #2196f3"},children:[(0,Ig.jsx)(ag,{gutterBottom:!0,variant:"h5",component:"div",children:null===g||void 0===g?void 0:g.name}),(0,Ig.jsx)(ag,{variant:"body2",color:"text.secondary",children:"A T-shirt, or tee shirt, is a style of fabric shirt named after the T shape of its body and sleeves."})]}),(0,Ig.jsxs)(xZ,{style:{padding:10,paddingBottom:15,textAlign:"center"},children:[(0,Ig.jsx)(nZ,{variant:"contained",size:"large",children:"BUY NOW"}),(0,Ig.jsx)(nZ,{variant:"outlined",size:"large",children:"ADD TO CART"})]})]})},e)}))]})]})},jZ=function(){return(0,Ig.jsx)("div",{})},PZ=function(g){var e=(0,t.useState)(),I=(0,n.Z)(e,2),C=I[0];I[1];return(0,Ig.jsx)("p",{children:C})},OZ=function(){var g=_i(qi);return(0,t.useEffect)((function(){return e=Us(),I=function(e){g({isAuthenticating:!1,user:e&&{uid:e.uid,email:e.email,displayName:e.displayName}})},br(e).onAuthStateChanged(I,t,n);var e,I,t,n}),[g]),(0,Ig.jsxs)(p,{children:[(0,Ig.jsx)(h,{path:Me.signin,element:(0,Ig.jsx)(Oe,{})}),(0,Ig.jsx)(h,{path:Me.main,element:(0,Ig.jsx)(DZ,{})}),(0,Ig.jsx)(h,{path:Me.scanner,element:(0,Ig.jsx)(qe,{})}),(0,Ig.jsx)(h,{path:Me.pc,element:(0,Ig.jsx)(jZ,{})}),(0,Ig.jsx)(h,{path:Me.image,element:(0,Ig.jsx)(PZ,{})}),(0,Ig.jsx)(h,{path:Me.barcode,element:(0,Ig.jsx)(DZ,{})}),(0,Ig.jsx)(h,{path:"*",element:(0,Ig.jsx)(b,{to:Me.main})})]})},_Z=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function qZ(g,e){navigator.serviceWorker.register(g).then((function(g){g.onupdatefound=function(){var I=g.installing;null!=I&&(I.onstatechange=function(){"installed"===I.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),e&&e.onUpdate&&e.onUpdate(g)):(console.log("Content is cached for offline use."),e&&e.onSuccess&&e.onSuccess(g)))})}})).catch((function(g){console.error("Error during service worker registration:",g)}))}var $Z=I(8023),gb=I(9598),eb="function"===typeof Symbol&&Symbol.for?Symbol.for("mui.nested"):"__THEME_NESTED__";var Ib=function(g){var e=g.children,I=g.theme,n=(0,gb.Z)(),l=t.useMemo((function(){var g=null===n?I:function(g,e){return"function"===typeof e?e(g):(0,C.Z)({},g,e)}(n,I);return null!=g&&(g[eb]=null!==n),g}),[I,n]);return(0,Ig.jsx)($Z.Z.Provider,{value:l,children:e})};function tb(g){var e=(0,ke.Z)();return(0,Ig.jsx)(Mg.T.Provider,{value:"object"===typeof e?e:{},children:g.children})}var nb=function(g){var e=g.children,I=g.theme;return(0,Ig.jsx)(Ib,{theme:I,children:(0,Ig.jsx)(tb,{children:e})})};function Cb(g){var e=g.styles,I=g.defaultTheme,t=void 0===I?{}:I,n="function"===typeof e?function(g){return e(void 0===(I=g)||null===I||0===Object.keys(I).length?t:g);var I}:e;return(0,Ig.jsx)(Dg,{styles:n})}var lb=I(6482);var ob=function(g){return(0,Ig.jsx)(Cb,(0,C.Z)({},g,{defaultTheme:lb.Z}))},ab=function(g,e){return(0,C.Z)({WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",boxSizing:"border-box",WebkitTextSizeAdjust:"100%"},e&&{colorScheme:g.palette.mode})},ib=function(g){return(0,C.Z)({color:g.palette.text.primary},g.typography.body1,{backgroundColor:g.palette.background.default,"@media print":{backgroundColor:g.palette.common.white}})};var rb=function(g){var e=(0,_.Z)({props:g,name:"MuiCssBaseline"}),I=e.children,n=e.enableColorScheme,l=void 0!==n&&n;return(0,Ig.jsxs)(t.Fragment,{children:[(0,Ig.jsx)(ob,{styles:function(g){return function(g){var e,I,t={html:ab(g,arguments.length>1&&void 0!==arguments[1]&&arguments[1]),"*, *::before, *::after":{boxSizing:"inherit"},"strong, b":{fontWeight:g.typography.fontWeightBold},body:(0,C.Z)({margin:0},ib(g),{"&::backdrop":{backgroundColor:g.palette.background.default}})},n=null==(e=g.components)||null==(I=e.MuiCssBaseline)?void 0:I.styleOverrides;return n&&(t=[t,n]),t}(g,l)}}),I]})},cb=function(g){sI(I,g);var e=bI(I);function I(){var g;mI(this,I);for(var t=arguments.length,n=new Array(t),C=0;C<t;C++)n[C]=arguments[C];return(g=e.call.apply(e,[this].concat(n))).state={hasError:!1},g}return GI(I,[{key:"componentDidCatch",value:function(g,e){this.setState({hasError:!0}),this.props.onError(g,e)}},{key:"render",value:function(){var g=this.props,e=g.errorComponent,I=g.children;return this.state.hasError?e:I}}]),I}(t.Component),Ab=cb,ub=function(){return(0,Ig.jsx)(Pe,{children:"Something went wrong!"})};Or("firebase","9.6.3","app");var sb,db="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof I.g?I.g:"undefined"!==typeof self?self:{},Zb={},bb=bb||{},mb=db||self;function hb(){}function Gb(g){var e=typeof g;return"array"==(e="object"!=e?e:g?Array.isArray(g)?"array":e:"null")||"object"==e&&"number"==typeof g.length}function pb(g){var e=typeof g;return"object"==e&&null!=g||"function"==e}var yb="closure_uid_"+(1e9*Math.random()>>>0),Bb=0;function vb(g,e,I){return g.call.apply(g.bind,arguments)}function Vb(g,e,I){if(!g)throw Error();if(2<arguments.length){var t=Array.prototype.slice.call(arguments,2);return function(){var I=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(I,t),g.apply(e,I)}}return function(){return g.apply(e,arguments)}}function Wb(g,e,I){return(Wb=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?vb:Vb).apply(null,arguments)}function Sb(g,e){var I=Array.prototype.slice.call(arguments,1);return function(){var e=I.slice();return e.push.apply(e,arguments),g.apply(this,e)}}function fb(g,e){function I(){}I.prototype=e.prototype,g.Z=e.prototype,g.prototype=new I,g.prototype.constructor=g,g.Vb=function(g,I,t){for(var n=Array(arguments.length-2),C=2;C<arguments.length;C++)n[C-2]=arguments[C];return e.prototype[I].apply(g,n)}}function kb(){this.s=this.s,this.o=this.o}var Rb={};kb.prototype.s=!1,kb.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var g=function(g){return Object.prototype.hasOwnProperty.call(g,yb)&&g[yb]||(g[yb]=++Bb)}(this);delete Rb[g]}},kb.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var Xb=Array.prototype.indexOf?function(g,e){return Array.prototype.indexOf.call(g,e,void 0)}:function(g,e){if("string"===typeof g)return"string"!==typeof e||1!=e.length?-1:g.indexOf(e,0);for(var I=0;I<g.length;I++)if(I in g&&g[I]===e)return I;return-1},Jb=Array.prototype.forEach?function(g,e,I){Array.prototype.forEach.call(g,e,I)}:function(g,e,I){for(var t=g.length,n="string"===typeof g?g.split(""):g,C=0;C<t;C++)C in n&&e.call(I,n[C],C,g)};function Yb(g){return Array.prototype.concat.apply([],arguments)}function Hb(g){var e=g.length;if(0<e){for(var I=Array(e),t=0;t<e;t++)I[t]=g[t];return I}return[]}function wb(g){return/^[\s\xa0]*$/.test(g)}var Nb,Kb=String.prototype.trim?function(g){return g.trim()}:function(g){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(g)[1]};function Fb(g,e){return-1!=g.indexOf(e)}function Eb(g,e){return g<e?-1:g>e?1:0}g:{var xb=mb.navigator;if(xb){var zb=xb.userAgent;if(zb){Nb=zb;break g}}Nb=""}function Ub(g,e,I){for(var t in g)e.call(I,g[t],t,g)}function Mb(g){var e={};for(var I in g)e[I]=g[I];return e}var Lb="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Tb(g,e){for(var I,t,n=1;n<arguments.length;n++){for(I in t=arguments[n])g[I]=t[I];for(var C=0;C<Lb.length;C++)I=Lb[C],Object.prototype.hasOwnProperty.call(t,I)&&(g[I]=t[I])}}function Qb(g){return Qb[" "](g),g}Qb[" "]=hb;var Db,jb=Fb(Nb,"Opera"),Pb=Fb(Nb,"Trident")||Fb(Nb,"MSIE"),Ob=Fb(Nb,"Edge"),_b=Ob||Pb,qb=Fb(Nb,"Gecko")&&!(Fb(Nb.toLowerCase(),"webkit")&&!Fb(Nb,"Edge"))&&!(Fb(Nb,"Trident")||Fb(Nb,"MSIE"))&&!Fb(Nb,"Edge"),$b=Fb(Nb.toLowerCase(),"webkit")&&!Fb(Nb,"Edge");function gm(){var g=mb.document;return g?g.documentMode:void 0}g:{var em="",Im=function(){var g=Nb;return qb?/rv:([^\);]+)(\)|;)/.exec(g):Ob?/Edge\/([\d\.]+)/.exec(g):Pb?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(g):$b?/WebKit\/(\S+)/.exec(g):jb?/(?:Version)[ \/]?(\S+)/.exec(g):void 0}();if(Im&&(em=Im?Im[1]:""),Pb){var tm=gm();if(null!=tm&&tm>parseFloat(em)){Db=String(tm);break g}}Db=em}var nm,Cm={};function lm(){return function(g){var e=Cm;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=g(9)}((function(){for(var g=0,e=Kb(String(Db)).split("."),I=Kb("9").split("."),t=Math.max(e.length,I.length),n=0;0==g&&n<t;n++){var C=e[n]||"",l=I[n]||"";do{if(C=/(\d*)(\D*)(.*)/.exec(C)||["","","",""],l=/(\d*)(\D*)(.*)/.exec(l)||["","","",""],0==C[0].length&&0==l[0].length)break;g=Eb(0==C[1].length?0:parseInt(C[1],10),0==l[1].length?0:parseInt(l[1],10))||Eb(0==C[2].length,0==l[2].length)||Eb(C[2],l[2]),C=C[3],l=l[3]}while(0==g)}return 0<=g}))}if(mb.document&&Pb){var om=gm();nm=om||(parseInt(Db,10)||void 0)}else nm=void 0;var am=nm,im=function(){if(!mb.addEventListener||!Object.defineProperty)return!1;var g=!1,e=Object.defineProperty({},"passive",{get:function(){g=!0}});try{mb.addEventListener("test",hb,e),mb.removeEventListener("test",hb,e)}catch(I){}return g}();function rm(g,e){this.type=g,this.g=this.target=e,this.defaultPrevented=!1}function cm(g,e){if(rm.call(this,g?g.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,g){var I=this.type=g.type,t=g.changedTouches&&g.changedTouches.length?g.changedTouches[0]:null;if(this.target=g.target||g.srcElement,this.g=e,e=g.relatedTarget){if(qb){g:{try{Qb(e.nodeName);var n=!0;break g}catch(C){}n=!1}n||(e=null)}}else"mouseover"==I?e=g.fromElement:"mouseout"==I&&(e=g.toElement);this.relatedTarget=e,t?(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0):(this.clientX=void 0!==g.clientX?g.clientX:g.pageX,this.clientY=void 0!==g.clientY?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0),this.button=g.button,this.key=g.key||"",this.ctrlKey=g.ctrlKey,this.altKey=g.altKey,this.shiftKey=g.shiftKey,this.metaKey=g.metaKey,this.pointerId=g.pointerId||0,this.pointerType="string"===typeof g.pointerType?g.pointerType:Am[g.pointerType]||"",this.state=g.state,this.i=g,g.defaultPrevented&&cm.Z.h.call(this)}}rm.prototype.h=function(){this.defaultPrevented=!0},fb(cm,rm);var Am={2:"touch",3:"pen",4:"mouse"};cm.prototype.h=function(){cm.Z.h.call(this);var g=this.i;g.preventDefault?g.preventDefault():g.returnValue=!1};var um="closure_listenable_"+(1e6*Math.random()|0),sm=0;function dm(g,e,I,t,n){this.listener=g,this.proxy=null,this.src=e,this.type=I,this.capture=!!t,this.ia=n,this.key=++sm,this.ca=this.fa=!1}function Zm(g){g.ca=!0,g.listener=null,g.proxy=null,g.src=null,g.ia=null}function bm(g){this.src=g,this.g={},this.h=0}function mm(g,e){var I=e.type;if(I in g.g){var t,n=g.g[I],C=Xb(n,e);(t=0<=C)&&Array.prototype.splice.call(n,C,1),t&&(Zm(e),0==g.g[I].length&&(delete g.g[I],g.h--))}}function hm(g,e,I,t){for(var n=0;n<g.length;++n){var C=g[n];if(!C.ca&&C.listener==e&&C.capture==!!I&&C.ia==t)return n}return-1}bm.prototype.add=function(g,e,I,t,n){var C=g.toString();(g=this.g[C])||(g=this.g[C]=[],this.h++);var l=hm(g,e,t,n);return-1<l?(e=g[l],I||(e.fa=!1)):((e=new dm(e,this.src,C,!!t,n)).fa=I,g.push(e)),e};var Gm="closure_lm_"+(1e6*Math.random()|0),pm={};function ym(g,e,I,t,n){if(t&&t.once)return vm(g,e,I,t,n);if(Array.isArray(e)){for(var C=0;C<e.length;C++)ym(g,e[C],I,t,n);return null}return I=Xm(I),g&&g[um]?g.N(e,I,pb(t)?!!t.capture:!!t,n):Bm(g,e,I,!1,t,n)}function Bm(g,e,I,t,n,C){if(!e)throw Error("Invalid event type");var l=pb(n)?!!n.capture:!!n,o=km(g);if(o||(g[Gm]=o=new bm(g)),(I=o.add(e,I,t,l,C)).proxy)return I;if(t=function(){function g(I){return e.call(g.src,g.listener,I)}var e=fm;return g}(),I.proxy=t,t.src=g,t.listener=I,g.addEventListener)im||(n=l),void 0===n&&(n=!1),g.addEventListener(e.toString(),t,n);else if(g.attachEvent)g.attachEvent(Sm(e.toString()),t);else{if(!g.addListener||!g.removeListener)throw Error("addEventListener and attachEvent are unavailable.");g.addListener(t)}return I}function vm(g,e,I,t,n){if(Array.isArray(e)){for(var C=0;C<e.length;C++)vm(g,e[C],I,t,n);return null}return I=Xm(I),g&&g[um]?g.O(e,I,pb(t)?!!t.capture:!!t,n):Bm(g,e,I,!0,t,n)}function Vm(g,e,I,t,n){if(Array.isArray(e))for(var C=0;C<e.length;C++)Vm(g,e[C],I,t,n);else t=pb(t)?!!t.capture:!!t,I=Xm(I),g&&g[um]?(g=g.i,(e=String(e).toString())in g.g&&(-1<(I=hm(C=g.g[e],I,t,n))&&(Zm(C[I]),Array.prototype.splice.call(C,I,1),0==C.length&&(delete g.g[e],g.h--)))):g&&(g=km(g))&&(e=g.g[e.toString()],g=-1,e&&(g=hm(e,I,t,n)),(I=-1<g?e[g]:null)&&Wm(I))}function Wm(g){if("number"!==typeof g&&g&&!g.ca){var e=g.src;if(e&&e[um])mm(e.i,g);else{var I=g.type,t=g.proxy;e.removeEventListener?e.removeEventListener(I,t,g.capture):e.detachEvent?e.detachEvent(Sm(I),t):e.addListener&&e.removeListener&&e.removeListener(t),(I=km(e))?(mm(I,g),0==I.h&&(I.src=null,e[Gm]=null)):Zm(g)}}}function Sm(g){return g in pm?pm[g]:pm[g]="on"+g}function fm(g,e){if(g.ca)g=!0;else{e=new cm(e,this);var I=g.listener,t=g.ia||g.src;g.fa&&Wm(g),g=I.call(t,e)}return g}function km(g){return(g=g[Gm])instanceof bm?g:null}var Rm="__closure_events_fn_"+(1e9*Math.random()>>>0);function Xm(g){return"function"===typeof g?g:(g[Rm]||(g[Rm]=function(e){return g.handleEvent(e)}),g[Rm])}function Jm(){kb.call(this),this.i=new bm(this),this.P=this,this.I=null}function Ym(g,e){var I,t=g.I;if(t)for(I=[];t;t=t.I)I.push(t);if(g=g.P,t=e.type||e,"string"===typeof e)e=new rm(e,g);else if(e instanceof rm)e.target=e.target||g;else{var n=e;Tb(e=new rm(t,g),n)}if(n=!0,I)for(var C=I.length-1;0<=C;C--){var l=e.g=I[C];n=Hm(l,t,!0,e)&&n}if(n=Hm(l=e.g=g,t,!0,e)&&n,n=Hm(l,t,!1,e)&&n,I)for(C=0;C<I.length;C++)n=Hm(l=e.g=I[C],t,!1,e)&&n}function Hm(g,e,I,t){if(!(e=g.i.g[String(e)]))return!0;e=e.concat();for(var n=!0,C=0;C<e.length;++C){var l=e[C];if(l&&!l.ca&&l.capture==I){var o=l.listener,a=l.ia||l.src;l.fa&&mm(g.i,l),n=!1!==o.call(a,t)&&n}}return n&&!t.defaultPrevented}fb(Jm,kb),Jm.prototype[um]=!0,Jm.prototype.removeEventListener=function(g,e,I,t){Vm(this,g,e,I,t)},Jm.prototype.M=function(){if(Jm.Z.M.call(this),this.i){var g,e=this.i;for(g in e.g){for(var I=e.g[g],t=0;t<I.length;t++)Zm(I[t]);delete e.g[g],e.h--}}this.I=null},Jm.prototype.N=function(g,e,I,t){return this.i.add(String(g),e,!1,I,t)},Jm.prototype.O=function(g,e,I,t){return this.i.add(String(g),e,!0,I,t)};var wm=mb.JSON.stringify;function Nm(){var g=Lm,e=null;return g.g&&(e=g.g,g.g=g.g.next,g.g||(g.h=null),e.next=null),e}var Km,Fm=function(){function g(){mI(this,g),this.h=this.g=null}return GI(g,[{key:"add",value:function(g,e){var I=Em.get();I.set(g,e),this.h?this.h.next=I:this.g=I,this.h=I}}]),g}(),Em=new(function(){function g(e,I){mI(this,g),this.i=e,this.j=I,this.h=0,this.g=null}return GI(g,[{key:"get",value:function(){var g;return 0<this.h?(this.h--,g=this.g,this.g=g.next,g.next=null):g=this.i(),g}}]),g}())((function(){return new xm}),(function(g){return g.reset()})),xm=function(){function g(){mI(this,g),this.next=this.g=this.h=null}return GI(g,[{key:"set",value:function(g,e){this.h=g,this.g=e,this.next=null}},{key:"reset",value:function(){this.next=this.g=this.h=null}}]),g}();function zm(g){mb.setTimeout((function(){throw g}),0)}function Um(g,e){Km||function(){var g=mb.Promise.resolve(void 0);Km=function(){g.then(Tm)}}(),Mm||(Km(),Mm=!0),Lm.add(g,e)}var Mm=!1,Lm=new Fm;function Tm(){for(var g;g=Nm();){try{g.h.call(g.g)}catch(I){zm(I)}var e=Em;e.j(g),100>e.h&&(e.h++,g.next=e.g,e.g=g)}Mm=!1}function Qm(g,e){Jm.call(this),this.h=g||1,this.g=e||mb,this.j=Wb(this.kb,this),this.l=Date.now()}function Dm(g){g.da=!1,g.S&&(g.g.clearTimeout(g.S),g.S=null)}function jm(g,e,I){if("function"===typeof g)I&&(g=Wb(g,I));else{if(!g||"function"!=typeof g.handleEvent)throw Error("Invalid listener argument");g=Wb(g.handleEvent,g)}return 2147483647<Number(e)?-1:mb.setTimeout(g,e||0)}function Pm(g){g.g=jm((function(){g.g=null,g.i&&(g.i=!1,Pm(g))}),g.j);var e=g.h;g.h=null,g.m.apply(null,e)}fb(Qm,Jm),(sb=Qm.prototype).da=!1,sb.S=null,sb.kb=function(){if(this.da){var g=Date.now()-this.l;0<g&&g<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-g):(this.S&&(this.g.clearTimeout(this.S),this.S=null),Ym(this,"tick"),this.da&&(Dm(this),this.start()))}},sb.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},sb.M=function(){Qm.Z.M.call(this),Dm(this),delete this.g};var Om=function(g){sI(I,g);var e=bI(I);function I(g,t){var n;return mI(this,I),(n=e.call(this)).m=g,n.j=t,n.h=null,n.i=!1,n.g=null,n}return GI(I,[{key:"l",value:function(g){this.h=arguments,this.g?this.i=!0:Pm(this)}},{key:"M",value:function(){gr(oI(I.prototype),"M",this).call(this),this.g&&(mb.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}]),I}(kb);function _m(g){kb.call(this),this.h=g,this.g={}}fb(_m,kb);var qm=[];function $m(g,e,I,t){Array.isArray(I)||(I&&(qm[0]=I.toString()),I=qm);for(var n=0;n<I.length;n++){var C=ym(e,I[n],t||g.handleEvent,!1,g.h||g);if(!C)break;g.g[C.key]=C}}function gh(g){Ub(g.g,(function(g,e){this.g.hasOwnProperty(e)&&Wm(g)}),g),g.g={}}function eh(){this.g=!0}function Ih(g,e,I,t){g.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(g,e){if(!g.g)return e;if(!e)return null;try{var I=JSON.parse(e);if(I)for(g=0;g<I.length;g++)if(Array.isArray(I[g])){var t=I[g];if(!(2>t.length)){var n=t[1];if(Array.isArray(n)&&!(1>n.length)){var C=n[0];if("noop"!=C&&"stop"!=C&&"close"!=C)for(var l=1;l<n.length;l++)n[l]=""}}}return wm(I)}catch(o){return e}}(g,I)+(t?" "+t:"")}))}_m.prototype.M=function(){_m.Z.M.call(this),gh(this)},_m.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},eh.prototype.Aa=function(){this.g=!1},eh.prototype.info=function(){};var th={},nh=null;function Ch(){return nh=nh||new Jm}function lh(g){rm.call(this,th.Ma,g)}function oh(g){var e=Ch();Ym(e,new lh(e,g))}function ah(g,e){rm.call(this,th.STAT_EVENT,g),this.stat=e}function ih(g){var e=Ch();Ym(e,new ah(e,g))}function rh(g,e){rm.call(this,th.Na,g),this.size=e}function ch(g,e){if("function"!==typeof g)throw Error("Fn must not be null and must be a function");return mb.setTimeout((function(){g()}),e)}th.Ma="serverreachability",fb(lh,rm),th.STAT_EVENT="statevent",fb(ah,rm),th.Na="timingevent",fb(rh,rm);var Ah={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},uh={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function sh(){}function dh(g){return g.h||(g.h=g.i())}function Zh(){}sh.prototype.h=null;var bh,mh={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function hh(){rm.call(this,"d")}function Gh(){rm.call(this,"c")}function ph(){}function yh(g,e,I,t){this.l=g,this.j=e,this.m=I,this.X=t||1,this.V=new _m(this),this.P=vh,g=_b?125:void 0,this.W=new Qm(g),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new Bh}function Bh(){this.i=null,this.g="",this.h=!1}fb(hh,rm),fb(Gh,rm),fb(ph,sh),ph.prototype.g=function(){return new XMLHttpRequest},ph.prototype.i=function(){return{}},bh=new ph;var vh=45e3,Vh={},Wh={};function Sh(g,e,I){g.K=1,g.v=Oh(Lh(e)),g.s=I,g.U=!0,fh(g,null)}function fh(g,e){g.F=Date.now(),Jh(g),g.A=Lh(g.v);var I=g.A,t=g.X;Array.isArray(t)||(t=[String(t)]),iG(I.h,"t",t),g.C=0,I=g.l.H,g.h=new Bh,g.g=cp(g.l,I?e:null,!g.s),0<g.O&&(g.L=new Om(Wb(g.Ia,g,g.g),g.O)),$m(g.V,g.g,"readystatechange",g.gb),e=g.H?Mb(g.H):{},g.s?(g.u||(g.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",g.g.ea(g.A,g.u,g.s,e)):(g.u="GET",g.g.ea(g.A,g.u,null,e)),oh(1),function(g,e,I,t,n,C){g.info((function(){if(g.g)if(C)for(var l="",o=C.split("&"),a=0;a<o.length;a++){var i=o[a].split("=");if(1<i.length){var r=i[0];i=i[1];var c=r.split("_");l=2<=c.length&&"type"==c[1]?l+(r+"=")+i+"&":l+(r+"=redacted&")}}else l=null;else l=C;return"XMLHTTP REQ ("+t+") [attempt "+n+"]: "+e+"\n"+I+"\n"+l}))}(g.j,g.u,g.A,g.m,g.X,g.s)}function kh(g){return!!g.g&&("GET"==g.u&&2!=g.K&&g.l.Ba)}function Rh(g,e,I){for(var t,n=!0;!g.I&&g.C<I.length;){if((t=Xh(g,I))==Wh){4==e&&(g.o=4,ih(14),n=!1),Ih(g.j,g.m,null,"[Incomplete Response]");break}if(t==Vh){g.o=4,ih(15),Ih(g.j,g.m,I,"[Invalid Chunk]"),n=!1;break}Ih(g.j,g.m,t,null),Kh(g,t)}kh(g)&&t!=Wh&&t!=Vh&&(g.h.g="",g.C=0),4!=e||0!=I.length||g.h.h||(g.o=1,ih(16),n=!1),g.i=g.i&&n,n?0<I.length&&!g.aa&&(g.aa=!0,(e=g.l).g==g&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+I.length),tp(e),e.L=!0,ih(11))):(Ih(g.j,g.m,I,"[Invalid Chunked Response]"),Nh(g),wh(g))}function Xh(g,e){var I=g.C,t=e.indexOf("\n",I);return-1==t?Wh:(I=Number(e.substring(I,t)),isNaN(I)?Vh:(t+=1)+I>e.length?Wh:(e=e.substr(t,I),g.C=t+I,e))}function Jh(g){g.Y=Date.now()+g.P,Yh(g,g.P)}function Yh(g,e){if(null!=g.B)throw Error("WatchDog timer not null");g.B=ch(Wb(g.eb,g),e)}function Hh(g){g.B&&(mb.clearTimeout(g.B),g.B=null)}function wh(g){0==g.l.G||g.I||lp(g.l,g)}function Nh(g){Hh(g);var e=g.L;e&&"function"==typeof e.na&&e.na(),g.L=null,Dm(g.W),gh(g.V),g.g&&(e=g.g,g.g=null,e.abort(),e.na())}function Kh(g,e){try{var I=g.l;if(0!=I.G&&(I.g==g||bG(I.i,g)))if(I.I=g.N,!g.J&&bG(I.i,g)&&3==I.G){try{var t=I.Ca.g.parse(e)}catch(C){t=null}if(Array.isArray(t)&&3==t.length){var n=t;if(0==n[0]){g:if(!I.u){if(I.g){if(!(I.g.F+3e3<g.F))break g;Cp(I),jG(I)}Ip(I),ih(18)}}else I.ta=n[1],0<I.ta-I.U&&37500>n[2]&&I.N&&0==I.A&&!I.v&&(I.v=ch(Wb(I.ab,I),6e3));if(1>=ZG(I.i)&&I.ka){try{I.ka()}catch(C){}I.ka=void 0}}else ap(I,11)}else if((g.J||I.g==g)&&Cp(I),!wb(e))for(n=I.Ca.g.parse(e),e=0;e<n.length;e++){var C=n[e];if(I.U=C[0],C=C[1],2==I.G)if("c"==C[0]){I.J=C[1],I.la=C[2];var l=C[3];null!=l&&(I.ma=l,I.h.info("VER="+I.ma));var o=C[4];null!=o&&(I.za=o,I.h.info("SVER="+I.za));var a=C[5];null!=a&&"number"===typeof a&&0<a&&(t=1.5*a,I.K=t,I.h.info("backChannelRequestTimeoutMs_="+t)),t=I;var i=g.g;if(i){var r=i.g?i.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(r){var c=t.i;!c.g&&(Fb(r,"spdy")||Fb(r,"quic")||Fb(r,"h2"))&&(c.j=c.l,c.g=new Set,c.h&&(mG(c,c.h),c.h=null))}if(t.D){var A=i.g?i.g.getResponseHeader("X-HTTP-Session-Id"):null;A&&(t.sa=A,Ph(t.F,t.D,A))}}I.G=3,I.j&&I.j.xa(),I.$&&(I.O=Date.now()-g.F,I.h.info("Handshake RTT: "+I.O+"ms"));var u=g;if((t=I).oa=rp(t,t.H?t.la:null,t.W),u.J){hG(t.i,u);var s=u,d=t.K;d&&s.setTimeout(d),s.B&&(Hh(s),Jh(s)),t.g=u}else ep(t);0<I.l.length&&_G(I)}else"stop"!=C[0]&&"close"!=C[0]||ap(I,7);else 3==I.G&&("stop"==C[0]||"close"==C[0]?"stop"==C[0]?ap(I,7):DG(I):"noop"!=C[0]&&I.j&&I.j.wa(C),I.A=0)}oh(4)}catch(C){}}function Fh(g,e){if(g.forEach&&"function"==typeof g.forEach)g.forEach(e,void 0);else if(Gb(g)||"string"===typeof g)Jb(g,e,void 0);else{if(g.T&&"function"==typeof g.T)var I=g.T();else if(g.R&&"function"==typeof g.R)I=void 0;else if(Gb(g)||"string"===typeof g){I=[];for(var t=g.length,n=0;n<t;n++)I.push(n)}else for(n in I=[],t=0,g)I[t++]=n;t=function(g){if(g.R&&"function"==typeof g.R)return g.R();if("string"===typeof g)return g.split("");if(Gb(g)){for(var e=[],I=g.length,t=0;t<I;t++)e.push(g[t]);return e}for(t in e=[],I=0,g)e[I++]=g[t];return e}(g),n=t.length;for(var C=0;C<n;C++)e.call(void 0,t[C],I&&I[C],g)}}function Eh(g,e){this.h={},this.g=[],this.i=0;var I=arguments.length;if(1<I){if(I%2)throw Error("Uneven number of arguments");for(var t=0;t<I;t+=2)this.set(arguments[t],arguments[t+1])}else if(g)if(g instanceof Eh)for(I=g.T(),t=0;t<I.length;t++)this.set(I[t],g.get(I[t]));else for(t in g)this.set(t,g[t])}function xh(g){if(g.i!=g.g.length){for(var e=0,I=0;e<g.g.length;){var t=g.g[e];zh(g.h,t)&&(g.g[I++]=t),e++}g.g.length=I}if(g.i!=g.g.length){var n={};for(I=e=0;e<g.g.length;)zh(n,t=g.g[e])||(g.g[I++]=t,n[t]=1),e++;g.g.length=I}}function zh(g,e){return Object.prototype.hasOwnProperty.call(g,e)}(sb=yh.prototype).setTimeout=function(g){this.P=g},sb.gb=function(g){g=g.target;var e=this.L;e&&3==UG(g)?e.l():this.Ia(g)},sb.Ia=function(g){try{if(g==this.g)g:{var e=UG(this.g),I=this.g.Da(),t=this.g.ba();if(!(3>e)&&(3!=e||_b||this.g&&(this.h.h||this.g.ga()||MG(this.g)))){this.I||4!=e||7==I||oh(8==I||0>=t?3:2),Hh(this);var n=this.g.ba();this.N=n;e:if(kh(this)){var C=MG(this.g);g="";var l=C.length,o=4==UG(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){Nh(this),wh(this);var a="";break e}this.h.i=new mb.TextDecoder}for(I=0;I<l;I++)this.h.h=!0,g+=this.h.i.decode(C[I],{stream:o&&I==l-1});C.splice(0,l),this.h.g+=g,this.C=0,a=this.h.g}else a=this.g.ga();if(this.i=200==n,function(g,e,I,t,n,C,l){g.info((function(){return"XMLHTTP RESP ("+t+") [ attempt "+n+"]: "+e+"\n"+I+"\n"+C+" "+l}))}(this.j,this.u,this.A,this.m,this.X,e,n),this.i){if(this.$&&!this.J){e:{if(this.g){var i,r=this.g;if((i=r.g?r.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!wb(i)){var c=i;break e}}c=null}if(!(n=c)){this.i=!1,this.o=3,ih(12),Nh(this),wh(this);break g}Ih(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Kh(this,n)}this.U?(Rh(this,e,a),_b&&this.i&&3==e&&($m(this.V,this.W,"tick",this.fb),this.W.start())):(Ih(this.j,this.m,a,null),Kh(this,a)),4==e&&Nh(this),this.i&&!this.I&&(4==e?lp(this.l,this):(this.i=!1,Jh(this)))}else 400==n&&0<a.indexOf("Unknown SID")?(this.o=3,ih(12)):(this.o=0,ih(13)),Nh(this),wh(this)}}}catch(e){}},sb.fb=function(){if(this.g){var g=UG(this.g),e=this.g.ga();this.C<e.length&&(Hh(this),Rh(this,g,e),this.i&&4!=g&&Jh(this))}},sb.cancel=function(){this.I=!0,Nh(this)},sb.eb=function(){this.B=null;var g=Date.now();0<=g-this.Y?(function(g,e){g.info((function(){return"TIMEOUT: "+e}))}(this.j,this.A),2!=this.K&&(oh(3),ih(17)),Nh(this),this.o=2,wh(this)):Yh(this,this.Y-g)},(sb=Eh.prototype).R=function(){xh(this);for(var g=[],e=0;e<this.g.length;e++)g.push(this.h[this.g[e]]);return g},sb.T=function(){return xh(this),this.g.concat()},sb.get=function(g,e){return zh(this.h,g)?this.h[g]:e},sb.set=function(g,e){zh(this.h,g)||(this.i++,this.g.push(g)),this.h[g]=e},sb.forEach=function(g,e){for(var I=this.T(),t=0;t<I.length;t++){var n=I[t],C=this.get(n);g.call(e,C,n,this)}};var Uh=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Mh(g,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,g instanceof Mh){this.g=void 0!==e?e:g.g,Th(this,g.j),this.s=g.s,Qh(this,g.i),Dh(this,g.m),this.l=g.l,e=g.h;var I=new CG;I.i=e.i,e.g&&(I.g=new Eh(e.g),I.h=e.h),jh(this,I),this.o=g.o}else g&&(I=String(g).match(Uh))?(this.g=!!e,Th(this,I[1]||"",!0),this.s=_h(I[2]||""),Qh(this,I[3]||"",!0),Dh(this,I[4]),this.l=_h(I[5]||"",!0),jh(this,I[6]||"",!0),this.o=_h(I[7]||"")):(this.g=!!e,this.h=new CG(null,this.g))}function Lh(g){return new Mh(g)}function Th(g,e,I){g.j=I?_h(e,!0):e,g.j&&(g.j=g.j.replace(/:$/,""))}function Qh(g,e,I){g.i=I?_h(e,!0):e}function Dh(g,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);g.m=e}else g.m=null}function jh(g,e,I){e instanceof CG?(g.h=e,function(g,e){e&&!g.j&&(lG(g),g.i=null,g.g.forEach((function(g,e){var I=e.toLowerCase();e!=I&&(oG(this,e),iG(this,I,g))}),g)),g.j=e}(g.h,g.g)):(I||(e=qh(e,tG)),g.h=new CG(e,g.g))}function Ph(g,e,I){g.h.set(e,I)}function Oh(g){return Ph(g,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),g}function _h(g,e){return g?e?decodeURI(g.replace(/%25/g,"%2525")):decodeURIComponent(g):""}function qh(g,e,I){return"string"===typeof g?(g=encodeURI(g).replace(e,$h),I&&(g=g.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g):null}function $h(g){return"%"+((g=g.charCodeAt(0))>>4&15).toString(16)+(15&g).toString(16)}Mh.prototype.toString=function(){var g=[],e=this.j;e&&g.push(qh(e,gG,!0),":");var I=this.i;return(I||"file"==e)&&(g.push("//"),(e=this.s)&&g.push(qh(e,gG,!0),"@"),g.push(encodeURIComponent(String(I)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(I=this.m)&&g.push(":",String(I))),(I=this.l)&&(this.i&&"/"!=I.charAt(0)&&g.push("/"),g.push(qh(I,"/"==I.charAt(0)?IG:eG,!0))),(I=this.h.toString())&&g.push("?",I),(I=this.o)&&g.push("#",qh(I,nG)),g.join("")};var gG=/[#\/\?@]/g,eG=/[#\?:]/g,IG=/[#\?]/g,tG=/[#\?@]/g,nG=/#/g;function CG(g,e){this.h=this.g=null,this.i=g||null,this.j=!!e}function lG(g){g.g||(g.g=new Eh,g.h=0,g.i&&function(g,e){if(g){g=g.split("&");for(var I=0;I<g.length;I++){var t=g[I].indexOf("="),n=null;if(0<=t){var C=g[I].substring(0,t);n=g[I].substring(t+1)}else C=g[I];e(C,n?decodeURIComponent(n.replace(/\+/g," ")):"")}}}(g.i,(function(e,I){g.add(decodeURIComponent(e.replace(/\+/g," ")),I)})))}function oG(g,e){lG(g),e=rG(g,e),zh(g.g.h,e)&&(g.i=null,g.h-=g.g.get(e).length,zh((g=g.g).h,e)&&(delete g.h[e],g.i--,g.g.length>2*g.i&&xh(g)))}function aG(g,e){return lG(g),e=rG(g,e),zh(g.g.h,e)}function iG(g,e,I){oG(g,e),0<I.length&&(g.i=null,g.g.set(rG(g,e),Hb(I)),g.h+=I.length)}function rG(g,e){return e=String(e),g.j&&(e=e.toLowerCase()),e}(sb=CG.prototype).add=function(g,e){lG(this),this.i=null,g=rG(this,g);var I=this.g.get(g);return I||this.g.set(g,I=[]),I.push(e),this.h+=1,this},sb.forEach=function(g,e){lG(this),this.g.forEach((function(I,t){Jb(I,(function(I){g.call(e,I,t,this)}),this)}),this)},sb.T=function(){lG(this);for(var g=this.g.R(),e=this.g.T(),I=[],t=0;t<e.length;t++)for(var n=g[t],C=0;C<n.length;C++)I.push(e[t]);return I},sb.R=function(g){lG(this);var e=[];if("string"===typeof g)aG(this,g)&&(e=Yb(e,this.g.get(rG(this,g))));else{g=this.g.R();for(var I=0;I<g.length;I++)e=Yb(e,g[I])}return e},sb.set=function(g,e){return lG(this),this.i=null,aG(this,g=rG(this,g))&&(this.h-=this.g.get(g).length),this.g.set(g,[e]),this.h+=1,this},sb.get=function(g,e){return g&&0<(g=this.R(g)).length?String(g[0]):e},sb.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var g=[],e=this.g.T(),I=0;I<e.length;I++){var t=e[I],n=encodeURIComponent(String(t));t=this.R(t);for(var C=0;C<t.length;C++){var l=n;""!==t[C]&&(l+="="+encodeURIComponent(String(t[C]))),g.push(l)}}return this.i=g.join("&")};var cG=GI((function g(e,I){mI(this,g),this.h=e,this.g=I}));function AG(g){this.l=g||sG,mb.PerformanceNavigationTiming?g=0<(g=mb.performance.getEntriesByType("navigation")).length&&("hq"==g[0].nextHopProtocol||"h2"==g[0].nextHopProtocol):g=!!(mb.g&&mb.g.Ea&&mb.g.Ea()&&mb.g.Ea().Zb),this.j=g?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var uG,sG=10;function dG(g){return!!g.h||!!g.g&&g.g.size>=g.j}function ZG(g){return g.h?1:g.g?g.g.size:0}function bG(g,e){return g.h?g.h==e:!!g.g&&g.g.has(e)}function mG(g,e){g.g?g.g.add(e):g.h=e}function hG(g,e){g.h&&g.h==e?g.h=null:g.g&&g.g.has(e)&&g.g.delete(e)}function GG(g){if(null!=g.h)return g.i.concat(g.h.D);if(null!=g.g&&0!==g.g.size){var e,I=g.i,t=cI(g.g.values());try{for(t.s();!(e=t.n()).done;){var n=e.value;I=I.concat(n.D)}}catch(C){t.e(C)}finally{t.f()}return I}return Hb(g.i)}function pG(){}function yG(){this.g=new pG}function BG(g,e,I){var t=I||"";try{Fh(g,(function(g,I){var n=g;pb(g)&&(n=wm(g)),e.push(t+I+"="+encodeURIComponent(n))}))}catch(n){throw e.push(t+"type="+encodeURIComponent("_badmap")),n}}function vG(g,e,I,t,n){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,n(t)}catch(C){}}function VG(g){this.l=g.$b||null,this.j=g.ib||!1}function WG(g,e){Jm.call(this),this.D=g,this.u=e,this.m=void 0,this.readyState=SG,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}AG.prototype.cancel=function(){if(this.i=GG(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){var g,e=cI(this.g.values());try{for(e.s();!(g=e.n()).done;){g.value.cancel()}}catch(I){e.e(I)}finally{e.f()}this.g.clear()}},pG.prototype.stringify=function(g){return mb.JSON.stringify(g,void 0)},pG.prototype.parse=function(g){return mb.JSON.parse(g,void 0)},fb(VG,sh),VG.prototype.g=function(){return new WG(this.l,this.j)},VG.prototype.i=(uG={},function(){return uG}),fb(WG,Jm);var SG=0;function fG(g){g.j.read().then(g.Sa.bind(g)).catch(g.ha.bind(g))}function kG(g){g.readyState=4,g.l=null,g.j=null,g.A=null,RG(g)}function RG(g){g.onreadystatechange&&g.onreadystatechange.call(g)}(sb=WG.prototype).open=function(g,e){if(this.readyState!=SG)throw this.abort(),Error("Error reopening a connection");this.C=g,this.B=e,this.readyState=1,RG(this)},sb.send=function(g){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};g&&(e.body=g),(this.D||mb).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))},sb.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,kG(this)),this.readyState=SG},sb.Va=function(g){if(this.g&&(this.l=g,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=g.headers,this.readyState=2,RG(this)),this.g&&(this.readyState=3,RG(this),this.g)))if("arraybuffer"===this.responseType)g.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if("undefined"!==typeof mb.ReadableStream&&"body"in g){if(this.j=g.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;fG(this)}else g.text().then(this.Ua.bind(this),this.ha.bind(this))},sb.Sa=function(g){if(this.g){if(this.u&&g.value)this.response.push(g.value);else if(!this.u){var e=g.value?g.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!g.done}))&&(this.response=this.responseText+=e)}g.done?kG(this):RG(this),3==this.readyState&&fG(this)}},sb.Ua=function(g){this.g&&(this.response=this.responseText=g,kG(this))},sb.Ta=function(g){this.g&&(this.response=g,kG(this))},sb.ha=function(){this.g&&kG(this)},sb.setRequestHeader=function(g,e){this.v.append(g,e)},sb.getResponseHeader=function(g){return this.h&&this.h.get(g.toLowerCase())||""},sb.getAllResponseHeaders=function(){if(!this.h)return"";for(var g=[],e=this.h.entries(),I=e.next();!I.done;)I=I.value,g.push(I[0]+": "+I[1]),I=e.next();return g.join("\r\n")},Object.defineProperty(WG.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(g){this.m=g?"include":"same-origin"}});var XG=mb.JSON.parse;function JG(g){Jm.call(this),this.headers=new Eh,this.u=g||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=YG,this.K=this.L=!1}fb(JG,Jm);var YG="",HG=/^https?$/i,wG=["POST","PUT"];function NG(g){return"content-type"==g.toLowerCase()}function KG(g,e){g.h=!1,g.g&&(g.l=!0,g.g.abort(),g.l=!1),g.j=e,g.m=5,FG(g),xG(g)}function FG(g){g.D||(g.D=!0,Ym(g,"complete"),Ym(g,"error"))}function EG(g){if(g.h&&"undefined"!=typeof bb&&(!g.C[1]||4!=UG(g)||2!=g.ba()))if(g.v&&4==UG(g))jm(g.Fa,0,g);else if(Ym(g,"readystatechange"),4==UG(g)){g.h=!1;try{var e,I=g.ba();g:switch(I){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break g;default:t=!1}if(!(e=t)){var n;if(n=0===I){var C=String(g.H).match(Uh)[1]||null;if(!C&&mb.self&&mb.self.location){var l=mb.self.location.protocol;C=l.substr(0,l.length-1)}n=!HG.test(C?C.toLowerCase():"")}e=n}if(e)Ym(g,"complete"),Ym(g,"success");else{g.m=6;try{var o=2<UG(g)?g.g.statusText:""}catch(a){o=""}g.j=o+" ["+g.ba()+"]",FG(g)}}finally{xG(g)}}}function xG(g,e){if(g.g){zG(g);var I=g.g,t=g.C[0]?hb:null;g.g=null,g.C=null,e||Ym(g,"ready");try{I.onreadystatechange=t}catch(n){}}}function zG(g){g.g&&g.K&&(g.g.ontimeout=null),g.A&&(mb.clearTimeout(g.A),g.A=null)}function UG(g){return g.g?g.g.readyState:0}function MG(g){try{if(!g.g)return null;if("response"in g.g)return g.g.response;switch(g.J){case YG:case"text":return g.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in g.g)return g.g.mozResponseArrayBuffer}return null}catch(e){return null}}function LG(g,e,I){g:{for(t in I){var t=!1;break g}t=!0}t||(I=function(g){var e="";return Ub(g,(function(g,I){e+=I,e+=":",e+=g,e+="\r\n"})),e}(I),"string"===typeof g?null!=I&&encodeURIComponent(String(I)):Ph(g,e,I))}function TG(g,e,I){return I&&I.internalChannelParams&&I.internalChannelParams[g]||e}function QG(g){this.za=0,this.l=[],this.h=new eh,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=TG("failFast",!1,g),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=TG("baseRetryDelayMs",5e3,g),this.$a=TG("retryDelaySeedMs",1e4,g),this.Ya=TG("forwardChannelMaxRetries",2,g),this.ra=TG("forwardChannelRequestTimeoutMs",2e4,g),this.qa=g&&g.xmlHttpFactory||void 0,this.Ba=g&&g.Yb||!1,this.K=void 0,this.H=g&&g.supportsCrossDomainXhr||!1,this.J="",this.i=new AG(g&&g.concurrentRequestLimit),this.Ca=new yG,this.ja=g&&g.fastHandshake||!1,this.Ra=g&&g.Wb||!1,g&&g.Aa&&this.h.Aa(),g&&g.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&g&&g.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!g||!1!==g.Xb}function DG(g){if(PG(g),3==g.G){var e=g.V++,I=Lh(g.F);Ph(I,"SID",g.J),Ph(I,"RID",e),Ph(I,"TYPE","terminate"),$G(g,I),(e=new yh(g,g.h,e,void 0)).K=2,e.v=Oh(Lh(I)),I=!1,mb.navigator&&mb.navigator.sendBeacon&&(I=mb.navigator.sendBeacon(e.v.toString(),"")),!I&&mb.Image&&((new Image).src=e.v,I=!0),I||(e.g=cp(e.l,null),e.g.ea(e.v)),e.F=Date.now(),Jh(e)}ip(g)}function jG(g){g.g&&(tp(g),g.g.cancel(),g.g=null)}function PG(g){jG(g),g.u&&(mb.clearTimeout(g.u),g.u=null),Cp(g),g.i.cancel(),g.m&&("number"===typeof g.m&&mb.clearTimeout(g.m),g.m=null)}function OG(g,e){g.l.push(new cG(g.Za++,e)),3==g.G&&_G(g)}function _G(g){dG(g.i)||g.m||(g.m=!0,Um(g.Ha,g),g.C=0)}function qG(g,e){var I;I=e?e.m:g.V++;var t=Lh(g.F);Ph(t,"SID",g.J),Ph(t,"RID",I),Ph(t,"AID",g.U),$G(g,t),g.o&&g.s&&LG(t,g.o,g.s),I=new yh(g,g.h,I,g.C+1),null===g.o&&(I.H=g.s),e&&(g.l=e.D.concat(g.l)),e=gp(g,I,1e3),I.setTimeout(Math.round(.5*g.ra)+Math.round(.5*g.ra*Math.random())),mG(g.i,I),Sh(I,t,e)}function $G(g,e){g.j&&Fh({},(function(g,I){Ph(e,I,g)}))}function gp(g,e,I){I=Math.min(g.l.length,I);var t=g.j?Wb(g.j.Oa,g.j,g):null;g:for(var n=g.l,C=-1;;){var l=["count="+I];-1==C?0<I?(C=n[0].h,l.push("ofs="+C)):C=0:l.push("ofs="+C);for(var o=!0,a=0;a<I;a++){var i=n[a].h,r=n[a].g;if(0>(i-=C))C=Math.max(0,n[a].h-100),o=!1;else try{BG(r,l,"req"+i+"_")}catch(Rp){t&&t(r)}}if(o){t=l.join("&");break g}}return g=g.l.splice(0,I),e.D=g,t}function ep(g){g.g||g.u||(g.Y=1,Um(g.Ga,g),g.A=0)}function Ip(g){return!(g.g||g.u||3<=g.A)&&(g.Y++,g.u=ch(Wb(g.Ga,g),op(g,g.A)),g.A++,!0)}function tp(g){null!=g.B&&(mb.clearTimeout(g.B),g.B=null)}function np(g){g.g=new yh(g,g.h,"rpc",g.Y),null===g.o&&(g.g.H=g.s),g.g.O=0;var e=Lh(g.oa);Ph(e,"RID","rpc"),Ph(e,"SID",g.J),Ph(e,"CI",g.N?"0":"1"),Ph(e,"AID",g.U),$G(g,e),Ph(e,"TYPE","xmlhttp"),g.o&&g.s&&LG(e,g.o,g.s),g.K&&g.g.setTimeout(g.K);var I=g.g;g=g.la,I.K=1,I.v=Oh(Lh(e)),I.s=null,I.U=!0,fh(I,g)}function Cp(g){null!=g.v&&(mb.clearTimeout(g.v),g.v=null)}function lp(g,e){var I=null;if(g.g==e){Cp(g),tp(g),g.g=null;var t=2}else{if(!bG(g.i,e))return;I=e.D,hG(g.i,e),t=1}if(g.I=e.N,0!=g.G)if(e.i)if(1==t){I=e.s?e.s.length:0,e=Date.now()-e.F;var n=g.C;Ym(t=Ch(),new rh(t,I,e,n)),_G(g)}else ep(g);else if(3==(n=e.o)||0==n&&0<g.I||!(1==t&&function(g,e){return!(ZG(g.i)>=g.i.j-(g.m?1:0))&&(g.m?(g.l=e.D.concat(g.l),!0):!(1==g.G||2==g.G||g.C>=(g.Xa?0:g.Ya))&&(g.m=ch(Wb(g.Ha,g,e),op(g,g.C)),g.C++,!0))}(g,e)||2==t&&Ip(g)))switch(I&&0<I.length&&(e=g.i,e.i=e.i.concat(I)),n){case 1:ap(g,5);break;case 4:ap(g,10);break;case 3:ap(g,6);break;default:ap(g,2)}}function op(g,e){var I=g.Pa+Math.floor(Math.random()*g.$a);return g.j||(I*=2),I*e}function ap(g,e){if(g.h.info("Error code "+e),2==e){var I=null;g.j&&(I=null);var t=Wb(g.jb,g);I||(I=new Mh("//www.google.com/images/cleardot.gif"),mb.location&&"http"==mb.location.protocol||Th(I,"https"),Oh(I)),function(g,e){var I=new eh;if(mb.Image){var t=new Image;t.onload=Sb(vG,I,t,"TestLoadImage: loaded",!0,e),t.onerror=Sb(vG,I,t,"TestLoadImage: error",!1,e),t.onabort=Sb(vG,I,t,"TestLoadImage: abort",!1,e),t.ontimeout=Sb(vG,I,t,"TestLoadImage: timeout",!1,e),mb.setTimeout((function(){t.ontimeout&&t.ontimeout()}),1e4),t.src=g}else e(!1)}(I.toString(),t)}else ih(2);g.G=0,g.j&&g.j.va(e),ip(g),PG(g)}function ip(g){g.G=0,g.I=-1,g.j&&(0==GG(g.i).length&&0==g.l.length||(g.i.i.length=0,Hb(g.l),g.l.length=0),g.j.ua())}function rp(g,e,I){var t=function(g){return g instanceof Mh?Lh(g):new Mh(g,void 0)}(I);if(""!=t.i)e&&Qh(t,e+"."+t.i),Dh(t,t.m);else{var n=mb.location;t=function(g,e,I,t){var n=new Mh(null,void 0);return g&&Th(n,g),e&&Qh(n,e),I&&Dh(n,I),t&&(n.l=t),n}(n.protocol,e?e+"."+n.hostname:n.hostname,+n.port,I)}return g.aa&&Ub(g.aa,(function(g,e){Ph(t,e,g)})),e=g.D,I=g.sa,e&&I&&Ph(t,e,I),Ph(t,"VER",g.ma),$G(g,t),t}function cp(g,e,I){if(e&&!g.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=I&&g.Ba&&!g.qa?new JG(new VG({ib:!0})):new JG(g.qa)).L=g.H,e}function Ap(){}function up(){if(Pb&&!(10<=Number(am)))throw Error("Environmental error: no available transport.")}function sp(g,e){Jm.call(this),this.g=new QG(e),this.l=g,this.h=e&&e.messageUrlParams||null,g=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(g?g["X-Client-Protocol"]="webchannel":g={"X-Client-Protocol":"webchannel"}),this.g.s=g,g=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(g?g["X-WebChannel-Content-Type"]=e.messageContentType:g={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(g?g["X-WebChannel-Client-Profile"]=e.ya:g={"X-WebChannel-Client-Profile":e.ya}),this.g.P=g,(g=e&&e.httpHeadersOverwriteParam)&&!wb(g)&&(this.g.o=g),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!wb(e)&&(this.g.D=e,null!==(g=this.h)&&e in g&&(e in(g=this.h)&&delete g[e])),this.j=new bp(this)}function dp(g){hh.call(this);var e=g.__sm__;if(e){g:{for(var I in e){g=I;break g}g=void 0}(this.i=g)&&(g=this.i,e=null!==e&&g in e?e[g]:void 0),this.data=e}else this.data=g}function Zp(){Gh.call(this),this.status=1}function bp(g){this.g=g}(sb=JG.prototype).ea=function(g,e,I,t){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+g);e=e?e.toUpperCase():"GET",this.H=g,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():bh.g(),this.C=this.u?dh(this.u):dh(bh),this.g.onreadystatechange=Wb(this.Fa,this);try{this.F=!0,this.g.open(e,String(g),!0),this.F=!1}catch(C){return void KG(this,C)}g=I||"";var n=new Eh(this.headers);t&&Fh(t,(function(g,e){n.set(e,g)})),t=function(g){g:{for(var e=NG,I=g.length,t="string"===typeof g?g.split(""):g,n=0;n<I;n++)if(n in t&&e.call(void 0,t[n],n,g)){e=n;break g}e=-1}return 0>e?null:"string"===typeof g?g.charAt(e):g[e]}(n.T()),I=mb.FormData&&g instanceof mb.FormData,!(0<=Xb(wG,e))||t||I||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),n.forEach((function(g,e){this.g.setRequestHeader(e,g)}),this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{zG(this),0<this.B&&((this.K=function(g){return Pb&&lm()&&"number"===typeof g.timeout&&void 0!==g.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Wb(this.pa,this)):this.A=jm(this.pa,this.B,this)),this.v=!0,this.g.send(g),this.v=!1}catch(C){KG(this,C)}},sb.pa=function(){"undefined"!=typeof bb&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Ym(this,"timeout"),this.abort(8))},sb.abort=function(g){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=g||7,Ym(this,"complete"),Ym(this,"abort"),xG(this))},sb.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),xG(this,!0)),JG.Z.M.call(this)},sb.Fa=function(){this.s||(this.F||this.v||this.l?EG(this):this.cb())},sb.cb=function(){EG(this)},sb.ba=function(){try{return 2<UG(this)?this.g.status:-1}catch(uG){return-1}},sb.ga=function(){try{return this.g?this.g.responseText:""}catch(uG){return""}},sb.Qa=function(g){if(this.g){var e=this.g.responseText;return g&&0==e.indexOf(g)&&(e=e.substring(g.length)),XG(e)}},sb.Da=function(){return this.m},sb.La=function(){return"string"===typeof this.j?this.j:String(this.j)},(sb=QG.prototype).ma=8,sb.G=1,sb.hb=function(g){try{this.h.info("Origin Trials invoked: "+g)}catch(e){}},sb.Ha=function(g){if(this.m)if(this.m=null,1==this.G){if(!g){this.V=Math.floor(1e5*Math.random()),g=this.V++;var e=new yh(this,this.h,g,void 0),I=this.s;if(this.P&&(I?Tb(I=Mb(I),this.P):I=this.P),null===this.o&&(e.H=I),this.ja)g:{for(var t=0,n=0;n<this.l.length;n++){var C=this.l[n];if(void 0===(C="__data__"in C.g&&"string"===typeof(C=C.g.__data__)?C.length:void 0))break;if(4096<(t+=C)){t=n;break g}if(4096===t||n===this.l.length-1){t=n+1;break g}}t=1e3}else t=1e3;t=gp(this,e,t),Ph(n=Lh(this.F),"RID",g),Ph(n,"CVER",22),this.D&&Ph(n,"X-HTTP-Session-Id",this.D),$G(this,n),this.o&&I&&LG(n,this.o,I),mG(this.i,e),this.Ra&&Ph(n,"TYPE","init"),this.ja?(Ph(n,"$req",t),Ph(n,"SID","null"),e.$=!0,Sh(e,n,null)):Sh(e,n,t),this.G=2}}else 3==this.G&&(g?qG(this,g):0==this.l.length||dG(this.i)||qG(this))},sb.Ga=function(){if(this.u=null,np(this),this.$&&!(this.L||null==this.g||0>=this.O)){var g=2*this.O;this.h.info("BP detection timer enabled: "+g),this.B=ch(Wb(this.bb,this),g)}},sb.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,ih(10),jG(this),np(this))},sb.ab=function(){null!=this.v&&(this.v=null,jG(this),Ip(this),ih(19))},sb.jb=function(g){g?(this.h.info("Successfully pinged google.com"),ih(2)):(this.h.info("Failed to ping google.com"),ih(1))},(sb=Ap.prototype).xa=function(){},sb.wa=function(){},sb.va=function(){},sb.ua=function(){},sb.Oa=function(){},up.prototype.g=function(g,e){return new sp(g,e)},fb(sp,Jm),sp.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var g=this.g,e=this.l,I=this.h||void 0;g.Wa&&(g.h.info("Origin Trials enabled."),Um(Wb(g.hb,g,e))),ih(0),g.W=e,g.aa=I||{},g.N=g.X,g.F=rp(g,null,g.W),_G(g)},sp.prototype.close=function(){DG(this.g)},sp.prototype.u=function(g){if("string"===typeof g){var e={};e.__data__=g,OG(this.g,e)}else this.v?((e={}).__data__=wm(g),OG(this.g,e)):OG(this.g,g)},sp.prototype.M=function(){this.g.j=null,delete this.j,DG(this.g),delete this.g,sp.Z.M.call(this)},fb(dp,hh),fb(Zp,Gh),fb(bp,Ap),bp.prototype.xa=function(){Ym(this.g,"a")},bp.prototype.wa=function(g){Ym(this.g,new dp(g))},bp.prototype.va=function(g){Ym(this.g,new Zp(g))},bp.prototype.ua=function(){Ym(this.g,"b")},up.prototype.createWebChannel=up.prototype.g,sp.prototype.send=sp.prototype.u,sp.prototype.open=sp.prototype.m,sp.prototype.close=sp.prototype.close,Ah.NO_ERROR=0,Ah.TIMEOUT=8,Ah.HTTP_ERROR=6,uh.COMPLETE="complete",Zh.EventType=mh,mh.OPEN="a",mh.CLOSE="b",mh.ERROR="c",mh.MESSAGE="d",Jm.prototype.listen=Jm.prototype.N,JG.prototype.listenOnce=JG.prototype.O,JG.prototype.getLastError=JG.prototype.La,JG.prototype.getLastErrorCode=JG.prototype.Da,JG.prototype.getStatus=JG.prototype.ba,JG.prototype.getResponseJson=JG.prototype.Qa,JG.prototype.getResponseText=JG.prototype.ga,JG.prototype.send=JG.prototype.ea;Zb.createWebChannelTransport=function(){return new up},Zb.getStatEventTarget=function(){return Ch()},Zb.ErrorCode=Ah,Zb.EventType=uh,Zb.Event=th,Zb.Stat={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},Zb.FetchXmlHttpFactory=VG,Zb.WebChannel=Zh,Zb.XhrIo=JG;var mp="@firebase/firestore",hp=function(){function g(e){mI(this,g),this.uid=e}return GI(g,[{key:"isAuthenticated",value:function(){return null!=this.uid}},{key:"toKey",value:function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}},{key:"isEqual",value:function(g){return g.uid===this.uid}}]),g}();hp.UNAUTHENTICATED=new hp(null),hp.GOOGLE_CREDENTIALS=new hp("google-credentials-uid"),hp.FIRST_PARTY=new hp("first-party-uid"),hp.MOCK_USER=new hp("mock-user");var Gp="9.6.3",pp=new Xr("@firebase/firestore");function yp(g){if(pp.logLevel<=yr.DEBUG){for(var e=arguments.length,I=new Array(e>1?e-1:0),t=1;t<e;t++)I[t-1]=arguments[t];var n=I.map(vp);pp.debug.apply(pp,["Firestore (".concat(Gp,"): ").concat(g)].concat((0,L.Z)(n)))}}function Bp(g){if(pp.logLevel<=yr.ERROR){for(var e=arguments.length,I=new Array(e>1?e-1:0),t=1;t<e;t++)I[t-1]=arguments[t];var n=I.map(vp);pp.error.apply(pp,["Firestore (".concat(Gp,"): ").concat(g)].concat((0,L.Z)(n)))}}function vp(g){if("string"==typeof g)return g;try{return e=g,JSON.stringify(e)}catch(e){return g}var e}function Vp(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state",e="FIRESTORE (".concat(Gp,") INTERNAL ASSERTION FAILED: ")+g;throw Bp(e),new Error(e)}function Wp(g,e){g||Vp()}var Sp={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},fp=function(g){sI(I,g);var e=bI(I);function I(g,t){var n;return mI(this,I),(n=e.call(this,g,t)).code=g,n.message=t,n.toString=function(){return"".concat(n.name,": [code=").concat(n.code,"]: ").concat(n.message)},n}return GI(I)}(lr),kp=GI((function g(){var e=this;mI(this,g),this.promise=new Promise((function(g,I){e.resolve=g,e.reject=I}))})),Rp=GI((function g(e,I){mI(this,g),this.user=I,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(e))})),Xp=function(){function g(){mI(this,g)}return GI(g,[{key:"getToken",value:function(){return Promise.resolve(null)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(g,e){g.enqueueRetryable((function(){return e(hp.UNAUTHENTICATED)}))}},{key:"shutdown",value:function(){}}]),g}(),Jp=function(){function g(e){mI(this,g),this.t=e,this.currentUser=hp.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}return GI(g,[{key:"start",value:function(g,e){var I=this,t=this.i,n=function(g){return I.i!==t?(t=I.i,e(g)):Promise.resolve()},C=new kp;this.o=function(){I.i++,I.currentUser=I.u(),C.resolve(),C=new kp,g.enqueueRetryable((function(){return n(I.currentUser)}))};var l=function(){var e=C;g.enqueueRetryable(lI(yI().mark((function g(){return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,e.promise;case 2:return g.next=4,n(I.currentUser);case 4:case"end":return g.stop()}}),g)}))))},o=function(g){yp("FirebaseAuthCredentialsProvider","Auth detected"),I.auth=g,I.auth.addAuthTokenListener(I.o),l()};this.t.onInit((function(g){return o(g)})),setTimeout((function(){if(!I.auth){var g=I.t.getImmediate({optional:!0});g?o(g):(yp("FirebaseAuthCredentialsProvider","Auth not yet detected"),C.resolve(),C=new kp)}}),0),l()}},{key:"getToken",value:function(){var g=this,e=this.i,I=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(I).then((function(I){return g.i!==e?(yp("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),g.getToken()):I?(Wp("string"==typeof I.accessToken),new Rp(I.accessToken,g.currentUser)):null})):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.auth&&this.auth.removeAuthTokenListener(this.o)}},{key:"u",value:function(){var g=this.auth&&this.auth.getUid();return Wp(null===g||"string"==typeof g),new hp(g)}}]),g}(),Yp=GI((function g(e,I,t){mI(this,g),this.type="FirstParty",this.user=hp.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",I);var n=e.auth.getAuthHeaderValueForFirstParty([]);n&&this.headers.set("Authorization",n),t&&this.headers.set("X-Goog-Iam-Authorization-Token",t)})),Hp=function(){function g(e,I,t){mI(this,g),this.h=e,this.l=I,this.m=t}return GI(g,[{key:"getToken",value:function(){return Promise.resolve(new Yp(this.h,this.l,this.m))}},{key:"start",value:function(g,e){g.enqueueRetryable((function(){return e(hp.FIRST_PARTY)}))}},{key:"shutdown",value:function(){}},{key:"invalidateToken",value:function(){}}]),g}(),wp=GI((function g(e){mI(this,g),this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)})),Np=function(){function g(e){mI(this,g),this.g=e,this.forceRefresh=!1,this.appCheck=null}return GI(g,[{key:"start",value:function(g,e){var I=this;this.o=function(I){g.enqueueRetryable((function(){return function(g){return null!=g.error&&yp("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(g.error.message)),e(g.token)}(I)}))};var t=function(g){yp("FirebaseAppCheckTokenProvider","AppCheck detected"),I.appCheck=g,I.appCheck.addTokenListener(I.o)};this.g.onInit((function(g){return t(g)})),setTimeout((function(){if(!I.appCheck){var g=I.g.getImmediate({optional:!0});g?t(g):yp("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}},{key:"getToken",value:function(){var g=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(g).then((function(g){return g?(Wp("string"==typeof g.token),new wp(g.token)):null})):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}]),g}(),Kp=function(){function g(e,I){var t=this;mI(this,g),this.previousValue=e,I&&(I.sequenceNumberHandler=function(g){return t.p(g)},this.T=function(g){return I.writeSequenceNumber(g)})}return GI(g,[{key:"p",value:function(g){return this.previousValue=Math.max(g,this.previousValue),this.previousValue}},{key:"next",value:function(){var g=++this.previousValue;return this.T&&this.T(g),g}}]),g}();function Fp(g){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),I=new Uint8Array(g);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(I);else for(var t=0;t<g;t++)I[t]=Math.floor(256*Math.random());return I}Kp.I=-1;var Ep=function(){function g(){mI(this,g)}return GI(g,null,[{key:"A",value:function(){for(var g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/g.length)*g.length,I="";I.length<20;)for(var t=Fp(40),n=0;n<t.length;++n)I.length<20&&t[n]<e&&(I+=g.charAt(t[n]%g.length));return I}}]),g}();function xp(g,e){return g<e?-1:g>e?1:0}var zp=function(){function g(e,I,t){mI(this,g),void 0===I?I=0:I>e.length&&Vp(),void 0===t?t=e.length-I:t>e.length-I&&Vp(),this.segments=e,this.offset=I,this.len=t}return GI(g,[{key:"length",get:function(){return this.len}},{key:"isEqual",value:function(e){return 0===g.comparator(this,e)}},{key:"child",value:function(e){var I=this.segments.slice(this.offset,this.limit());return e instanceof g?e.forEach((function(g){I.push(g)})):I.push(e),this.construct(I)}},{key:"limit",value:function(){return this.offset+this.length}},{key:"popFirst",value:function(g){return g=void 0===g?1:g,this.construct(this.segments,this.offset+g,this.length-g)}},{key:"popLast",value:function(){return this.construct(this.segments,this.offset,this.length-1)}},{key:"firstSegment",value:function(){return this.segments[this.offset]}},{key:"lastSegment",value:function(){return this.get(this.length-1)}},{key:"get",value:function(g){return this.segments[this.offset+g]}},{key:"isEmpty",value:function(){return 0===this.length}},{key:"isPrefixOf",value:function(g){if(g.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==g.get(e))return!1;return!0}},{key:"isImmediateParentOf",value:function(g){if(this.length+1!==g.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==g.get(e))return!1;return!0}},{key:"forEach",value:function(g){for(var e=this.offset,I=this.limit();e<I;e++)g(this.segments[e])}},{key:"toArray",value:function(){return this.segments.slice(this.offset,this.limit())}}],[{key:"comparator",value:function(g,e){for(var I=Math.min(g.length,e.length),t=0;t<I;t++){var n=g.get(t),C=e.get(t);if(n<C)return-1;if(n>C)return 1}return g.length<e.length?-1:g.length>e.length?1:0}}]),g}(),Up=function(g){sI(I,g);var e=bI(I);function I(){return mI(this,I),e.apply(this,arguments)}return GI(I,[{key:"construct",value:function(g,e,t){return new I(g,e,t)}},{key:"canonicalString",value:function(){return this.toArray().join("/")}},{key:"toString",value:function(){return this.canonicalString()}}],[{key:"fromString",value:function(){for(var g=[],e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var C=0,l=t;C<l.length;C++){var o=l[C];if(o.indexOf("//")>=0)throw new fp(Sp.INVALID_ARGUMENT,"Invalid segment (".concat(o,"). Paths must not contain // in them."));g.push.apply(g,(0,L.Z)(o.split("/").filter((function(g){return g.length>0}))))}return new I(g)}},{key:"emptyPath",value:function(){return new I([])}}]),I}(zp);var Mp=function(g){function e(g){mI(this,e),this.binaryString=g}return GI(e,[{key:Symbol.iterator,value:function(){var g=this,e=0;return{next:function(){return e<g.binaryString.length?{value:g.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}}},{key:"toBase64",value:function(){return g=this.binaryString,btoa(g);var g}},{key:"toUint8Array",value:function(){return function(g){for(var e=new Uint8Array(g.length),I=0;I<g.length;I++)e[I]=g.charCodeAt(I);return e}(this.binaryString)}},{key:"approximateByteSize",value:function(){return 2*this.binaryString.length}},{key:"compareTo",value:function(g){return xp(this.binaryString,g.binaryString)}},{key:"isEqual",value:function(g){return this.binaryString===g.binaryString}}],[{key:"fromBase64String",value:function(g){return new e(atob(g))}},{key:"fromUint8Array",value:function(g){var I=function(g){for(var e="",I=0;I<g.length;++I)e+=String.fromCharCode(g[I]);return e}(g);return new e(I)}}]),e}();Mp.EMPTY_BYTE_STRING=new Mp("");var Lp=function(){function g(e){mI(this,g),this.path=e}return GI(g,[{key:"hasCollectionId",value:function(g){return this.path.length>=2&&this.path.get(this.path.length-2)===g}},{key:"isEqual",value:function(g){return null!==g&&0===Up.comparator(this.path,g.path)}},{key:"toString",value:function(){return this.path.toString()}}],[{key:"fromPath",value:function(e){return new g(Up.fromString(e))}},{key:"fromName",value:function(e){return new g(Up.fromString(e).popFirst(5))}},{key:"comparator",value:function(g,e){return Up.comparator(g.path,e.path)}},{key:"isDocumentKey",value:function(g){return g.length%2==0}},{key:"fromSegments",value:function(e){return new g(new Up(e.slice()))}}]),g}();var Tp,Qp;(Qp=Tp||(Tp={}))[Qp.OK=0]="OK",Qp[Qp.CANCELLED=1]="CANCELLED",Qp[Qp.UNKNOWN=2]="UNKNOWN",Qp[Qp.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Qp[Qp.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Qp[Qp.NOT_FOUND=5]="NOT_FOUND",Qp[Qp.ALREADY_EXISTS=6]="ALREADY_EXISTS",Qp[Qp.PERMISSION_DENIED=7]="PERMISSION_DENIED",Qp[Qp.UNAUTHENTICATED=16]="UNAUTHENTICATED",Qp[Qp.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Qp[Qp.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Qp[Qp.ABORTED=10]="ABORTED",Qp[Qp.OUT_OF_RANGE=11]="OUT_OF_RANGE",Qp[Qp.UNIMPLEMENTED=12]="UNIMPLEMENTED",Qp[Qp.INTERNAL=13]="INTERNAL",Qp[Qp.UNAVAILABLE=14]="UNAVAILABLE",Qp[Qp.DATA_LOSS=15]="DATA_LOSS";var Dp=function(){function g(e,I){mI(this,g),this.comparator=e,this.root=I||Pp.EMPTY}return GI(g,[{key:"insert",value:function(e,I){return new g(this.comparator,this.root.insert(e,I,this.comparator).copy(null,null,Pp.BLACK,null,null))}},{key:"remove",value:function(e){return new g(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Pp.BLACK,null,null))}},{key:"get",value:function(g){for(var e=this.root;!e.isEmpty();){var I=this.comparator(g,e.key);if(0===I)return e.value;I<0?e=e.left:I>0&&(e=e.right)}return null}},{key:"indexOf",value:function(g){for(var e=0,I=this.root;!I.isEmpty();){var t=this.comparator(g,I.key);if(0===t)return e+I.left.size;t<0?I=I.left:(e+=I.left.size+1,I=I.right)}return-1}},{key:"isEmpty",value:function(){return this.root.isEmpty()}},{key:"size",get:function(){return this.root.size}},{key:"minKey",value:function(){return this.root.minKey()}},{key:"maxKey",value:function(){return this.root.maxKey()}},{key:"inorderTraversal",value:function(g){return this.root.inorderTraversal(g)}},{key:"forEach",value:function(g){this.inorderTraversal((function(e,I){return g(e,I),!1}))}},{key:"toString",value:function(){var g=[];return this.inorderTraversal((function(e,I){return g.push("".concat(e,":").concat(I)),!1})),"{".concat(g.join(", "),"}")}},{key:"reverseTraversal",value:function(g){return this.root.reverseTraversal(g)}},{key:"getIterator",value:function(){return new jp(this.root,null,this.comparator,!1)}},{key:"getIteratorFrom",value:function(g){return new jp(this.root,g,this.comparator,!1)}},{key:"getReverseIterator",value:function(){return new jp(this.root,null,this.comparator,!0)}},{key:"getReverseIteratorFrom",value:function(g){return new jp(this.root,g,this.comparator,!0)}}]),g}(),jp=function(){function g(e,I,t,n){mI(this,g),this.isReverse=n,this.nodeStack=[];for(var C=1;!e.isEmpty();)if(C=I?t(e.key,I):1,n&&(C*=-1),C<0)e=this.isReverse?e.left:e.right;else{if(0===C){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}return GI(g,[{key:"getNext",value:function(){var g=this.nodeStack.pop(),e={key:g.key,value:g.value};if(this.isReverse)for(g=g.left;!g.isEmpty();)this.nodeStack.push(g),g=g.right;else for(g=g.right;!g.isEmpty();)this.nodeStack.push(g),g=g.left;return e}},{key:"hasNext",value:function(){return this.nodeStack.length>0}},{key:"peek",value:function(){if(0===this.nodeStack.length)return null;var g=this.nodeStack[this.nodeStack.length-1];return{key:g.key,value:g.value}}}]),g}(),Pp=function(){function g(e,I,t,n,C){mI(this,g),this.key=e,this.value=I,this.color=null!=t?t:g.RED,this.left=null!=n?n:g.EMPTY,this.right=null!=C?C:g.EMPTY,this.size=this.left.size+1+this.right.size}return GI(g,[{key:"copy",value:function(e,I,t,n,C){return new g(null!=e?e:this.key,null!=I?I:this.value,null!=t?t:this.color,null!=n?n:this.left,null!=C?C:this.right)}},{key:"isEmpty",value:function(){return!1}},{key:"inorderTraversal",value:function(g){return this.left.inorderTraversal(g)||g(this.key,this.value)||this.right.inorderTraversal(g)}},{key:"reverseTraversal",value:function(g){return this.right.reverseTraversal(g)||g(this.key,this.value)||this.left.reverseTraversal(g)}},{key:"min",value:function(){return this.left.isEmpty()?this:this.left.min()}},{key:"minKey",value:function(){return this.min().key}},{key:"maxKey",value:function(){return this.right.isEmpty()?this.key:this.right.maxKey()}},{key:"insert",value:function(g,e,I){var t=this,n=I(g,t.key);return(t=n<0?t.copy(null,null,null,t.left.insert(g,e,I),null):0===n?t.copy(null,e,null,null,null):t.copy(null,null,null,null,t.right.insert(g,e,I))).fixUp()}},{key:"removeMin",value:function(){if(this.left.isEmpty())return g.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()}},{key:"remove",value:function(e,I){var t,n=this;if(I(e,n.key)<0)n.left.isEmpty()||n.left.isRed()||n.left.left.isRed()||(n=n.moveRedLeft()),n=n.copy(null,null,null,n.left.remove(e,I),null);else{if(n.left.isRed()&&(n=n.rotateRight()),n.right.isEmpty()||n.right.isRed()||n.right.left.isRed()||(n=n.moveRedRight()),0===I(e,n.key)){if(n.right.isEmpty())return g.EMPTY;t=n.right.min(),n=n.copy(t.key,t.value,null,null,n.right.removeMin())}n=n.copy(null,null,null,null,n.right.remove(e,I))}return n.fixUp()}},{key:"isRed",value:function(){return this.color}},{key:"fixUp",value:function(){var g=this;return g.right.isRed()&&!g.left.isRed()&&(g=g.rotateLeft()),g.left.isRed()&&g.left.left.isRed()&&(g=g.rotateRight()),g.left.isRed()&&g.right.isRed()&&(g=g.colorFlip()),g}},{key:"moveRedLeft",value:function(){var g=this.colorFlip();return g.right.left.isRed()&&(g=(g=(g=g.copy(null,null,null,null,g.right.rotateRight())).rotateLeft()).colorFlip()),g}},{key:"moveRedRight",value:function(){var g=this.colorFlip();return g.left.left.isRed()&&(g=(g=g.rotateRight()).colorFlip()),g}},{key:"rotateLeft",value:function(){var e=this.copy(null,null,g.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}},{key:"rotateRight",value:function(){var e=this.copy(null,null,g.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}},{key:"colorFlip",value:function(){var g=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,g,e)}},{key:"checkMaxDepth",value:function(){var g=this.check();return Math.pow(2,g)<=this.size+1}},{key:"check",value:function(){if(this.isRed()&&this.left.isRed())throw Vp();if(this.right.isRed())throw Vp();var g=this.left.check();if(g!==this.right.check())throw Vp();return g+(this.isRed()?0:1)}}]),g}();Pp.EMPTY=null,Pp.RED=!0,Pp.BLACK=!1,Pp.EMPTY=new(function(){function g(){mI(this,g),this.size=0}return GI(g,[{key:"key",get:function(){throw Vp()}},{key:"value",get:function(){throw Vp()}},{key:"color",get:function(){throw Vp()}},{key:"left",get:function(){throw Vp()}},{key:"right",get:function(){throw Vp()}},{key:"copy",value:function(g,e,I,t,n){return this}},{key:"insert",value:function(g,e,I){return new Pp(g,e)}},{key:"remove",value:function(g,e){return this}},{key:"isEmpty",value:function(){return!0}},{key:"inorderTraversal",value:function(g){return!1}},{key:"reverseTraversal",value:function(g){return!1}},{key:"minKey",value:function(){return null}},{key:"maxKey",value:function(){return null}},{key:"isRed",value:function(){return!1}},{key:"checkMaxDepth",value:function(){return!0}},{key:"check",value:function(){return 0}}]),g}());var Op=function(){function g(e){mI(this,g),this.comparator=e,this.data=new Dp(this.comparator)}return GI(g,[{key:"has",value:function(g){return null!==this.data.get(g)}},{key:"first",value:function(){return this.data.minKey()}},{key:"last",value:function(){return this.data.maxKey()}},{key:"size",get:function(){return this.data.size}},{key:"indexOf",value:function(g){return this.data.indexOf(g)}},{key:"forEach",value:function(g){this.data.inorderTraversal((function(e,I){return g(e),!1}))}},{key:"forEachInRange",value:function(g,e){for(var I=this.data.getIteratorFrom(g[0]);I.hasNext();){var t=I.getNext();if(this.comparator(t.key,g[1])>=0)return;e(t.key)}}},{key:"forEachWhile",value:function(g,e){var I;for(I=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();I.hasNext();)if(!g(I.getNext().key))return}},{key:"firstAfterOrEqual",value:function(g){var e=this.data.getIteratorFrom(g);return e.hasNext()?e.getNext().key:null}},{key:"getIterator",value:function(){return new _p(this.data.getIterator())}},{key:"getIteratorFrom",value:function(g){return new _p(this.data.getIteratorFrom(g))}},{key:"add",value:function(g){return this.copy(this.data.remove(g).insert(g,!0))}},{key:"delete",value:function(g){return this.has(g)?this.copy(this.data.remove(g)):this}},{key:"isEmpty",value:function(){return this.data.isEmpty()}},{key:"unionWith",value:function(g){var e=this;return e.size<g.size&&(e=g,g=this),g.forEach((function(g){e=e.add(g)})),e}},{key:"isEqual",value:function(e){if(!(e instanceof g))return!1;if(this.size!==e.size)return!1;for(var I=this.data.getIterator(),t=e.data.getIterator();I.hasNext();){var n=I.getNext().key,C=t.getNext().key;if(0!==this.comparator(n,C))return!1}return!0}},{key:"toArray",value:function(){var g=[];return this.forEach((function(e){g.push(e)})),g}},{key:"toString",value:function(){var g=[];return this.forEach((function(e){return g.push(e)})),"SortedSet("+g.toString()+")"}},{key:"copy",value:function(e){var I=new g(this.comparator);return I.data=e,I}}]),g}(),_p=function(){function g(e){mI(this,g),this.iter=e}return GI(g,[{key:"getNext",value:function(){return this.iter.getNext().key}},{key:"hasNext",value:function(){return this.iter.hasNext()}}]),g}();new Dp(Lp.comparator);new Dp(Lp.comparator);new Dp(Lp.comparator);new Op(Lp.comparator);new Op(xp);function qp(g){for(var e="",I=0;I<g.length;I++)e.length>0&&(e=gy(e)),e=$p(g.get(I),e);return gy(e)}function $p(g,e){for(var I=e,t=g.length,n=0;n<t;n++){var C=g.charAt(n);switch(C){case"\0":I+="\x01\x10";break;case"\x01":I+="\x01\x11";break;default:I+=C}}return I}function gy(g){return g+"\x01\x01"}var ey=GI((function g(e,I,t){mI(this,g),this.ownerId=e,this.allowTabSynchronization=I,this.leaseTimestampMs=t}));ey.store="owner",ey.key="owner";var Iy=GI((function g(e,I,t){mI(this,g),this.userId=e,this.lastAcknowledgedBatchId=I,this.lastStreamToken=t}));Iy.store="mutationQueues",Iy.keyPath="userId";var ty=GI((function g(e,I,t,n,C){mI(this,g),this.userId=e,this.batchId=I,this.localWriteTimeMs=t,this.baseMutations=n,this.mutations=C}));ty.store="mutations",ty.keyPath="batchId",ty.userMutationsIndex="userMutationsIndex",ty.userMutationsKeyPath=["userId","batchId"];var ny=function(){function g(){mI(this,g)}return GI(g,null,[{key:"prefixForUser",value:function(g){return[g]}},{key:"prefixForPath",value:function(g,e){return[g,qp(e)]}},{key:"key",value:function(g,e,I){return[g,qp(e),I]}}]),g}();ny.store="documentMutations",ny.PLACEHOLDER=new ny;var Cy=GI((function g(e,I,t,n,C,l){mI(this,g),this.unknownDocument=e,this.noDocument=I,this.document=t,this.hasCommittedMutations=n,this.readTime=C,this.parentPath=l}));Cy.store="remoteDocuments",Cy.readTimeIndex="readTimeIndex",Cy.readTimeIndexPath="readTime",Cy.collectionReadTimeIndex="collectionReadTimeIndex",Cy.collectionReadTimeIndexPath=["parentPath","readTime"];var ly=GI((function g(e){mI(this,g),this.byteSize=e}));ly.store="remoteDocumentGlobal",ly.key="remoteDocumentGlobalKey";var oy=GI((function g(e,I,t,n,C,l,o){mI(this,g),this.targetId=e,this.canonicalId=I,this.readTime=t,this.resumeToken=n,this.lastListenSequenceNumber=C,this.lastLimboFreeSnapshotVersion=l,this.query=o}));oy.store="targets",oy.keyPath="targetId",oy.queryTargetsIndexName="queryTargetsIndex",oy.queryTargetsKeyPath=["canonicalId","targetId"];var ay=GI((function g(e,I,t){mI(this,g),this.targetId=e,this.path=I,this.sequenceNumber=t}));ay.store="targetDocuments",ay.keyPath=["targetId","path"],ay.documentTargetsIndex="documentTargetsIndex",ay.documentTargetsKeyPath=["path","targetId"];var iy=GI((function g(e,I,t,n){mI(this,g),this.highestTargetId=e,this.highestListenSequenceNumber=I,this.lastRemoteSnapshotVersion=t,this.targetCount=n}));iy.key="targetGlobalKey",iy.store="targetGlobal";var ry=GI((function g(e,I){mI(this,g),this.collectionId=e,this.parent=I}));ry.store="collectionParents",ry.keyPath=["collectionId","parent"];var cy=GI((function g(e,I,t,n){mI(this,g),this.clientId=e,this.updateTimeMs=I,this.networkEnabled=t,this.inForeground=n}));cy.store="clientMetadata",cy.keyPath="clientId";var Ay=GI((function g(e,I,t){mI(this,g),this.bundleId=e,this.createTime=I,this.version=t}));Ay.store="bundles",Ay.keyPath="bundleId";var uy=GI((function g(e,I,t){mI(this,g),this.name=e,this.readTime=I,this.bundledQuery=t}));uy.store="namedQueries",uy.keyPath="name";[Iy.store,ty.store,ny.store,Cy.store,oy.store,ey.store,iy.store,ay.store].concat([cy.store]).concat([ly.store]).concat([ry.store]).concat([Ay.store,uy.store]);function sy(g){return"IndexedDbTransactionError"===g.name}var dy=function(){function g(e,I,t){mI(this,g),this.cacheSizeCollectionThreshold=e,this.percentileToCollect=I,this.maximumSequenceNumbersToCollect=t}return GI(g,null,[{key:"withCacheSize",value:function(e){return new g(e,g.DEFAULT_COLLECTION_PERCENTILE,g.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}]),g}();dy.DEFAULT_COLLECTION_PERCENTILE=10,dy.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,dy.DEFAULT=new dy(41943040,dy.DEFAULT_COLLECTION_PERCENTILE,dy.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),dy.DISABLED=new dy(-1,0,0);function Zy(){return"undefined"!=typeof document?document:null}var by=function(){function g(e,I){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,C=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;mI(this,g),this.Me=e,this.timerId=I,this.Wi=t,this.Gi=n,this.zi=C,this.Hi=0,this.Ji=null,this.Yi=Date.now(),this.reset()}return GI(g,[{key:"reset",value:function(){this.Hi=0}},{key:"Xi",value:function(){this.Hi=this.zi}},{key:"Zi",value:function(g){var e=this;this.cancel();var I=Math.floor(this.Hi+this.tr()),t=Math.max(0,Date.now()-this.Yi),n=Math.max(0,I-t);n>0&&yp("ExponentialBackoff","Backing off for ".concat(n," ms (base delay: ").concat(this.Hi," ms, delay with jitter: ").concat(I," ms, last attempt: ").concat(t," ms ago)")),this.Ji=this.Me.enqueueAfterDelay(this.timerId,n,(function(){return e.Yi=Date.now(),g()})),this.Hi*=this.Gi,this.Hi<this.Wi&&(this.Hi=this.Wi),this.Hi>this.zi&&(this.Hi=this.zi)}},{key:"er",value:function(){null!==this.Ji&&(this.Ji.skipDelay(),this.Ji=null)}},{key:"cancel",value:function(){null!==this.Ji&&(this.Ji.cancel(),this.Ji=null)}},{key:"tr",value:function(){return(Math.random()-.5)*this.Hi}}]),g}();var my=function(){function g(e,I,t,n,C){mI(this,g),this.asyncQueue=e,this.timerId=I,this.targetTimeMs=t,this.op=n,this.removalCallback=C,this.deferred=new kp,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((function(g){}))}return GI(g,[{key:"start",value:function(g){var e=this;this.timerHandle=setTimeout((function(){return e.handleDelayElapsed()}),g)}},{key:"skipDelay",value:function(){return this.handleDelayElapsed()}},{key:"cancel",value:function(g){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new fp(Sp.CANCELLED,"Operation cancelled"+(g?": "+g:""))))}},{key:"handleDelayElapsed",value:function(){var g=this;this.asyncQueue.enqueueAndForget((function(){return null!==g.timerHandle?(g.clearTimeout(),g.op().then((function(e){return g.deferred.resolve(e)}))):Promise.resolve()}))}},{key:"clearTimeout",value:function(g){function e(){return g.apply(this,arguments)}return e.toString=function(){return g.toString()},e}((function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}))}],[{key:"createAndSchedule",value:function(e,I,t,n,C){var l=new g(e,I,Date.now()+t,n,C);return l.start(t),l}}]),g}();function hy(g,e){if(Bp("AsyncQueue","".concat(e,": ").concat(g)),sy(g))return new fp(Sp.UNAVAILABLE,"".concat(e,": ").concat(g));throw g}var Gy=function(){function g(e,I,t,n){var C=this;mI(this,g),this.authCredentials=e,this.appCheckCredentials=I,this.asyncQueue=t,this.databaseInfo=n,this.user=hp.UNAUTHENTICATED,this.clientId=Ep.A(),this.authCredentialListener=function(){return Promise.resolve()},this.authCredentials.start(t,function(){var g=lI(yI().mark((function g(e){return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return yp("FirestoreClient","Received user=",e.uid),g.next=3,C.authCredentialListener(e);case 3:C.user=e;case 4:case"end":return g.stop()}}),g)})));return function(e){return g.apply(this,arguments)}}()),this.appCheckCredentials.start(t,(function(){return Promise.resolve()}))}return GI(g,[{key:"getConfiguration",value:function(){var g=lI(yI().mark((function g(){return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.abrupt("return",{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100});case 1:case"end":return g.stop()}}),g,this)})));return function(){return g.apply(this,arguments)}}()},{key:"setCredentialChangeListener",value:function(g){this.authCredentialListener=g}},{key:"verifyNotTerminated",value:function(){if(this.asyncQueue.isShuttingDown)throw new fp(Sp.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"terminate",value:function(){var g=this;this.asyncQueue.enterRestrictedMode();var e=new kp;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(lI(yI().mark((function I(){var t;return yI().wrap((function(I){for(;;)switch(I.prev=I.next){case 0:if(I.prev=0,I.t0=g.onlineComponents,!I.t0){I.next=5;break}return I.next=5,g.onlineComponents.terminate();case 5:if(I.t1=g.offlineComponents,!I.t1){I.next=9;break}return I.next=9,g.offlineComponents.terminate();case 9:g.authCredentials.shutdown(),g.appCheckCredentials.shutdown(),e.resolve(),I.next=18;break;case 14:I.prev=14,I.t2=I.catch(0),t=hy(I.t2,"Failed to shutdown persistence"),e.reject(t);case 18:case"end":return I.stop()}}),I,null,[[0,14]])})))),e.promise}}]),g}();var py=GI((function g(e,I,t,n,C,l,o,a){mI(this,g),this.databaseId=e,this.appId=I,this.persistenceKey=t,this.host=n,this.ssl=C,this.forceLongPolling=l,this.autoDetectLongPolling=o,this.useFetchStreams=a})),yy=function(){function g(e,I){mI(this,g),this.projectId=e,this.database=I||"(default)"}return GI(g,[{key:"isDefaultDatabase",get:function(){return"(default)"===this.database}},{key:"isEqual",value:function(e){return e instanceof g&&e.projectId===this.projectId&&e.database===this.database}}]),g}(),By=new Map;var vy=function(){function g(e){var I;if(mI(this,g),void 0===e.host){if(void 0!==e.ssl)throw new fp(Sp.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(I=e.ssl)||void 0===I||I;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new fp(Sp.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,function(g,e,I,t){if(!0===e&&!0===t)throw new fp(Sp.INVALID_ARGUMENT,"".concat(g," and ").concat(I," cannot be used together."))}("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}return GI(g,[{key:"isEqual",value:function(g){return this.host===g.host&&this.ssl===g.ssl&&this.credentials===g.credentials&&this.cacheSizeBytes===g.cacheSizeBytes&&this.experimentalForceLongPolling===g.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===g.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===g.ignoreUndefinedProperties&&this.useFetchStreams===g.useFetchStreams}}]),g}(),Vy=function(){function g(e,I,t){mI(this,g),this._authCredentials=I,this._appCheckCredentials=t,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new vy({}),this._settingsFrozen=!1,e instanceof yy?this._databaseId=e:(this._app=e,this._databaseId=function(g){if(!Object.prototype.hasOwnProperty.apply(g.options,["projectId"]))throw new fp(Sp.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new yy(g.options.projectId)}(e))}return GI(g,[{key:"app",get:function(){if(!this._app)throw new fp(Sp.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}},{key:"_initialized",get:function(){return this._settingsFrozen}},{key:"_terminated",get:function(){return void 0!==this._terminateTask}},{key:"_setSettings",value:function(g){if(this._settingsFrozen)throw new fp(Sp.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new vy(g),void 0!==g.credentials&&(this._authCredentials=function(g){if(!g)return new Xp;switch(g.type){case"gapi":var e=g.client;return Wp(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Hp(e,g.sessionIndex||"0",g.iamToken||null);case"provider":return g.client;default:throw new fp(Sp.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(g.credentials))}},{key:"_getSettings",value:function(){return this._settings}},{key:"_freezeSettings",value:function(){return this._settingsFrozen=!0,this._settings}},{key:"_delete",value:function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}},{key:"toJSON",value:function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}},{key:"_terminate",value:function(){return function(g){var e=By.get(g);e&&(yp("ComponentProvider","Removing Datastore"),By.delete(g),e.terminate())}(this),Promise.resolve()}}]),g}();var Wy=function(){function g(){var e=this;mI(this,g),this.mc=Promise.resolve(),this.gc=[],this.yc=!1,this.Tc=[],this.Ec=null,this.Ic=!1,this.Ac=!1,this.Rc=[],this.ur=new by(this,"async_queue_retry"),this.bc=function(){var g=Zy();g&&yp("AsyncQueue","Visibility state changed to "+g.visibilityState),e.ur.er()};var I=Zy();I&&"function"==typeof I.addEventListener&&I.addEventListener("visibilitychange",this.bc)}return GI(g,[{key:"isShuttingDown",get:function(){return this.yc}},{key:"enqueueAndForget",value:function(g){this.enqueue(g)}},{key:"enqueueAndForgetEvenWhileRestricted",value:function(g){this.Pc(),this.vc(g)}},{key:"enterRestrictedMode",value:function(g){if(!this.yc){this.yc=!0,this.Ac=g||!1;var e=Zy();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.bc)}}},{key:"enqueue",value:function(g){var e=this;if(this.Pc(),this.yc)return new Promise((function(){}));var I=new kp;return this.vc((function(){return e.yc&&e.Ac?Promise.resolve():(g().then(I.resolve,I.reject),I.promise)})).then((function(){return I.promise}))}},{key:"enqueueRetryable",value:function(g){var e=this;this.enqueueAndForget((function(){return e.gc.push(g),e.Vc()}))}},{key:"Vc",value:function(){var g=lI(yI().mark((function g(){var e=this;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(0===this.gc.length){g.next=14;break}return g.prev=1,g.next=4,this.gc[0]();case 4:this.gc.shift(),this.ur.reset(),g.next=13;break;case 8:if(g.prev=8,g.t0=g.catch(1),sy(g.t0)){g.next=12;break}throw g.t0;case 12:yp("AsyncQueue","Operation failed with retryable error: "+g.t0);case 13:this.gc.length>0&&this.ur.Zi((function(){return e.Vc()}));case 14:case"end":return g.stop()}}),g,this,[[1,8]])})));return function(){return g.apply(this,arguments)}}()},{key:"vc",value:function(g){var e=this,I=this.mc.then((function(){return e.Ic=!0,g().catch((function(g){e.Ec=g,e.Ic=!1;var I=function(g){var e=g.message||"";return g.stack&&(e=g.stack.includes(g.message)?g.stack:g.message+"\n"+g.stack),e}(g);throw Bp("INTERNAL UNHANDLED ERROR: ",I),g})).then((function(g){return e.Ic=!1,g}))}));return this.mc=I,I}},{key:"enqueueAfterDelay",value:function(g,e,I){var t=this;this.Pc(),this.Rc.indexOf(g)>-1&&(e=0);var n=my.createAndSchedule(this,g,e,I,(function(g){return t.Sc(g)}));return this.Tc.push(n),n}},{key:"Pc",value:function(){this.Ec&&Vp()}},{key:"verifyOperationInProgress",value:function(){}},{key:"Dc",value:function(){var g=lI(yI().mark((function g(){var e;return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return e=this.mc,g.next=3,e;case 3:if(e!==this.mc){g.next=0;break}case 4:case"end":return g.stop()}}),g,this)})));return function(){return g.apply(this,arguments)}}()},{key:"Cc",value:function(g){var e,I=cI(this.Tc);try{for(I.s();!(e=I.n()).done;){if(e.value.timerId===g)return!0}}catch(t){I.e(t)}finally{I.f()}return!1}},{key:"Nc",value:function(g){var e=this;return this.Dc().then((function(){e.Tc.sort((function(g,e){return g.targetTimeMs-e.targetTimeMs}));var I,t=cI(e.Tc);try{for(t.s();!(I=t.n()).done;){var n=I.value;if(n.skipDelay(),"all"!==g&&n.timerId===g)break}}catch(C){t.e(C)}finally{t.f()}return e.Dc()}))}},{key:"kc",value:function(g){this.Rc.push(g)}},{key:"Sc",value:function(g){var e=this.Tc.indexOf(g);this.Tc.splice(e,1)}}]),g}();var Sy=function(g){sI(I,g);var e=bI(I);function I(g,t,n){var C;return mI(this,I),(C=e.call(this,g,t,n)).type="firestore",C._queue=new Wy,C._persistenceKey="name"in g?g.name:"[DEFAULT]",C}return GI(I,[{key:"_terminate",value:function(){return this._firestoreClient||ky(this),this._firestoreClient.terminate()}}]),I}(Vy);function fy(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Pr();return Ur(g,"firestore").getImmediate()}function ky(g){var e,I=g._freezeSettings(),t=function(g,e,I,t){return new py(g,e,I,t.host,t.ssl,t.experimentalForceLongPolling,t.experimentalAutoDetectLongPolling,t.useFetchStreams)}(g._databaseId,(null===(e=g._app)||void 0===e?void 0:e.options.appId)||"",g._persistenceKey,I);g._firestoreClient=new Gy(g._authCredentials,g._appCheckCredentials,g._queue,t)}!function(g){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Gp="9.6.3",zr(new mr("firestore",(function(g,I){var t=I.options,n=g.getProvider("app").getImmediate(),C=new Sy(n,new Jp(g.getProvider("auth-internal")),new Np(g.getProvider("app-check-internal")));return t=Object.assign({useFetchStreams:e},t),C._setSettings(t),C}),"PUBLIC")),Or(mp,"3.4.3",g),Or(mp,"3.4.3","esm2017")}();var Ry={apiKey:"AIzaSyCDQaq4-ShhGwr-rnGYEJ7JcQ6rAAOBXY4",authDomain:"inc-be-project.firebaseapp.com",projectId:"inc-be-project",storageBucket:"inc-be-project.appspot.com",messagingSenderId:"127227560265",appId:"1:127227560265:web:e4349e372b0f694fc19a98",measurementId:"G-W6MVMR4QTL"},Xy=function(){var g=lI(yI().mark((function g(){return yI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:g.prev=0,jr(Ry),fy(),Us(),g.next=10;break;case 6:return g.prev=6,g.t0=g.catch(0),console.error(g.t0),g.abrupt("return",g.t0);case 10:case"end":return g.stop()}}),g,null,[[0,6]])})));return function(){return g.apply(this,arguments)}}(),Jy=Xy,Yy=I(5519),Hy=(0,Je.Z)({components:{MuiAppBar:{styleOverrides:{colorDefault:{backgroundColor:Yy.Z[50]}}}}});Jy(),e.render((0,Ig.jsxs)(nb,{theme:Hy,children:[(0,Ig.jsx)(rb,{}),(0,Ig.jsx)(Ee,{children:(0,Ig.jsx)(Oi,{children:(0,Ig.jsx)(Ab,{onError:console.log,errorComponent:(0,Ig.jsx)(ub,{}),children:(0,Ig.jsx)(OZ,{})})})})]}),document.getElementById("root")),function(g){if("serviceWorker"in navigator){if(new URL("/trail-room",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("/trail-room","/service-worker.js");_Z?(!function(g,e){fetch(g,{headers:{"Service-Worker":"script"}}).then((function(I){var t=I.headers.get("content-type");404===I.status||null!=t&&-1===t.indexOf("javascript")?navigator.serviceWorker.ready.then((function(g){g.unregister().then((function(){window.location.reload()}))})):qZ(g,e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e,g),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):qZ(e,g)}))}}()}()}();
//# sourceMappingURL=main.f2047555.js.map